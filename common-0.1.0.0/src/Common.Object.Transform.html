<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Common.Object.Transform
Description : Key frame animation for object transformation.
Copyright   : (c) Xie Ruifeng, 2020
License     : AGPL-3
Maintainer  : krantz.xrf@outlook.com
Stability   : experimental
Portability : portable
-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Common.Object.Transform</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Renderable Objects</span></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- | 'SceneRender' is used for procedural 'Object' creation in place of 'Renderable'.</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Common.Object.Transform.html#GroupRender"><span class="hs-identifier">GroupRender</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#oNewGroup"><span class="hs-identifier">oNewGroup</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#oNewGroupScaled"><span class="hs-identifier">oNewGroupScaled</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#oNewCentered"><span class="hs-identifier">oNewCentered</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Alignment</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-comment">-- | Alignment controls how the objects in the next key frame is aligned according to</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-comment">--   those objects from the current frame.</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier">GroupAlignment</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#applyAlignment"><span class="hs-identifier">applyAlignment</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Group Modifier</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#scaled"><span class="hs-identifier">scaled</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#allMargins"><span class="hs-identifier">allMargins</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#withMargin"><span class="hs-identifier">withMargin</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** X Alignment</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#leftAligned"><span class="hs-identifier">leftAligned</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#rightAligned"><span class="hs-identifier">rightAligned</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#xCentered"><span class="hs-identifier">xCentered</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#placedBelow"><span class="hs-identifier">placedBelow</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Y Alignment</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#bottomAligned"><span class="hs-identifier">bottomAligned</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#topAligned"><span class="hs-identifier">topAligned</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#yCentered"><span class="hs-identifier">yCentered</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Key Frame Animations</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier">Trans</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#%3A%3D%3E"><span class="hs-operator">(:=&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#transOrigin"><span class="hs-identifier">transOrigin</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#transformObject%27"><span class="hs-identifier">transformObject'</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#transformObject"><span class="hs-identifier">transformObject</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#dupFromObject"><span class="hs-identifier">dupFromObject</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Object duplication</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#dupObject"><span class="hs-identifier">dupObject</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Primitives</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#readGroupTrans"><span class="hs-identifier">readGroupTrans</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Compose</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Linear.V2</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Linear.Vector</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(*^)</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.SvgTree.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Coord</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Reanimate</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Reanimate.Scene</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- |Duplicate the object, make it independent from the original.</span><span>
</span><span id="line-63"></span><span id="local-6989586621679232611"><span id="local-6989586621679232612"><span class="annot"><a href="Common.Object.Transform.html#dupObject"><span class="hs-identifier hs-type">dupObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Renderable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232611"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232611"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232611"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-64"></span><span id="dupObject"><span class="annot"><span class="annottext">dupObject :: Object s a -&gt; Scene s (Object s a)
</span><a href="Common.Object.Transform.html#dupObject"><span class="hs-identifier hs-var hs-var">dupObject</span></a></span></span><span> </span><span id="local-6989586621679232576"><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232576"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679232575"><span class="annot"><span class="annottext">ObjectData a
</span><a href="#local-6989586621679232575"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object s a
-&gt; Getting (ObjectData a) (ObjectData a) (ObjectData a)
-&gt; Scene s (ObjectData a)
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-identifier hs-var">oRead</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232576"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (ObjectData a) (ObjectData a) (ObjectData a)
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679232572"><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232572"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; Scene s (Object s a)
forall a s. Renderable a =&gt; a -&gt; Scene s (Object s a)
</span><span class="hs-identifier hs-var">oNew</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting a (ObjectData a) a -&gt; ObjectData a -&gt; a
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting a (ObjectData a) a
forall a. Renderable a =&gt; Lens' (ObjectData a) a
</span><span class="hs-identifier hs-var">oValue</span></span><span> </span><span class="annot"><span class="annottext">ObjectData a
</span><a href="#local-6989586621679232575"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232572"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectData a -&gt; ObjectData a -&gt; ObjectData a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ObjectData a
</span><a href="#local-6989586621679232575"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">Object s a -&gt; Scene s (Object s a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232572"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- |Description for key frame animations.</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- __Note__:</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- * 'IsString' instance provided here for conveniently creating new objects.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- * The following objects are collected as the base for alignment:</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">--     * Objects that vanished, or</span><span>
</span><span id="line-78"></span><span class="hs-comment">--     * Source objects for transformations</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- * The following objects are collected as the target for alignment:</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">--     * Objects newly created, or</span><span>
</span><span id="line-83"></span><span class="hs-comment">--     * Target objects for transformations</span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="Trans"><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-var">Trans</span></a></span></span><span> </span><span id="local-6989586621679232850"><span class="annot"><a href="#local-6989586621679232850"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679232851"><span class="annot"><a href="#local-6989586621679232851"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- |Object newly created in this frame.</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="New"><span class="annot"><a href="Common.Object.Transform.html#New"><span class="hs-identifier hs-var">New</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679232851"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- |Previous object vanishing in this frame.</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Vanish"><span class="annot"><a href="Common.Object.Transform.html#Vanish"><span class="hs-identifier hs-var">Vanish</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679232850"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">-- |Object transformaton in this frame.</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679232850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span id="%3A%3A%3D%3E"><span class="annot"><a href="Common.Object.Transform.html#%3A%3A%3D%3E"><span class="hs-operator hs-var">::=&gt;</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679232851"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679232558"><span id="local-6989586621679232560"><span id="local-6989586621679232562"><span class="annot"><span class="annottext">Int -&gt; Trans a b -&gt; ShowS
[Trans a b] -&gt; ShowS
Trans a b -&gt; String
(Int -&gt; Trans a b -&gt; ShowS)
-&gt; (Trans a b -&gt; String)
-&gt; ([Trans a b] -&gt; ShowS)
-&gt; Show (Trans a b)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a b. (Show b, Show a) =&gt; Int -&gt; Trans a b -&gt; ShowS
forall a b. (Show b, Show a) =&gt; [Trans a b] -&gt; ShowS
forall a b. (Show b, Show a) =&gt; Trans a b -&gt; String
showList :: [Trans a b] -&gt; ShowS
$cshowList :: forall a b. (Show b, Show a) =&gt; [Trans a b] -&gt; ShowS
show :: Trans a b -&gt; String
$cshow :: forall a b. (Show b, Show a) =&gt; Trans a b -&gt; String
showsPrec :: Int -&gt; Trans a b -&gt; ShowS
$cshowsPrec :: forall a b. (Show b, Show a) =&gt; Int -&gt; Trans a b -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232553"><span id="local-6989586621679232555"><span class="annot"><span class="annottext">a -&gt; Trans a b -&gt; Trans a a
(a -&gt; b) -&gt; Trans a a -&gt; Trans a b
(forall a b. (a -&gt; b) -&gt; Trans a a -&gt; Trans a b)
-&gt; (forall a b. a -&gt; Trans a b -&gt; Trans a a) -&gt; Functor (Trans a)
forall a b. a -&gt; Trans a b -&gt; Trans a a
forall a b. (a -&gt; b) -&gt; Trans a a -&gt; Trans a b
forall a a b. a -&gt; Trans a b -&gt; Trans a a
forall a a b. (a -&gt; b) -&gt; Trans a a -&gt; Trans a b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Trans a b -&gt; Trans a a
$c&lt;$ :: forall a a b. a -&gt; Trans a b -&gt; Trans a a
fmap :: (a -&gt; b) -&gt; Trans a a -&gt; Trans a b
$cfmap :: forall a a b. (a -&gt; b) -&gt; Trans a a -&gt; Trans a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232518"><span id="local-6989586621679232520"><span id="local-6989586621679232522"><span id="local-6989586621679232524"><span id="local-6989586621679232526"><span id="local-6989586621679232528"><span id="local-6989586621679232530"><span id="local-6989586621679232532"><span id="local-6989586621679232534"><span id="local-6989586621679232536"><span id="local-6989586621679232538"><span id="local-6989586621679232540"><span id="local-6989586621679232542"><span id="local-6989586621679232544"><span id="local-6989586621679232546"><span id="local-6989586621679232548"><span id="local-6989586621679232550"><span class="annot"><span class="annottext">Trans a a -&gt; Bool
(a -&gt; m) -&gt; Trans a a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
(forall m. Monoid m =&gt; Trans a m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Trans a a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Trans a a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a)
-&gt; (forall a. Trans a a -&gt; [a])
-&gt; (forall a. Trans a a -&gt; Bool)
-&gt; (forall a. Trans a a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Trans a a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Trans a a -&gt; a)
-&gt; (forall a. Ord a =&gt; Trans a a -&gt; a)
-&gt; (forall a. Num a =&gt; Trans a a -&gt; a)
-&gt; (forall a. Num a =&gt; Trans a a -&gt; a)
-&gt; Foldable (Trans a)
forall a. Eq a =&gt; a -&gt; Trans a a -&gt; Bool
forall a. Num a =&gt; Trans a a -&gt; a
forall a. Ord a =&gt; Trans a a -&gt; a
forall m. Monoid m =&gt; Trans a m -&gt; m
forall a. Trans a a -&gt; Bool
forall a. Trans a a -&gt; Int
forall a. Trans a a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a
forall a a. Eq a =&gt; a -&gt; Trans a a -&gt; Bool
forall a a. Num a =&gt; Trans a a -&gt; a
forall a a. Ord a =&gt; Trans a a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Trans a a -&gt; m
forall a m. Monoid m =&gt; Trans a m -&gt; m
forall a a. Trans a a -&gt; Bool
forall a a. Trans a a -&gt; Int
forall a a. Trans a a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
forall a a. (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a
forall a m a. Monoid m =&gt; (a -&gt; m) -&gt; Trans a a -&gt; m
forall a b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
forall a a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: Trans a a -&gt; a
$cproduct :: forall a a. Num a =&gt; Trans a a -&gt; a
sum :: Trans a a -&gt; a
$csum :: forall a a. Num a =&gt; Trans a a -&gt; a
minimum :: Trans a a -&gt; a
$cminimum :: forall a a. Ord a =&gt; Trans a a -&gt; a
maximum :: Trans a a -&gt; a
$cmaximum :: forall a a. Ord a =&gt; Trans a a -&gt; a
elem :: a -&gt; Trans a a -&gt; Bool
$celem :: forall a a. Eq a =&gt; a -&gt; Trans a a -&gt; Bool
length :: Trans a a -&gt; Int
$clength :: forall a a. Trans a a -&gt; Int
null :: Trans a a -&gt; Bool
$cnull :: forall a a. Trans a a -&gt; Bool
toList :: Trans a a -&gt; [a]
$ctoList :: forall a a. Trans a a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a
$cfoldl1 :: forall a a. (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a
$cfoldr1 :: forall a a. (a -&gt; a -&gt; a) -&gt; Trans a a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
$cfoldl' :: forall a b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
$cfoldl :: forall a b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
$cfoldr' :: forall a a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
$cfoldr :: forall a a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Trans a a -&gt; b
foldMap' :: (a -&gt; m) -&gt; Trans a a -&gt; m
$cfoldMap' :: forall a m a. Monoid m =&gt; (a -&gt; m) -&gt; Trans a a -&gt; m
foldMap :: (a -&gt; m) -&gt; Trans a a -&gt; m
$cfoldMap :: forall a m a. Monoid m =&gt; (a -&gt; m) -&gt; Trans a a -&gt; m
fold :: Trans a m -&gt; m
$cfold :: forall a m. Monoid m =&gt; Trans a m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232507"><span id="local-6989586621679232509"><span id="local-6989586621679232511"><span id="local-6989586621679232513"><span class="annot"><span class="annottext">Functor (Trans a)
Foldable (Trans a)
Functor (Trans a)
-&gt; Foldable (Trans a)
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; Trans a a -&gt; f (Trans a b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    Trans a (f a) -&gt; f (Trans a a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Trans a a -&gt; m (Trans a b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    Trans a (m a) -&gt; m (Trans a a))
-&gt; Traversable (Trans a)
(a -&gt; f b) -&gt; Trans a a -&gt; f (Trans a b)
forall a. Functor (Trans a)
forall a. Foldable (Trans a)
forall a (m :: * -&gt; *) a. Monad m =&gt; Trans a (m a) -&gt; m (Trans a a)
forall a (f :: * -&gt; *) a.
Applicative f =&gt;
Trans a (f a) -&gt; f (Trans a a)
forall a (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Trans a a -&gt; m (Trans a b)
forall a (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Trans a a -&gt; f (Trans a b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Trans a (m a) -&gt; m (Trans a a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Trans a (f a) -&gt; f (Trans a a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Trans a a -&gt; m (Trans a b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Trans a a -&gt; f (Trans a b)
sequence :: Trans a (m a) -&gt; m (Trans a a)
$csequence :: forall a (m :: * -&gt; *) a. Monad m =&gt; Trans a (m a) -&gt; m (Trans a a)
mapM :: (a -&gt; m b) -&gt; Trans a a -&gt; m (Trans a b)
$cmapM :: forall a (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Trans a a -&gt; m (Trans a b)
sequenceA :: Trans a (f a) -&gt; f (Trans a a)
$csequenceA :: forall a (f :: * -&gt; *) a.
Applicative f =&gt;
Trans a (f a) -&gt; f (Trans a a)
traverse :: (a -&gt; f b) -&gt; Trans a a -&gt; f (Trans a b)
$ctraverse :: forall a (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Trans a a -&gt; f (Trans a b)
$cp2Traversable :: forall a. Foldable (Trans a)
$cp1Traversable :: forall a. Functor (Trans a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- |Short cut for single object transformaton in this frame.</span><span>
</span><span id="line-94"></span><span id="local-6989586621679232858"><span id="local-6989586621679232859"><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#%3A%3D%3E"><span class="hs-operator hs-type">(:=&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679232859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232858"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232858"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="#local-6989586621679232505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span id="%24b%3A%3D%3E"><span id="%24m%3A%3D%3E"><span id="%3A%3D%3E"><span class="annot"><span class="annottext">$b:=&gt; :: a -&gt; b -&gt; Trans a b
$m:=&gt; :: forall r a b. Trans a b -&gt; (a -&gt; b -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="Common.Object.Transform.html#%24b%3A%3D%3E"><span class="hs-operator hs-var hs-var hs-var">:=&gt;</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679232502"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679232505"><span class="annot"><a href="#local-6989586621679232505"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#%3A%3A%3D%3E"><span class="hs-operator hs-type">::=&gt;</span></a></span><span> </span><span id="local-6989586621679232502"><span class="annot"><a href="#local-6989586621679232502"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span id="local-6989586621679232500"><span id="local-6989586621679232501"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621679232501"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232501"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679232497"><span class="annot"><span class="annottext">fromString :: String -&gt; Trans a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Trans a b
forall a b. b -&gt; Trans a b
</span><a href="Common.Object.Transform.html#New"><span class="hs-identifier hs-var">New</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Trans a b) -&gt; (String -&gt; b) -&gt; String -&gt; Trans a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; b
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span></span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- |Traverse the origins of the 'Trans'.</span><span>
</span><span id="line-101"></span><span id="local-6989586621679232613"><span id="local-6989586621679232614"><span id="local-6989586621679232615"><span class="annot"><a href="Common.Object.Transform.html#transOrigin"><span class="hs-identifier hs-type">transOrigin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232613"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232614"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679232615"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232613"><span class="hs-identifier hs-type">a'</span></a></span></span></span></span><span>
</span><span id="line-102"></span><span id="transOrigin"><span class="annot"><span class="annottext">transOrigin :: (a -&gt; f a') -&gt; Trans a b -&gt; f (Trans a' b)
</span><a href="Common.Object.Transform.html#transOrigin"><span class="hs-identifier hs-var hs-var">transOrigin</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f a'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Object.Transform.html#New"><span class="hs-identifier hs-type">New</span></a></span><span> </span><span id="local-6989586621679232495"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679232495"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trans a' b -&gt; f (Trans a' b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Trans a' b
forall a b. b -&gt; Trans a b
</span><a href="Common.Object.Transform.html#New"><span class="hs-identifier hs-var">New</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679232495"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="annot"><a href="Common.Object.Transform.html#transOrigin"><span class="hs-identifier hs-var">transOrigin</span></a></span><span> </span><span id="local-6989586621679232494"><span class="annot"><span class="annottext">a -&gt; f a'
</span><a href="#local-6989586621679232494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Object.Transform.html#Vanish"><span class="hs-identifier hs-type">Vanish</span></a></span><span> </span><span id="local-6989586621679232493"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232493"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a' -&gt; Trans a' b
forall a b. a -&gt; Trans a b
</span><a href="Common.Object.Transform.html#Vanish"><span class="hs-identifier hs-var">Vanish</span></a></span><span> </span><span class="annot"><span class="annottext">(a' -&gt; Trans a' b) -&gt; f a' -&gt; f (Trans a' b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f a'
</span><a href="#local-6989586621679232494"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232493"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Common.Object.Transform.html#transOrigin"><span class="hs-identifier hs-var">transOrigin</span></a></span><span> </span><span id="local-6989586621679232491"><span class="annot"><span class="annottext">a -&gt; f a'
</span><a href="#local-6989586621679232491"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679232490"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679232490"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Common.Object.Transform.html#%3A%3A%3D%3E"><span class="hs-operator hs-type">::=&gt;</span></a></span><span> </span><span id="local-6989586621679232489"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679232489"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a'] -&gt; b -&gt; Trans a' b
forall a b. [a] -&gt; b -&gt; Trans a b
</span><a href="Common.Object.Transform.html#%3A%3A%3D%3E"><span class="hs-operator hs-var">(::=&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([a'] -&gt; b -&gt; Trans a' b) -&gt; f [a'] -&gt; f (b -&gt; Trans a' b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f a') -&gt; [a] -&gt; f [a']
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f a'
</span><a href="#local-6989586621679232491"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679232490"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f (b -&gt; Trans a' b) -&gt; f b -&gt; f (Trans a' b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; f b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679232489"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- |Allow rendering for groups of objects.</span><span>
</span><span id="line-107"></span><span class="hs-keyword">class</span><span> </span><span id="GroupRender"><span class="annot"><a href="Common.Object.Transform.html#GroupRender"><span class="hs-identifier hs-var">GroupRender</span></a></span></span><span> </span><span id="local-6989586621679232820"><span class="annot"><a href="#local-6989586621679232820"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- |Render a group of objects to a group of SVGs.</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">-- The group structure should be taken into consideration while rendering.</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- e.g. Group of 'T.Text' can be rendered using 'Reanimate.LaTeX.latexChunks'.</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679232818"><span id="renderGroup"><span class="annot"><a href="Common.Object.Transform.html#renderGroup"><span class="hs-identifier hs-type">renderGroup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232818"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232818"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232820"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232818"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- |New object, with its translation lifted to 'Object' level.</span><span>
</span><span id="line-114"></span><span id="local-6989586621679232821"><span class="annot"><a href="Common.Object.Transform.html#oNewCentered"><span class="hs-identifier hs-type">oNewCentered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232821"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232821"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-115"></span><span id="oNewCentered"><span class="annot"><span class="annottext">oNewCentered :: SVG -&gt; Scene s (Object s SVG)
</span><a href="Common.Object.Transform.html#oNewCentered"><span class="hs-identifier hs-var hs-var">oNewCentered</span></a></span></span><span> </span><span id="local-6989586621679232486"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679232486"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679232485"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232485"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232484"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232484"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232483"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232483"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232482"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232482"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; (Double, Double, Double, Double)
</span><span class="hs-identifier hs-var">boundingBox</span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679232486"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679232480"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679232480"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Scene s (Object s SVG)
forall a s. Renderable a =&gt; a -&gt; Scene s (Object s a)
</span><span class="hs-identifier hs-var">oNew</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><span class="hs-identifier hs-var">center</span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679232486"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679232480"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 Double -&gt; Identity (V2 Double))
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) (V2 Double)
</span><span class="hs-identifier hs-var">oTranslate</span></span><span> </span><span class="annot"><span class="annottext">((V2 Double -&gt; Identity (V2 Double))
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; V2 Double -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; V2 Double
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232485"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232483"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232484"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232482"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="annottext">Object s SVG -&gt; Scene s (Object s SVG)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679232480"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- |Create a group of objects, translation of each lifted to 'Object' level.</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Common.Object.Transform.html#oNewGroup"><span class="hs-identifier hs-type">oNewGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679232673"><span class="annot"><a href="#local-6989586621679232673"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679232674"><span class="annot"><a href="#local-6989586621679232674"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679232672"><span class="annot"><a href="#local-6989586621679232672"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232674"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupRender"><span class="hs-identifier hs-type">GroupRender</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232674"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232672"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679232674"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232672"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span id="oNewGroup"><span class="annot"><span class="annottext">oNewGroup :: t a -&gt; Scene s (t (Object s SVG))
</span><a href="Common.Object.Transform.html#oNewGroup"><span class="hs-identifier hs-var hs-var">oNewGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; Scene s (Object s SVG))
-&gt; t SVG -&gt; Scene s (t (Object s SVG))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Scene s (Object s SVG)
forall s. SVG -&gt; Scene s (Object s SVG)
</span><a href="Common.Object.Transform.html#oNewCentered"><span class="hs-identifier hs-var">oNewCentered</span></a></span><span> </span><span class="annot"><span class="annottext">(t SVG -&gt; Scene s (t (Object s SVG)))
-&gt; (t a -&gt; t SVG) -&gt; t a -&gt; Scene s (t (Object s SVG))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; t SVG
forall a (t :: * -&gt; *).
(GroupRender a, Traversable t) =&gt;
t a -&gt; t SVG
</span><a href="Common.Object.Transform.html#renderGroup"><span class="hs-identifier hs-var">renderGroup</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- |Create a group of objects, scaled as a group, translation of each lifted to 'Object' level.</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Common.Object.Transform.html#oNewGroupScaled"><span class="hs-identifier hs-type">oNewGroupScaled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679232472"><span class="annot"><a href="#local-6989586621679232472"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679232471"><span class="annot"><a href="#local-6989586621679232471"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679232470"><span class="annot"><a href="#local-6989586621679232470"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232471"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupRender"><span class="hs-identifier hs-type">GroupRender</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232471"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232470"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679232471"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232470"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span id="oNewGroupScaled"><span class="annot"><span class="annottext">oNewGroupScaled :: Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><a href="Common.Object.Transform.html#oNewGroupScaled"><span class="hs-identifier hs-var hs-var">oNewGroupScaled</span></a></span></span><span> </span><span id="local-6989586621679232469"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232469"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; Scene s (Object s SVG))
-&gt; t SVG -&gt; Scene s (t (Object s SVG))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; Scene s (Object s SVG)
forall s. SVG -&gt; Scene s (Object s SVG)
</span><a href="Common.Object.Transform.html#oNewCentered"><span class="hs-identifier hs-var">oNewCentered</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; Scene s (Object s SVG))
-&gt; (SVG -&gt; SVG) -&gt; SVG -&gt; Scene s (Object s SVG)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">scale</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232469"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(t SVG -&gt; Scene s (t (Object s SVG)))
-&gt; (t a -&gt; t SVG) -&gt; t a -&gt; Scene s (t (Object s SVG))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; t SVG
forall a (t :: * -&gt; *).
(GroupRender a, Traversable t) =&gt;
t a -&gt; t SVG
</span><a href="Common.Object.Transform.html#renderGroup"><span class="hs-identifier hs-var">renderGroup</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span id="local-6989586621679232667"><span id="local-6989586621679232668"><span class="annot"><a href="Common.Object.Transform.html#collectOld"><span class="hs-identifier hs-type">collectOld</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232668"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232667"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679232668"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-131"></span><span id="collectOld"><span class="annot"><span class="annottext">collectOld :: [Trans a b] -&gt; Compose [] [] a
</span><a href="Common.Object.Transform.html#collectOld"><span class="hs-identifier hs-var hs-var">collectOld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; Compose [] [] a
forall k k1 (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">([[a]] -&gt; Compose [] [] a)
-&gt; ([Trans a b] -&gt; [[a]]) -&gt; [Trans a b] -&gt; Compose [] [] a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Trans a b -&gt; Maybe [a]) -&gt; [Trans a b] -&gt; [[a]]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Common.Object.Transform.html#New"><span class="hs-identifier hs-type">New</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [a]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="Common.Object.Transform.html#Vanish"><span class="hs-identifier hs-type">Vanish</span></a></span><span> </span><span id="local-6989586621679232465"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232465"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe [a]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232465"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679232464"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679232464"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Common.Object.Transform.html#%3A%3A%3D%3E"><span class="hs-operator hs-type">::=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe [a]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679232464"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- |Group alignment, given a base, align the second parameter according to the base.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">type</span><span> </span><span id="GroupAlignment"><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-var">GroupAlignment</span></a></span></span><span> </span><span id="local-6989586621679232463"><span class="annot"><a href="#local-6989586621679232463"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679232462"><span class="annot"><a href="#local-6989586621679232462"><span class="hs-identifier hs-type">t'</span></a></span></span><span> </span><span id="local-6989586621679232461"><span class="annot"><a href="#local-6989586621679232461"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679232460"><span class="annot"><a href="#local-6989586621679232460"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679232459"><span class="annot"><a href="#local-6989586621679232459"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679232463"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232461"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232460"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232462"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232461"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232459"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232461"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="local-6989586621679232639"><span id="local-6989586621679232640"><span class="annot"><a href="Common.Object.Transform.html#readHeight"><span class="hs-identifier hs-type">readHeight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232640"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232640"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span><span>
</span><span id="line-140"></span><span id="readHeight"><span class="annot"><span class="annottext">readHeight :: [Object s a] -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readHeight"><span class="hs-identifier hs-var hs-var">readHeight</span></a></span></span><span> </span><span id="local-6989586621679232457"><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232457"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679232456"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232456"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double) -&gt; [Object s a] -&gt; Scene s [Double]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232457"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679232454"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232454"><span class="hs-identifier hs-var">base</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double) -&gt; [Object s a] -&gt; Scene s [Double]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oBBMinY</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232457"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679232452"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232452"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double) -&gt; [Object s a] -&gt; Scene s [Double]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oBBHeight</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232457"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232450"><span class="annot"><span class="annottext">yMins :: [Double]
</span><a href="#local-6989586621679232450"><span class="hs-identifier hs-var hs-var">yMins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; [Double] -&gt; [Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232456"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232454"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232448"><span class="annot"><span class="annottext">yMaxs :: [Double]
</span><a href="#local-6989586621679232448"><span class="hs-identifier hs-var hs-var">yMaxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; [Double] -&gt; [Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232450"><span class="hs-identifier hs-var">yMins</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232452"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s Double
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232448"><span class="hs-identifier hs-var">yMaxs</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679232450"><span class="hs-identifier hs-var">yMins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679232787"><span id="local-6989586621679232788"><span id="local-6989586621679232789"><span class="annot"><a href="Common.Object.Transform.html#readCenterOf"><span class="hs-identifier hs-type">readCenterOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232789"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-149"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectData</span></span><span> </span><span class="annot"><a href="#local-6989586621679232788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-150"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectData</span></span><span> </span><span class="annot"><a href="#local-6989586621679232788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-151"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232789"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232787"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232788"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232787"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span></span><span>
</span><span id="line-153"></span><span id="readCenterOf"><span class="annot"><span class="annottext">readCenterOf :: Getter (ObjectData a) Double
-&gt; Getter (ObjectData a) Double -&gt; t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterOf"><span class="hs-identifier hs-var hs-var">readCenterOf</span></a></span></span><span> </span><span id="local-6989586621679232444"><span class="annot"><span class="annottext">Getter (ObjectData a) Double
</span><a href="#local-6989586621679232444"><span class="hs-identifier hs-var">lb</span></a></span></span><span> </span><span id="local-6989586621679232443"><span class="annot"><span class="annottext">Getter (ObjectData a) Double
</span><a href="#local-6989586621679232443"><span class="hs-identifier hs-var">ub</span></a></span></span><span> </span><span id="local-6989586621679232442"><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232442"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679232441"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232441"><span class="hs-identifier hs-var">aMin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t Double -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">(t Double -&gt; Double) -&gt; Scene s (t Double) -&gt; Scene s Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double)
-&gt; t (Object s a) -&gt; Scene s (t Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
Getter (ObjectData a) Double
</span><a href="#local-6989586621679232444"><span class="hs-identifier hs-var">lb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232442"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679232440"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232440"><span class="hs-identifier hs-var">aMax</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t Double -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">(t Double -&gt; Double) -&gt; Scene s (t Double) -&gt; Scene s Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double)
-&gt; t (Object s a) -&gt; Scene s (t Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
Getter (ObjectData a) Double
</span><a href="#local-6989586621679232443"><span class="hs-identifier hs-var">ub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232442"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s Double
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232441"><span class="hs-identifier hs-var">aMin</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232440"><span class="hs-identifier hs-var">aMax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span id="local-6989586621679232732"><span id="local-6989586621679232733"><span id="local-6989586621679232734"><span class="annot"><a href="Common.Object.Transform.html#readCenterX"><span class="hs-identifier hs-type">readCenterX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232734"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232734"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232732"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span></span><span>
</span><span id="line-159"></span><span id="readCenterX"><span class="annot"><span class="annottext">readCenterX :: t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterX"><span class="hs-identifier hs-var hs-var">readCenterX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getter (ObjectData a) Double
-&gt; Getter (ObjectData a) Double -&gt; t (Object s a) -&gt; Scene s Double
forall (t :: * -&gt; *) a s.
Traversable t =&gt;
Getter (ObjectData a) Double
-&gt; Getter (ObjectData a) Double -&gt; t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterOf"><span class="hs-identifier hs-var">readCenterOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oLeftX</span></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oRightX</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621679232434"><span id="local-6989586621679232435"><span id="local-6989586621679232436"><span class="annot"><a href="Common.Object.Transform.html#readCenterY"><span class="hs-identifier hs-type">readCenterY</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232436"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232436"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232435"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232434"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232435"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span></span></span><span>
</span><span id="line-162"></span><span id="readCenterY"><span class="annot"><span class="annottext">readCenterY :: t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterY"><span class="hs-identifier hs-var hs-var">readCenterY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getter (ObjectData a) Double
-&gt; Getter (ObjectData a) Double -&gt; t (Object s a) -&gt; Scene s Double
forall (t :: * -&gt; *) a s.
Traversable t =&gt;
Getter (ObjectData a) Double
-&gt; Getter (ObjectData a) Double -&gt; t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterOf"><span class="hs-identifier hs-var">readCenterOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oBottomY</span></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTopY</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span id="local-6989586621679232735"><span id="local-6989586621679232736"><span id="local-6989586621679232737"><span id="local-6989586621679232738"><span id="local-6989586621679232739"><span class="annot"><a href="Common.Object.Transform.html#centeredOf"><span class="hs-identifier hs-type">centeredOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232739"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232738"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679232781"><span class="annot"><a href="#local-6989586621679232781"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679232783"><span class="annot"><a href="#local-6989586621679232783"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232783"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232781"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679232780"><span class="annot"><a href="#local-6989586621679232780"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Setter'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectData</span></span><span> </span><span class="annot"><a href="#local-6989586621679232780"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232739"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232738"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232735"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-168"></span><span id="centeredOf"><span class="annot"><span class="annottext">centeredOf :: (forall x (f :: * -&gt; *).
 Traversable f =&gt;
 f (Object s x) -&gt; Scene s Double)
-&gt; (forall x. Setter' (ObjectData x) Double)
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#centeredOf"><span class="hs-identifier hs-var hs-var">centeredOf</span></a></span></span><span> </span><span id="local-6989586621679232429"><span class="annot"><span class="annottext">forall x (f :: * -&gt; *).
Traversable f =&gt;
f (Object s x) -&gt; Scene s Double
</span><a href="#local-6989586621679232429"><span class="hs-identifier hs-var">readCenter</span></a></span></span><span> </span><span id="local-6989586621679232428"><span class="annot"><span class="annottext">forall x. Setter' (ObjectData x) Double
</span><a href="#local-6989586621679232428"><span class="hs-identifier hs-var">setPos</span></a></span></span><span> </span><span id="local-6989586621679232427"><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232427"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679232426"><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232426"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679232425"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232425"><span class="hs-identifier hs-var">aCenter</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t (Object s a) -&gt; Scene s Double
forall x (f :: * -&gt; *).
Traversable f =&gt;
f (Object s x) -&gt; Scene s Double
</span><a href="#local-6989586621679232429"><span class="hs-identifier hs-var">readCenter</span></a></span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232427"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679232424"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232424"><span class="hs-identifier hs-var">aOrig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t' (Object s b) -&gt; Scene s Double
forall x (f :: * -&gt; *).
Traversable f =&gt;
f (Object s x) -&gt; Scene s Double
</span><a href="#local-6989586621679232429"><span class="hs-identifier hs-var">readCenter</span></a></span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232426"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232423"><span class="annot"><span class="annottext">delta :: Double
</span><a href="#local-6989586621679232423"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232425"><span class="hs-identifier hs-var">aCenter</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232424"><span class="hs-identifier hs-var">aOrig</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; t' (Object s b) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData b -&gt; Identity (ObjectData b)
forall x. Setter' (ObjectData x) Double
</span><a href="#local-6989586621679232428"><span class="hs-identifier hs-var">setPos</span></a></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; (Double -&gt; Double) -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232423"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232426"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679232750"><span id="local-6989586621679232751"><span id="local-6989586621679232752"><span id="local-6989586621679232753"><span id="local-6989586621679232754"><span class="annot"><a href="Common.Object.Transform.html#alignedOf"><span class="hs-identifier hs-type">alignedOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232754"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232753"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679232419"><span class="annot"><a href="#local-6989586621679232419"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Getter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectData</span></span><span> </span><span class="annot"><a href="#local-6989586621679232419"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679232765"><span class="annot"><a href="#local-6989586621679232765"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232765"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232765"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Setter'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ObjectData</span></span><span> </span><span class="annot"><a href="#local-6989586621679232752"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232754"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232753"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232751"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232752"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-179"></span><span id="alignedOf"><span class="annot"><span class="annottext">alignedOf :: (forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#alignedOf"><span class="hs-identifier hs-var hs-var">alignedOf</span></a></span></span><span> </span><span id="local-6989586621679232418"><span class="annot"><span class="annottext">forall a. Getter (ObjectData a) Double
</span><a href="#local-6989586621679232418"><span class="hs-identifier hs-var">alignStd</span></a></span></span><span> </span><span id="local-6989586621679232417"><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><a href="#local-6989586621679232417"><span class="hs-identifier hs-var">collect</span></a></span></span><span> </span><span id="local-6989586621679232416"><span class="annot"><span class="annottext">Setter' (ObjectData b) Double
</span><a href="#local-6989586621679232416"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span id="local-6989586621679232415"><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232415"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679232414"><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232414"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679232413"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232413"><span class="hs-identifier hs-var">aMax</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t Double -&gt; Double
forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><a href="#local-6989586621679232417"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">(t Double -&gt; Double) -&gt; Scene s (t Double) -&gt; Scene s Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double)
-&gt; t (Object s a) -&gt; Scene s (t Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><a href="#local-6989586621679232418"><span class="hs-identifier hs-var">alignStd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232415"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679232412"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232412"><span class="hs-identifier hs-var">aOrig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t' Double -&gt; Double
forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><a href="#local-6989586621679232417"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">(t' Double -&gt; Double) -&gt; Scene s (t' Double) -&gt; Scene s Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s Double)
-&gt; t' (Object s b) -&gt; Scene s (t' Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b
-&gt; Getting Double (ObjectData b) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData b) Double
forall a. Getter (ObjectData a) Double
</span><a href="#local-6989586621679232418"><span class="hs-identifier hs-var">alignStd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232414"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232411"><span class="annot"><span class="annottext">delta :: Double
</span><a href="#local-6989586621679232411"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232413"><span class="hs-identifier hs-var">aMax</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232412"><span class="hs-identifier hs-var">aOrig</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; t' (Object s b) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData b -&gt; Identity (ObjectData b)
Setter' (ObjectData b) Double
</span><a href="#local-6989586621679232416"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; (Double -&gt; Double) -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232411"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232414"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- |Aligned according to the left boundary (minimum X).</span><span>
</span><span id="line-186"></span><span id="local-6989586621679232406"><span id="local-6989586621679232407"><span id="local-6989586621679232408"><span id="local-6989586621679232409"><span id="local-6989586621679232410"><span class="annot"><a href="Common.Object.Transform.html#leftAligned"><span class="hs-identifier hs-type">leftAligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232410"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232409"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232410"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232409"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232408"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232407"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232406"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-187"></span><span id="leftAligned"><span class="annot"><span class="annottext">leftAligned :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#leftAligned"><span class="hs-identifier hs-var hs-var">leftAligned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
forall (t :: * -&gt; *) (t' :: * -&gt; *) b s a.
(Traversable t, Traversable t') =&gt;
(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#alignedOf"><span class="hs-identifier hs-var">alignedOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oLeftX</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Setter' (ObjectData b) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- |Aligned according to the right boundary (maximum X).</span><span>
</span><span id="line-190"></span><span id="local-6989586621679232400"><span id="local-6989586621679232401"><span id="local-6989586621679232402"><span id="local-6989586621679232403"><span id="local-6989586621679232404"><span class="annot"><a href="Common.Object.Transform.html#rightAligned"><span class="hs-identifier hs-type">rightAligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232404"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232403"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232404"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232403"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232402"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232401"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232400"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-191"></span><span id="rightAligned"><span class="annot"><span class="annottext">rightAligned :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#rightAligned"><span class="hs-identifier hs-var hs-var">rightAligned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
forall (t :: * -&gt; *) (t' :: * -&gt; *) b s a.
(Traversable t, Traversable t') =&gt;
(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#alignedOf"><span class="hs-identifier hs-var">alignedOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oRightX</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Setter' (ObjectData b) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- |Aligned according to the horizontal center line (average of min/max X).</span><span>
</span><span id="line-194"></span><span id="local-6989586621679232395"><span id="local-6989586621679232396"><span id="local-6989586621679232397"><span id="local-6989586621679232398"><span id="local-6989586621679232399"><span class="annot"><a href="Common.Object.Transform.html#xCentered"><span class="hs-identifier hs-type">xCentered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232399"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232398"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232399"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232398"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232397"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232396"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232395"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-195"></span><span id="xCentered"><span class="annot"><span class="annottext">xCentered :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#xCentered"><span class="hs-identifier hs-var hs-var">xCentered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x (f :: * -&gt; *).
 Traversable f =&gt;
 f (Object s x) -&gt; Scene s Double)
-&gt; (forall x. Setter' (ObjectData x) Double)
-&gt; GroupAlignment t t' s a b
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
(forall x (f :: * -&gt; *).
 Traversable f =&gt;
 f (Object s x) -&gt; Scene s Double)
-&gt; (forall x. Setter' (ObjectData x) Double)
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#centeredOf"><span class="hs-identifier hs-var">centeredOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall x (f :: * -&gt; *).
Traversable f =&gt;
f (Object s x) -&gt; Scene s Double
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterX"><span class="hs-identifier hs-var">readCenterX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
forall x. Setter' (ObjectData x) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- |Placed below the alignment base.</span><span>
</span><span id="line-198"></span><span id="local-6989586621679232390"><span id="local-6989586621679232391"><span id="local-6989586621679232392"><span id="local-6989586621679232393"><span id="local-6989586621679232394"><span class="annot"><a href="Common.Object.Transform.html#placedBelow"><span class="hs-identifier hs-type">placedBelow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232394"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232393"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232394"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232393"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232392"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232390"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-199"></span><span id="placedBelow"><span class="annot"><span class="annottext">placedBelow :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#placedBelow"><span class="hs-identifier hs-var hs-var">placedBelow</span></a></span></span><span> </span><span id="local-6989586621679232389"><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232389"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679232388"><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232388"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679232387"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232387"><span class="hs-identifier hs-var">minY</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t Double -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">(t Double -&gt; Double) -&gt; Scene s (t Double) -&gt; Scene s Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s Double)
-&gt; t (Object s a) -&gt; Scene s (t Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oBottomY</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232389"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679232386"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232386"><span class="hs-identifier hs-var">maxY</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t' Double -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">(t' Double -&gt; Double) -&gt; Scene s (t' Double) -&gt; Scene s Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s Double)
-&gt; t' (Object s b) -&gt; Scene s (t' Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b
-&gt; Getting Double (ObjectData b) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-operator hs-var">`oRead`</span></span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData b) Double
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTopY</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232388"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232385"><span class="annot"><span class="annottext">deltaY :: Double
</span><a href="#local-6989586621679232385"><span class="hs-identifier hs-var hs-var">deltaY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232387"><span class="hs-identifier hs-var">minY</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232386"><span class="hs-identifier hs-var">maxY</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; t' (Object s b) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679232384"><span class="annot"><span class="annottext">Object s b
</span><a href="#local-6989586621679232384"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s b
</span><a href="#local-6989586621679232384"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((ObjectData b -&gt; ObjectData b) -&gt; Scene s ())
-&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData b -&gt; Identity (ObjectData b)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; (Double -&gt; Double) -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232385"><span class="hs-identifier hs-var">deltaY</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232388"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- |Aligned according to the bottom boundary (minimum Y).</span><span>
</span><span id="line-206"></span><span id="local-6989586621679232379"><span id="local-6989586621679232380"><span id="local-6989586621679232381"><span id="local-6989586621679232382"><span id="local-6989586621679232383"><span class="annot"><a href="Common.Object.Transform.html#bottomAligned"><span class="hs-identifier hs-type">bottomAligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232383"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232382"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232383"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232382"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232381"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232380"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232379"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-207"></span><span id="bottomAligned"><span class="annot"><span class="annottext">bottomAligned :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#bottomAligned"><span class="hs-identifier hs-var hs-var">bottomAligned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
forall (t :: * -&gt; *) (t' :: * -&gt; *) b s a.
(Traversable t, Traversable t') =&gt;
(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#alignedOf"><span class="hs-identifier hs-var">alignedOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oBottomY</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Setter' (ObjectData b) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- |Aligned according to the top boundary (minimum Y).</span><span>
</span><span id="line-210"></span><span id="local-6989586621679232374"><span id="local-6989586621679232375"><span id="local-6989586621679232376"><span id="local-6989586621679232377"><span id="local-6989586621679232378"><span class="annot"><a href="Common.Object.Transform.html#topAligned"><span class="hs-identifier hs-type">topAligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232378"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232377"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232378"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232377"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232376"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232375"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232374"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-211"></span><span id="topAligned"><span class="annot"><span class="annottext">topAligned :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#topAligned"><span class="hs-identifier hs-var hs-var">topAligned</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
forall (t :: * -&gt; *) (t' :: * -&gt; *) b s a.
(Traversable t, Traversable t') =&gt;
(forall a. Getter (ObjectData a) Double)
-&gt; (forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double)
-&gt; Setter' (ObjectData b) Double
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#alignedOf"><span class="hs-identifier hs-var">alignedOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
forall a. Getter (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTopY</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
forall (f :: * -&gt; *). Traversable f =&gt; f Double -&gt; Double
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
Setter' (ObjectData b) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- |Aligned according to the vertical center line (average of min/max Y).</span><span>
</span><span id="line-214"></span><span id="local-6989586621679232369"><span id="local-6989586621679232370"><span id="local-6989586621679232371"><span id="local-6989586621679232372"><span id="local-6989586621679232373"><span class="annot"><a href="Common.Object.Transform.html#yCentered"><span class="hs-identifier hs-type">yCentered</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232373"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232372"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232373"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232372"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232371"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232370"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232369"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-215"></span><span id="yCentered"><span class="annot"><span class="annottext">yCentered :: GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#yCentered"><span class="hs-identifier hs-var hs-var">yCentered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x (f :: * -&gt; *).
 Traversable f =&gt;
 f (Object s x) -&gt; Scene s Double)
-&gt; (forall x. Setter' (ObjectData x) Double)
-&gt; GroupAlignment t t' s a b
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
(forall x (f :: * -&gt; *).
 Traversable f =&gt;
 f (Object s x) -&gt; Scene s Double)
-&gt; (forall x. Setter' (ObjectData x) Double)
-&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#centeredOf"><span class="hs-identifier hs-var">centeredOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall x (f :: * -&gt; *).
Traversable f =&gt;
f (Object s x) -&gt; Scene s Double
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterY"><span class="hs-identifier hs-var">readCenterY</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Lens' (ObjectData a) Double
forall x. Setter' (ObjectData x) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- |'Traversal' of all four margins.</span><span>
</span><span id="line-218"></span><span id="local-6989586621679232695"><span id="local-6989586621679232696"><span class="annot"><a href="Common.Object.Transform.html#allMargins"><span class="hs-identifier hs-type">allMargins</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679232696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679232696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679232696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679232696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679232695"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679232695"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679232695"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679232695"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679232696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232695"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-219"></span><span id="allMargins"><span class="annot"><span class="annottext">allMargins :: (a -&gt; f b) -&gt; (a, a, a, a) -&gt; f (b, b, b, b)
</span><a href="Common.Object.Transform.html#allMargins"><span class="hs-identifier hs-var hs-var">allMargins</span></a></span></span><span> </span><span id="local-6989586621679232368"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679232368"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679232367"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232367"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232366"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232366"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232365"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232365"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679232364"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232364"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b -&gt; b -&gt; b -&gt; b -&gt; (b, b, b, b))
-&gt; f b -&gt; f (b -&gt; b -&gt; b -&gt; (b, b, b, b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679232368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232367"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (b -&gt; b -&gt; b -&gt; (b, b, b, b))
-&gt; f b -&gt; f (b -&gt; b -&gt; (b, b, b, b))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679232368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232366"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">f (b -&gt; b -&gt; (b, b, b, b)) -&gt; f b -&gt; f (b -&gt; (b, b, b, b))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679232368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232365"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">f (b -&gt; (b, b, b, b)) -&gt; f b -&gt; f (b, b, b, b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679232368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679232364"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- |Set margin.</span><span>
</span><span id="line-222"></span><span id="local-6989586621679232359"><span id="local-6989586621679232360"><span id="local-6989586621679232361"><span id="local-6989586621679232362"><span id="local-6989586621679232363"><span class="annot"><a href="Common.Object.Transform.html#withMargin"><span class="hs-identifier hs-type">withMargin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232363"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232362"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Coord</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232363"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232362"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232361"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232359"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-223"></span><span id="withMargin"><span class="annot"><span class="annottext">withMargin :: Double -&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#withMargin"><span class="hs-identifier hs-var hs-var">withMargin</span></a></span></span><span> </span><span id="local-6989586621679232358"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232358"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; t' (Object s b) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Double, Double, Double, Double)
 -&gt; Identity (Double, Double, Double, Double))
-&gt; ObjectData b -&gt; Identity (ObjectData b)
forall a. Lens' (ObjectData a) (Double, Double, Double, Double)
</span><span class="hs-identifier hs-var">oMargin</span></span><span> </span><span class="annot"><span class="annottext">(((Double, Double, Double, Double)
  -&gt; Identity (Double, Double, Double, Double))
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; ((Double -&gt; Identity Double)
    -&gt; (Double, Double, Double, Double)
    -&gt; Identity (Double, Double, Double, Double))
-&gt; (Double -&gt; Identity Double)
-&gt; ObjectData b
-&gt; Identity (ObjectData b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; (Double, Double, Double, Double)
-&gt; Identity (Double, Double, Double, Double)
forall a b. Traversal (a, a, a, a) (b, b, b, b) a b
</span><a href="Common.Object.Transform.html#allMargins"><span class="hs-identifier hs-var">allMargins</span></a></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; Double -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232358"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- |Scaled by a factor.</span><span>
</span><span id="line-226"></span><span id="local-6989586621679232352"><span id="local-6989586621679232353"><span id="local-6989586621679232354"><span id="local-6989586621679232355"><span id="local-6989586621679232356"><span class="annot"><a href="Common.Object.Transform.html#scaled"><span class="hs-identifier hs-type">scaled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232356"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232355"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232356"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232355"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232354"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232353"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232352"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span></span><span>
</span><span id="line-227"></span><span id="scaled"><span class="annot"><span class="annottext">scaled :: Double -&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#scaled"><span class="hs-identifier hs-var hs-var">scaled</span></a></span></span><span> </span><span id="local-6989586621679232351"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232351"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679232350"><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232350"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t' (Object s b) -&gt; (Object s b -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232350"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679232348"><span class="annot"><span class="annottext">Object s b
</span><a href="#local-6989586621679232348"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s b
</span><a href="#local-6989586621679232348"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 Double -&gt; Identity (V2 Double))
-&gt; ObjectData b -&gt; Identity (ObjectData b)
forall a. Lens' (ObjectData a) (V2 Double)
</span><span class="hs-identifier hs-var">oTranslate</span></span><span> </span><span class="annot"><span class="annottext">((V2 Double -&gt; Identity (V2 Double))
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; (V2 Double -&gt; V2 Double) -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232351"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; V2 Double -&gt; V2 Double
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s b
</span><a href="#local-6989586621679232348"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData b -&gt; Identity (ObjectData b)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oScale</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; (Double -&gt; Double) -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232351"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- |Apply some 'GroupAlignment's.</span><span>
</span><span id="line-232"></span><span id="local-6989586621679232654"><span id="local-6989586621679232655"><span id="local-6989586621679232656"><span id="local-6989586621679232657"><span id="local-6989586621679232658"><span class="annot"><a href="Common.Object.Transform.html#applyAlignment"><span class="hs-identifier hs-type">applyAlignment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232658"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232657"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232658"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232657"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232655"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232654"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232658"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232655"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232657"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232654"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-237"></span><span id="applyAlignment"><span class="annot"><span class="annottext">applyAlignment :: [GroupAlignment t t' s a b] -&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#applyAlignment"><span class="hs-identifier hs-var hs-var">applyAlignment</span></a></span></span><span> </span><span id="local-6989586621679232345"><span class="annot"><span class="annottext">[GroupAlignment t t' s a b]
</span><a href="#local-6989586621679232345"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621679232344"><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232344"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679232343"><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232343"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GroupAlignment t t' s a b -&gt; Scene s ())
-&gt; [GroupAlignment t t' s a b] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(t' (Object s b) -&gt; Scene s ()) -&gt; t' (Object s b) -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t' (Object s b)
</span><a href="#local-6989586621679232343"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((t' (Object s b) -&gt; Scene s ()) -&gt; Scene s ())
-&gt; (GroupAlignment t t' s a b -&gt; t' (Object s b) -&gt; Scene s ())
-&gt; GroupAlignment t t' s a b
-&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GroupAlignment t t' s a b -&gt; GroupAlignment t t' s a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679232344"><span class="hs-identifier hs-var">base</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[GroupAlignment t t' s a b]
</span><a href="#local-6989586621679232345"><span class="hs-identifier hs-var">align</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- |Key frame animation, with automatic creation for new objects.</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- __Warning__: if alignment base (see 'Trans' for details) is empty, then all the</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- alignment functions provided in this module would crash your program. In this</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- case, custom (ad-hoc) alignment functions might be useful. Or, to specify a</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- custom alignment base @bs@, use @const (alignment bs)@ instead of @alignment@.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- __Note__: if the target object utilise @OverloadedStrings@ via 'IsString', the type</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- becomes ambiguous. Use @TypeApplications@ for this situation:</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- &gt; transformObject' @ObjType alignments transformations</span><span>
</span><span id="line-250"></span><span id="local-6989586621679232340"><span id="local-6989586621679232341"><span id="local-6989586621679232342"><span class="annot"><a href="Common.Object.Transform.html#transformObject%27"><span class="hs-identifier hs-type">transformObject'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.Object.Transform.html#GroupRender"><span class="hs-identifier hs-type">GroupRender</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232342"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-251"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#GroupAlignment"><span class="hs-identifier hs-type">GroupAlignment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232341"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232340"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679232341"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232340"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232341"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232340"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679232342"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232341"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232341"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-254"></span><span id="transformObject%27"><span class="annot"><span class="annottext">transformObject' :: [GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG]
-&gt; [Trans (Object s a) t] -&gt; Scene s [Object s SVG]
</span><a href="Common.Object.Transform.html#transformObject%27"><span class="hs-identifier hs-var hs-var">transformObject'</span></a></span></span><span> </span><span id="local-6989586621679232339"><span class="annot"><span class="annottext">[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG]
</span><a href="#local-6989586621679232339"><span class="hs-identifier hs-var">align</span></a></span></span><span> </span><span id="local-6989586621679232338"><span class="annot"><span class="annottext">[Trans (Object s a) t]
</span><a href="#local-6989586621679232338"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compose [] (Trans (Object s a)) t
-&gt; Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
t a -&gt; Scene s (t (Object s SVG))
</span><a href="Common.Object.Transform.html#oNewGroup"><span class="hs-identifier hs-var">oNewGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Trans (Object s a) t] -&gt; Compose [] (Trans (Object s a)) t
forall k k1 (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="annot"><span class="annottext">[Trans (Object s a) t]
</span><a href="#local-6989586621679232338"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="annottext">Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
-&gt; (Compose [] (Trans (Object s a)) (Object s SVG)
    -&gt; Scene s (Compose [] (Trans (Object s a)) (Object s SVG)))
-&gt; Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Compose [] [] (Object s a)
-&gt; Compose [] (Trans (Object s a)) (Object s SVG)
-&gt; Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
</span><a href="#local-6989586621679232337"><span class="hs-identifier hs-var">applyAlignment'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Trans (Object s a) t] -&gt; Compose [] [] (Object s a)
forall a b. [Trans a b] -&gt; Compose [] [] a
</span><a href="Common.Object.Transform.html#collectOld"><span class="hs-identifier hs-var">collectOld</span></a></span><span> </span><span class="annot"><span class="annottext">[Trans (Object s a) t]
</span><a href="#local-6989586621679232338"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="annottext">Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
-&gt; (Compose [] (Trans (Object s a)) (Object s SVG)
    -&gt; Scene s [Object s SVG])
-&gt; Scene s [Object s SVG]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Trans (Object s a) [Object s SVG]] -&gt; Scene s [Object s SVG]
forall s a b.
[Trans (Object s a) [Object s b]] -&gt; Scene s [Object s b]
</span><a href="Common.Object.Transform.html#transformObjectRaw"><span class="hs-identifier hs-var">transformObjectRaw</span></a></span><span> </span><span class="annot"><span class="annottext">([Trans (Object s a) [Object s SVG]] -&gt; Scene s [Object s SVG])
-&gt; (Compose [] (Trans (Object s a)) (Object s SVG)
    -&gt; [Trans (Object s a) [Object s SVG]])
-&gt; Compose [] (Trans (Object s a)) (Object s SVG)
-&gt; Scene s [Object s SVG]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Compose [] (Trans (Object s a)) [Object s SVG]
-&gt; [Trans (Object s a) [Object s SVG]]
forall k1 (f :: k1 -&gt; *) k2 (g :: k2 -&gt; k1) (a :: k2).
Compose f g a -&gt; f (g a)
</span><span class="hs-identifier hs-var hs-var">getCompose</span></span><span> </span><span class="annot"><span class="annottext">(Compose [] (Trans (Object s a)) [Object s SVG]
 -&gt; [Trans (Object s a) [Object s SVG]])
-&gt; (Compose [] (Trans (Object s a)) (Object s SVG)
    -&gt; Compose [] (Trans (Object s a)) [Object s SVG])
-&gt; Compose [] (Trans (Object s a)) (Object s SVG)
-&gt; [Trans (Object s a) [Object s SVG]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; [Object s SVG])
-&gt; Compose [] (Trans (Object s a)) (Object s SVG)
-&gt; Compose [] (Trans (Object s a)) [Object s SVG]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679232337"><span class="annot"><span class="annottext">applyAlignment' :: Compose [] [] (Object s a)
-&gt; Compose [] (Trans (Object s a)) (Object s SVG)
-&gt; Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
</span><a href="#local-6989586621679232337"><span class="hs-identifier hs-var hs-var">applyAlignment'</span></a></span></span><span> </span><span id="local-6989586621679232334"><span class="annot"><span class="annottext">Compose [] [] (Object s a)
</span><a href="#local-6989586621679232334"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621679232333"><span class="annot"><span class="annottext">Compose [] (Trans (Object s a)) (Object s SVG)
</span><a href="#local-6989586621679232333"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compose [] (Trans (Object s a)) (Object s SVG)
</span><a href="#local-6989586621679232333"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">Compose [] (Trans (Object s a)) (Object s SVG)
-&gt; Scene s ()
-&gt; Scene s (Compose [] (Trans (Object s a)) (Object s SVG))
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG]
-&gt; GroupAlignment
     (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
[GroupAlignment t t' s a b] -&gt; GroupAlignment t t' s a b
</span><a href="Common.Object.Transform.html#applyAlignment"><span class="hs-identifier hs-var">applyAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG]
</span><a href="#local-6989586621679232339"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">Compose [] [] (Object s a)
</span><a href="#local-6989586621679232334"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Compose [] (Trans (Object s a)) (Object s SVG)
</span><a href="#local-6989586621679232333"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621679232664"><span id="local-6989586621679232665"><span id="local-6989586621679232666"><span class="annot"><a href="Common.Object.Transform.html#transformObjectRaw"><span class="hs-identifier hs-type">transformObjectRaw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232666"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232665"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232666"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232666"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232666"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232664"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-261"></span><span id="transformObjectRaw"><span class="annot"><span class="annottext">transformObjectRaw :: [Trans (Object s a) [Object s b]] -&gt; Scene s [Object s b]
</span><a href="Common.Object.Transform.html#transformObjectRaw"><span class="hs-identifier hs-var hs-var">transformObjectRaw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s [Object s b] -&gt; Scene s [Object s b]
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s [Object s b] -&gt; Scene s [Object s b])
-&gt; ([Trans (Object s a) [Object s b]] -&gt; Scene s [Object s b])
-&gt; [Trans (Object s a) [Object s b]]
-&gt; Scene s [Object s b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([[Object s b]] -&gt; [Object s b])
-&gt; Scene s [[Object s b]] -&gt; Scene s [Object s b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[[Object s b]] -&gt; [Object s b]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">(Scene s [[Object s b]] -&gt; Scene s [Object s b])
-&gt; ([Trans (Object s a) [Object s b]] -&gt; Scene s [[Object s b]])
-&gt; [Trans (Object s a) [Object s b]]
-&gt; Scene s [Object s b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Trans (Object s a) [Object s b] -&gt; Scene s [Object s b])
-&gt; [Trans (Object s a) [Object s b]] -&gt; Scene s [[Object s b]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s [Object s b] -&gt; Scene s [Object s b]
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s [Object s b] -&gt; Scene s [Object s b])
-&gt; (Trans (Object s a) [Object s b] -&gt; Scene s [Object s b])
-&gt; Trans (Object s a) [Object s b]
-&gt; Scene s [Object s b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="Common.Object.Transform.html#New"><span class="hs-identifier hs-type">New</span></a></span><span> </span><span id="local-6989586621679232328"><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232328"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232328"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s b] -&gt; Scene s () -&gt; Scene s [Object s b]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; [Object s b] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oShowWith`</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeIn</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232328"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="Common.Object.Transform.html#Vanish"><span class="hs-identifier hs-type">Vanish</span></a></span><span> </span><span id="local-6989586621679232325"><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232325"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Object s b] -&gt; Scene s () -&gt; Scene s [Object s b]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oHideWith</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232325"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeOut</span></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679232322"><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232322"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Common.Object.Transform.html#%3A%3A%3D%3E"><span class="hs-operator hs-type">::=&gt;</span></a></span><span> </span><span id="local-6989586621679232321"><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232321"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232321"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s b] -&gt; Scene s () -&gt; Scene s [Object s b]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>      </span><span id="local-6989586621679232320"><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232320"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; Scene s (V2 Double)
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s (V2 Double)
</span><a href="Common.Object.Transform.html#readGroupTrans"><span class="hs-identifier hs-var">readGroupTrans</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232322"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679232319"><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232319"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s b] -&gt; Scene s (V2 Double)
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s (V2 Double)
</span><a href="Common.Object.Transform.html#readGroupTrans"><span class="hs-identifier hs-var">readGroupTrans</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232321"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span id="local-6989586621679232318"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232318"><span class="hs-identifier hs-var">h0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; Scene s Double
forall s a. [Object s a] -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readHeight"><span class="hs-identifier hs-var">readHeight</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232322"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span id="local-6989586621679232317"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232317"><span class="hs-identifier hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s b] -&gt; Scene s Double
forall s a. [Object s a] -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readHeight"><span class="hs-identifier hs-var">readHeight</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232321"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span id="local-6989586621679232316"><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679232316"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object s a
-&gt; Getting (SVG -&gt; SVG) (ObjectData a) (SVG -&gt; SVG)
-&gt; Scene s (SVG -&gt; SVG)
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-identifier hs-var">oRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s a] -&gt; Object s a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232322"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Getting (SVG -&gt; SVG) (ObjectData a) (SVG -&gt; SVG)
forall a. Lens' (ObjectData a) (SVG -&gt; SVG)
</span><span class="hs-identifier hs-var">oContext</span></span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; [Object s b] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s b -&gt; (ObjectData b -&gt; ObjectData b) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
-&gt; ObjectData b -&gt; Identity (ObjectData b)
forall a. Lens' (ObjectData a) (SVG -&gt; SVG)
</span><span class="hs-identifier hs-var">oContext</span></span><span> </span><span class="annot"><span class="annottext">(((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
 -&gt; ObjectData b -&gt; Identity (ObjectData b))
-&gt; (SVG -&gt; SVG) -&gt; ObjectData b -&gt; ObjectData b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679232316"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232321"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; (Object s a -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232322"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">((Object s a -&gt; Scene s ()) -&gt; Scene s ())
-&gt; (Object s a -&gt; Scene s ()) -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679232313"><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232313"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
forall s a.
Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oTween</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679232313"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ())
-&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679232311"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232311"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679232310"><span class="annot"><span class="annottext">ObjectData a
</span><a href="#local-6989586621679232310"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679232309"><span class="annot"><span class="annottext">scaleRatio :: Double
</span><a href="#local-6989586621679232309"><span class="hs-identifier hs-var hs-var">scaleRatio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232311"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232311"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232317"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232318"><span class="hs-identifier hs-var">h0</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ObjectData a
</span><a href="#local-6989586621679232310"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">ObjectData a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; ObjectData a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(V2 Double -&gt; Identity (V2 Double))
-&gt; ObjectData a -&gt; Identity (ObjectData a)
forall a. Lens' (ObjectData a) (V2 Double)
</span><span class="hs-identifier hs-var">oTranslate</span></span><span> </span><span class="annot"><span class="annottext">((V2 Double -&gt; Identity (V2 Double))
 -&gt; ObjectData a -&gt; Identity (ObjectData a))
-&gt; (V2 Double -&gt; V2 Double) -&gt; ObjectData a -&gt; ObjectData a
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679232307"><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232307"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232309"><span class="hs-identifier hs-var">scaleRatio</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; V2 Double -&gt; V2 Double
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232307"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Double -&gt; V2 Double -&gt; V2 Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232320"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">V2 Double -&gt; V2 Double -&gt; V2 Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232320"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>          </span><span class="annot"><span class="annottext">ObjectData a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; ObjectData a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(V2 Double -&gt; Identity (V2 Double))
-&gt; ObjectData a -&gt; Identity (ObjectData a)
forall a. Lens' (ObjectData a) (V2 Double)
</span><span class="hs-identifier hs-var">oTranslate</span></span><span> </span><span class="annot"><span class="annottext">((V2 Double -&gt; Identity (V2 Double))
 -&gt; ObjectData a -&gt; Identity (ObjectData a))
-&gt; (V2 Double -&gt; V2 Double) -&gt; ObjectData a -&gt; ObjectData a
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Double -&gt; V2 Double -&gt; V2 Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232311"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; V2 Double -&gt; V2 Double
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232319"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Double -&gt; V2 Double -&gt; V2 Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">V2 Double
</span><a href="#local-6989586621679232320"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>          </span><span class="annot"><span class="annottext">ObjectData a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; ObjectData a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData a -&gt; Identity (ObjectData a)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oScale</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData a -&gt; Identity (ObjectData a))
-&gt; (Double -&gt; Double) -&gt; ObjectData a -&gt; ObjectData a
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679232309"><span class="hs-identifier hs-var">scaleRatio</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s ()) -&gt; [Object s a] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Object s a -&gt; Scene s ()
forall s a. Object s a -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oHide</span></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679232322"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="annottext">(Object s b -&gt; Scene s ()) -&gt; [Object s b] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Object s b -&gt; Scene s ()
forall s a. Object s a -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oShow</span></span><span> </span><span class="annot"><span class="annottext">[Object s b]
</span><a href="#local-6989586621679232321"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- |Key frame animation.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- __Warning__: if alignment base (see 'Trans' for details) is empty, then all the</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- alignment functions provided in this module would crash your program. In this</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- case, custom (ad-hoc) alignment functions might be useful. Or, to specify a</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- custom alignment base @bs@, use @const (alignment bs)@ instead of @alignment@.</span><span>
</span><span id="line-287"></span><span id="local-6989586621679232604"><span id="local-6989586621679232605"><span id="local-6989586621679232606"><span class="annot"><a href="Common.Object.Transform.html#transformObject"><span class="hs-identifier hs-type">transformObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232606"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232605"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232606"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232604"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232606"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-288"></span><span id="transformObject"><span class="annot"><span class="annottext">transformObject :: [Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><a href="Common.Object.Transform.html#transformObject"><span class="hs-identifier hs-var hs-var">transformObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s [Object s b] -&gt; Scene s ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Scene s [Object s b] -&gt; Scene s ())
-&gt; ([Trans (Object s a) [Object s b]] -&gt; Scene s [Object s b])
-&gt; [Trans (Object s a) [Object s b]]
-&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Trans (Object s a) [Object s b]] -&gt; Scene s [Object s b]
forall s a b.
[Trans (Object s a) [Object s b]] -&gt; Scene s [Object s b]
</span><a href="Common.Object.Transform.html#transformObjectRaw"><span class="hs-identifier hs-var">transformObjectRaw</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- |Key frame animation, but without hiding the original.</span><span>
</span><span id="line-291"></span><span id="local-6989586621679232301"><span id="local-6989586621679232302"><span id="local-6989586621679232303"><span class="annot"><a href="Common.Object.Transform.html#dupFromObject"><span class="hs-identifier hs-type">dupFromObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Renderable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232303"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.Object.Transform.html#Trans"><span class="hs-identifier hs-type">Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232302"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232302"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232301"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232302"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-292"></span><span id="dupFromObject"><span class="annot"><span class="annottext">dupFromObject :: [Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><a href="Common.Object.Transform.html#dupFromObject"><span class="hs-identifier hs-var hs-var">dupFromObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  (WrappedMonad (Scene s))
  [Trans (Object s a) [Object s b]]
  [Trans (Object s a) [Object s b]]
  (Object s a)
  (Object s a)
-&gt; (Object s a -&gt; Scene s (Object s a))
-&gt; [Trans (Object s a) [Object s b]]
-&gt; Scene s [Trans (Object s a) [Object s b]]
forall (m :: * -&gt; *) s t a b.
LensLike (WrappedMonad m) s t a b -&gt; (a -&gt; m b) -&gt; s -&gt; m t
</span><span class="hs-identifier hs-var">mapMOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Trans (Object s a) [Object s b]
 -&gt; WrappedMonad (Scene s) (Trans (Object s a) [Object s b]))
-&gt; [Trans (Object s a) [Object s b]]
-&gt; WrappedMonad (Scene s) [Trans (Object s a) [Object s b]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((Trans (Object s a) [Object s b]
  -&gt; WrappedMonad (Scene s) (Trans (Object s a) [Object s b]))
 -&gt; [Trans (Object s a) [Object s b]]
 -&gt; WrappedMonad (Scene s) [Trans (Object s a) [Object s b]])
-&gt; ((Object s a -&gt; WrappedMonad (Scene s) (Object s a))
    -&gt; Trans (Object s a) [Object s b]
    -&gt; WrappedMonad (Scene s) (Trans (Object s a) [Object s b]))
-&gt; LensLike
     (WrappedMonad (Scene s))
     [Trans (Object s a) [Object s b]]
     [Trans (Object s a) [Object s b]]
     (Object s a)
     (Object s a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; WrappedMonad (Scene s) (Object s a))
-&gt; Trans (Object s a) [Object s b]
-&gt; WrappedMonad (Scene s) (Trans (Object s a) [Object s b])
forall a b a'. Traversal (Trans a b) (Trans a' b) a a'
</span><a href="Common.Object.Transform.html#transOrigin"><span class="hs-identifier hs-var">transOrigin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Object s a -&gt; Scene s (Object s a)
forall a s. Renderable a =&gt; Object s a -&gt; Scene s (Object s a)
</span><a href="Common.Object.Transform.html#dupObject"><span class="hs-identifier hs-var">dupObject</span></a></span><span> </span><span class="annot"><span class="annottext">([Trans (Object s a) [Object s b]]
 -&gt; Scene s [Trans (Object s a) [Object s b]])
-&gt; ([Trans (Object s a) [Object s b]] -&gt; Scene s ())
-&gt; [Trans (Object s a) [Object s b]]
-&gt; Scene s ()
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Trans (Object s a) [Object s b]] -&gt; Scene s ()
forall s a b. [Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><a href="Common.Object.Transform.html#transformObject"><span class="hs-identifier hs-var">transformObject</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- |Read the overall translation of an 'Object' group.</span><span>
</span><span id="line-295"></span><span id="local-6989586621679232641"><span id="local-6989586621679232642"><span id="local-6989586621679232643"><span class="annot"><a href="Common.Object.Transform.html#readGroupTrans"><span class="hs-identifier hs-type">readGroupTrans</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679232643"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679232643"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679232642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232641"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679232642"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-296"></span><span id="readGroupTrans"><span class="annot"><span class="annottext">readGroupTrans :: t (Object s a) -&gt; Scene s (V2 Double)
</span><a href="Common.Object.Transform.html#readGroupTrans"><span class="hs-identifier hs-var hs-var">readGroupTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 (Scene s Double) -&gt; Scene s (V2 Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">(V2 (Scene s Double) -&gt; Scene s (V2 Double))
-&gt; (t (Object s a) -&gt; V2 (Scene s Double))
-&gt; t (Object s a)
-&gt; Scene s (V2 Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s Double -&gt; Scene s Double -&gt; V2 (Scene s Double)
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">(Scene s Double -&gt; Scene s Double -&gt; V2 (Scene s Double))
-&gt; (t (Object s a) -&gt; Scene s Double)
-&gt; t (Object s a)
-&gt; Scene s Double
-&gt; V2 (Scene s Double)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">t (Object s a) -&gt; Scene s Double
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterX"><span class="hs-identifier hs-var">readCenterX</span></a></span><span> </span><span class="annot"><span class="annottext">(t (Object s a) -&gt; Scene s Double -&gt; V2 (Scene s Double))
-&gt; (t (Object s a) -&gt; Scene s Double)
-&gt; t (Object s a)
-&gt; V2 (Scene s Double)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">t (Object s a) -&gt; Scene s Double
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s Double
</span><a href="Common.Object.Transform.html#readCenterY"><span class="hs-identifier hs-var">readCenterY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span></pre></body></html>