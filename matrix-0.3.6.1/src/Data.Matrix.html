<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- | Matrix datatype and operations.</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">--   Every provided example has been tested.</span><span>
</span><span id="line-5"></span><span class="hs-comment">--   Run @cabal test@ for further tests.</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Matrix</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Matrix type</span></span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier">Matrix</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#prettyMatrix"><span class="hs-identifier">prettyMatrix</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#nrows"><span class="hs-identifier">nrows</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#ncols"><span class="hs-identifier">ncols</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#forceMatrix"><span class="hs-identifier">forceMatrix</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Builders</span></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#matrix"><span class="hs-identifier">matrix</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#rowVector"><span class="hs-identifier">rowVector</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#colVector"><span class="hs-identifier">colVector</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Special matrices</span></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#zero"><span class="hs-identifier">zero</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#identity"><span class="hs-identifier">identity</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#diagonalList"><span class="hs-identifier">diagonalList</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#diagonal"><span class="hs-identifier">diagonal</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#permMatrix"><span class="hs-identifier">permMatrix</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * List conversions</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#fromList"><span class="hs-identifier">fromList</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#fromLists"><span class="hs-identifier">fromLists</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#toList"><span class="hs-identifier">toList</span></a></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#toLists"><span class="hs-identifier">toLists</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Accessing</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#getElem"><span class="hs-identifier">getElem</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier">unsafeGet</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#safeGet"><span class="hs-identifier">safeGet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#safeSet"><span class="hs-identifier">safeSet</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#getRow"><span class="hs-identifier">getRow</span></a></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#safeGetRow"><span class="hs-identifier">safeGetRow</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#getCol"><span class="hs-identifier">getCol</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#safeGetCol"><span class="hs-identifier">safeGetCol</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#getDiag"><span class="hs-identifier">getDiag</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#getMatrixAsVector"><span class="hs-identifier">getMatrixAsVector</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Manipulating matrices</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#setElem"><span class="hs-identifier">setElem</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#unsafeSet"><span class="hs-identifier">unsafeSet</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#transpose"><span class="hs-identifier">transpose</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#setSize"><span class="hs-identifier">setSize</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#extendTo"><span class="hs-identifier">extendTo</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#inverse"><span class="hs-identifier">inverse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#rref"><span class="hs-identifier">rref</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#mapRow"><span class="hs-identifier">mapRow</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#mapCol"><span class="hs-identifier">mapCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#mapPos"><span class="hs-identifier">mapPos</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Submatrices</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Splitting blocks</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#submatrix"><span class="hs-identifier">submatrix</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#minorMatrix"><span class="hs-identifier">minorMatrix</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier">splitBlocks</span></a></span><span>
</span><span id="line-40"></span><span>   </span><span class="annot"><span class="hs-comment">-- ** Joining blocks</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#%3C-%3E"><span class="hs-operator">(&lt;-&gt;)</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#joinBlocks"><span class="hs-identifier">joinBlocks</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Matrix operations</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#elementwise"><span class="hs-identifier">elementwise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#elementwiseUnsafe"><span class="hs-identifier">elementwiseUnsafe</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Matrix multiplication</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** About matrix multiplication</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="hs-comment">-- $mult</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Functions</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStd"><span class="hs-identifier">multStd</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStd2"><span class="hs-identifier">multStd2</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStrassen"><span class="hs-identifier">multStrassen</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStrassenMixed"><span class="hs-identifier">multStrassenMixed</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Linear transformations</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#scaleMatrix"><span class="hs-identifier">scaleMatrix</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#scaleRow"><span class="hs-identifier">scaleRow</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#combineRows"><span class="hs-identifier">combineRows</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#switchRows"><span class="hs-identifier">switchRows</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#switchCols"><span class="hs-identifier">switchCols</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Decompositions</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#luDecomp"><span class="hs-identifier">luDecomp</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#luDecompUnsafe"><span class="hs-identifier">luDecompUnsafe</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#luDecomp%27"><span class="hs-identifier">luDecomp'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#luDecompUnsafe%27"><span class="hs-identifier">luDecompUnsafe'</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#cholDecomp"><span class="hs-identifier">cholDecomp</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Properties</span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-identifier">trace</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#diagProd"><span class="hs-identifier">diagProd</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Determinants</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#detLaplace"><span class="hs-identifier">detLaplace</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#detLU"><span class="hs-identifier">detLU</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#flatten"><span class="hs-identifier">flatten</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl1</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Classes</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Loop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">numLoop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">numLoopFold</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Foldable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl1</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Applicative</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;$&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;*&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pure</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- Data</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Primitive</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PrimMonad</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PrimState</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maximumBy</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">foldl1'</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Mutable</span></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MV</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-92"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-93"></span><span class="hs-comment">---- MATRIX TYPE</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-type">encode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-96"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#encode"><span class="hs-pragma hs-type">encode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-97"></span><span id="encode"><span class="annot"><span class="annottext">encode :: Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var hs-var">encode</span></a></span></span><span> </span><span id="local-6989586621679050260"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050260"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050259"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050259"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050258"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050258"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050259"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050260"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050258"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="annot"><a href="Data.Matrix.html#decode"><span class="hs-identifier hs-type">decode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#decode"><span class="hs-pragma hs-type">decode</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-101"></span><span id="decode"><span class="annot"><span class="annottext">decode :: Int -&gt; Int -&gt; (Int, Int)
</span><a href="Data.Matrix.html#decode"><span class="hs-identifier hs-var hs-var">decode</span></a></span></span><span> </span><span id="local-6989586621679050254"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050254"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679050253"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050253"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050252"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050251"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679050252"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050252"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050251"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050251"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-identifier hs-var">quotRem</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050253"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050254"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Type of matrices.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">--   Elements can be of any type. Rows and columns</span><span>
</span><span id="line-108"></span><span class="hs-comment">--   are indexed starting by 1. This means that, if @m :: Matrix a@ and</span><span>
</span><span id="line-109"></span><span class="hs-comment">--   @i,j :: Int@, then @m ! (i,j)@ is the element in the @i@-th row and</span><span>
</span><span id="line-110"></span><span class="hs-comment">--   @j@-th column of @m@.</span><span>
</span><span id="line-111"></span><span id="local-6989586621679050248"><span id="local-6989586621679050249"></span></span><span class="hs-keyword">data</span><span> </span><span id="Matrix"><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-var">Matrix</span></a></span></span><span> </span><span id="local-6989586621679050656"><span class="annot"><a href="#local-6989586621679050656"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="M"><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-112"></span><span>   </span><span id="nrows"><span class="annot"><span class="annottext">Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of rows.</span><span>
</span><span id="line-113"></span><span> </span><span class="hs-special">,</span><span> </span><span id="ncols"><span class="annot"><span class="annottext">Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of columns.</span><span>
</span><span id="line-114"></span><span> </span><span class="hs-special">,</span><span> </span><span id="rowOffset"><span class="annot"><span class="annottext">Matrix a -&gt; Int
</span><a href="Data.Matrix.html#rowOffset"><span class="hs-identifier hs-var hs-var">rowOffset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-115"></span><span> </span><span class="hs-special">,</span><span> </span><span id="colOffset"><span class="annot"><span class="annottext">Matrix a -&gt; Int
</span><a href="Data.Matrix.html#colOffset"><span class="hs-identifier hs-var hs-var">colOffset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-116"></span><span> </span><span class="hs-special">,</span><span> </span><span id="vcols"><span class="annot"><span class="annottext">Matrix a -&gt; Int
</span><a href="Data.Matrix.html#vcols"><span class="hs-identifier hs-var hs-var">vcols</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of columns of the matrix without offset</span><span>
</span><span id="line-117"></span><span> </span><span class="hs-special">,</span><span> </span><span id="mvect"><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var hs-var">mvect</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050656"><span class="hs-identifier hs-type">a</span></a></span><span>          </span><span class="hs-comment">-- ^ Content of the matrix as a plain vector.</span><span>
</span><span id="line-118"></span><span>   </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Matrix a -&gt; Rep (Matrix a) x)
-&gt; (forall x. Rep (Matrix a) x -&gt; Matrix a) -&gt; Generic (Matrix a)
forall x. Rep (Matrix a) x -&gt; Matrix a
forall x. Matrix a -&gt; Rep (Matrix a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Matrix a) x -&gt; Matrix a
forall a x. Matrix a -&gt; Rep (Matrix a) x
$cto :: forall a x. Rep (Matrix a) x -&gt; Matrix a
$cfrom :: forall a x. Matrix a -&gt; Rep (Matrix a) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679050239"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050236"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679050239"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050239"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679050234"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050234"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679050233"><span class="annot"><span class="annottext">== :: Matrix a -&gt; Matrix a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679050232"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050232"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050231"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679050231"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050234"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621679050230"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679050230"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050234"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050231"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050232"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool] -&gt; [Bool]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050230"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050232"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; [Bool] -&gt; [Bool]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050234"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050228"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050227"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050232"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050228"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050227"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679050228"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050228"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050231"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050227"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050227"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050230"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Just a cool way to output the size of a matrix.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-type">sizeStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-129"></span><span id="sizeStr"><span class="annot"><span class="annottext">sizeStr :: Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var hs-var">sizeStr</span></a></span></span><span> </span><span id="local-6989586621679050225"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050225"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050224"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050224"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050225"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050224"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Display a matrix as a 'String' using the 'Show' instance of its elements.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679050222"><span class="annot"><a href="Data.Matrix.html#prettyMatrix"><span class="hs-identifier hs-type">prettyMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679050222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-133"></span><span id="prettyMatrix"><span class="annot"><span class="annottext">prettyMatrix :: Matrix a -&gt; String
</span><a href="Data.Matrix.html#prettyMatrix"><span class="hs-identifier hs-var hs-var">prettyMatrix</span></a></span></span><span> </span><span id="local-6989586621679050221"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050221"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-134"></span><span>   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#9484; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String -&gt; [String]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050221"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050217"><span class="hs-identifier hs-var">blank</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &#9488;\n&quot;</span></span><span>
</span><span id="line-135"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-136"></span><span>   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#9474; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; [Int] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679050215"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050215"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679050214"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix String
</span><a href="#local-6989586621679050213"><span class="hs-identifier hs-var">strings</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix String -&gt; (Int, Int) -&gt; String
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050212"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050215"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050221"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &#9474;&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679050212"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050212"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050221"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#9492; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String -&gt; [String]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050221"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050217"><span class="hs-identifier hs-var">blank</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &#9496;&quot;</span></span><span>
</span><span id="line-138"></span><span>   </span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>   </span><span id="local-6989586621679050213"><span class="annot"><span class="annottext">strings :: Matrix String
</span><a href="#local-6989586621679050213"><span class="hs-identifier hs-var">strings</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679050211"><span class="annot"><span class="annottext">Vector String
</span><a href="#local-6989586621679050211"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; String) -&gt; Matrix a -&gt; Matrix String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050221"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-141"></span><span>   </span><span id="local-6989586621679050210"><span class="annot"><span class="annottext">widest :: Int
</span><a href="#local-6989586621679050210"><span class="hs-identifier hs-var hs-var">widest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Int -&gt; Int
forall a. Ord a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.maximum</span></span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Int) -&gt; Vector Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; Vector String -&gt; Vector Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Vector String
</span><a href="#local-6989586621679050211"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-142"></span><span>   </span><span id="local-6989586621679050214"><span class="annot"><span class="annottext">fill :: String -&gt; String
</span><a href="#local-6989586621679050214"><span class="hs-identifier hs-var hs-var">fill</span></a></span></span><span> </span><span id="local-6989586621679050207"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050207"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050210"><span class="hs-identifier hs-var">widest</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050207"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679050207"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-143"></span><span>   </span><span id="local-6989586621679050217"><span class="annot"><span class="annottext">blank :: String
</span><a href="#local-6989586621679050217"><span class="hs-identifier hs-var hs-var">blank</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679050214"><span class="hs-identifier hs-var">fill</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span id="local-6989586621679050206"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050201"><span id="local-6989586621679050204"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679050206"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span> </span><span id="local-6989586621679050199"><span class="annot"><span class="annottext">show :: Matrix a -&gt; String
</span><a href="#local-6989586621679050199"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; String
forall a. Show a =&gt; Matrix a -&gt; String
</span><a href="Data.Matrix.html#prettyMatrix"><span class="hs-identifier hs-var">prettyMatrix</span></a></span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621679050198"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679050198"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050198"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span> </span><span id="local-6989586621679050195"><span class="annot"><span class="annottext">rnf :: Matrix a -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; ()) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var hs-var">mvect</span></a></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | /O(rows*cols)/. Similar to 'V.force'. It copies the matrix content</span><span>
</span><span id="line-153"></span><span class="hs-comment">--   dropping any extra memory.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   Useful when using 'submatrix' from a big matrix.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span id="local-6989586621679050531"><span class="annot"><a href="Data.Matrix.html#forceMatrix"><span class="hs-identifier hs-type">forceMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050531"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050531"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-158"></span><span id="forceMatrix"><span class="annot"><span class="annottext">forceMatrix :: Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#forceMatrix"><span class="hs-identifier hs-var hs-var">forceMatrix</span></a></span></span><span> </span><span id="local-6989586621679050192"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050192"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050192"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050192"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679050191"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050191"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050190"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050190"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050191"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050190"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050192"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-161"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-162"></span><span class="hs-comment">---- FUNCTOR INSTANCE</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050187"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fmap</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-166"></span><span> </span><span id="local-6989586621679050185"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679050184"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679050184"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679050183"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050183"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050182"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050182"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679050181"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050181"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679050180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050180"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679050179"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050179"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679050178"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050178"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector b -&gt; Matrix b
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050183"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050182"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050181"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050180"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050179"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector b -&gt; Matrix b) -&gt; Vector b -&gt; Matrix b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Vector a -&gt; Vector b
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679050184"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050178"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-169"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-172"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-173"></span><span class="hs-comment">---- MONOID INSTANCE</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679050176"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050171"><span id="local-6989586621679050173"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679050176"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679050169"><span class="annot"><span class="annottext">&lt;&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span id="local-6989586621679050168"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050163"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679050168"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050168"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679050161"><span class="annot"><span class="annottext">mempty :: Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [a] -&gt; Matrix a
forall a. Int -&gt; Int -&gt; [a] -&gt; Matrix a
</span><a href="Data.Matrix.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679050160"><span class="annot"><span class="annottext">mappend :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span id="local-6989586621679050159"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050159"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679050158"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050158"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050159"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050158"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050159"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050158"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; a) -&gt; (Int, Int) -&gt; a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; a
</span><a href="#local-6989586621679050155"><span class="hs-identifier hs-var">zipTogether</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679050155"><span class="annot"><span class="annottext">zipTogether :: Int -&gt; Int -&gt; a
</span><a href="#local-6989586621679050155"><span class="hs-identifier hs-var hs-var">zipTogether</span></a></span></span><span> </span><span id="local-6989586621679050154"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050154"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span id="local-6989586621679050153"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050153"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; Maybe a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
</span><a href="Data.Matrix.html#safeGet"><span class="hs-identifier hs-var">safeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050154"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050153"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050159"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
</span><a href="Data.Matrix.html#safeGet"><span class="hs-identifier hs-var">safeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050154"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050153"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050158"><span class="hs-identifier hs-var">m'</span></a></span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-185"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-186"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-187"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-190"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-191"></span><span class="hs-comment">---- APPLICATIVE INSTANCE</span><span>
</span><span id="line-192"></span><span class="hs-comment">---- Works like tensor product but applies a function</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050143"><span id="local-6989586621679050145"><span id="local-6989586621679050147"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679050141"><span class="annot"><span class="annottext">pure :: a -&gt; Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679050140"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [a] -&gt; Matrix a
forall a. Int -&gt; Int -&gt; [a] -&gt; Matrix a
</span><a href="Data.Matrix.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050140"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679050139"><span class="annot"><span class="annottext">Matrix (a -&gt; b)
</span><a href="#local-6989586621679050139"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679050138"><span class="annot"><span class="annottext">&lt;*&gt; :: Matrix (a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span id="local-6989586621679050137"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050137"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix (Matrix b) -&gt; Matrix b
forall a. Matrix (Matrix a) -&gt; Matrix a
</span><a href="Data.Matrix.html#flatten"><span class="hs-identifier hs-var">flatten</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix (Matrix b) -&gt; Matrix b) -&gt; Matrix (Matrix b) -&gt; Matrix b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679050136"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679050136"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679050136"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Matrix a -&gt; Matrix b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050137"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; Matrix b) -&gt; Matrix (a -&gt; b) -&gt; Matrix (Matrix b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix (a -&gt; b)
</span><a href="#local-6989586621679050139"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-200"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Flatten a matrix of matrices. All sub matrices must have same dimensions</span><span>
</span><span id="line-205"></span><span class="hs-comment">--   This criteria is not checked.</span><span>
</span><span id="line-206"></span><span id="local-6989586621679050583"><span class="annot"><a href="Data.Matrix.html#flatten"><span class="hs-identifier hs-type">flatten</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050583"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050583"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-207"></span><span id="flatten"><span class="annot"><span class="annottext">flatten :: Matrix (Matrix a) -&gt; Matrix a
</span><a href="Data.Matrix.html#flatten"><span class="hs-identifier hs-var hs-var">flatten</span></a></span></span><span> </span><span id="local-6989586621679050135"><span class="annot"><span class="annottext">Matrix (Matrix a)
</span><a href="#local-6989586621679050135"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a -&gt; Matrix a) -&gt; [Matrix a] -&gt; Matrix a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C-%3E"><span class="hs-operator hs-var">(&lt;-&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">([Matrix a] -&gt; Matrix a) -&gt; [Matrix a] -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a) -&gt; [Int] -&gt; [Matrix a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a -&gt; Matrix a) -&gt; Vector (Matrix a) -&gt; Matrix a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator hs-var">(&lt;|&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Matrix a) -&gt; Matrix a)
-&gt; (Int -&gt; Vector (Matrix a)) -&gt; Int -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679050134"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050134"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix (Matrix a) -&gt; Vector (Matrix a)
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getRow"><span class="hs-identifier hs-var">getRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050134"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix (Matrix a)
</span><a href="#local-6989586621679050135"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix (Matrix a) -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix (Matrix a)
</span><a href="#local-6989586621679050135"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | /O(rows*cols)/. Map a function over a row.</span><span>
</span><span id="line-210"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- &gt;                          ( 1 2 3 )   ( 1 2 3 )</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- &gt;                          ( 4 5 6 )   ( 5 6 7 )</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- &gt; mapRow (\_ x -&gt; x + 1) 2 ( 7 8 9 ) = ( 7 8 9 )</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span id="local-6989586621679050374"><span class="annot"><a href="Data.Matrix.html#mapRow"><span class="hs-identifier hs-type">mapRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050374"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function takes the current column as additional argument.</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>            </span><span class="hs-comment">-- ^ Row to map.</span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050374"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-219"></span><span id="mapRow"><span class="annot"><span class="annottext">mapRow :: (Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#mapRow"><span class="hs-identifier hs-var hs-var">mapRow</span></a></span></span><span> </span><span id="local-6989586621679050133"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621679050133"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679050132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050132"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679050131"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050131"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050131"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050131"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679050130"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050130"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050129"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050129"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050128"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679050128"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050130"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050129"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050131"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050130"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050132"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-223"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621679050133"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050129"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050128"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-224"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050128"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | /O(rows*cols)/. Map a function over a column.</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-228"></span><span class="hs-comment">--</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- &gt;                          ( 1 2 3 )   ( 1 3 3 )</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- &gt;                          ( 4 5 6 )   ( 4 6 6 )</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- &gt; mapCol (\_ x -&gt; x + 1) 2 ( 7 8 9 ) = ( 7 9 9 )</span><span>
</span><span id="line-232"></span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span id="local-6989586621679050127"><span class="annot"><a href="Data.Matrix.html#mapCol"><span class="hs-identifier hs-type">mapCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050127"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050127"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function takes the current row as additional argument.</span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>            </span><span class="hs-comment">-- ^ Column to map.</span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050127"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050127"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-236"></span><span id="mapCol"><span class="annot"><span class="annottext">mapCol :: (Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#mapCol"><span class="hs-identifier hs-var hs-var">mapCol</span></a></span></span><span> </span><span id="local-6989586621679050126"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621679050126"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679050125"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050125"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679050124"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050124"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050124"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050124"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679050123"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050123"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050122"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050122"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050121"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679050121"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050123"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050122"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050124"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050122"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050125"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-240"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
</span><a href="#local-6989586621679050126"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050123"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050121"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-241"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050121"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | /O(rows*cols)/. Map a function over elements.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- &gt;                            ( 1 2 3 )   ( 0 -1 -2 )</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- &gt;                            ( 4 5 6 )   ( 1  0 -1 )</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- &gt; mapPos (\(r,c) a -&gt; r - c) ( 7 8 9 ) = ( 2  1  0 )</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span id="local-6989586621679050119"><span id="local-6989586621679050120"><span class="annot"><a href="Data.Matrix.html#mapPos"><span class="hs-identifier hs-type">mapPos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050120"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050119"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function takes the current Position as additional argument.</span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050120"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050119"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-254"></span><span id="mapPos"><span class="annot"><span class="annottext">mapPos :: ((Int, Int) -&gt; a -&gt; b) -&gt; Matrix a -&gt; Matrix b
</span><a href="Data.Matrix.html#mapPos"><span class="hs-identifier hs-var hs-var">mapPos</span></a></span></span><span> </span><span id="local-6989586621679050118"><span class="annot"><span class="annottext">(Int, Int) -&gt; a -&gt; b
</span><a href="#local-6989586621679050118"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679050117"><span class="annot"><span class="annottext">m :: Matrix a
</span><a href="#local-6989586621679050117"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ncols :: forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var">ncols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679050116"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050116"><span class="hs-identifier hs-var">cols</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mvect :: forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var">mvect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679050115"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050115"><span class="hs-identifier hs-var">vect</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050117"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mvect :: Vector b
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var">mvect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
forall a b. (Int -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.imap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679050113"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050113"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679050112"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050112"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; a -&gt; b
</span><a href="#local-6989586621679050118"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="Data.Matrix.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050116"><span class="hs-identifier hs-var">cols</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050113"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050112"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050115"><span class="hs-identifier hs-var">vect</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-258"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-259"></span><span class="hs-comment">---- FOLDABLE AND TRAVERSABLE INSTANCES</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050079"><span id="local-6989586621679050081"><span id="local-6989586621679050083"><span id="local-6989586621679050085"><span id="local-6989586621679050087"><span id="local-6989586621679050089"><span id="local-6989586621679050091"><span id="local-6989586621679050093"><span id="local-6989586621679050095"><span id="local-6989586621679050097"><span id="local-6989586621679050099"><span id="local-6989586621679050101"><span id="local-6989586621679050103"><span id="local-6989586621679050105"><span id="local-6989586621679050107"><span id="local-6989586621679050110"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span> </span><span id="local-6989586621679050077"><span class="annot"><span class="annottext">foldMap :: (a -&gt; m) -&gt; Matrix a -&gt; m
</span><a href="#local-6989586621679050077"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span id="local-6989586621679050076"><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679050076"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Vector a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m
</span><a href="#local-6989586621679050076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; m) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var hs-var">mvect</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Vector a)
-&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#forceMatrix"><span class="hs-identifier hs-var">forceMatrix</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679050067"><span id="local-6989586621679050069"><span id="local-6989586621679050072"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span> </span><span id="local-6989586621679050065"><span class="annot"><span class="annottext">sequenceA :: Matrix (f a) -&gt; f (Matrix a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sequenceA</span></span></span><span> </span><span id="local-6989586621679050063"><span class="annot"><span class="annottext">Matrix (f a)
</span><a href="#local-6989586621679050063"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; f (Vector a) -&gt; f (Matrix a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix (f a) -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix (f a)
</span><a href="#local-6989586621679050063"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix (f a) -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix (f a)
</span><a href="#local-6989586621679050063"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix (f a) -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix (f a)
</span><a href="#local-6989586621679050063"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f (Vector a) -&gt; f (Matrix a))
-&gt; (Matrix (f a) -&gt; f (Vector a)) -&gt; Matrix (f a) -&gt; f (Matrix a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (f a) -&gt; f (Vector a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">(Vector (f a) -&gt; f (Vector a))
-&gt; (Matrix (f a) -&gt; Vector (f a)) -&gt; Matrix (f a) -&gt; f (Vector a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix (f a) -&gt; Vector (f a)
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var hs-var">mvect</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix (f a) -&gt; f (Matrix a)) -&gt; Matrix (f a) -&gt; f (Matrix a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix (f a) -&gt; Matrix (f a)
forall a. Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#forceMatrix"><span class="hs-identifier hs-var">forceMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix (f a)
</span><a href="#local-6989586621679050063"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-268"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-269"></span><span class="hs-comment">---- BUILDERS</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | /O(rows*cols)/. The zero matrix of the given size.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- &gt; zero n m =</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- &gt;                 m</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- &gt;   1 ( 0 0 ... 0 0 )</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- &gt;   2 ( 0 0 ... 0 0 )</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- &gt;     (     ...     )</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- &gt;     ( 0 0 ... 0 0 )</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- &gt;   n ( 0 0 ... 0 0 )</span><span>
</span><span id="line-280"></span><span id="local-6989586621679050343"><span class="annot"><a href="Data.Matrix.html#zero"><span class="hs-identifier hs-type">zero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050343"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-281"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Rows</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Columns</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050343"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-284"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#zero"><span class="hs-pragma hs-type">zero</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-285"></span><span id="zero"><span class="annot"><span class="annottext">zero :: Int -&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#zero"><span class="hs-identifier hs-var hs-var">zero</span></a></span></span><span> </span><span id="local-6989586621679050062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050062"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050061"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050061"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050062"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050061"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050061"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Vector a
forall a. Int -&gt; a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050062"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050061"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | /O(rows*cols)/. Generate a matrix from a generator function.</span><span>
</span><span id="line-288"></span><span class="hs-comment">--   Example of usage:</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- &gt;                                  (  1  0 -1 -2 )</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- &gt;                                  (  3  2  1  0 )</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- &gt;                                  (  5  4  3  2 )</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- &gt; matrix 4 4 $ \(i,j) -&gt; 2*i - j = (  7  6  5  4 )</span><span>
</span><span id="line-294"></span><span id="local-6989586621679050628"><span class="annot"><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-type">matrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Rows</span><span>
</span><span id="line-295"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Columns</span><span>
</span><span id="line-296"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Generator function</span><span>
</span><span id="line-297"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050628"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-298"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#matrix"><span class="hs-pragma hs-type">matrix</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-299"></span><span id="matrix"><span class="annot"><span class="annottext">matrix :: Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var hs-var">matrix</span></a></span></span><span> </span><span id="local-6989586621679050059"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050059"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050058"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050058"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679050057"><span class="annot"><span class="annottext">(Int, Int) -&gt; a
</span><a href="#local-6989586621679050057"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050059"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050058"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050058"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s a)) -&gt; Vector a
forall a. (forall s. ST s (MVector s a)) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.create</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (MVector s a)) -&gt; Vector a)
-&gt; (forall s. ST s (MVector s a)) -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679050055"><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679050055"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector (PrimState (ST s)) a)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.new</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s (MVector (PrimState (ST s)) a))
-&gt; Int -&gt; ST s (MVector (PrimState (ST s)) a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050059"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050058"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679050053"><span class="annot"><span class="annottext">en :: (Int, Int) -&gt; Int
</span><a href="#local-6989586621679050053"><span class="hs-identifier hs-var hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050058"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050059"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679050052"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050052"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050058"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679050051"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050051"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.unsafeWrite</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679050055"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679050053"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050051"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; a
</span><a href="#local-6989586621679050057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050052"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050051"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="annottext">MVector s a -&gt; ST s (MVector s a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679050055"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | /O(rows*cols)/. Identity matrix of the given order.</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- &gt; identity n =</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- &gt;                 n</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;   1 ( 1 0 ... 0 0 )</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- &gt;   2 ( 0 1 ... 0 0 )</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- &gt;     (     ...     )</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- &gt;     ( 0 0 ... 1 0 )</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- &gt;   n ( 0 0 ... 0 1 )</span><span>
</span><span id="line-316"></span><span class="hs-comment">--</span><span>
</span><span id="line-317"></span><span id="local-6989586621679050473"><span class="annot"><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-type">identity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050473"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050473"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-318"></span><span id="identity"><span class="annot"><span class="annottext">identity :: Int -&gt; Matrix a
</span><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span></span><span> </span><span id="local-6989586621679050049"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050049"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050049"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679050048"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050048"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050047"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050047"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050047"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- | Similar to 'diagonalList', but using 'V.Vector', which</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   should be more efficient.</span><span>
</span><span id="line-322"></span><span id="local-6989586621679050046"><span class="annot"><a href="Data.Matrix.html#diagonal"><span class="hs-identifier hs-type">diagonal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050046"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Default element</span><span>
</span><span id="line-323"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050046"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ Diagonal vector</span><span>
</span><span id="line-324"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050046"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-325"></span><span id="diagonal"><span class="annot"><span class="annottext">diagonal :: a -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#diagonal"><span class="hs-identifier hs-var hs-var">diagonal</span></a></span></span><span> </span><span id="local-6989586621679050045"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050045"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679050044"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050044"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050043"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050043"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679050042"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050042"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050041"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050041"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050042"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050041"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050044"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050042"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050045"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621679050043"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679050043"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050044"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Create a matrix from a non-empty list given the desired size.</span><span>
</span><span id="line-330"></span><span class="hs-comment">--   The list must have at least /rows*cols/ elements.</span><span>
</span><span id="line-331"></span><span class="hs-comment">--   An example:</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">-- &gt;                       ( 1 2 3 )</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- &gt;                       ( 4 5 6 )</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- &gt; fromList 3 3 [1..] =  ( 7 8 9 )</span><span>
</span><span id="line-336"></span><span class="hs-comment">--</span><span>
</span><span id="line-337"></span><span id="local-6989586621679050611"><span class="annot"><a href="Data.Matrix.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Rows</span><span>
</span><span id="line-338"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Columns</span><span>
</span><span id="line-339"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of elements</span><span>
</span><span id="line-340"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050611"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-341"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#fromList"><span class="hs-pragma hs-type">fromList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-342"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: Int -&gt; Int -&gt; [a] -&gt; Matrix a
</span><a href="Data.Matrix.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span id="local-6989586621679050038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050038"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050037"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050037"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050038"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050037"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050037"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; ([a] -&gt; Vector a) -&gt; [a] -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; Vector a
forall a. Int -&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromListN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050038"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050037"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- | Get the elements of a matrix stored in a list.</span><span>
</span><span id="line-345"></span><span class="hs-comment">--</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- &gt;        ( 1 2 3 )</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- &gt;        ( 4 5 6 )</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- &gt; toList ( 7 8 9 ) = [1,2,3,4,5,6,7,8,9]</span><span>
</span><span id="line-349"></span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span id="local-6989586621679050035"><span class="annot"><a href="Data.Matrix.html#toList"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050035"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050035"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-351"></span><span id="toList"><span class="annot"><span class="annottext">toList :: Matrix a -&gt; [a]
</span><a href="Data.Matrix.html#toList"><span class="hs-identifier hs-var hs-var">toList</span></a></span></span><span> </span><span id="local-6989586621679050034"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050034"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050033"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050032"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050034"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679050033"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050033"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050034"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050032"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050032"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050034"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | Get the elements of a matrix stored in a list of lists,</span><span>
</span><span id="line-354"></span><span class="hs-comment">--   where each list contains the elements of a single row.</span><span>
</span><span id="line-355"></span><span class="hs-comment">--</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- &gt;         ( 1 2 3 )   [ [1,2,3]</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- &gt;         ( 4 5 6 )   , [4,5,6]</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- &gt; toLists ( 7 8 9 ) = , [7,8,9] ]</span><span>
</span><span id="line-359"></span><span class="hs-comment">--</span><span>
</span><span id="line-360"></span><span id="local-6989586621679050031"><span class="annot"><a href="Data.Matrix.html#toLists"><span class="hs-identifier hs-type">toLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050031"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050031"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-361"></span><span id="toLists"><span class="annot"><span class="annottext">toLists :: Matrix a -&gt; [[a]]
</span><a href="Data.Matrix.html#toLists"><span class="hs-identifier hs-var hs-var">toLists</span></a></span></span><span> </span><span id="local-6989586621679050030"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050030"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050029"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050028"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050030"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679050028"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050028"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050030"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679050029"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050029"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679050030"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Diagonal matrix from a non-empty list given the desired size.</span><span>
</span><span id="line-364"></span><span class="hs-comment">--   Non-diagonal elements will be filled with the given default element.</span><span>
</span><span id="line-365"></span><span class="hs-comment">--   The list must have at least /order/ elements.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- &gt; diagonalList n 0 [1..] =</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- &gt;                   n</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- &gt;   1 ( 1 0 ... 0   0 )</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- &gt;   2 ( 0 2 ... 0   0 )</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- &gt;     (     ...       )</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- &gt;     ( 0 0 ... n-1 0 )</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- &gt;   n ( 0 0 ... 0   n )</span><span>
</span><span id="line-374"></span><span class="hs-comment">--</span><span>
</span><span id="line-375"></span><span id="local-6989586621679050027"><span class="annot"><a href="Data.Matrix.html#diagonalList"><span class="hs-identifier hs-type">diagonalList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050027"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050027"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050027"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-376"></span><span id="diagonalList"><span class="annot"><span class="annottext">diagonalList :: Int -&gt; a -&gt; [a] -&gt; Matrix a
</span><a href="Data.Matrix.html#diagonalList"><span class="hs-identifier hs-var hs-var">diagonalList</span></a></span></span><span> </span><span id="local-6989586621679050026"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050026"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050025"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050025"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679050024"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050024"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050026"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050026"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679050023"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050023"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679050022"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050022"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050023"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050022"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050024"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050023"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050025"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Create a matrix from a non-empty list of non-empty lists.</span><span>
</span><span id="line-379"></span><span class="hs-comment">--   /Each list must have at least as many elements as the first list/.</span><span>
</span><span id="line-380"></span><span class="hs-comment">--   Examples:</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- &gt; fromLists [ [1,2,3]      ( 1 2 3 )</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- &gt;           , [4,5,6]      ( 4 5 6 )</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- &gt;           , [7,8,9] ] =  ( 7 8 9 )</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- &gt; fromLists [ [1,2,3  ]     ( 1 2 3 )</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- &gt;           , [4,5,6,7]     ( 4 5 6 )</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- &gt;           , [8,9,0  ] ] = ( 8 9 0 )</span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span id="local-6989586621679050020"><span class="annot"><a href="Data.Matrix.html#fromLists"><span class="hs-identifier hs-type">fromLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050020"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050020"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-391"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#fromLists"><span class="hs-pragma hs-type">fromLists</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-392"></span><span id="fromLists"><span class="annot"><span class="annottext">fromLists :: [[a]] -&gt; Matrix a
</span><a href="Data.Matrix.html#fromLists"><span class="hs-identifier hs-var hs-var">fromLists</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromLists: empty list.&quot;</span></span><span>
</span><span id="line-393"></span><span class="annot"><a href="Data.Matrix.html#fromLists"><span class="hs-identifier hs-var">fromLists</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050018"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050018"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679050017"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679050017"><span class="hs-identifier hs-var">xss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [a] -&gt; Matrix a
forall a. Int -&gt; Int -&gt; [a] -&gt; Matrix a
</span><a href="Data.Matrix.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050016"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050015"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Matrix a) -&gt; [a] -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[a]] -&gt; [a]) -&gt; [[a]] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050018"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]] -&gt; [[a]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [[a]] -&gt; [[a]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050015"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679050017"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679050016"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679050016"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679050017"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span id="local-6989586621679050015"><span class="annot"><span class="annottext">m :: Int
</span><a href="#local-6989586621679050015"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050018"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | /O(1)/. Represent a vector as a one row matrix.</span><span>
</span><span id="line-399"></span><span id="local-6989586621679050013"><span class="annot"><a href="Data.Matrix.html#rowVector"><span class="hs-identifier hs-type">rowVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050013"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050013"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-400"></span><span id="rowVector"><span class="annot"><span class="annottext">rowVector :: Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#rowVector"><span class="hs-identifier hs-var hs-var">rowVector</span></a></span></span><span> </span><span id="local-6989586621679050012"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050012"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050011"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050011"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050012"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679050011"><span class="annot"><span class="annottext">m :: Int
</span><a href="#local-6989586621679050011"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050012"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | /O(1)/. Represent a vector as a one column matrix.</span><span>
</span><span id="line-405"></span><span id="local-6989586621679050010"><span class="annot"><a href="Data.Matrix.html#colVector"><span class="hs-identifier hs-type">colVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050010"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050010"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-406"></span><span id="colVector"><span class="annot"><span class="annottext">colVector :: Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#colVector"><span class="hs-identifier hs-var hs-var">colVector</span></a></span></span><span> </span><span id="local-6989586621679050009"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050009"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050009"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679050009"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- | /O(rows*cols)/. Permutation matrix.</span><span>
</span><span id="line-409"></span><span class="hs-comment">--</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- &gt; permMatrix n i j =</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- &gt;               i     j       n</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- &gt;   1 ( 1 0 ... 0 ... 0 ... 0 0 )</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- &gt;   2 ( 0 1 ... 0 ... 0 ... 0 0 )</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- &gt;     (     ...   ...   ...     )</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- &gt;   i ( 0 0 ... 0 ... 1 ... 0 0 )</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- &gt;     (     ...   ...   ...     )</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- &gt;   j ( 0 0 ... 1 ... 0 ... 0 0 )</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- &gt;     (     ...   ...   ...     )</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- &gt;     ( 0 0 ... 0 ... 0 ... 1 0 )</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- &gt;   n ( 0 0 ... 0 ... 0 ... 0 1 )</span><span>
</span><span id="line-421"></span><span class="hs-comment">--</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- When @i == j@ it reduces to 'identity' @n@.</span><span>
</span><span id="line-423"></span><span class="hs-comment">--</span><span>
</span><span id="line-424"></span><span id="local-6989586621679050008"><span class="annot"><a href="Data.Matrix.html#permMatrix"><span class="hs-identifier hs-type">permMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050008"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-425"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Size of the matrix.</span><span>
</span><span id="line-426"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Permuted row 1.</span><span>
</span><span id="line-427"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Permuted row 2.</span><span>
</span><span id="line-428"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Permutation matrix.</span></span><span>
</span><span id="line-429"></span><span id="permMatrix"><span class="annot"><span class="annottext">permMatrix :: Int -&gt; Int -&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#permMatrix"><span class="hs-identifier hs-var hs-var">permMatrix</span></a></span></span><span> </span><span id="local-6989586621679050007"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050007"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050006"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050006"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679050005"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050005"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050006"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050005"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050007"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-430"></span><span class="annot"><a href="Data.Matrix.html#permMatrix"><span class="hs-identifier hs-var">permMatrix</span></a></span><span> </span><span id="local-6989586621679050004"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050004"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679050003"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050003"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679050002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050002"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050004"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050004"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; a
forall p. Num p =&gt; (Int, Int) -&gt; p
</span><a href="#local-6989586621679050001"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-431"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>  </span><span id="local-6989586621679050001"><span class="annot"><span class="annottext">f :: (Int, Int) -&gt; p
</span><a href="#local-6989586621679050001"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050000"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050000"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049999"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049999"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050000"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050003"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049999"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050002"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span>
</span><span id="line-434"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050000"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050002"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049999"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050003"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span>
</span><span id="line-435"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679050000"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049999"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span>
</span><span id="line-436"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-439"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-440"></span><span class="hs-comment">---- ACCESSING</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">-- | /O(1)/. Get an element of a matrix. Indices range from /(1,1)/ to /(n,m)/.</span><span>
</span><span id="line-443"></span><span class="hs-comment">--   It returns an 'error' if the requested element is outside of range.</span><span>
</span><span id="line-444"></span><span id="local-6989586621679049998"><span class="annot"><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-type">getElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Row</span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Column</span><span>
</span><span id="line-446"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049998"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix</span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049998"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-448"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#getElem"><span class="hs-pragma hs-type">getElem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-449"></span><span id="getElem"><span class="annot"><span class="annottext">getElem :: Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var hs-var">getElem</span></a></span></span><span> </span><span id="local-6989586621679049997"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049997"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679049996"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049996"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679049995"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049995"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-452"></span><span>       </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;getElem: Trying to get the &quot;</span></span><span>
</span><span id="line-453"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049997"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049996"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; element from a &quot;</span></span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049995"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049995"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; matrix.&quot;</span></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
</span><a href="Data.Matrix.html#safeGet"><span class="hs-identifier hs-var">safeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049997"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049996"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049995"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | /O(1)/. Unsafe variant of 'getElem', without bounds checking.</span><span>
</span><span id="line-461"></span><span id="local-6989586621679050627"><span class="annot"><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-type">unsafeGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Row</span><span>
</span><span id="line-462"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Column</span><span>
</span><span id="line-463"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050627"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix</span><span>
</span><span id="line-464"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050627"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-465"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#unsafeGet"><span class="hs-pragma hs-type">unsafeGet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-466"></span><span id="unsafeGet"><span class="annot"><span class="annottext">unsafeGet :: Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var hs-var">unsafeGet</span></a></span></span><span> </span><span id="local-6989586621679049994"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049994"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679049993"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049993"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679049992"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049992"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049991"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049991"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049990"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049990"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049989"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049989"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049989"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; Int -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049990"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049994"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049992"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049993"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049991"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">-- | Short alias for 'getElem'.</span><span>
</span><span id="line-469"></span><span id="local-6989586621679050650"><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050650"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-470"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">!</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-471"></span><span id="local-6989586621679049988"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049988"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="%21"><span class="annot"><span class="annottext">! :: Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var hs-var">!</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049987"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049986"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049986"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var">getElem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049986"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049988"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Internal alias for 'unsafeGet'.</span><span>
</span><span id="line-474"></span><span id="local-6989586621679049985"><span class="annot"><a href="Data.Matrix.html#%21."><span class="hs-operator hs-type">(!.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049985"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049985"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-475"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">!.</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-476"></span><span id="local-6989586621679049983"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049983"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="%21."><span class="annot"><span class="annottext">!. :: Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var hs-var">!.</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049982"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049981"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049981"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049982"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049981"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049983"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- | Variant of 'getElem' that returns Maybe instead of an error.</span><span>
</span><span id="line-479"></span><span id="local-6989586621679050605"><span class="annot"><a href="Data.Matrix.html#safeGet"><span class="hs-identifier hs-type">safeGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679050605"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-480"></span><span id="safeGet"><span class="annot"><span class="annottext">safeGet :: Int -&gt; Int -&gt; Matrix a -&gt; Maybe a
</span><a href="Data.Matrix.html#safeGet"><span class="hs-identifier hs-var hs-var">safeGet</span></a></span></span><span> </span><span id="local-6989586621679049980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049980"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679049979"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049979"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679049978"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049978"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049977"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049977"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049976"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049976"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049980"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049977"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049979"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049976"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049980"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049979"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-482"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; a -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049980"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049979"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049978"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="hs-comment">-- | Variant of 'setElem' that returns Maybe instead of an error.</span><span>
</span><span id="line-485"></span><span id="local-6989586621679049972"><span class="annot"><a href="Data.Matrix.html#safeSet"><span class="hs-identifier hs-type">safeSet</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679049972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-486"></span><span id="safeSet"><span class="annot"><span class="annottext">safeSet :: a -&gt; (Int, Int) -&gt; Matrix a -&gt; Maybe (Matrix a)
</span><a href="Data.Matrix.html#safeSet"><span class="hs-identifier hs-var hs-var">safeSet</span></a></span></span><span> </span><span id="local-6989586621679049971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049971"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679049970"><span class="annot"><span class="annottext">p :: (Int, Int)
</span><a href="#local-6989586621679049970"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679049969"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049969"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049968"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049968"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049967"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049967"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049966"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049966"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049965"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049965"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049969"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049966"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049968"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049965"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049969"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049968"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Matrix a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Maybe (Matrix a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Maybe (Matrix a)) -&gt; Matrix a -&gt; Maybe (Matrix a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#unsafeSet"><span class="hs-identifier hs-var">unsafeSet</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049971"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049970"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049967"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | /O(1)/. Get a row of a matrix as a vector.</span><span>
</span><span id="line-491"></span><span id="local-6989586621679050574"><span class="annot"><a href="Data.Matrix.html#getRow"><span class="hs-identifier hs-type">getRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050574"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050574"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-492"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#getRow"><span class="hs-pragma hs-type">getRow</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-493"></span><span id="getRow"><span class="annot"><span class="annottext">getRow :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getRow"><span class="hs-identifier hs-var hs-var">getRow</span></a></span></span><span> </span><span id="local-6989586621679049964"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049964"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679049963"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049963"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049962"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049962"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049961"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049961"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049960"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049960"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049959"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049959"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector a -&gt; Vector a
forall a. Int -&gt; Int -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.slice</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049960"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049964"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049962"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049961"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049963"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049959"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | Varian of 'getRow' that returns a maybe instead of an error</span><span>
</span><span id="line-496"></span><span id="local-6989586621679049957"><span class="annot"><a href="Data.Matrix.html#safeGetRow"><span class="hs-identifier hs-type">safeGetRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049957"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679049957"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-497"></span><span id="safeGetRow"><span class="annot"><span class="annottext">safeGetRow :: Int -&gt; Matrix a -&gt; Maybe (Vector a)
</span><a href="Data.Matrix.html#safeGetRow"><span class="hs-identifier hs-var hs-var">safeGetRow</span></a></span></span><span> </span><span id="local-6989586621679049956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049956"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679049955"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049955"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049956"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049955"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049956"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Vector a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Maybe (Vector a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Maybe (Vector a)) -&gt; Vector a -&gt; Maybe (Vector a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getRow"><span class="hs-identifier hs-var">getRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049956"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049955"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="hs-comment">-- | /O(rows)/. Get a column of a matrix as a vector.</span><span>
</span><span id="line-502"></span><span id="local-6989586621679049954"><span class="annot"><a href="Data.Matrix.html#getCol"><span class="hs-identifier hs-type">getCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679049954"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-503"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#getCol"><span class="hs-pragma hs-type">getCol</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-504"></span><span id="getCol"><span class="annot"><span class="annottext">getCol :: Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getCol"><span class="hs-identifier hs-var hs-var">getCol</span></a></span></span><span> </span><span id="local-6989586621679049953"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049953"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049952"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049952"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679049951"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049951"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049950"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049950"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049949"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049949"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049948"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049948"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; a) -&gt; Vector a
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049952"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; a) -&gt; Vector a) -&gt; (Int -&gt; a) -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049946"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049946"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049948"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049949"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049946"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049951"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049953"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049950"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-comment">-- | Varian of 'getColumn' that returns a maybe instead of an error</span><span>
</span><span id="line-507"></span><span id="local-6989586621679049944"><span class="annot"><a href="Data.Matrix.html#safeGetCol"><span class="hs-identifier hs-type">safeGetCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049944"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679049944"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-508"></span><span id="safeGetCol"><span class="annot"><span class="annottext">safeGetCol :: Int -&gt; Matrix a -&gt; Maybe (Vector a)
</span><a href="Data.Matrix.html#safeGetCol"><span class="hs-identifier hs-var hs-var">safeGetCol</span></a></span></span><span> </span><span id="local-6989586621679049943"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049943"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679049942"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049942"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049943"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049942"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049943"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Vector a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Maybe (Vector a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Maybe (Vector a)) -&gt; Vector a -&gt; Maybe (Vector a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getCol"><span class="hs-identifier hs-var">getCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049943"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049942"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | /O(min rows cols)/. Diagonal of a /not necessarily square/ matrix.</span><span>
</span><span id="line-513"></span><span id="local-6989586621679049941"><span class="annot"><a href="Data.Matrix.html#getDiag"><span class="hs-identifier hs-type">getDiag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049941"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679049941"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-514"></span><span id="getDiag"><span class="annot"><span class="annottext">getDiag :: Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getDiag"><span class="hs-identifier hs-var hs-var">getDiag</span></a></span></span><span> </span><span id="local-6989586621679049940"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049940"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; a) -&gt; Vector a
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049939"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; a) -&gt; Vector a) -&gt; (Int -&gt; a) -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049938"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049938"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049940"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049938"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049938"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-516"></span><span>  </span><span id="local-6989586621679049939"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679049939"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049940"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049940"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">-- | /O(rows*cols)/. Transform a 'Matrix' to a 'V.Vector' of size /rows*cols/.</span><span>
</span><span id="line-519"></span><span class="hs-comment">--  This is equivalent to get all the rows of the matrix using 'getRow'</span><span>
</span><span id="line-520"></span><span class="hs-comment">--  and then append them, but far more efficient.</span><span>
</span><span id="line-521"></span><span id="local-6989586621679049936"><span class="annot"><a href="Data.Matrix.html#getMatrixAsVector"><span class="hs-identifier hs-type">getMatrixAsVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679049936"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-522"></span><span id="getMatrixAsVector"><span class="annot"><span class="annottext">getMatrixAsVector :: Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getMatrixAsVector"><span class="hs-identifier hs-var hs-var">getMatrixAsVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var hs-var">mvect</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Vector a)
-&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#forceMatrix"><span class="hs-identifier hs-var">forceMatrix</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-525"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-526"></span><span class="hs-comment">---- MANIPULATING MATRICES</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span id="local-6989586621679050447"><span id="local-6989586621679050448"><span class="annot"><a href="Data.Matrix.html#msetElem"><span class="hs-identifier hs-type">msetElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-529"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ New element</span><span>
</span><span id="line-530"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of columns of the matrix</span><span>
</span><span id="line-531"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Row offset</span><span>
</span><span id="line-532"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Column offset</span><span>
</span><span id="line-533"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Position to set the new element</span><span>
</span><span id="line-534"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MV.MVector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimState</span></span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679050447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Mutable vector</span><span>
</span><span id="line-535"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050448"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-536"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#msetElem"><span class="hs-pragma hs-type">msetElem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-537"></span><span id="msetElem"><span class="annot"><span class="annottext">msetElem :: a
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (Int, Int)
-&gt; MVector (PrimState m) a
-&gt; m ()
</span><a href="Data.Matrix.html#msetElem"><span class="hs-identifier hs-var hs-var">msetElem</span></a></span></span><span> </span><span id="local-6989586621679049934"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049934"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679049933"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049933"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049932"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049931"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049931"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049930"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049930"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049929"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049929"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049928"><span class="annot"><span class="annottext">MVector (PrimState m) a
</span><a href="#local-6989586621679049928"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState m) a
</span><a href="#local-6989586621679049928"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049933"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049930"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049932"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049929"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049931"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049934"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span id="local-6989586621679049925"><span id="local-6989586621679049926"><span class="annot"><a href="Data.Matrix.html#unsafeMset"><span class="hs-identifier hs-type">unsafeMset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679049926"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-540"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ New element</span><span>
</span><span id="line-541"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of columns of the matrix</span><span>
</span><span id="line-542"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Row offset</span><span>
</span><span id="line-543"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Column offset</span><span>
</span><span id="line-544"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Position to set the new element</span><span>
</span><span id="line-545"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MV.MVector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimState</span></span><span> </span><span class="annot"><a href="#local-6989586621679049926"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679049925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Mutable vector</span><span>
</span><span id="line-546"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049926"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-547"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#unsafeMset"><span class="hs-pragma hs-type">unsafeMset</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-548"></span><span id="unsafeMset"><span class="annot"><span class="annottext">unsafeMset :: a
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (Int, Int)
-&gt; MVector (PrimState m) a
-&gt; m ()
</span><a href="Data.Matrix.html#unsafeMset"><span class="hs-identifier hs-var hs-var">unsafeMset</span></a></span></span><span> </span><span id="local-6989586621679049923"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049923"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679049922"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049922"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049921"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049921"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049920"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049920"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049919"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049919"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049918"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049918"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049917"><span class="annot"><span class="annottext">MVector (PrimState m) a
</span><a href="#local-6989586621679049917"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.unsafeWrite</span></span><span> </span><span class="annot"><span class="annottext">MVector (PrimState m) a
</span><a href="#local-6989586621679049917"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049922"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049919"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049921"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049918"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049920"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049923"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span class="hs-comment">-- | Replace the value of a cell in a matrix.</span><span>
</span><span id="line-551"></span><span id="local-6989586621679049916"><span class="annot"><a href="Data.Matrix.html#setElem"><span class="hs-identifier hs-type">setElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679049916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ New value.</span><span>
</span><span id="line-552"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Position to replace.</span><span>
</span><span id="line-553"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Original matrix.</span><span>
</span><span id="line-554"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix with the given position replaced with the given value.</span></span><span>
</span><span id="line-555"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#setElem"><span class="hs-pragma hs-type">setElem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-556"></span><span id="setElem"><span class="annot"><span class="annottext">setElem :: a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setElem"><span class="hs-identifier hs-var hs-var">setElem</span></a></span></span><span> </span><span id="local-6989586621679049915"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049915"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679049914"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049914"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049913"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049913"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049912"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049912"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049911"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049911"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049910"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049910"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049909"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049909"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049908"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049908"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049913"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049912"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049911"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049910"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049909"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
forall a.
(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (Int, Int)
-&gt; MVector (PrimState (ST s)) a
-&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
a
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (Int, Int)
-&gt; MVector (PrimState m) a
-&gt; m ()
</span><a href="Data.Matrix.html#msetElem"><span class="hs-identifier hs-var">msetElem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049915"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049909"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049911"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049910"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049914"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049908"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="hs-comment">-- | Unsafe variant of 'setElem', without bounds checking.</span><span>
</span><span id="line-559"></span><span id="local-6989586621679050465"><span class="annot"><a href="Data.Matrix.html#unsafeSet"><span class="hs-identifier hs-type">unsafeSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ New value.</span><span>
</span><span id="line-560"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Position to replace.</span><span>
</span><span id="line-561"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Original matrix.</span><span>
</span><span id="line-562"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix with the given position replaced with the given value.</span></span><span>
</span><span id="line-563"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#unsafeSet"><span class="hs-pragma hs-type">unsafeSet</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-564"></span><span id="unsafeSet"><span class="annot"><span class="annottext">unsafeSet :: a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#unsafeSet"><span class="hs-identifier hs-var hs-var">unsafeSet</span></a></span></span><span> </span><span id="local-6989586621679049906"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049906"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679049905"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049905"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049904"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049904"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049903"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049903"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049902"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049902"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049901"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049901"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049900"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049900"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049899"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049899"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049904"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049903"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049902"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049901"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049900"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
forall a.
(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (Int, Int)
-&gt; MVector (PrimState (ST s)) a
-&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
a
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; (Int, Int)
-&gt; MVector (PrimState m) a
-&gt; m ()
</span><a href="Data.Matrix.html#unsafeMset"><span class="hs-identifier hs-var">unsafeMset</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049906"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049900"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049902"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049901"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049905"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049899"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">-- | /O(rows*cols)/. The transpose of a matrix.</span><span>
</span><span id="line-567"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-568"></span><span class="hs-comment">--</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- &gt;           ( 1 2 3 )   ( 1 4 7 )</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- &gt;           ( 4 5 6 )   ( 2 5 8 )</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- &gt; transpose ( 7 8 9 ) = ( 3 6 9 )</span><span>
</span><span id="line-572"></span><span id="local-6989586621679049898"><span class="annot"><a href="Data.Matrix.html#transpose"><span class="hs-identifier hs-type">transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049898"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049898"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-573"></span><span id="transpose"><span class="annot"><span class="annottext">transpose :: Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#transpose"><span class="hs-identifier hs-var hs-var">transpose</span></a></span></span><span> </span><span id="local-6989586621679049897"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049897"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049897"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049897"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049896"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049896"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049895"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049895"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049897"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049895"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049896"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-comment">-- | /O(rows*rows*rows*rows) = O(cols*cols*cols*cols)/. The inverse of a square matrix.</span><span>
</span><span id="line-576"></span><span class="hs-comment">--   Uses naive Gaussian elimination formula.</span><span>
</span><span id="line-577"></span><span id="local-6989586621679049894"><span class="annot"><a href="Data.Matrix.html#inverse"><span class="hs-identifier hs-type">inverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679049894"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679049894"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049894"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-578"></span><span id="inverse"><span class="annot"><span class="annottext">inverse :: Matrix a -&gt; Either String (Matrix a)
</span><a href="Data.Matrix.html#inverse"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span id="local-6989586621679049893"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-580"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Matrix a)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-581"></span><span>            </span><span class="annot"><span class="annottext">(String -&gt; Either String (Matrix a))
-&gt; String -&gt; Either String (Matrix a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Inverting non-square matrix with dimensions &quot;</span></span><span>
</span><span id="line-582"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-584"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-585"></span><span>            </span><span id="local-6989586621679049891"><span class="annot"><span class="annottext">adjoinedWId :: Matrix a
</span><a href="#local-6989586621679049891"><span class="hs-identifier hs-var hs-var">adjoinedWId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>            </span><span id="local-6989586621679049890"><span class="annot"><span class="annottext">rref'd :: Either String (Matrix a)
</span><a href="#local-6989586621679049890"><span class="hs-identifier hs-var hs-var">rref'd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall a.
(Fractional a, Eq a) =&gt;
Matrix a -&gt; Either String (Matrix a)
</span><a href="Data.Matrix.html#rref"><span class="hs-identifier hs-var">rref</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049891"><span class="hs-identifier hs-var">adjoinedWId</span></a></span><span>
</span><span id="line-587"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
</span><a href="#local-6989586621679049890"><span class="hs-identifier hs-var">rref'd</span></a></span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
-&gt; (Matrix a -&gt; Either String (Matrix a))
-&gt; Either String (Matrix a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Either String (Matrix a))
-&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Either String (Matrix a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049893"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-- | /O(rows*rows*cols*cols)/. Converts a matrix to reduced row echelon form, thus</span><span>
</span><span id="line-590"></span><span class="hs-comment">--  solving a linear system of equations. This requires that (cols &gt; rows)</span><span>
</span><span id="line-591"></span><span class="hs-comment">--  if cols &lt; rows, then there are fewer variables than equations and the</span><span>
</span><span id="line-592"></span><span class="hs-comment">--  problem cannot be solved consistently. If rows = cols, then it is</span><span>
</span><span id="line-593"></span><span class="hs-comment">--  basically a homogenous system of equations, so it will be reduced to</span><span>
</span><span id="line-594"></span><span class="hs-comment">--  identity or an error depending on whether the marix is invertible</span><span>
</span><span id="line-595"></span><span class="hs-comment">--  (this case is allowed for robustness).</span><span>
</span><span id="line-596"></span><span id="local-6989586621679050440"><span class="annot"><a href="Data.Matrix.html#rref"><span class="hs-identifier hs-type">rref</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679050440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679050440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-597"></span><span id="rref"><span class="annot"><span class="annottext">rref :: Matrix a -&gt; Either String (Matrix a)
</span><a href="Data.Matrix.html#rref"><span class="hs-identifier hs-var hs-var">rref</span></a></span></span><span> </span><span id="local-6989586621679049889"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049889"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-598"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049889"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049889"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-599"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String (Matrix a)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Either String (Matrix a))
-&gt; String -&gt; Either String (Matrix a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-600"></span><span>                </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid dimensions &quot;</span></span><span>
</span><span id="line-601"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049889"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049889"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; the number of columns must be greater than or equal to the number of rows&quot;</span></span><span>
</span><span id="line-603"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall a a. Num a =&gt; Matrix a -&gt; Either a (Matrix a)
</span><a href="#local-6989586621679049888"><span class="hs-identifier hs-var">rrefRefd</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Either String (Matrix a))
-&gt; Either String (Matrix a) -&gt; Either String (Matrix a)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall a.
(Fractional a, Eq a) =&gt;
Matrix a -&gt; Either String (Matrix a)
</span><a href="Data.Matrix.html#ref"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049889"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679049888"><span class="annot"><span class="annottext">rrefRefd :: Matrix a -&gt; Either a (Matrix a)
</span><a href="#local-6989586621679049888"><span class="hs-identifier hs-var hs-var">rrefRefd</span></a></span></span><span> </span><span id="local-6989586621679049885"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049885"><span class="hs-identifier hs-var">mtx</span></a></span></span><span>
</span><span id="line-606"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049885"><span class="hs-identifier hs-var">mtx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either a (Matrix a)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049885"><span class="hs-identifier hs-var">mtx</span></a></span><span>
</span><span id="line-607"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-608"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-609"></span><span>                </span><span class="hs-comment">-- this is super-slow: [resolvedRight] is cubic because [combineRows] is quadratic</span><span>
</span><span id="line-610"></span><span>                </span><span id="local-6989586621679049884"><span class="annot"><span class="annottext">resolvedRight :: Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var hs-var">resolvedRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Matrix a -&gt; Matrix a)
 -&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a)
-&gt; (Matrix a -&gt; Matrix a)
-&gt; [Matrix a -&gt; Matrix a]
-&gt; Matrix a
-&gt; Matrix a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a)
-&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Matrix a -&gt; Matrix a) -&gt; [Int] -&gt; [Matrix a -&gt; Matrix a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679049881"><span class="hs-identifier hs-var">resolveRow</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049880"><span class="hs-identifier hs-var">col</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049885"><span class="hs-identifier hs-var">mtx</span></a></span><span>
</span><span id="line-611"></span><span>                    </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>                    </span><span id="local-6989586621679049880"><span class="annot"><span class="annottext">col :: Int
</span><a href="#local-6989586621679049880"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049885"><span class="hs-identifier hs-var">mtx</span></a></span><span>
</span><span id="line-613"></span><span>                    </span><span id="local-6989586621679049881"><span class="annot"><span class="annottext">resolveRow :: Int -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679049881"><span class="hs-identifier hs-var hs-var">resolveRow</span></a></span></span><span> </span><span id="local-6989586621679049879"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049879"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049879"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var">getElem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049879"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049880"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049885"><span class="hs-identifier hs-var">mtx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049880"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-614"></span><span>                </span><span id="local-6989586621679049878"><span class="annot"><span class="annottext">top :: Matrix a
</span><a href="#local-6989586621679049878"><span class="hs-identifier hs-var hs-var">top</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span>
</span><span id="line-615"></span><span>                </span><span id="local-6989586621679049877"><span class="annot"><span class="annottext">top' :: Either a (Matrix a)
</span><a href="#local-6989586621679049877"><span class="hs-identifier hs-var hs-var">top'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either a (Matrix a)
</span><a href="#local-6989586621679049888"><span class="hs-identifier hs-var">rrefRefd</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049878"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-616"></span><span>                </span><span id="local-6989586621679049876"><span class="annot"><span class="annottext">bot :: Matrix a
</span><a href="#local-6989586621679049876"><span class="hs-identifier hs-var hs-var">bot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049884"><span class="hs-identifier hs-var">resolvedRight</span></a></span><span>
</span><span id="line-617"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either a (Matrix a)
</span><a href="#local-6989586621679049877"><span class="hs-identifier hs-var">top'</span></a></span><span> </span><span class="annot"><span class="annottext">Either a (Matrix a)
-&gt; (Matrix a -&gt; Either a (Matrix a)) -&gt; Either a (Matrix a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either a (Matrix a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Either a (Matrix a))
-&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Either a (Matrix a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049876"><span class="hs-identifier hs-var">bot</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span id="local-6989586621679049875"><span class="annot"><a href="Data.Matrix.html#ref"><span class="hs-identifier hs-type">ref</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679049875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679049875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-621"></span><span id="ref"><span class="annot"><span class="annottext">ref :: Matrix a -&gt; Either String (Matrix a)
</span><a href="Data.Matrix.html#ref"><span class="hs-identifier hs-var hs-var">ref</span></a></span></span><span> </span><span id="local-6989586621679049874"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049874"><span class="hs-identifier hs-var">mtx</span></a></span></span><span>
</span><span id="line-622"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049874"><span class="hs-identifier hs-var">mtx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-623"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
</span><a href="#local-6989586621679049873"><span class="hs-identifier hs-var">clearedLeft</span></a></span><span>
</span><span id="line-624"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-625"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679049872"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049872"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049871"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049871"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049870"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049870"><span class="hs-identifier hs-var">bl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049869"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049869"><span class="hs-identifier hs-var">br</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
forall a.
Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var">splitBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a))
-&gt; Either String (Matrix a)
-&gt; Either String (Matrix a, Matrix a, Matrix a, Matrix a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
</span><a href="#local-6989586621679049873"><span class="hs-identifier hs-var">clearedLeft</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>                </span><span id="local-6989586621679049868"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049868"><span class="hs-identifier hs-var">br'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall a.
(Fractional a, Eq a) =&gt;
Matrix a -&gt; Either String (Matrix a)
</span><a href="Data.Matrix.html#ref"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049869"><span class="hs-identifier hs-var">br</span></a></span><span>
</span><span id="line-627"></span><span>                </span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049872"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049871"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C-%3E"><span class="hs-operator hs-var">&lt;-&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049870"><span class="hs-identifier hs-var">bl</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049868"><span class="hs-identifier hs-var">br'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679049867"><span class="annot"><span class="annottext">sigAtTop :: Either String (Matrix a)
</span><a href="#local-6989586621679049867"><span class="hs-identifier hs-var hs-var">sigAtTop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049866"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049866"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049866"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049874"><span class="hs-identifier hs-var">mtx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a) -&gt; Either String Int -&gt; Either String (Matrix a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String Int
</span><a href="#local-6989586621679049865"><span class="hs-identifier hs-var">goodRow</span></a></span><span>
</span><span id="line-630"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-631"></span><span>        </span><span id="local-6989586621679049864"><span class="annot"><span class="annottext">significantRow :: Int -&gt; Bool
</span><a href="#local-6989586621679049864"><span class="hs-identifier hs-var hs-var">significantRow</span></a></span></span><span> </span><span id="local-6989586621679049863"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049863"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var">getElem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049863"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049874"><span class="hs-identifier hs-var">mtx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-632"></span><span>        </span><span id="local-6989586621679049865"><span class="annot"><span class="annottext">goodRow :: Either String Int
</span><a href="#local-6989586621679049865"><span class="hs-identifier hs-var hs-var">goodRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Maybe Int
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Int]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679049864"><span class="hs-identifier hs-var">significantRow</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049874"><span class="hs-identifier hs-var">mtx</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-633"></span><span>            </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Int
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Attempt to invert a non-invertible matrix&quot;</span></span><span>
</span><span id="line-634"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679049861"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049861"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either String Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049861"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span id="local-6989586621679049860"><span class="annot"><span class="annottext">normalizedFirstRow :: Either String (Matrix a)
</span><a href="#local-6989586621679049860"><span class="hs-identifier hs-var hs-var">normalizedFirstRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049859"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049859"><span class="hs-identifier hs-var">sigAtTop'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#scaleRow"><span class="hs-identifier hs-var">scaleRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var">getElem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049859"><span class="hs-identifier hs-var">sigAtTop'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049859"><span class="hs-identifier hs-var">sigAtTop'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a)
-&gt; Either String (Matrix a) -&gt; Either String (Matrix a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
</span><a href="#local-6989586621679049867"><span class="hs-identifier hs-var">sigAtTop</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679049873"><span class="annot"><span class="annottext">clearedLeft :: Either String (Matrix a)
</span><a href="#local-6989586621679049873"><span class="hs-identifier hs-var hs-var">clearedLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-637"></span><span>            </span><span id="local-6989586621679049857"><span class="annot"><span class="annottext">[Matrix a -&gt; Matrix a]
</span><a href="#local-6989586621679049857"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Either String (Matrix a -&gt; Matrix a))
-&gt; [Int] -&gt; Either String [Matrix a -&gt; Matrix a]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Either String (Matrix a -&gt; Matrix a)
</span><a href="#local-6989586621679049855"><span class="hs-identifier hs-var">combinator</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049874"><span class="hs-identifier hs-var">mtx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-638"></span><span>            </span><span id="local-6989586621679049854"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049854"><span class="hs-identifier hs-var">firstRow</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
</span><a href="#local-6989586621679049860"><span class="hs-identifier hs-var">normalizedFirstRow</span></a></span><span>
</span><span id="line-639"></span><span>            </span><span class="annot"><span class="annottext">Matrix a -&gt; Either String (Matrix a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Either String (Matrix a))
-&gt; Matrix a -&gt; Either String (Matrix a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Matrix a -&gt; Matrix a)
 -&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a)
-&gt; (Matrix a -&gt; Matrix a)
-&gt; [Matrix a -&gt; Matrix a]
-&gt; Matrix a
-&gt; Matrix a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a)
-&gt; (Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[Matrix a -&gt; Matrix a]
</span><a href="#local-6989586621679049857"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049854"><span class="hs-identifier hs-var">firstRow</span></a></span><span>
</span><span id="line-640"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-641"></span><span>        </span><span id="local-6989586621679049855"><span class="annot"><span class="annottext">combinator :: Int -&gt; Either String (Matrix a -&gt; Matrix a)
</span><a href="#local-6989586621679049855"><span class="hs-identifier hs-var hs-var">combinator</span></a></span></span><span> </span><span id="local-6989586621679049853"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049853"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049852"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049852"><span class="hs-identifier hs-var">normalizedFirstRow'</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049853"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var">getElem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049853"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049852"><span class="hs-identifier hs-var">normalizedFirstRow'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a -&gt; Matrix a)
-&gt; Either String (Matrix a) -&gt; Either String (Matrix a -&gt; Matrix a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either String (Matrix a)
</span><a href="#local-6989586621679049860"><span class="hs-identifier hs-var">normalizedFirstRow</span></a></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span class="hs-comment">-- | Extend a matrix to a given size adding a default element.</span><span>
</span><span id="line-644"></span><span class="hs-comment">--   If the matrix already has the required size, nothing happens.</span><span>
</span><span id="line-645"></span><span class="hs-comment">--   The matrix is /never/ reduced in size.</span><span>
</span><span id="line-646"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-647"></span><span class="hs-comment">--</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- &gt;                            ( 1 2 3 0 0 )</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- &gt;                ( 1 2 3 )   ( 4 5 6 0 0 )</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- &gt;                ( 4 5 6 )   ( 7 8 9 0 0 )</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- &gt; extendTo 0 4 5 ( 7 8 9 ) = ( 0 0 0 0 0 )</span><span>
</span><span id="line-652"></span><span class="hs-comment">--</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- The definition of 'extendTo' is based on 'setSize':</span><span>
</span><span id="line-654"></span><span class="hs-comment">--</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- &gt; extendTo e n m a = setSize e (max n $ nrows a) (max m $ ncols a) a</span><span>
</span><span id="line-656"></span><span class="hs-comment">--</span><span>
</span><span id="line-657"></span><span id="local-6989586621679049851"><span class="annot"><a href="Data.Matrix.html#extendTo"><span class="hs-identifier hs-type">extendTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679049851"><span class="hs-identifier hs-type">a</span></a></span><span>   </span><span class="hs-comment">-- ^ Element to add when extending.</span><span>
</span><span id="line-658"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Minimal number of rows.</span><span>
</span><span id="line-659"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Minimal number of columns.</span><span>
</span><span id="line-660"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049851"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049851"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-661"></span><span id="extendTo"><span class="annot"><span class="annottext">extendTo :: a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#extendTo"><span class="hs-identifier hs-var hs-var">extendTo</span></a></span></span><span> </span><span id="local-6989586621679049850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049850"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679049849"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049849"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049848"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049848"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049847"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049847"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049850"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049849"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049847"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049848"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049847"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049847"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Set the size of a matrix to given parameters. Use a default element</span><span>
</span><span id="line-664"></span><span class="hs-comment">--   for undefined entries if the matrix has been extended.</span><span>
</span><span id="line-665"></span><span id="local-6989586621679050420"><span class="annot"><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-type">setSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679050420"><span class="hs-identifier hs-type">a</span></a></span><span>   </span><span class="hs-comment">-- ^ Default element.</span><span>
</span><span id="line-666"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of rows.</span><span>
</span><span id="line-667"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of columns.</span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050420"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050420"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-670"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#setSize"><span class="hs-pragma hs-type">setSize</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-671"></span><span id="setSize"><span class="annot"><span class="annottext">setSize :: a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var hs-var">setSize</span></a></span></span><span> </span><span id="local-6989586621679049846"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049846"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679049845"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049845"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049844"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049844"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049843"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049843"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049842"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049842"><span class="hs-identifier hs-var">n0</span></a></span></span><span> </span><span id="local-6989586621679049841"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049841"><span class="hs-identifier hs-var">m0</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049845"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049844"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049840"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049840"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049839"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049839"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-672"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049840"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049842"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049839"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049841"><span class="hs-identifier hs-var">m0</span></a></span><span>
</span><span id="line-673"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049840"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049839"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049843"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-674"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049846"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-677"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-678"></span><span class="hs-comment">---- WORKING WITH BLOCKS</span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="hs-comment">-- | /O(1)/. Extract a submatrix given row and column limits.</span><span>
</span><span id="line-681"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-682"></span><span class="hs-comment">--</span><span>
</span><span id="line-683"></span><span class="hs-comment">-- &gt;                   ( 1 2 3 )</span><span>
</span><span id="line-684"></span><span class="hs-comment">-- &gt;                   ( 4 5 6 )   ( 2 3 )</span><span>
</span><span id="line-685"></span><span class="hs-comment">-- &gt; submatrix 1 2 2 3 ( 7 8 9 ) = ( 5 6 )</span><span>
</span><span id="line-686"></span><span id="local-6989586621679050437"><span class="annot"><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-type">submatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-comment">-- ^ Starting row</span><span>
</span><span id="line-687"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Ending row</span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-comment">-- ^ Starting column</span><span>
</span><span id="line-689"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Ending column</span><span>
</span><span id="line-690"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050437"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-691"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050437"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-692"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#submatrix"><span class="hs-pragma hs-type">submatrix</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-693"></span><span id="submatrix"><span class="annot"><span class="annottext">submatrix :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var hs-var">submatrix</span></a></span></span><span> </span><span id="local-6989586621679049836"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679049835"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049835"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621679049834"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679049833"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049833"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049832"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049832"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049831"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049831"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049830"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049830"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049829"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049829"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049828"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049828"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049827"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049827"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049832"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;submatrix: starting row (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) is out of range. Matrix has &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049832"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; rows.&quot;</span></span><span>
</span><span id="line-695"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049831"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;submatrix: starting column (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) is out of range. Matrix has &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049831"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; columns.&quot;</span></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049835"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049835"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049832"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;submatrix: ending row (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049835"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) is out of range. Matrix has &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049832"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; rows, and starting row is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049833"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049833"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049831"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;submatrix: ending column (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049833"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;) is out of range. Matrix has &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049831"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; columns, and starting column is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049835"><span class="hs-identifier hs-var">r2</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049833"><span class="hs-identifier hs-var">c2</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049830"><span class="hs-identifier hs-var">ro</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049836"><span class="hs-identifier hs-var">r1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049829"><span class="hs-identifier hs-var">co</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049834"><span class="hs-identifier hs-var">c1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049828"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049827"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="hs-comment">-- | /O(rows*cols)/. Remove a row and a column from a matrix.</span><span>
</span><span id="line-701"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-702"></span><span class="hs-comment">--</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- &gt;                 ( 1 2 3 )</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- &gt;                 ( 4 5 6 )   ( 1 3 )</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- &gt; minorMatrix 2 2 ( 7 8 9 ) = ( 7 9 )</span><span>
</span><span id="line-706"></span><span id="local-6989586621679049826"><span class="annot"><a href="Data.Matrix.html#minorMatrix"><span class="hs-identifier hs-type">minorMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Row @r@ to remove.</span><span>
</span><span id="line-707"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Column @c@ to remove.</span><span>
</span><span id="line-708"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Original matrix.</span><span>
</span><span id="line-709"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049826"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix with row @r@ and column @c@ removed.</span></span><span>
</span><span id="line-710"></span><span id="minorMatrix"><span class="annot"><span class="annottext">minorMatrix :: Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#minorMatrix"><span class="hs-identifier hs-var hs-var">minorMatrix</span></a></span></span><span> </span><span id="local-6989586621679049825"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049825"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span id="local-6989586621679049824"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049824"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049823"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049823"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049822"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049822"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049821"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049821"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049820"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049819"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049819"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049818"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049818"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049817"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679049817"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049825"><span class="hs-identifier hs-var">r0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049821"><span class="hs-identifier hs-var">ro</span></a></span><span>
</span><span id="line-712"></span><span>      </span><span id="local-6989586621679049816"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679049816"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049824"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049820"><span class="hs-identifier hs-var">co</span></a></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049823"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049822"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049821"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049820"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049819"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; Bool) -&gt; Vector a -&gt; Vector a
forall a. (Int -&gt; a -&gt; Bool) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.ifilter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049814"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049814"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049813"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049813"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049812"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049812"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
</span><a href="Data.Matrix.html#decode"><span class="hs-identifier hs-var">decode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049819"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049814"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049813"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049817"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049812"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049816"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049818"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-comment">-- | /O(1)/. Make a block-partition of a matrix using a given element as reference.</span><span>
</span><span id="line-716"></span><span class="hs-comment">--   The element will stay in the bottom-right corner of the top-left corner matrix.</span><span>
</span><span id="line-717"></span><span class="hs-comment">--</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- &gt;                 (             )   (      |      )</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- &gt;                 (             )   ( ...  | ...  )</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- &gt;                 (    x        )   (    x |      )</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- &gt; splitBlocks i j (             ) = (-------------) , where x = a_{i,j}</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- &gt;                 (             )   (      |      )</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- &gt;                 (             )   ( ...  | ...  )</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- &gt;                 (             )   (      |      )</span><span>
</span><span id="line-725"></span><span class="hs-comment">--</span><span>
</span><span id="line-726"></span><span class="hs-comment">--   Note that some blocks can end up empty. We use the following notation for these blocks:</span><span>
</span><span id="line-727"></span><span class="hs-comment">--</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- &gt; ( TL | TR )</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- &gt; (---------)</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- &gt; ( BL | BR )</span><span>
</span><span id="line-731"></span><span class="hs-comment">--</span><span>
</span><span id="line-732"></span><span class="hs-comment">--   Where T = Top, B = Bottom, L = Left, R = Right.</span><span>
</span><span id="line-733"></span><span class="hs-comment">--</span><span>
</span><span id="line-734"></span><span id="local-6989586621679050427"><span class="annot"><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-type">splitBlocks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Row of the splitting element.</span><span>
</span><span id="line-735"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Column of the splitting element.</span><span>
</span><span id="line-736"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix to split.</span><span>
</span><span id="line-737"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-738"></span><span>               </span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050427"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ (TL,TR,BL,BR)</span></span><span>
</span><span id="line-739"></span><span class="hs-pragma">{-# INLINE</span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Matrix.html#splitBlocks"><span class="hs-pragma hs-type">splitBlocks</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-740"></span><span id="splitBlocks"><span class="annot"><span class="annottext">splitBlocks :: Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var hs-var">splitBlocks</span></a></span></span><span> </span><span id="local-6989586621679049811"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049811"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679049810"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049810"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679049809"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049809"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049808"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049808"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049807"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049807"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-741"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049811"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049810"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049809"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049811"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049810"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049807"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049809"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-742"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049811"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049808"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049810"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049809"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049811"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049808"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049810"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049807"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049809"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>
</span><span id="line-744"></span><span class="hs-comment">-- | Join blocks of the form detailed in 'splitBlocks'. Precisely:</span><span>
</span><span id="line-745"></span><span class="hs-comment">--</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- &gt; joinBlocks (tl,tr,bl,br) =</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- &gt;   (tl &lt;|&gt; tr)</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- &gt;       &lt;-&gt;</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- &gt;   (bl &lt;|&gt; br)</span><span>
</span><span id="line-750"></span><span id="local-6989586621679050389"><span class="annot"><a href="Data.Matrix.html#joinBlocks"><span class="hs-identifier hs-type">joinBlocks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050389"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050389"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-751"></span><span class="hs-pragma">{-# INLINE</span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.Matrix.html#joinBlocks"><span class="hs-pragma hs-type">joinBlocks</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-752"></span><span id="joinBlocks"><span class="annot"><span class="annottext">joinBlocks :: (Matrix a, Matrix a, Matrix a, Matrix a) -&gt; Matrix a
</span><a href="Data.Matrix.html#joinBlocks"><span class="hs-identifier hs-var hs-var">joinBlocks</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049806"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049806"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049805"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049805"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049804"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049804"><span class="hs-identifier hs-var">bl</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049803"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049803"><span class="hs-identifier hs-var">br</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049802"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679049802"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049806"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-754"></span><span>      </span><span id="local-6989586621679049801"><span class="annot"><span class="annottext">nb :: Int
</span><a href="#local-6989586621679049801"><span class="hs-identifier hs-var hs-var">nb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049804"><span class="hs-identifier hs-var">bl</span></a></span><span>
</span><span id="line-755"></span><span>      </span><span id="local-6989586621679049800"><span class="annot"><span class="annottext">n' :: Int
</span><a href="#local-6989586621679049800"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049802"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049801"><span class="hs-identifier hs-var">nb</span></a></span><span>
</span><span id="line-756"></span><span>      </span><span id="local-6989586621679049799"><span class="annot"><span class="annottext">m :: Int
</span><a href="#local-6989586621679049799"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049806"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-757"></span><span>      </span><span id="local-6989586621679049798"><span class="annot"><span class="annottext">mr :: Int
</span><a href="#local-6989586621679049798"><span class="hs-identifier hs-var hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049805"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-758"></span><span>      </span><span id="local-6989586621679049797"><span class="annot"><span class="annottext">m' :: Int
</span><a href="#local-6989586621679049797"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049799"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049798"><span class="hs-identifier hs-var">mr</span></a></span><span>
</span><span id="line-759"></span><span>      </span><span id="local-6989586621679049796"><span class="annot"><span class="annottext">en :: (Int, Int) -&gt; Int
</span><a href="#local-6989586621679049796"><span class="hs-identifier hs-var hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049797"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049800"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049797"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049797"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s a)) -&gt; Vector a
forall a. (forall s. ST s (MVector s a)) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.create</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (MVector s a)) -&gt; Vector a)
-&gt; (forall s. ST s (MVector s a)) -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-761"></span><span>        </span><span id="local-6989586621679049795"><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049795"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector (PrimState (ST s)) a)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.new</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049800"><span class="hs-identifier hs-var">n'</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049797"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049794"><span class="annot"><span class="annottext">wr :: Int -&gt; a -&gt; ST s ()
</span><a href="#local-6989586621679049794"><span class="hs-identifier hs-var hs-var">wr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049795"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-763"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049802"><span class="hs-identifier hs-var">n</span></a></span><span>  </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049793"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049793"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-764"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049799"><span class="hs-identifier hs-var">m</span></a></span><span>  </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049792"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049792"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ST s ()
</span><a href="#local-6989586621679049794"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049796"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049793"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049792"><span class="hs-identifier hs-var">j</span></a></span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049806"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049793"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049792"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049798"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049791"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049791"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ST s ()
</span><a href="#local-6989586621679049794"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049796"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049793"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049791"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049799"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049805"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049793"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049791"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049801"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049790"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049790"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-767"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049789"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621679049789"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049790"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049802"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-768"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049799"><span class="hs-identifier hs-var">m</span></a></span><span>  </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049788"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049788"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ST s ()
</span><a href="#local-6989586621679049794"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049796"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049789"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049788"><span class="hs-identifier hs-var">j</span></a></span><span>  </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049804"><span class="hs-identifier hs-var">bl</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049790"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049788"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049798"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049787"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049787"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; ST s ()
</span><a href="#local-6989586621679049794"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049796"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049789"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049787"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049799"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049803"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049790"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049787"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>        </span><span class="annot"><span class="annottext">MVector s a -&gt; ST s (MVector s a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049795"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-773"></span><span class="annot"><span class="hs-pragma">&quot;matrix/splitAndJoin&quot;</span></span><span>
</span><span id="line-774"></span><span>   </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679049786"><span class="annot"><a href="#local-6989586621679049786"><span class="hs-pragma hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679049785"><span class="annot"><a href="#local-6989586621679049785"><span class="hs-pragma hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679049784"><span class="annot"><a href="#local-6989586621679049784"><span class="hs-pragma hs-var">m</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Matrix.html#joinBlocks"><span class="hs-pragma hs-type">joinBlocks</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Matrix.html#splitBlocks"><span class="hs-pragma hs-type">splitBlocks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049786"><span class="hs-pragma hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049785"><span class="hs-pragma hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049784"><span class="hs-pragma hs-type">m</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679049784"><span class="hs-pragma hs-type">m</span></a></span><span>
</span><span id="line-775"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span class="hs-comment">-- | Horizontally join two matrices. Visually:</span><span>
</span><span id="line-778"></span><span class="hs-comment">--</span><span>
</span><span id="line-779"></span><span class="hs-comment">-- &gt; ( A ) &lt;|&gt; ( B ) = ( A | B )</span><span>
</span><span id="line-780"></span><span class="hs-comment">--</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- Where both matrices /A/ and /B/ have the same number of rows.</span><span>
</span><span id="line-782"></span><span class="hs-comment">-- /This condition is not checked/.</span><span>
</span><span id="line-783"></span><span id="local-6989586621679049783"><span class="annot"><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator hs-type">(&lt;|&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049783"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049783"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049783"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-784"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;|&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-785"></span><span id="local-6989586621679049782"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049782"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="%3C%7C%3E"><span class="annot"><span class="annottext">&lt;|&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C%7C%3E"><span class="hs-operator hs-var hs-var">&lt;|&gt;</span></a></span></span><span> </span><span id="local-6989586621679049781"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049781"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049780"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679049780"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049782"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049782"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049780"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049781"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049779"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049779"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049778"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049778"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-788"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049778"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049780"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049782"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049779"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049778"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049781"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049779"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049778"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049780"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>
</span><span id="line-790"></span><span class="hs-comment">-- | Vertically join two matrices. Visually:</span><span>
</span><span id="line-791"></span><span class="hs-comment">--</span><span>
</span><span id="line-792"></span><span class="hs-comment">-- &gt;                   ( A )</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- &gt; ( A ) &lt;-&gt; ( B ) = ( - )</span><span>
</span><span id="line-794"></span><span class="hs-comment">-- &gt;                   ( B )</span><span>
</span><span id="line-795"></span><span class="hs-comment">--</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- Where both matrices /A/ and /B/ have the same number of columns.</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- /This condition is not checked/.</span><span>
</span><span id="line-798"></span><span id="local-6989586621679050577"><span class="annot"><a href="Data.Matrix.html#%3C-%3E"><span class="hs-operator hs-type">(&lt;-&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050577"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-799"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;-&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-800"></span><span id="local-6989586621679049777"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049777"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="%3C-%3E"><span class="annot"><span class="annottext">&lt;-&gt; :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%3C-%3E"><span class="hs-operator hs-var hs-var">&lt;-&gt;</span></a></span></span><span> </span><span id="local-6989586621679049776"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049776"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-801"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049775"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679049775"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049777"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049775"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049776"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049777"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049774"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049774"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049773"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049773"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-803"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049774"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049775"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049777"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049774"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049773"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049776"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049774"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049775"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049773"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-806"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-807"></span><span class="hs-comment">---- MATRIX OPERATIONS</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- | Perform an operation element-wise.</span><span>
</span><span id="line-810"></span><span class="hs-comment">--   The second matrix must have at least as many rows</span><span>
</span><span id="line-811"></span><span class="hs-comment">--   and columns as the first matrix. If it's bigger,</span><span>
</span><span id="line-812"></span><span class="hs-comment">--   the leftover items will be ignored.</span><span>
</span><span id="line-813"></span><span class="hs-comment">--   If it's smaller, it will cause a run-time error.</span><span>
</span><span id="line-814"></span><span class="hs-comment">--   You may want to use 'elementwiseUnsafe' if you</span><span>
</span><span id="line-815"></span><span class="hs-comment">--   are definitely sure that a run-time error won't</span><span>
</span><span id="line-816"></span><span class="hs-comment">--   arise.</span><span>
</span><span id="line-817"></span><span id="local-6989586621679049770"><span id="local-6989586621679049771"><span id="local-6989586621679049772"><span class="annot"><a href="Data.Matrix.html#elementwise"><span class="hs-identifier hs-type">elementwise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679049772"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049771"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049770"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049772"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049771"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049770"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-818"></span><span id="elementwise"><span class="annot"><span class="annottext">elementwise :: (a -&gt; b -&gt; c) -&gt; Matrix a -&gt; Matrix b -&gt; Matrix c
</span><a href="Data.Matrix.html#elementwise"><span class="hs-identifier hs-var hs-var">elementwise</span></a></span></span><span> </span><span id="local-6989586621679049769"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679049769"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679049768"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049768"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049767"><span class="annot"><span class="annottext">Matrix b
</span><a href="#local-6989586621679049767"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; c) -&gt; Matrix c
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049768"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049768"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; c) -&gt; Matrix c) -&gt; ((Int, Int) -&gt; c) -&gt; Matrix c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-819"></span><span>  </span><span class="hs-glyph">\</span><span id="local-6989586621679049766"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049766"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679049769"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049768"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049766"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix b
</span><a href="#local-6989586621679049767"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix b -&gt; (Int, Int) -&gt; b
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679049766"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span class="hs-comment">-- | Unsafe version of 'elementwise', but faster.</span><span>
</span><span id="line-822"></span><span id="local-6989586621679049763"><span id="local-6989586621679049764"><span id="local-6989586621679049765"><span class="annot"><a href="Data.Matrix.html#elementwiseUnsafe"><span class="hs-identifier hs-type">elementwiseUnsafe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679049765"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049764"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049763"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049765"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049764"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049763"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-823"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#elementwiseUnsafe"><span class="hs-pragma hs-type">elementwiseUnsafe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-824"></span><span id="elementwiseUnsafe"><span class="annot"><span class="annottext">elementwiseUnsafe :: (a -&gt; b -&gt; c) -&gt; Matrix a -&gt; Matrix b -&gt; Matrix c
</span><a href="Data.Matrix.html#elementwiseUnsafe"><span class="hs-identifier hs-var hs-var">elementwiseUnsafe</span></a></span></span><span> </span><span id="local-6989586621679049762"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679049762"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679049761"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049761"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049760"><span class="annot"><span class="annottext">Matrix b
</span><a href="#local-6989586621679049760"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; c) -&gt; Matrix c
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049761"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049761"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; c) -&gt; Matrix c) -&gt; ((Int, Int) -&gt; c) -&gt; Matrix c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-825"></span><span>  </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049759"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049759"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049758"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049758"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679049762"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049759"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049758"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049761"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix b -&gt; b
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049759"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049758"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix b
</span><a href="#local-6989586621679049760"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-type">+.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#-."><span class="hs-operator hs-type">-.</span></a></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="hs-comment">-- | Internal unsafe addition.</span><span>
</span><span id="line-830"></span><span id="local-6989586621679049755"><span class="annot"><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-type">(+.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049755"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-831"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+.</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-832"></span><span id="%2B."><span class="annot"><span class="annottext">+. :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var hs-var">(+.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
forall a b c. (a -&gt; b -&gt; c) -&gt; Matrix a -&gt; Matrix b -&gt; Matrix c
</span><a href="Data.Matrix.html#elementwiseUnsafe"><span class="hs-identifier hs-var">elementwiseUnsafe</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="hs-comment">-- | Internal unsafe substraction.</span><span>
</span><span id="line-835"></span><span id="local-6989586621679049754"><span class="annot"><a href="Data.Matrix.html#-."><span class="hs-operator hs-type">(-.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049754"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049754"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-836"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-.</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-837"></span><span id="-."><span class="annot"><span class="annottext">-. :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#-."><span class="hs-operator hs-var hs-var">(-.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
forall a b c. (a -&gt; b -&gt; c) -&gt; Matrix a -&gt; Matrix b -&gt; Matrix c
</span><a href="Data.Matrix.html#elementwiseUnsafe"><span class="hs-identifier hs-var">elementwiseUnsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-840"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-841"></span><span class="hs-comment">---- MATRIX MULTIPLICATION</span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="hs-comment">{- $mult

Four methods are provided for matrix multiplication.

* 'multStd':
     Matrix multiplication following directly the definition.
     This is the best choice when you know for sure that your
     matrices are small.

* 'multStd2':
     Matrix multiplication following directly the definition.
     However, using a different definition from 'multStd'.
     According to our benchmarks with this version, 'multStd2' is
     around 3 times faster than 'multStd'.

* 'multStrassen':
     Matrix multiplication following the Strassen's algorithm.
     Complexity grows slower but also some work is added
     partitioning the matrix. Also, it only works on square
     matrices of order @2^n@, so if this condition is not
     met, it is zero-padded until this is accomplished.
     Therefore, its use is not recommended.

* 'multStrassenMixed':
     This function mixes the previous methods.
     It provides a better performance in general. Method @(@'*'@)@
     of the 'Num' class uses this function because it gives the best
     average performance. However, if you know for sure that your matrices are
     small (size less than 500x500), you should use 'multStd' or 'multStd2' instead,
     since 'multStrassenMixed' is going to switch to those functions anyway.

We keep researching how to get better performance for matrix multiplication.
If you want to be on the safe side, use ('*').

-}</span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="hs-comment">-- | Standard matrix multiplication by definition.</span><span>
</span><span id="line-880"></span><span id="local-6989586621679049753"><span class="annot"><a href="Data.Matrix.html#multStd"><span class="hs-identifier hs-type">multStd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049753"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049753"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-881"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStd"><span class="hs-pragma hs-type">multStd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-882"></span><span id="multStd"><span class="annot"><span class="annottext">multStd :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd"><span class="hs-identifier hs-var hs-var">multStd</span></a></span></span><span> </span><span id="local-6989586621679049752"><span class="annot"><span class="annottext">a1 :: Matrix a
</span><a href="#local-6989586621679049752"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049751"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049751"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049750"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049750"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049749"><span class="annot"><span class="annottext">a2 :: Matrix a
</span><a href="#local-6989586621679049749"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049748"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049748"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679049747"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049747"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-883"></span><span>   </span><span class="hs-comment">-- Checking that sizes match...</span><span>
</span><span id="line-884"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049750"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049748"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiplication of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049751"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049750"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span>
</span><span id="line-885"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049748"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049747"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; matrices.&quot;</span></span><span>
</span><span id="line-886"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd_"><span class="hs-identifier hs-var">multStd_</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049752"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049749"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span class="hs-comment">-- | Standard matrix multiplication by definition.</span><span>
</span><span id="line-889"></span><span id="local-6989586621679049745"><span class="annot"><a href="Data.Matrix.html#multStd2"><span class="hs-identifier hs-type">multStd2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049745"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049745"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-890"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStd2"><span class="hs-pragma hs-type">multStd2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-891"></span><span id="multStd2"><span class="annot"><span class="annottext">multStd2 :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd2"><span class="hs-identifier hs-var hs-var">multStd2</span></a></span></span><span> </span><span id="local-6989586621679049744"><span class="annot"><span class="annottext">a1 :: Matrix a
</span><a href="#local-6989586621679049744"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049743"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049743"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049742"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049742"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049741"><span class="annot"><span class="annottext">a2 :: Matrix a
</span><a href="#local-6989586621679049741"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049740"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049740"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679049739"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049739"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-892"></span><span>   </span><span class="hs-comment">-- Checking that sizes match...</span><span>
</span><span id="line-893"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049742"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049740"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiplication of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049743"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049742"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span>
</span><span id="line-894"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049740"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049739"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; matrices.&quot;</span></span><span>
</span><span id="line-895"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd__"><span class="hs-identifier hs-var">multStd__</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049744"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049741"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="hs-comment">-- | Standard matrix multiplication by definition, without checking if sizes match.</span><span>
</span><span id="line-898"></span><span id="local-6989586621679050401"><span class="annot"><a href="Data.Matrix.html#multStd_"><span class="hs-identifier hs-type">multStd_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050401"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050401"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050401"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050401"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-899"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStd_"><span class="hs-pragma hs-type">multStd_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-900"></span><span id="multStd_"><span class="annot"><span class="annottext">multStd_ :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd_"><span class="hs-identifier hs-var hs-var">multStd_</span></a></span></span><span> </span><span id="local-6989586621679049737"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049737"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049736"><span class="annot"><span class="annottext">b :: Matrix a
</span><a href="#local-6989586621679049736"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Vector a
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Vector a) -&gt; a -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049737"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049736"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span class="annot"><a href="Data.Matrix.html#multStd_"><span class="hs-identifier hs-var">multStd_</span></a></span><span> </span><span id="local-6989586621679049734"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049734"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049733"><span class="annot"><span class="annottext">b :: Matrix a
</span><a href="#local-6989586621679049733"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-902"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-903"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- A</span><span>
</span><span id="line-904"></span><span>        </span><span id="local-6989586621679049732"><span class="annot"><span class="annottext">a11 :: a
</span><a href="#local-6989586621679049732"><span class="hs-identifier hs-var hs-var">a11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049734"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049731"><span class="annot"><span class="annottext">a12 :: a
</span><a href="#local-6989586621679049731"><span class="hs-identifier hs-var hs-var">a12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049734"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>        </span><span id="local-6989586621679049730"><span class="annot"><span class="annottext">a21 :: a
</span><a href="#local-6989586621679049730"><span class="hs-identifier hs-var hs-var">a21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049734"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049729"><span class="annot"><span class="annottext">a22 :: a
</span><a href="#local-6989586621679049729"><span class="hs-identifier hs-var hs-var">a22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049734"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>        </span><span class="hs-comment">-- B</span><span>
</span><span id="line-907"></span><span>        </span><span id="local-6989586621679049728"><span class="annot"><span class="annottext">b11 :: a
</span><a href="#local-6989586621679049728"><span class="hs-identifier hs-var hs-var">b11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049733"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049727"><span class="annot"><span class="annottext">b12 :: a
</span><a href="#local-6989586621679049727"><span class="hs-identifier hs-var hs-var">b12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049733"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-908"></span><span>        </span><span id="local-6989586621679049726"><span class="annot"><span class="annottext">b21 :: a
</span><a href="#local-6989586621679049726"><span class="hs-identifier hs-var hs-var">b21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049733"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049725"><span class="annot"><span class="annottext">b22 :: a
</span><a href="#local-6989586621679049725"><span class="hs-identifier hs-var hs-var">b22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049733"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-910"></span><span>         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049732"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049728"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049731"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049726"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049732"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049727"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049731"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049725"><span class="hs-identifier hs-var">b22</span></a></span><span>
</span><span id="line-911"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049730"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049728"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049729"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049726"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049730"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049727"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049729"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049725"><span class="hs-identifier hs-var">b22</span></a></span><span>
</span><span id="line-912"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-913"></span><span class="annot"><a href="Data.Matrix.html#multStd_"><span class="hs-identifier hs-var">multStd_</span></a></span><span> </span><span id="local-6989586621679049723"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049722"><span class="annot"><span class="annottext">b :: Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-914"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-915"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- A</span><span>
</span><span id="line-916"></span><span>        </span><span id="local-6989586621679049721"><span class="annot"><span class="annottext">a11 :: a
</span><a href="#local-6989586621679049721"><span class="hs-identifier hs-var hs-var">a11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049720"><span class="annot"><span class="annottext">a12 :: a
</span><a href="#local-6989586621679049720"><span class="hs-identifier hs-var hs-var">a12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049719"><span class="annot"><span class="annottext">a13 :: a
</span><a href="#local-6989586621679049719"><span class="hs-identifier hs-var hs-var">a13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>        </span><span id="local-6989586621679049718"><span class="annot"><span class="annottext">a21 :: a
</span><a href="#local-6989586621679049718"><span class="hs-identifier hs-var hs-var">a21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049717"><span class="annot"><span class="annottext">a22 :: a
</span><a href="#local-6989586621679049717"><span class="hs-identifier hs-var hs-var">a22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049716"><span class="annot"><span class="annottext">a23 :: a
</span><a href="#local-6989586621679049716"><span class="hs-identifier hs-var hs-var">a23</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>        </span><span id="local-6989586621679049715"><span class="annot"><span class="annottext">a31 :: a
</span><a href="#local-6989586621679049715"><span class="hs-identifier hs-var hs-var">a31</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049714"><span class="annot"><span class="annottext">a32 :: a
</span><a href="#local-6989586621679049714"><span class="hs-identifier hs-var hs-var">a32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049713"><span class="annot"><span class="annottext">a33 :: a
</span><a href="#local-6989586621679049713"><span class="hs-identifier hs-var hs-var">a33</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049723"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>        </span><span class="hs-comment">-- B</span><span>
</span><span id="line-920"></span><span>        </span><span id="local-6989586621679049712"><span class="annot"><span class="annottext">b11 :: a
</span><a href="#local-6989586621679049712"><span class="hs-identifier hs-var hs-var">b11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049711"><span class="annot"><span class="annottext">b12 :: a
</span><a href="#local-6989586621679049711"><span class="hs-identifier hs-var hs-var">b12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049710"><span class="annot"><span class="annottext">b13 :: a
</span><a href="#local-6989586621679049710"><span class="hs-identifier hs-var hs-var">b13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>        </span><span id="local-6989586621679049709"><span class="annot"><span class="annottext">b21 :: a
</span><a href="#local-6989586621679049709"><span class="hs-identifier hs-var hs-var">b21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049708"><span class="annot"><span class="annottext">b22 :: a
</span><a href="#local-6989586621679049708"><span class="hs-identifier hs-var hs-var">b22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049707"><span class="annot"><span class="annottext">b23 :: a
</span><a href="#local-6989586621679049707"><span class="hs-identifier hs-var hs-var">b23</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span>        </span><span id="local-6989586621679049706"><span class="annot"><span class="annottext">b31 :: a
</span><a href="#local-6989586621679049706"><span class="hs-identifier hs-var hs-var">b31</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049705"><span class="annot"><span class="annottext">b32 :: a
</span><a href="#local-6989586621679049705"><span class="hs-identifier hs-var hs-var">b32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">;</span><span> </span><span id="local-6989586621679049704"><span class="annot"><span class="annottext">b33 :: a
</span><a href="#local-6989586621679049704"><span class="hs-identifier hs-var hs-var">b33</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049722"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Vector a
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-924"></span><span>         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049721"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049712"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049720"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049709"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049719"><span class="hs-identifier hs-var">a13</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049706"><span class="hs-identifier hs-var">b31</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049721"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049711"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049720"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049708"><span class="hs-identifier hs-var">b22</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049719"><span class="hs-identifier hs-var">a13</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049705"><span class="hs-identifier hs-var">b32</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049721"><span class="hs-identifier hs-var">a11</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049710"><span class="hs-identifier hs-var">b13</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049720"><span class="hs-identifier hs-var">a12</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049707"><span class="hs-identifier hs-var">b23</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049719"><span class="hs-identifier hs-var">a13</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049704"><span class="hs-identifier hs-var">b33</span></a></span><span>
</span><span id="line-925"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049718"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049712"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049717"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049709"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049716"><span class="hs-identifier hs-var">a23</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049706"><span class="hs-identifier hs-var">b31</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049718"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049711"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049717"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049708"><span class="hs-identifier hs-var">b22</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049716"><span class="hs-identifier hs-var">a23</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049705"><span class="hs-identifier hs-var">b32</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049718"><span class="hs-identifier hs-var">a21</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049710"><span class="hs-identifier hs-var">b13</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049717"><span class="hs-identifier hs-var">a22</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049707"><span class="hs-identifier hs-var">b23</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049716"><span class="hs-identifier hs-var">a23</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049704"><span class="hs-identifier hs-var">b33</span></a></span><span>
</span><span id="line-926"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049715"><span class="hs-identifier hs-var">a31</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049712"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049714"><span class="hs-identifier hs-var">a32</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049709"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049713"><span class="hs-identifier hs-var">a33</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049706"><span class="hs-identifier hs-var">b31</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049715"><span class="hs-identifier hs-var">a31</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049711"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049714"><span class="hs-identifier hs-var">a32</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049708"><span class="hs-identifier hs-var">b22</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049713"><span class="hs-identifier hs-var">a33</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049705"><span class="hs-identifier hs-var">b32</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049715"><span class="hs-identifier hs-var">a31</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049710"><span class="hs-identifier hs-var">b13</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049714"><span class="hs-identifier hs-var">a32</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049707"><span class="hs-identifier hs-var">b23</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049713"><span class="hs-identifier hs-var">a33</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049704"><span class="hs-identifier hs-var">b33</span></a></span><span>
</span><span id="line-927"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-928"></span><span class="annot"><a href="Data.Matrix.html#multStd_"><span class="hs-identifier hs-var">multStd_</span></a></span><span> </span><span id="local-6989586621679049703"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049703"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049702"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049702"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049701"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049701"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049700"><span class="annot"><span class="annottext">b :: Matrix a
</span><a href="#local-6989586621679049700"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679049699"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049699"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049702"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049699"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049698"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049698"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049697"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049697"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049703"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049698"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049695"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049700"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21."><span class="hs-operator hs-var">!.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049695"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049697"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049695"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049695"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049701"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-929"></span><span>
</span><span id="line-930"></span><span id="local-6989586621679049694"><span class="annot"><a href="Data.Matrix.html#multStd__"><span class="hs-identifier hs-type">multStd__</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049694"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-931"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStd__"><span class="hs-pragma hs-type">multStd__</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-932"></span><span id="multStd__"><span class="annot"><span class="annottext">multStd__ :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd__"><span class="hs-identifier hs-var hs-var">multStd__</span></a></span></span><span> </span><span id="local-6989586621679049693"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049693"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679049692"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049692"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a. Int -&gt; Int -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
</span><a href="Data.Matrix.html#matrix"><span class="hs-identifier hs-var">matrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049691"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049690"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(((Int, Int) -&gt; a) -&gt; Matrix a) -&gt; ((Int, Int) -&gt; a) -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049689"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049689"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049688"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049688"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a -&gt; a
forall a. Num a =&gt; Vector a -&gt; Vector a -&gt; a
</span><a href="Data.Matrix.html#dotProduct"><span class="hs-identifier hs-var">dotProduct</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Vector a) -&gt; Int -&gt; Vector a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Vector a)
</span><a href="#local-6989586621679049686"><span class="hs-identifier hs-var">avs</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Vector a) -&gt; Int -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049689"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Vector a) -&gt; Int -&gt; Vector a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Vector a)
</span><a href="#local-6989586621679049685"><span class="hs-identifier hs-var">bvs</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Vector a) -&gt; Int -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049688"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-934"></span><span>    </span><span id="local-6989586621679049691"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679049691"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049693"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-935"></span><span>    </span><span id="local-6989586621679049686"><span class="annot"><span class="annottext">avs :: Vector (Vector a)
</span><a href="#local-6989586621679049686"><span class="hs-identifier hs-var hs-var">avs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Vector a) -&gt; Vector (Vector a)
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049691"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Vector a) -&gt; Vector (Vector a))
-&gt; (Int -&gt; Vector a) -&gt; Vector (Vector a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049684"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049684"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getRow"><span class="hs-identifier hs-var">getRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049684"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049693"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-936"></span><span>    </span><span id="local-6989586621679049690"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679049690"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049692"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-937"></span><span>    </span><span id="local-6989586621679049685"><span class="annot"><span class="annottext">bvs :: Vector (Vector a)
</span><a href="#local-6989586621679049685"><span class="hs-identifier hs-var hs-var">bvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Vector a) -&gt; Vector (Vector a)
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049690"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Vector a) -&gt; Vector (Vector a))
-&gt; (Int -&gt; Vector a) -&gt; Vector (Vector a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049683"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049683"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a -&gt; Vector a
forall a. Int -&gt; Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getCol"><span class="hs-identifier hs-var">getCol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049683"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049692"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-938"></span><span>
</span><span id="line-939"></span><span id="local-6989586621679050395"><span class="annot"><a href="Data.Matrix.html#dotProduct"><span class="hs-identifier hs-type">dotProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679050395"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050395"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-940"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#dotProduct"><span class="hs-pragma hs-type">dotProduct</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-941"></span><span id="dotProduct"><span class="annot"><span class="annottext">dotProduct :: Vector a -&gt; Vector a -&gt; a
</span><a href="Data.Matrix.html#dotProduct"><span class="hs-identifier hs-var hs-var">dotProduct</span></a></span></span><span> </span><span id="local-6989586621679049682"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049682"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679049681"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049681"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; a -&gt; (a -&gt; Int -&gt; a) -&gt; a
forall a acc.
(Num a, Eq a) =&gt;
a -&gt; a -&gt; acc -&gt; (acc -&gt; a -&gt; acc) -&gt; acc
</span><span class="hs-identifier hs-var">numLoopFold</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049682"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Int -&gt; a) -&gt; a) -&gt; (a -&gt; Int -&gt; a) -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-glyph">\</span><span id="local-6989586621679049680"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049680"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679049679"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049679"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049682"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049679"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Int -&gt; a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049681"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049679"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049680"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-943"></span><span>
</span><span id="line-944"></span><span class="hs-comment">{-
dotProduct v1 v2 = go (V.length v1 - 1) 0
  where
    go (-1) a = a
    go i a = go (i-1) $ (V.unsafeIndex v1 i) * (V.unsafeIndex v2 i) + a
-}</span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span id="local-6989586621679050387"><span class="annot"><a href="Data.Matrix.html#first"><span class="hs-identifier hs-type">first</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050387"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-952"></span><span id="first"><span class="annot"><span class="annottext">first :: (a -&gt; Bool) -&gt; [a] -&gt; a
</span><a href="Data.Matrix.html#first"><span class="hs-identifier hs-var hs-var">first</span></a></span></span><span> </span><span id="local-6989586621679049677"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679049677"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621679049676"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-953"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-954"></span><span>  </span><span id="local-6989586621679049676"><span class="annot"><span class="annottext">go :: [a] -&gt; a
</span><a href="#local-6989586621679049676"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049675"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049675"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679049674"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679049674"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679049677"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049675"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049675"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621679049676"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679049674"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-955"></span><span>  </span><span class="annot"><a href="#local-6989586621679049676"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;first: no element match the condition.&quot;</span></span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span class="hs-comment">-- | Strassen's algorithm over square matrices of order @2^n@.</span><span>
</span><span id="line-958"></span><span id="local-6989586621679049673"><span class="annot"><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-type">strassen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049673"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049673"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-959"></span><span class="hs-comment">-- Trivial 1x1 multiplication.</span><span>
</span><span id="line-960"></span><span id="strassen"><span class="annot"><span class="annottext">strassen :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var hs-var">strassen</span></a></span></span><span> </span><span id="local-6989586621679049671"><span class="annot"><span class="annottext">a :: Matrix a
</span><a href="#local-6989586621679049671"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049670"><span class="annot"><span class="annottext">b :: Matrix a
</span><a href="#local-6989586621679049670"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Vector a
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Vector a) -&gt; a -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049671"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049670"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- General case guesses that the input matrices are square matrices</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- whose order is a power of two.</span><span>
</span><span id="line-963"></span><span class="annot"><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span id="local-6989586621679049669"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049669"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679049668"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049668"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, Matrix a) -&gt; Matrix a
forall a. (Matrix a, Matrix a, Matrix a, Matrix a) -&gt; Matrix a
</span><a href="Data.Matrix.html#joinBlocks"><span class="hs-identifier hs-var">joinBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049667"><span class="hs-identifier hs-var">c11</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049666"><span class="hs-identifier hs-var">c12</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049665"><span class="hs-identifier hs-var">c21</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049664"><span class="hs-identifier hs-var">c22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-965"></span><span>  </span><span class="hs-comment">-- Size of the subproblem is halved.</span><span>
</span><span id="line-966"></span><span>  </span><span id="local-6989586621679049663"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679049663"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049669"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-967"></span><span>  </span><span class="hs-comment">-- Split of the original problem into smaller subproblems.</span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049661"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049661"><span class="hs-identifier hs-var">a11</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049660"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049660"><span class="hs-identifier hs-var">a12</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049659"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049659"><span class="hs-identifier hs-var">a21</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049658"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049658"><span class="hs-identifier hs-var">a22</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
forall a.
Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var">splitBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049663"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049663"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049669"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049657"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049657"><span class="hs-identifier hs-var">b11</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049656"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049656"><span class="hs-identifier hs-var">b12</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049655"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049655"><span class="hs-identifier hs-var">b21</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049654"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049654"><span class="hs-identifier hs-var">b22</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
forall a.
Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var">splitBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049663"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049663"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049668"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-970"></span><span>  </span><span class="hs-comment">-- The seven Strassen's products.</span><span>
</span><span id="line-971"></span><span>  </span><span id="local-6989586621679049653"><span class="annot"><span class="annottext">p1 :: Matrix a
</span><a href="#local-6989586621679049653"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049661"><span class="hs-identifier hs-var">a11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049658"><span class="hs-identifier hs-var">a22</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049657"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049654"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>  </span><span id="local-6989586621679049652"><span class="annot"><span class="annottext">p2 :: Matrix a
</span><a href="#local-6989586621679049652"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049659"><span class="hs-identifier hs-var">a21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049658"><span class="hs-identifier hs-var">a22</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049657"><span class="hs-identifier hs-var">b11</span></a></span><span>
</span><span id="line-973"></span><span>  </span><span id="local-6989586621679049651"><span class="annot"><span class="annottext">p3 :: Matrix a
</span><a href="#local-6989586621679049651"><span class="hs-identifier hs-var hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span>  </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049661"><span class="hs-identifier hs-var">a11</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049656"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049654"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>  </span><span id="local-6989586621679049650"><span class="annot"><span class="annottext">p4 :: Matrix a
</span><a href="#local-6989586621679049650"><span class="hs-identifier hs-var hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span>        </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049658"><span class="hs-identifier hs-var">a22</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049655"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049657"><span class="hs-identifier hs-var">b11</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>  </span><span id="local-6989586621679049649"><span class="annot"><span class="annottext">p5 :: Matrix a
</span><a href="#local-6989586621679049649"><span class="hs-identifier hs-var hs-var">p5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049661"><span class="hs-identifier hs-var">a11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049660"><span class="hs-identifier hs-var">a12</span></a></span><span class="hs-special">)</span><span>        </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049654"><span class="hs-identifier hs-var">b22</span></a></span><span>
</span><span id="line-976"></span><span>  </span><span id="local-6989586621679049648"><span class="annot"><span class="annottext">p6 :: Matrix a
</span><a href="#local-6989586621679049648"><span class="hs-identifier hs-var hs-var">p6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049659"><span class="hs-identifier hs-var">a21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049661"><span class="hs-identifier hs-var">a11</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049657"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049656"><span class="hs-identifier hs-var">b12</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>  </span><span id="local-6989586621679049647"><span class="annot"><span class="annottext">p7 :: Matrix a
</span><a href="#local-6989586621679049647"><span class="hs-identifier hs-var hs-var">p7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049660"><span class="hs-identifier hs-var">a12</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049658"><span class="hs-identifier hs-var">a22</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049655"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049654"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-comment">-- Merging blocks</span><span>
</span><span id="line-979"></span><span>  </span><span id="local-6989586621679049667"><span class="annot"><span class="annottext">c11 :: Matrix a
</span><a href="#local-6989586621679049667"><span class="hs-identifier hs-var hs-var">c11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049653"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049650"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049649"><span class="hs-identifier hs-var">p5</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049647"><span class="hs-identifier hs-var">p7</span></a></span><span>
</span><span id="line-980"></span><span>  </span><span id="local-6989586621679049666"><span class="annot"><span class="annottext">c12 :: Matrix a
</span><a href="#local-6989586621679049666"><span class="hs-identifier hs-var hs-var">c12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049651"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049649"><span class="hs-identifier hs-var">p5</span></a></span><span>
</span><span id="line-981"></span><span>  </span><span id="local-6989586621679049665"><span class="annot"><span class="annottext">c21 :: Matrix a
</span><a href="#local-6989586621679049665"><span class="hs-identifier hs-var hs-var">c21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049652"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049650"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-982"></span><span>  </span><span id="local-6989586621679049664"><span class="annot"><span class="annottext">c22 :: Matrix a
</span><a href="#local-6989586621679049664"><span class="hs-identifier hs-var hs-var">c22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049653"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049652"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049651"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049648"><span class="hs-identifier hs-var">p6</span></a></span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span class="hs-comment">-- | Strassen's matrix multiplication.</span><span>
</span><span id="line-985"></span><span id="local-6989586621679049646"><span class="annot"><a href="Data.Matrix.html#multStrassen"><span class="hs-identifier hs-type">multStrassen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049646"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-986"></span><span id="multStrassen"><span class="annot"><span class="annottext">multStrassen :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStrassen"><span class="hs-identifier hs-var hs-var">multStrassen</span></a></span></span><span> </span><span id="local-6989586621679049645"><span class="annot"><span class="annottext">a1 :: Matrix a
</span><a href="#local-6989586621679049645"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049644"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049644"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049643"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049643"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049642"><span class="annot"><span class="annottext">a2 :: Matrix a
</span><a href="#local-6989586621679049642"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049641"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049641"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679049640"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049640"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049643"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049641"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiplication of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049643"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span>
</span><span id="line-988"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049641"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049640"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; matrices.&quot;</span></span><span>
</span><span id="line-989"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-990"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049639"><span class="annot"><span class="annottext">mx :: Int
</span><a href="#local-6989586621679049639"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049644"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049643"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049641"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049640"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-991"></span><span>           </span><span id="local-6989586621679049637"><span class="annot"><span class="annottext">n2 :: Int
</span><a href="#local-6989586621679049637"><span class="hs-identifier hs-var hs-var">n2</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; a
</span><a href="Data.Matrix.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049639"><span class="hs-identifier hs-var">mx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; [Int] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-992"></span><span>           </span><span id="local-6989586621679049635"><span class="annot"><span class="annottext">b1 :: Matrix a
</span><a href="#local-6989586621679049635"><span class="hs-identifier hs-var hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049637"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049637"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049645"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-993"></span><span>           </span><span id="local-6989586621679049634"><span class="annot"><span class="annottext">b2 :: Matrix a
</span><a href="#local-6989586621679049634"><span class="hs-identifier hs-var hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049637"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049637"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049642"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-994"></span><span>       </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049640"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassen"><span class="hs-identifier hs-var">strassen</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049635"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049634"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span class="annot"><a href="Data.Matrix.html#strmixFactor"><span class="hs-identifier hs-type">strmixFactor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-997"></span><span id="strmixFactor"><span class="annot"><span class="annottext">strmixFactor :: Int
</span><a href="Data.Matrix.html#strmixFactor"><span class="hs-identifier hs-var hs-var">strmixFactor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">300</span></span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span class="hs-comment">-- | Strassen's mixed algorithm.</span><span>
</span><span id="line-1000"></span><span id="local-6989586621679049632"><span class="annot"><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-type">strassenMixed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049632"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1001"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.Matrix.html#strassenMixed"><span class="hs-pragma hs-type">strassenMixed</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1002"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.Matrix.html#strassenMixed"><span class="hs-pragma hs-type">strassenMixed</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1003"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Data.Matrix.html#strassenMixed"><span class="hs-pragma hs-type">strassenMixed</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1004"></span><span id="strassenMixed"><span class="annot"><span class="annottext">strassenMixed :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var hs-var">strassenMixed</span></a></span></span><span> </span><span id="local-6989586621679049630"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049630"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679049629"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049629"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-1005"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Matrix.html#strmixFactor"><span class="hs-identifier hs-var">strmixFactor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd__"><span class="hs-identifier hs-var">multStd__</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049630"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049629"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1006"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049626"><span class="annot"><span class="annottext">r' :: Int
</span><a href="#local-6989586621679049626"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1007"></span><span>               </span><span id="local-6989586621679049625"><span class="annot"><span class="annottext">a' :: Matrix a
</span><a href="#local-6989586621679049625"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049626"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049626"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049630"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1008"></span><span>               </span><span id="local-6989586621679049624"><span class="annot"><span class="annottext">b' :: Matrix a
</span><a href="#local-6989586621679049624"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049626"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049626"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049629"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1009"></span><span>           </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049625"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049624"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-1010"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1011"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s a)) -&gt; Vector a
forall a. (forall s. ST s (MVector s a)) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.create</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (MVector s a)) -&gt; Vector a)
-&gt; (forall s. ST s (MVector s a)) -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1012"></span><span>         </span><span id="local-6989586621679049623"><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049623"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector (PrimState (ST s)) a)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.unsafeNew</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049621"><span class="annot"><span class="annottext">en :: (Int, Int) -&gt; Int
</span><a href="#local-6989586621679049621"><span class="hs-identifier hs-var hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1014"></span><span>             </span><span id="local-6989586621679049620"><span class="annot"><span class="annottext">n' :: Int
</span><a href="#local-6989586621679049620"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1015"></span><span>         </span><span class="hs-comment">-- c11 = p1 + p4 - p5 + p7</span><span>
</span><span id="line-1016"></span><span>         </span><span class="annot"><span class="annottext">[ST s ()] -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049623"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049617"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1017"></span><span>                         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049616"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049615"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049614"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-1018"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049616"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049615"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049613"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-1019"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049616"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049615"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049612"><span class="hs-identifier hs-var">p5</span></a></span><span>
</span><span id="line-1020"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049616"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049615"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049611"><span class="hs-identifier hs-var">p7</span></a></span><span>
</span><span id="line-1021"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049616"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049616"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1022"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049615"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049615"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1023"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049617"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679049617"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049621"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049616"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049615"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-1025"></span><span>         </span><span class="hs-comment">-- c12 = p3 + p5</span><span>
</span><span id="line-1026"></span><span>         </span><span class="annot"><span class="annottext">[ST s ()] -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049623"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049610"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1027"></span><span>                         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049609"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049608"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049607"><span class="hs-identifier hs-var">p3</span></a></span><span>
</span><span id="line-1028"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049609"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049608"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049612"><span class="hs-identifier hs-var">p5</span></a></span><span>
</span><span id="line-1029"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049609"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049609"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1030"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049606"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049620"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1031"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049610"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679049610"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049621"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049609"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049606"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1032"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049608"><span class="annot"><span class="annottext">j' :: Int
</span><a href="#local-6989586621679049608"><span class="hs-identifier hs-var hs-var">j'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049606"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1033"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-1034"></span><span>         </span><span class="hs-comment">-- c21 = p2 + p4</span><span>
</span><span id="line-1035"></span><span>         </span><span class="annot"><span class="annottext">[ST s ()] -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049623"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049605"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1036"></span><span>                         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049604"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049603"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049602"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-1037"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049604"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049603"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049613"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-1038"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049601"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049601"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049620"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1039"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049603"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049603"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1040"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049605"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679049605"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049621"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049601"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049603"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049604"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621679049604"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049601"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1042"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-1043"></span><span>         </span><span class="hs-comment">-- c22 = p1 - p2 + p3 + p6</span><span>
</span><span id="line-1044"></span><span>         </span><span class="annot"><span class="annottext">[ST s ()] -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049623"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049600"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; ST s ()) -&gt; a -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1045"></span><span>                         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049599"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049598"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049614"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-1046"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049599"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049598"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049602"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-1047"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049599"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049598"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049607"><span class="hs-identifier hs-var">p3</span></a></span><span>
</span><span id="line-1048"></span><span>                       </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#unsafeGet"><span class="hs-identifier hs-var">unsafeGet</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049599"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049598"><span class="hs-identifier hs-var">j'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049597"><span class="hs-identifier hs-var">p6</span></a></span><span>
</span><span id="line-1049"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049596"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049596"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049620"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1050"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049595"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049595"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049620"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1051"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049600"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679049600"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049621"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049596"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049595"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049599"><span class="annot"><span class="annottext">i' :: Int
</span><a href="#local-6989586621679049599"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049596"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1053"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049598"><span class="annot"><span class="annottext">j' :: Int
</span><a href="#local-6989586621679049598"><span class="hs-identifier hs-var hs-var">j'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049595"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1054"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-1055"></span><span>         </span><span class="annot"><span class="annottext">MVector s a -&gt; ST s (MVector s a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049623"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1056"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1057"></span><span>  </span><span id="local-6989586621679049628"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049630"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1058"></span><span>  </span><span class="hs-comment">-- Size of the subproblem is halved.</span><span>
</span><span id="line-1059"></span><span>  </span><span id="local-6989586621679049619"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1060"></span><span>  </span><span class="hs-comment">-- Split of the original problem into smaller subproblems.</span><span>
</span><span id="line-1061"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049593"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049593"><span class="hs-identifier hs-var">a11</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049592"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049592"><span class="hs-identifier hs-var">a12</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049591"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049591"><span class="hs-identifier hs-var">a21</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049590"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049590"><span class="hs-identifier hs-var">a22</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
forall a.
Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var">splitBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049630"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1062"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049589"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049589"><span class="hs-identifier hs-var">b11</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049588"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049588"><span class="hs-identifier hs-var">b12</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049587"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049587"><span class="hs-identifier hs-var">b21</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049586"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049586"><span class="hs-identifier hs-var">b22</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
forall a.
Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var">splitBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049619"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049629"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1063"></span><span>  </span><span class="hs-comment">-- The seven Strassen's products.</span><span>
</span><span id="line-1064"></span><span>  </span><span id="local-6989586621679049614"><span class="annot"><span class="annottext">p1 :: Matrix a
</span><a href="#local-6989586621679049614"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049593"><span class="hs-identifier hs-var">a11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var">+.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049590"><span class="hs-identifier hs-var">a22</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049589"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var">+.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049586"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span>  </span><span id="local-6989586621679049602"><span class="annot"><span class="annottext">p2 :: Matrix a
</span><a href="#local-6989586621679049602"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049591"><span class="hs-identifier hs-var">a21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var">+.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049590"><span class="hs-identifier hs-var">a22</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049589"><span class="hs-identifier hs-var">b11</span></a></span><span>
</span><span id="line-1066"></span><span>  </span><span id="local-6989586621679049607"><span class="annot"><span class="annottext">p3 :: Matrix a
</span><a href="#local-6989586621679049607"><span class="hs-identifier hs-var hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span>  </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049593"><span class="hs-identifier hs-var">a11</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049588"><span class="hs-identifier hs-var">b12</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#-."><span class="hs-operator hs-var">-.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049586"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span>  </span><span id="local-6989586621679049613"><span class="annot"><span class="annottext">p4 :: Matrix a
</span><a href="#local-6989586621679049613"><span class="hs-identifier hs-var hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span>         </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049590"><span class="hs-identifier hs-var">a22</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049587"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#-."><span class="hs-operator hs-var">-.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049589"><span class="hs-identifier hs-var">b11</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1068"></span><span>  </span><span id="local-6989586621679049612"><span class="annot"><span class="annottext">p5 :: Matrix a
</span><a href="#local-6989586621679049612"><span class="hs-identifier hs-var hs-var">p5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049593"><span class="hs-identifier hs-var">a11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var">+.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049592"><span class="hs-identifier hs-var">a12</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049586"><span class="hs-identifier hs-var">b22</span></a></span><span>
</span><span id="line-1069"></span><span>  </span><span id="local-6989586621679049597"><span class="annot"><span class="annottext">p6 :: Matrix a
</span><a href="#local-6989586621679049597"><span class="hs-identifier hs-var hs-var">p6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049591"><span class="hs-identifier hs-var">a21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#-."><span class="hs-operator hs-var">-.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049593"><span class="hs-identifier hs-var">a11</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049589"><span class="hs-identifier hs-var">b11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var">+.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049588"><span class="hs-identifier hs-var">b12</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>  </span><span id="local-6989586621679049611"><span class="annot"><span class="annottext">p7 :: Matrix a
</span><a href="#local-6989586621679049611"><span class="hs-identifier hs-var hs-var">p7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049592"><span class="hs-identifier hs-var">a12</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#-."><span class="hs-operator hs-var">-.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049590"><span class="hs-identifier hs-var">a22</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049587"><span class="hs-identifier hs-var">b21</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#%2B."><span class="hs-operator hs-var">+.</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049586"><span class="hs-identifier hs-var">b22</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1071"></span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- | Mixed Strassen's matrix multiplication.</span><span>
</span><span id="line-1073"></span><span id="local-6989586621679049585"><span class="annot"><a href="Data.Matrix.html#multStrassenMixed"><span class="hs-identifier hs-type">multStrassenMixed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049585"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1074"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Matrix.html#multStrassenMixed"><span class="hs-pragma hs-type">multStrassenMixed</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1075"></span><span id="multStrassenMixed"><span class="annot"><span class="annottext">multStrassenMixed :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStrassenMixed"><span class="hs-identifier hs-var hs-var">multStrassenMixed</span></a></span></span><span> </span><span id="local-6989586621679049584"><span class="annot"><span class="annottext">a1 :: Matrix a
</span><a href="#local-6989586621679049584"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049583"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049583"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049582"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049582"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679049581"><span class="annot"><span class="annottext">a2 :: Matrix a
</span><a href="#local-6989586621679049581"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049580"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049580"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679049579"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049579"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049582"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049580"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Matrix a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Matrix a) -&gt; String -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Multiplication of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049583"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049582"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span>
</span><span id="line-1077"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="Data.Matrix.html#sizeStr"><span class="hs-identifier hs-var">sizeStr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049580"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049579"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; matrices.&quot;</span></span><span>
</span><span id="line-1078"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049583"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Matrix.html#strmixFactor"><span class="hs-identifier hs-var">strmixFactor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd__"><span class="hs-identifier hs-var">multStd__</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049584"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049581"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-1079"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1080"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049578"><span class="annot"><span class="annottext">mx :: Int
</span><a href="#local-6989586621679049578"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049583"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049582"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049580"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049579"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1081"></span><span>           </span><span id="local-6989586621679049577"><span class="annot"><span class="annottext">n2 :: Int
</span><a href="#local-6989586621679049577"><span class="hs-identifier hs-var hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">even</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049578"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049578"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049578"><span class="hs-identifier hs-var">mx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1082"></span><span>           </span><span id="local-6989586621679049575"><span class="annot"><span class="annottext">b1 :: Matrix a
</span><a href="#local-6989586621679049575"><span class="hs-identifier hs-var hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049577"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049577"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049584"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-1083"></span><span>           </span><span id="local-6989586621679049574"><span class="annot"><span class="annottext">b2 :: Matrix a
</span><a href="#local-6989586621679049574"><span class="hs-identifier hs-var hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049577"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049577"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049581"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-1084"></span><span>       </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#submatrix"><span class="hs-identifier hs-var">submatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049583"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049579"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#strassenMixed"><span class="hs-identifier hs-var">strassenMixed</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049575"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049574"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-1085"></span><span>
</span><span id="line-1086"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1087"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1088"></span><span class="hs-comment">---- NUMERICAL INSTANCE</span><span>
</span><span id="line-1089"></span><span>
</span><span id="line-1090"></span><span id="local-6989586621679049573"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1091"></span><span> </span><span id="local-6989586621679049564"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a)
-&gt; (Integer -&gt; Vector a) -&gt; Integer -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Vector a
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Vector a) -&gt; (Integer -&gt; a) -&gt; Integer -&gt; Vector a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-1092"></span><span> </span><span id="local-6989586621679049563"><span class="annot"><span class="annottext">negate :: Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">negate</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Matrix a -&gt; Matrix a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span>
</span><span id="line-1093"></span><span> </span><span id="local-6989586621679049562"><span class="annot"><span class="annottext">abs :: Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Matrix a -&gt; Matrix a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span>
</span><span id="line-1094"></span><span> </span><span id="local-6989586621679049560"><span class="annot"><span class="annottext">signum :: Matrix a -&gt; Matrix a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Matrix a -&gt; Matrix a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span> </span><span class="hs-comment">-- Addition of matrices.</span><span>
</span><span id="line-1097"></span><span> </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1098"></span><span> </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1099"></span><span> </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1100"></span><span> </span><span id="local-6989586621679049558"><span class="annot"><span class="annottext">+ :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679049558"><span class="hs-operator hs-var hs-var hs-var hs-var">(+)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
forall a b c. (a -&gt; b -&gt; c) -&gt; Matrix a -&gt; Matrix b -&gt; Matrix c
</span><a href="Data.Matrix.html#elementwise"><span class="hs-identifier hs-var">elementwise</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-1101"></span><span>
</span><span id="line-1102"></span><span> </span><span class="hs-comment">-- Substraction of matrices.</span><span>
</span><span id="line-1103"></span><span> </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1104"></span><span> </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1105"></span><span> </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-pragma hs-type">Matrix</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1106"></span><span> </span><span id="local-6989586621679049557"><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
forall a b c. (a -&gt; b -&gt; c) -&gt; Matrix a -&gt; Matrix b -&gt; Matrix c
</span><a href="Data.Matrix.html#elementwise"><span class="hs-identifier hs-var">elementwise</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span> </span><span class="hs-comment">-- Multiplication of matrices.</span><span>
</span><span id="line-1109"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1110"></span><span> </span><span id="local-6989586621679049556"><span class="annot"><span class="annottext">* :: Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="#local-6989586621679049556"><span class="hs-operator hs-var hs-var hs-var hs-var">(*)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStrassenMixed"><span class="hs-identifier hs-var">multStrassenMixed</span></a></span></span><span>
</span><span id="line-1111"></span><span>
</span><span id="line-1112"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1113"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1114"></span><span class="hs-comment">---- TRANSFORMATIONS</span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span class="hs-comment">-- | Scale a matrix by a given factor.</span><span>
</span><span id="line-1117"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1118"></span><span class="hs-comment">--</span><span>
</span><span id="line-1119"></span><span class="hs-comment">-- &gt;               ( 1 2 3 )   (  2  4  6 )</span><span>
</span><span id="line-1120"></span><span class="hs-comment">-- &gt;               ( 4 5 6 )   (  8 10 12 )</span><span>
</span><span id="line-1121"></span><span class="hs-comment">-- &gt; scaleMatrix 2 ( 7 8 9 ) = ( 14 16 18 )</span><span>
</span><span id="line-1122"></span><span id="local-6989586621679050342"><span class="annot"><a href="Data.Matrix.html#scaleMatrix"><span class="hs-identifier hs-type">scaleMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050342"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1123"></span><span id="scaleMatrix"><span class="annot"><span class="annottext">scaleMatrix :: a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#scaleMatrix"><span class="hs-identifier hs-var hs-var">scaleMatrix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Matrix a -&gt; Matrix a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; Matrix a -&gt; Matrix a)
-&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; Matrix a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-1124"></span><span>
</span><span id="line-1125"></span><span class="hs-comment">-- | Scale a row by a given factor.</span><span>
</span><span id="line-1126"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1127"></span><span class="hs-comment">--</span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- &gt;              ( 1 2 3 )   (  1  2  3 )</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- &gt;              ( 4 5 6 )   (  8 10 12 )</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- &gt; scaleRow 2 2 ( 7 8 9 ) = (  7  8  9 )</span><span>
</span><span id="line-1131"></span><span id="local-6989586621679050423"><span class="annot"><a href="Data.Matrix.html#scaleRow"><span class="hs-identifier hs-type">scaleRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050423"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1132"></span><span id="scaleRow"><span class="annot"><span class="annottext">scaleRow :: a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#scaleRow"><span class="hs-identifier hs-var hs-var">scaleRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. (Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#mapRow"><span class="hs-identifier hs-var">mapRow</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a)
-&gt; (a -&gt; Int -&gt; a -&gt; a) -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Int -&gt; a -&gt; a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; a) -&gt; Int -&gt; a -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; Int -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-1133"></span><span>
</span><span id="line-1134"></span><span class="hs-comment">-- | Add to one row a scalar multiple of another row.</span><span>
</span><span id="line-1135"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1136"></span><span class="hs-comment">--</span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- &gt;                   ( 1 2 3 )   (  1  2  3 )</span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- &gt;                   ( 4 5 6 )   (  6  9 12 )</span><span>
</span><span id="line-1139"></span><span class="hs-comment">-- &gt; combineRows 2 2 1 ( 7 8 9 ) = (  7  8  9 )</span><span>
</span><span id="line-1140"></span><span id="local-6989586621679050429"><span class="annot"><a href="Data.Matrix.html#combineRows"><span class="hs-identifier hs-type">combineRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679050429"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050429"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050429"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050429"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1141"></span><span id="combineRows"><span class="annot"><span class="annottext">combineRows :: Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#combineRows"><span class="hs-identifier hs-var hs-var">combineRows</span></a></span></span><span> </span><span id="local-6989586621679049554"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049554"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679049553"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049553"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679049552"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049552"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span id="local-6989586621679049551"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049551"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. (Int -&gt; a -&gt; a) -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#mapRow"><span class="hs-identifier hs-var">mapRow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049550"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049550"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679049549"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049549"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049549"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049553"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#getElem"><span class="hs-identifier hs-var">getElem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049552"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049550"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049551"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049554"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049551"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1142"></span><span>
</span><span id="line-1143"></span><span class="hs-comment">-- | Switch two rows of a matrix.</span><span>
</span><span id="line-1144"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1145"></span><span class="hs-comment">--</span><span>
</span><span id="line-1146"></span><span class="hs-comment">-- &gt;                ( 1 2 3 )   ( 4 5 6 )</span><span>
</span><span id="line-1147"></span><span class="hs-comment">-- &gt;                ( 4 5 6 )   ( 1 2 3 )</span><span>
</span><span id="line-1148"></span><span class="hs-comment">-- &gt; switchRows 1 2 ( 7 8 9 ) = ( 7 8 9 )</span><span>
</span><span id="line-1149"></span><span id="local-6989586621679050426"><span class="annot"><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-type">switchRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Row 1.</span><span>
</span><span id="line-1150"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Row 2.</span><span>
</span><span id="line-1151"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Original matrix.</span><span>
</span><span id="line-1152"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix with rows 1 and 2 switched.</span></span><span>
</span><span id="line-1153"></span><span id="switchRows"><span class="annot"><span class="annottext">switchRows :: Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var hs-var">switchRows</span></a></span></span><span> </span><span id="local-6989586621679049548"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049548"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679049547"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049547"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049546"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049546"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049545"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049545"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049544"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049544"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049543"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049542"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049542"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049541"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049541"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049546"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049545"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049544"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049543"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049542"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
forall a.
(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049540"><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049540"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1154"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049545"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049539"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049539"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1155"></span><span>    </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; Int -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; Int -&gt; m ()
</span><span class="hs-identifier hs-var">MV.swap</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049540"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049542"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049548"><span class="hs-identifier hs-var">r1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049544"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049539"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049543"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049542"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049547"><span class="hs-identifier hs-var">r2</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049544"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049539"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049543"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049541"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1156"></span><span>
</span><span id="line-1157"></span><span class="hs-comment">-- | Switch two coumns of a matrix.</span><span>
</span><span id="line-1158"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1159"></span><span class="hs-comment">--</span><span>
</span><span id="line-1160"></span><span class="hs-comment">-- &gt;                ( 1 2 3 )   ( 2 1 3 )</span><span>
</span><span id="line-1161"></span><span class="hs-comment">-- &gt;                ( 4 5 6 )   ( 5 4 6 )</span><span>
</span><span id="line-1162"></span><span class="hs-comment">-- &gt; switchCols 1 2 ( 7 8 9 ) = ( 8 7 9 )</span><span>
</span><span id="line-1163"></span><span id="local-6989586621679049537"><span class="annot"><a href="Data.Matrix.html#switchCols"><span class="hs-identifier hs-type">switchCols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Col 1.</span><span>
</span><span id="line-1164"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Col 2.</span><span>
</span><span id="line-1165"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Original matrix.</span><span>
</span><span id="line-1166"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Matrix with cols 1 and 2 switched.</span></span><span>
</span><span id="line-1167"></span><span id="switchCols"><span class="annot"><span class="annottext">switchCols :: Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchCols"><span class="hs-identifier hs-var hs-var">switchCols</span></a></span></span><span> </span><span id="local-6989586621679049536"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049536"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679049535"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049535"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679049534"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049534"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679049533"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049533"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679049532"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049532"><span class="hs-identifier hs-var">ro</span></a></span></span><span> </span><span id="local-6989586621679049531"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049531"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span id="local-6989586621679049530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049530"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679049529"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049529"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049534"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049533"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049532"><span class="hs-identifier hs-var">ro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049531"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049530"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
forall a.
(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049528"><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049528"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1168"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a (m :: * -&gt; *).
(Num a, Ord a, Monad m) =&gt;
a -&gt; a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">numLoop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049534"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679049527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049527"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1169"></span><span>    </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; Int -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; Int -&gt; m ()
</span><span class="hs-identifier hs-var">MV.swap</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049528"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049533"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049527"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049532"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049536"><span class="hs-identifier hs-var">c1</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049531"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049533"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049527"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049532"><span class="hs-identifier hs-var">ro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049535"><span class="hs-identifier hs-var">c2</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049531"><span class="hs-identifier hs-var">co</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679049529"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1172"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1173"></span><span class="hs-comment">---- DECOMPOSITIONS</span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span class="hs-comment">-- LU DECOMPOSITION</span><span>
</span><span id="line-1176"></span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- | Matrix LU decomposition with /partial pivoting/.</span><span>
</span><span id="line-1178"></span><span class="hs-comment">--   The result for a matrix /M/ is given in the format /(U,L,P,d)/ where:</span><span>
</span><span id="line-1179"></span><span class="hs-comment">--</span><span>
</span><span id="line-1180"></span><span class="hs-comment">--   * /U/ is an upper triangular matrix.</span><span>
</span><span id="line-1181"></span><span class="hs-comment">--</span><span>
</span><span id="line-1182"></span><span class="hs-comment">--   * /L/ is an /unit/ lower triangular matrix.</span><span>
</span><span id="line-1183"></span><span class="hs-comment">--</span><span>
</span><span id="line-1184"></span><span class="hs-comment">--   * /P/ is a permutation matrix.</span><span>
</span><span id="line-1185"></span><span class="hs-comment">--</span><span>
</span><span id="line-1186"></span><span class="hs-comment">--   * /d/ is the determinant of /P/.</span><span>
</span><span id="line-1187"></span><span class="hs-comment">--</span><span>
</span><span id="line-1188"></span><span class="hs-comment">--   * /PM = LU/.</span><span>
</span><span id="line-1189"></span><span class="hs-comment">--</span><span>
</span><span id="line-1190"></span><span class="hs-comment">--   These properties are only guaranteed when the input matrix is invertible.</span><span>
</span><span id="line-1191"></span><span class="hs-comment">--   An additional property matches thanks to the strategy followed for pivoting:</span><span>
</span><span id="line-1192"></span><span class="hs-comment">--</span><span>
</span><span id="line-1193"></span><span class="hs-comment">--   * /L_(i,j)/ &lt;= 1, for all /i,j/.</span><span>
</span><span id="line-1194"></span><span class="hs-comment">--</span><span>
</span><span id="line-1195"></span><span class="hs-comment">--   This follows from the maximal property of the selected pivots, which also</span><span>
</span><span id="line-1196"></span><span class="hs-comment">--   leads to a better numerical stability of the algorithm.</span><span>
</span><span id="line-1197"></span><span class="hs-comment">--</span><span>
</span><span id="line-1198"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1199"></span><span class="hs-comment">--</span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- &gt;          ( 1 2 0 )     ( 2 0  2 )   (   1 0 0 )   ( 0 0 1 )</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- &gt;          ( 0 2 1 )     ( 0 2 -1 )   ( 1/2 1 0 )   ( 1 0 0 )</span><span>
</span><span id="line-1202"></span><span class="hs-comment">-- &gt; luDecomp ( 2 0 2 ) = ( ( 0 0  2 ) , (   0 1 1 ) , ( 0 1 0 ) , 1 )</span><span>
</span><span id="line-1203"></span><span class="hs-comment">--</span><span>
</span><span id="line-1204"></span><span class="hs-comment">--   'Nothing' is returned if no LU decomposition exists.</span><span>
</span><span id="line-1205"></span><span id="local-6989586621679050353"><span class="annot"><a href="Data.Matrix.html#luDecomp"><span class="hs-identifier hs-type">luDecomp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679050353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1206"></span><span id="luDecomp"><span class="annot"><span class="annottext">luDecomp :: Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#luDecomp"><span class="hs-identifier hs-var hs-var">luDecomp</span></a></span></span><span> </span><span id="local-6989586621679049526"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049526"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#recLUDecomp"><span class="hs-identifier hs-var">recLUDecomp</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049526"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049524"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049524"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049523"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1207"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1208"></span><span>  </span><span id="local-6989586621679049524"><span class="annot"><span class="annottext">i :: Matrix a
</span><a href="#local-6989586621679049524"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a) -&gt; Int -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049526"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1209"></span><span>  </span><span id="local-6989586621679049523"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679049523"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049526"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049526"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1210"></span><span>
</span><span id="line-1211"></span><span id="local-6989586621679050363"><span class="annot"><a href="Data.Matrix.html#recLUDecomp"><span class="hs-identifier hs-type">recLUDecomp</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1212"></span><span>            </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ U</span><span>
</span><span id="line-1213"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ L</span><span>
</span><span id="line-1214"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ P</span><span>
</span><span id="line-1215"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ d</span><span>
</span><span id="line-1216"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Current row</span><span>
</span><span id="line-1217"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Total rows</span><span>
</span><span id="line-1218"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679050363"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1219"></span><span id="recLUDecomp"><span class="annot"><span class="annottext">recLUDecomp :: Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#recLUDecomp"><span class="hs-identifier hs-var hs-var">recLUDecomp</span></a></span></span><span> </span><span id="local-6989586621679049522"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049522"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679049521"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679049520"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049520"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679049519"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049519"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679049518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679049517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049517"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1220"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049517"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, a)
-&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049522"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049520"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049519"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049516"><span class="hs-identifier hs-var">ukk</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Matrix a, Matrix a, Matrix a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1222"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#recLUDecomp"><span class="hs-identifier hs-var">recLUDecomp</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049515"><span class="hs-identifier hs-var">u''</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049514"><span class="hs-identifier hs-var">l''</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049513"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049512"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049517"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1223"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1224"></span><span>  </span><span class="hs-comment">-- Pivot strategy: maximum value in absolute value below the current row.</span><span>
</span><span id="line-1225"></span><span>  </span><span id="local-6989586621679049511"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679049511"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Ordering) -&gt; [Int] -&gt; Int
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049510"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049510"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679049509"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049509"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049522"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049510"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049522"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049509"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049517"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1226"></span><span>  </span><span class="hs-comment">-- Switching to place pivot in current row.</span><span>
</span><span id="line-1227"></span><span>  </span><span id="local-6989586621679049507"><span class="annot"><span class="annottext">u' :: Matrix a
</span><a href="#local-6989586621679049507"><span class="hs-identifier hs-var hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049511"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049522"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-1228"></span><span>  </span><span id="local-6989586621679049506"><span class="annot"><span class="annottext">l' :: Matrix a
</span><a href="#local-6989586621679049506"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049505"><span class="annot"><span class="annottext">lw :: Int
</span><a href="#local-6989586621679049505"><span class="hs-identifier hs-var hs-var">lw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#vcols"><span class="hs-identifier hs-var hs-var">vcols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1229"></span><span>           </span><span id="local-6989586621679049504"><span class="annot"><span class="annottext">en :: (Int, Int) -&gt; Int
</span><a href="#local-6989586621679049504"><span class="hs-identifier hs-var hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int, Int) -&gt; Int
</span><a href="Data.Matrix.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049505"><span class="hs-identifier hs-var">lw</span></a></span><span>
</span><span id="line-1230"></span><span>           </span><span id="local-6989586621679049503"><span class="annot"><span class="annottext">lro :: Int
</span><a href="#local-6989586621679049503"><span class="hs-identifier hs-var hs-var">lro</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#rowOffset"><span class="hs-identifier hs-var hs-var">rowOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1231"></span><span>           </span><span id="local-6989586621679049502"><span class="annot"><span class="annottext">lco :: Int
</span><a href="#local-6989586621679049502"><span class="hs-identifier hs-var hs-var">lco</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#colOffset"><span class="hs-identifier hs-var hs-var">colOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1232"></span><span>       </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049511"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1233"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1234"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; Vector a -&gt; Matrix a
</span><a href="Data.Matrix.html#M"><span class="hs-identifier hs-var">M</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049503"><span class="hs-identifier hs-var">lro</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049502"><span class="hs-identifier hs-var">lco</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049505"><span class="hs-identifier hs-var">lw</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Matrix a) -&gt; Vector a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1235"></span><span>                     </span><span class="annot"><span class="annottext">(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
forall a.
(forall s. MVector s a -&gt; ST s ()) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679049501"><span class="annot"><span class="annottext">MVector s a
</span><a href="#local-6989586621679049501"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1236"></span><span>                                 </span><span class="hs-glyph">\</span><span id="local-6989586621679049500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049500"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) a -&gt; Int -&gt; Int -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; Int -&gt; m ()
</span><span class="hs-identifier hs-var">MV.swap</span></span><span> </span><span class="annot"><span class="annottext">MVector s a
MVector (PrimState (ST s)) a
</span><a href="#local-6989586621679049501"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049504"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049511"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049503"><span class="hs-identifier hs-var">lro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049500"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049502"><span class="hs-identifier hs-var">lco</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
</span><a href="#local-6989586621679049504"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049503"><span class="hs-identifier hs-var">lro</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049500"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049502"><span class="hs-identifier hs-var">lco</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1238"></span><span>                                </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Vector a) -&gt; Vector a -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#mvect"><span class="hs-identifier hs-var hs-var">mvect</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049521"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1239"></span><span>  </span><span id="local-6989586621679049513"><span class="annot"><span class="annottext">p' :: Matrix a
</span><a href="#local-6989586621679049513"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049511"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049520"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-comment">-- Permutation determinant</span><span>
</span><span id="line-1241"></span><span>  </span><span id="local-6989586621679049512"><span class="annot"><span class="annottext">d' :: a
</span><a href="#local-6989586621679049512"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049511"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049519"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049519"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-comment">-- Cancel elements below the pivot.</span><span>
</span><span id="line-1243"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049515"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049515"><span class="hs-identifier hs-var">u''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049514"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049514"><span class="hs-identifier hs-var">l''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Int -&gt; (Matrix a, Matrix a)
</span><a href="#local-6989586621679049499"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049507"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049506"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1244"></span><span>  </span><span id="local-6989586621679049516"><span class="annot"><span class="annottext">ukk :: a
</span><a href="#local-6989586621679049516"><span class="hs-identifier hs-var hs-var">ukk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049507"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1245"></span><span>  </span><span id="local-6989586621679049499"><span class="annot"><span class="annottext">go :: Matrix a -&gt; Matrix a -&gt; Int -&gt; (Matrix a, Matrix a)
</span><a href="#local-6989586621679049499"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679049498"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049498"><span class="hs-identifier hs-var">u_</span></a></span></span><span> </span><span id="local-6989586621679049497"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049497"><span class="hs-identifier hs-var">l_</span></a></span></span><span> </span><span id="local-6989586621679049496"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049496"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1246"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049496"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049498"><span class="hs-identifier hs-var">u_</span></a></span><span>
</span><span id="line-1247"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049498"><span class="hs-identifier hs-var">u_</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049497"><span class="hs-identifier hs-var">l_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049495"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679049495"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049498"><span class="hs-identifier hs-var">u_</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049496"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049516"><span class="hs-identifier hs-var">ukk</span></a></span><span>
</span><span id="line-1249"></span><span>         </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Int -&gt; (Matrix a, Matrix a)
</span><a href="#local-6989586621679049499"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049496"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049495"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049498"><span class="hs-identifier hs-var">u_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setElem"><span class="hs-identifier hs-var">setElem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049496"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049518"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049497"><span class="hs-identifier hs-var">l_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049496"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1250"></span><span>
</span><span id="line-1251"></span><span class="hs-comment">-- | Unsafe version of 'luDecomp'. It fails when the input matrix is singular.</span><span>
</span><span id="line-1252"></span><span id="local-6989586621679049494"><span class="annot"><a href="Data.Matrix.html#luDecompUnsafe"><span class="hs-identifier hs-type">luDecompUnsafe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679049494"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1253"></span><span id="luDecompUnsafe"><span class="annot"><span class="annottext">luDecompUnsafe :: Matrix a -&gt; (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#luDecompUnsafe"><span class="hs-identifier hs-var hs-var">luDecompUnsafe</span></a></span></span><span> </span><span id="local-6989586621679049493"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049493"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#luDecomp"><span class="hs-identifier hs-var">luDecomp</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049493"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1254"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679049492"><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, a)
</span><a href="#local-6989586621679049492"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, a)
</span><a href="#local-6989586621679049492"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1255"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Matrix a, Matrix a, Matrix a, a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Matrix a, Matrix a, Matrix a, a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;luDecompUnsafe of singular matrix.&quot;</span></span><span>
</span><span id="line-1256"></span><span>
</span><span id="line-1257"></span><span class="hs-comment">-- | Matrix LU decomposition with /complete pivoting/.</span><span>
</span><span id="line-1258"></span><span class="hs-comment">--   The result for a matrix /M/ is given in the format /(U,L,P,Q,d,e)/ where:</span><span>
</span><span id="line-1259"></span><span class="hs-comment">--</span><span>
</span><span id="line-1260"></span><span class="hs-comment">--   * /U/ is an upper triangular matrix.</span><span>
</span><span id="line-1261"></span><span class="hs-comment">--</span><span>
</span><span id="line-1262"></span><span class="hs-comment">--   * /L/ is an /unit/ lower triangular matrix.</span><span>
</span><span id="line-1263"></span><span class="hs-comment">--</span><span>
</span><span id="line-1264"></span><span class="hs-comment">--   * /P,Q/ are permutation matrices.</span><span>
</span><span id="line-1265"></span><span class="hs-comment">--</span><span>
</span><span id="line-1266"></span><span class="hs-comment">--   * /d,e/ are the determinants of /P/ and /Q/ respectively.</span><span>
</span><span id="line-1267"></span><span class="hs-comment">--</span><span>
</span><span id="line-1268"></span><span class="hs-comment">--   * /PMQ = LU/.</span><span>
</span><span id="line-1269"></span><span class="hs-comment">--</span><span>
</span><span id="line-1270"></span><span class="hs-comment">--   These properties are only guaranteed when the input matrix is invertible.</span><span>
</span><span id="line-1271"></span><span class="hs-comment">--   An additional property matches thanks to the strategy followed for pivoting:</span><span>
</span><span id="line-1272"></span><span class="hs-comment">--</span><span>
</span><span id="line-1273"></span><span class="hs-comment">--   * /L_(i,j)/ &lt;= 1, for all /i,j/.</span><span>
</span><span id="line-1274"></span><span class="hs-comment">--</span><span>
</span><span id="line-1275"></span><span class="hs-comment">--   This follows from the maximal property of the selected pivots, which also</span><span>
</span><span id="line-1276"></span><span class="hs-comment">--   leads to a better numerical stability of the algorithm.</span><span>
</span><span id="line-1277"></span><span class="hs-comment">--</span><span>
</span><span id="line-1278"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1279"></span><span class="hs-comment">--</span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- &gt;           ( 1 0 )     ( 2 1 )   (   1    0 0 )   ( 0 0 1 )</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- &gt;           ( 0 2 )     ( 0 2 )   (   0    1 0 )   ( 0 1 0 )   ( 1 0 )</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- &gt; luDecomp' ( 2 1 ) = ( ( 0 0 ) , ( 1/2 -1/4 1 ) , ( 1 0 0 ) , ( 0 1 ) , -1 , 1 )</span><span>
</span><span id="line-1283"></span><span class="hs-comment">--</span><span>
</span><span id="line-1284"></span><span class="hs-comment">--   'Nothing' is returned if no LU decomposition exists.</span><span>
</span><span id="line-1285"></span><span id="local-6989586621679050349"><span class="annot"><a href="Data.Matrix.html#luDecomp%27"><span class="hs-identifier hs-type">luDecomp'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679050349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1286"></span><span id="luDecomp%27"><span class="annot"><span class="annottext">luDecomp' :: Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="Data.Matrix.html#luDecomp%27"><span class="hs-identifier hs-var hs-var">luDecomp'</span></a></span></span><span> </span><span id="local-6989586621679049491"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049491"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="Data.Matrix.html#recLUDecomp%27"><span class="hs-identifier hs-var">recLUDecomp'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049491"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049489"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049489"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a) -&gt; Int -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049488"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1287"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1288"></span><span>  </span><span id="local-6989586621679049489"><span class="annot"><span class="annottext">i :: Matrix a
</span><a href="#local-6989586621679049489"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Matrix a) -&gt; Int -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049491"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1289"></span><span>  </span><span id="local-6989586621679049488"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679049488"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span>
</span><span id="line-1291"></span><span class="hs-comment">-- | Unsafe version of 'luDecomp''. It fails when the input matrix is singular.</span><span>
</span><span id="line-1292"></span><span id="local-6989586621679049487"><span class="annot"><a href="Data.Matrix.html#luDecompUnsafe%27"><span class="hs-identifier hs-type">luDecompUnsafe'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679049487"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1293"></span><span id="luDecompUnsafe%27"><span class="annot"><span class="annottext">luDecompUnsafe' :: Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="Data.Matrix.html#luDecompUnsafe%27"><span class="hs-identifier hs-var hs-var">luDecompUnsafe'</span></a></span></span><span> </span><span id="local-6989586621679049486"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049486"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="Data.Matrix.html#luDecomp%27"><span class="hs-identifier hs-var">luDecomp'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049486"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1294"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679049485"><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="#local-6989586621679049485"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="#local-6989586621679049485"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1295"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;luDecompUnsafe' of singular matrix.&quot;</span></span><span>
</span><span id="line-1296"></span><span>
</span><span id="line-1297"></span><span id="local-6989586621679050351"><span class="annot"><a href="Data.Matrix.html#recLUDecomp%27"><span class="hs-identifier hs-type">recLUDecomp'</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span>            </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ U</span><span>
</span><span id="line-1299"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ L</span><span>
</span><span id="line-1300"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ P</span><span>
</span><span id="line-1301"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ Q</span><span>
</span><span id="line-1302"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ d</span><span>
</span><span id="line-1303"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ e</span><span>
</span><span id="line-1304"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Current row</span><span>
</span><span id="line-1305"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>      </span><span class="hs-comment">-- ^ Total rows</span><span>
</span><span id="line-1306"></span><span>            </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679050351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1307"></span><span id="recLUDecomp%27"><span class="annot"><span class="annottext">recLUDecomp' :: Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="Data.Matrix.html#recLUDecomp%27"><span class="hs-identifier hs-var hs-var">recLUDecomp'</span></a></span></span><span> </span><span id="local-6989586621679049484"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049484"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679049483"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049483"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679049482"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049482"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679049481"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049481"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679049480"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049480"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679049479"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049479"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679049478"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679049477"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049477"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1308"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049477"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049476"><span class="hs-identifier hs-var">u''</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1309"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, Matrix a, a, a)
-&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049484"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049483"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049482"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049481"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049480"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049479"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1310"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049475"><span class="hs-identifier hs-var">ukk</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1311"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1312"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; Matrix a
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; Maybe (Matrix a, Matrix a, Matrix a, Matrix a, a, a)
</span><a href="Data.Matrix.html#recLUDecomp%27"><span class="hs-identifier hs-var">recLUDecomp'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049476"><span class="hs-identifier hs-var">u''</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049474"><span class="hs-identifier hs-var">l''</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049473"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049472"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049471"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049470"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049477"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1313"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1314"></span><span>  </span><span class="hs-comment">-- Pivot strategy: maximum value in absolute value below the current row &amp; col.</span><span>
</span><span id="line-1315"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049469"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049469"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049468"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049468"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Int) -&gt; Ordering)
-&gt; [(Int, Int)] -&gt; (Int, Int)
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; a) -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679049467"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049467"><span class="hs-identifier hs-var">i0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049466"><span class="hs-identifier hs-var">j0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049484"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049467"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049466"><span class="hs-identifier hs-var">j0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1316"></span><span>           </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049465"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049464"><span class="hs-identifier hs-var">j0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049465"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049465"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049484"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049464"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049464"><span class="hs-identifier hs-var">j0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049484"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1317"></span><span>  </span><span class="hs-comment">-- Switching to place pivot in current row.</span><span>
</span><span id="line-1318"></span><span>  </span><span id="local-6989586621679049463"><span class="annot"><span class="annottext">u' :: Matrix a
</span><a href="#local-6989586621679049463"><span class="hs-identifier hs-var hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchCols"><span class="hs-identifier hs-var">switchCols</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049468"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix a -&gt; Matrix a) -&gt; Matrix a -&gt; Matrix a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049469"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049484"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-1319"></span><span>  </span><span id="local-6989586621679049462"><span class="annot"><span class="annottext">l'0 :: Matrix a
</span><a href="#local-6989586621679049462"><span class="hs-identifier hs-var hs-var">l'0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049469"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049483"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1320"></span><span>  </span><span id="local-6989586621679049461"><span class="annot"><span class="annottext">l' :: Matrix a
</span><a href="#local-6989586621679049461"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchCols"><span class="hs-identifier hs-var">switchCols</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049469"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049462"><span class="hs-identifier hs-var">l'0</span></a></span><span>
</span><span id="line-1321"></span><span>  </span><span id="local-6989586621679049473"><span class="annot"><span class="annottext">p' :: Matrix a
</span><a href="#local-6989586621679049473"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchRows"><span class="hs-identifier hs-var">switchRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049469"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049482"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1322"></span><span>  </span><span id="local-6989586621679049472"><span class="annot"><span class="annottext">q' :: Matrix a
</span><a href="#local-6989586621679049472"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#switchCols"><span class="hs-identifier hs-var">switchCols</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049468"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049481"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-1323"></span><span>  </span><span class="hs-comment">-- Permutation determinant</span><span>
</span><span id="line-1324"></span><span>  </span><span id="local-6989586621679049471"><span class="annot"><span class="annottext">d' :: a
</span><a href="#local-6989586621679049471"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049469"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049480"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049480"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1325"></span><span>  </span><span id="local-6989586621679049470"><span class="annot"><span class="annottext">e' :: a
</span><a href="#local-6989586621679049470"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049468"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049479"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049479"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1326"></span><span>  </span><span class="hs-comment">-- Cancel elements below the pivot.</span><span>
</span><span id="line-1327"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679049476"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049476"><span class="hs-identifier hs-var">u''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679049474"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049474"><span class="hs-identifier hs-var">l''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Int -&gt; (Matrix a, Matrix a)
</span><a href="#local-6989586621679049460"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049463"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049461"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1328"></span><span>  </span><span id="local-6989586621679049475"><span class="annot"><span class="annottext">ukk :: a
</span><a href="#local-6989586621679049475"><span class="hs-identifier hs-var hs-var">ukk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049463"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1329"></span><span>  </span><span id="local-6989586621679049460"><span class="annot"><span class="annottext">go :: Matrix a -&gt; Matrix a -&gt; Int -&gt; (Matrix a, Matrix a)
</span><a href="#local-6989586621679049460"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679049459"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049459"><span class="hs-identifier hs-var">u_</span></a></span></span><span> </span><span id="local-6989586621679049458"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049458"><span class="hs-identifier hs-var">l_</span></a></span></span><span> </span><span id="local-6989586621679049457"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049457"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1330"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049457"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049459"><span class="hs-identifier hs-var">u_</span></a></span><span>
</span><span id="line-1331"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049459"><span class="hs-identifier hs-var">u_</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049458"><span class="hs-identifier hs-var">l_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1332"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679049456"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679049456"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049459"><span class="hs-identifier hs-var">u_</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049457"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049475"><span class="hs-identifier hs-var">ukk</span></a></span><span>
</span><span id="line-1333"></span><span>         </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Int -&gt; (Matrix a, Matrix a)
</span><a href="#local-6989586621679049460"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; a -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#combineRows"><span class="hs-identifier hs-var">combineRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049457"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049456"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049459"><span class="hs-identifier hs-var">u_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
forall a. a -&gt; (Int, Int) -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#setElem"><span class="hs-identifier hs-var">setElem</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049456"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049457"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049478"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049458"><span class="hs-identifier hs-var">l_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049457"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1334"></span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- CHOLESKY DECOMPOSITION</span><span>
</span><span id="line-1336"></span><span>
</span><span id="line-1337"></span><span class="hs-comment">-- | Simple Cholesky decomposition of a symmetric, positive definite matrix.</span><span>
</span><span id="line-1338"></span><span class="hs-comment">--   The result for a matrix /M/ is a lower triangular matrix /L/ such that:</span><span>
</span><span id="line-1339"></span><span class="hs-comment">--</span><span>
</span><span id="line-1340"></span><span class="hs-comment">--   * /M = LL^T/.</span><span>
</span><span id="line-1341"></span><span class="hs-comment">--</span><span>
</span><span id="line-1342"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1343"></span><span class="hs-comment">--</span><span>
</span><span id="line-1344"></span><span class="hs-comment">-- &gt;            (  2 -1  0 )   (  1.41  0     0    )</span><span>
</span><span id="line-1345"></span><span class="hs-comment">-- &gt;            ( -1  2 -1 )   ( -0.70  1.22  0    )</span><span>
</span><span id="line-1346"></span><span class="hs-comment">-- &gt; cholDecomp (  0 -1  2 ) = (  0.00 -0.81  1.15 )</span><span>
</span><span id="line-1347"></span><span id="local-6989586621679050341"><span class="annot"><a href="Data.Matrix.html#cholDecomp"><span class="hs-identifier hs-type">cholDecomp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679050341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050341"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1348"></span><span id="cholDecomp"><span class="annot"><span class="annottext">cholDecomp :: Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#cholDecomp"><span class="hs-identifier hs-var hs-var">cholDecomp</span></a></span></span><span> </span><span id="local-6989586621679049455"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049455"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-1349"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049455"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049455"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Matrix a -&gt; Matrix a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049455"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1350"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Matrix a, Matrix a, Matrix a, Matrix a) -&gt; Matrix a
forall a. (Matrix a, Matrix a, Matrix a, Matrix a) -&gt; Matrix a
</span><a href="Data.Matrix.html#joinBlocks"><span class="hs-identifier hs-var">joinBlocks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049453"><span class="hs-identifier hs-var">l11</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049452"><span class="hs-identifier hs-var">l12</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049451"><span class="hs-identifier hs-var">l21</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049450"><span class="hs-identifier hs-var">l22</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1351"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679049449"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049449"><span class="hs-identifier hs-var">a11</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049448"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049448"><span class="hs-identifier hs-var">a12</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049447"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049447"><span class="hs-identifier hs-var">a21</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679049446"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049446"><span class="hs-identifier hs-var">a22</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
forall a.
Int -&gt; Int -&gt; Matrix a -&gt; (Matrix a, Matrix a, Matrix a, Matrix a)
</span><a href="Data.Matrix.html#splitBlocks"><span class="hs-identifier hs-var">splitBlocks</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049455"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1352"></span><span>    </span><span id="local-6989586621679049445"><span class="annot"><span class="annottext">l11' :: a
</span><a href="#local-6989586621679049445"><span class="hs-identifier hs-var hs-var">l11'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049449"><span class="hs-identifier hs-var">a11</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1353"></span><span>    </span><span id="local-6989586621679049453"><span class="annot"><span class="annottext">l11 :: Matrix a
</span><a href="#local-6989586621679049453"><span class="hs-identifier hs-var hs-var">l11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; [a] -&gt; Matrix a
forall a. Int -&gt; Int -&gt; [a] -&gt; Matrix a
</span><a href="Data.Matrix.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049445"><span class="hs-identifier hs-var">l11'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1354"></span><span>    </span><span id="local-6989586621679049452"><span class="annot"><span class="annottext">l12 :: Matrix a
</span><a href="#local-6989586621679049452"><span class="hs-identifier hs-var hs-var">l12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a
forall a. Num a =&gt; Int -&gt; Int -&gt; Matrix a
</span><a href="Data.Matrix.html#zero"><span class="hs-identifier hs-var">zero</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049448"><span class="hs-identifier hs-var">a12</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#ncols"><span class="hs-identifier hs-var hs-var">ncols</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049448"><span class="hs-identifier hs-var">a12</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1355"></span><span>    </span><span id="local-6989586621679049451"><span class="annot"><span class="annottext">l21 :: Matrix a
</span><a href="#local-6989586621679049451"><span class="hs-identifier hs-var hs-var">l21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#scaleMatrix"><span class="hs-identifier hs-var">scaleMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049445"><span class="hs-identifier hs-var">l11'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049447"><span class="hs-identifier hs-var">a21</span></a></span><span>
</span><span id="line-1356"></span><span>    </span><span id="local-6989586621679049444"><span class="annot"><span class="annottext">a22' :: Matrix a
</span><a href="#local-6989586621679049444"><span class="hs-identifier hs-var hs-var">a22'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049446"><span class="hs-identifier hs-var">a22</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a -&gt; Matrix a
forall a. Num a =&gt; Matrix a -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#multStd"><span class="hs-identifier hs-var">multStd</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049451"><span class="hs-identifier hs-var">l21</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049451"><span class="hs-identifier hs-var">l21</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1357"></span><span>    </span><span id="local-6989586621679049450"><span class="annot"><span class="annottext">l22 :: Matrix a
</span><a href="#local-6989586621679049450"><span class="hs-identifier hs-var hs-var">l22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Matrix a
forall a. Floating a =&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#cholDecomp"><span class="hs-identifier hs-var">cholDecomp</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049444"><span class="hs-identifier hs-var">a22'</span></a></span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1360"></span><span class="hs-comment">-------------------------------------------------------</span><span>
</span><span id="line-1361"></span><span class="hs-comment">---- PROPERTIES</span><span>
</span><span id="line-1362"></span><span>
</span><span id="line-1363"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1364"></span><span class="annot"><span class="hs-pragma">&quot;matrix/traceOfSum&quot;</span></span><span>
</span><span id="line-1365"></span><span>    </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679049443"><span class="annot"><a href="#local-6989586621679049443"><span class="hs-pragma hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679049442"><span class="annot"><a href="#local-6989586621679049442"><span class="hs-pragma hs-var">b</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-pragma hs-type">trace</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679049443"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679049442"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-pragma hs-type">trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049443"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">+</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-pragma hs-type">trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049442"><span class="hs-pragma hs-type">b</span></a></span><span>
</span><span id="line-1366"></span><span>
</span><span id="line-1367"></span><span class="annot"><span class="hs-pragma">&quot;matrix/traceOfScale&quot;</span></span><span>
</span><span id="line-1368"></span><span>    </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679049441"><span class="annot"><a href="#local-6989586621679049441"><span class="hs-pragma hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679049440"><span class="annot"><a href="#local-6989586621679049440"><span class="hs-pragma hs-var">a</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-pragma hs-type">trace</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Data.Matrix.html#scaleMatrix"><span class="hs-pragma hs-type">scaleMatrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049441"><span class="hs-pragma hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049440"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679049441"><span class="hs-pragma hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">*</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-pragma hs-type">trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049440"><span class="hs-pragma hs-type">a</span></a></span><span>
</span><span id="line-1369"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1370"></span><span>
</span><span id="line-1371"></span><span class="hs-comment">-- | Sum of the elements in the diagonal. See also 'getDiag'.</span><span>
</span><span id="line-1372"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1373"></span><span class="hs-comment">--</span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- &gt;       ( 1 2 3 )</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- &gt;       ( 4 5 6 )</span><span>
</span><span id="line-1376"></span><span class="hs-comment">-- &gt; trace ( 7 8 9 ) = 15</span><span>
</span><span id="line-1377"></span><span id="local-6989586621679049439"><span class="annot"><a href="Data.Matrix.html#trace"><span class="hs-identifier hs-type">trace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049439"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049439"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049439"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1378"></span><span id="trace"><span class="annot"><span class="annottext">trace :: Matrix a -&gt; a
</span><a href="Data.Matrix.html#trace"><span class="hs-identifier hs-var hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getDiag"><span class="hs-identifier hs-var">getDiag</span></a></span><span>
</span><span id="line-1379"></span><span>
</span><span id="line-1380"></span><span class="hs-comment">-- | Product of the elements in the diagonal. See also 'getDiag'.</span><span>
</span><span id="line-1381"></span><span class="hs-comment">--   Example:</span><span>
</span><span id="line-1382"></span><span class="hs-comment">--</span><span>
</span><span id="line-1383"></span><span class="hs-comment">-- &gt;          ( 1 2 3 )</span><span>
</span><span id="line-1384"></span><span class="hs-comment">-- &gt;          ( 4 5 6 )</span><span>
</span><span id="line-1385"></span><span class="hs-comment">-- &gt; diagProd ( 7 8 9 ) = 45</span><span>
</span><span id="line-1386"></span><span id="local-6989586621679049437"><span class="annot"><a href="Data.Matrix.html#diagProd"><span class="hs-identifier hs-type">diagProd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049437"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049437"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049437"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1387"></span><span id="diagProd"><span class="annot"><span class="annottext">diagProd :: Matrix a -&gt; a
</span><a href="Data.Matrix.html#diagProd"><span class="hs-identifier hs-var hs-var">diagProd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.product</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; (Matrix a -&gt; Vector a) -&gt; Matrix a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Vector a
forall a. Matrix a -&gt; Vector a
</span><a href="Data.Matrix.html#getDiag"><span class="hs-identifier hs-var">getDiag</span></a></span><span>
</span><span id="line-1388"></span><span>
</span><span id="line-1389"></span><span class="hs-comment">-- DETERMINANT</span><span>
</span><span id="line-1390"></span><span>
</span><span id="line-1391"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1392"></span><span class="annot"><span class="hs-pragma">&quot;matrix/detLaplaceProduct&quot;</span></span><span>
</span><span id="line-1393"></span><span>    </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679049435"><span class="annot"><a href="#local-6989586621679049435"><span class="hs-pragma hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679049434"><span class="annot"><a href="#local-6989586621679049434"><span class="hs-pragma hs-var">b</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Matrix.html#detLaplace"><span class="hs-pragma hs-type">detLaplace</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679049435"><span class="hs-pragma hs-type">a</span></a></span><span class="annot"><span class="hs-pragma hs-type">*</span></span><span class="annot"><a href="#local-6989586621679049434"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Matrix.html#detLaplace"><span class="hs-pragma hs-type">detLaplace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049435"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">*</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#detLaplace"><span class="hs-pragma hs-type">detLaplace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049434"><span class="hs-pragma hs-type">b</span></a></span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="annot"><span class="hs-pragma">&quot;matrix/detLUProduct&quot;</span></span><span>
</span><span id="line-1396"></span><span>    </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679049433"><span class="annot"><a href="#local-6989586621679049433"><span class="hs-pragma hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679049432"><span class="annot"><a href="#local-6989586621679049432"><span class="hs-pragma hs-var">b</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.Matrix.html#detLU"><span class="hs-pragma hs-type">detLU</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="#local-6989586621679049433"><span class="hs-pragma hs-type">a</span></a></span><span class="annot"><span class="hs-pragma hs-type">*</span></span><span class="annot"><a href="#local-6989586621679049432"><span class="hs-pragma hs-type">b</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Matrix.html#detLU"><span class="hs-pragma hs-type">detLU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049433"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">*</span></span><span> </span><span class="annot"><a href="Data.Matrix.html#detLU"><span class="hs-pragma hs-type">detLU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049432"><span class="hs-pragma hs-type">b</span></a></span><span>
</span><span id="line-1397"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1398"></span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- | Matrix determinant using Laplace expansion.</span><span>
</span><span id="line-1400"></span><span class="hs-comment">--   If the elements of the 'Matrix' are instance of 'Ord' and 'Fractional'</span><span>
</span><span id="line-1401"></span><span class="hs-comment">--   consider to use 'detLU' in order to obtain better performance.</span><span>
</span><span id="line-1402"></span><span class="hs-comment">--   Function 'detLaplace' is /extremely/ slow.</span><span>
</span><span id="line-1403"></span><span id="local-6989586621679049431"><span class="annot"><a href="Data.Matrix.html#detLaplace"><span class="hs-identifier hs-type">detLaplace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679049431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049431"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1404"></span><span id="detLaplace"><span class="annot"><span class="annottext">detLaplace :: Matrix a -&gt; a
</span><a href="Data.Matrix.html#detLaplace"><span class="hs-identifier hs-var hs-var">detLaplace</span></a></span></span><span> </span><span id="local-6989586621679049430"><span class="annot"><span class="annottext">m :: Matrix a
</span><a href="#local-6989586621679049430"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Matrix.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049430"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1405"></span><span class="annot"><a href="Data.Matrix.html#detLaplace"><span class="hs-identifier hs-var">detLaplace</span></a></span><span> </span><span id="local-6989586621679049429"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049429"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
</span><a href="#local-6989586621679049428"><span class="hs-identifier hs-var">sum1</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049427"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049429"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; (Int, Int) -&gt; a
forall a. Matrix a -&gt; (Int, Int) -&gt; a
</span><a href="Data.Matrix.html#%21"><span class="hs-glyph hs-var">!</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049427"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; a
forall a. Num a =&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#detLaplace"><span class="hs-identifier hs-var">detLaplace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
forall a. Int -&gt; Int -&gt; Matrix a -&gt; Matrix a
</span><a href="Data.Matrix.html#minorMatrix"><span class="hs-identifier hs-var">minorMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049427"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049429"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679049427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679049427"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Int
forall a. Matrix a -&gt; Int
</span><a href="Data.Matrix.html#nrows"><span class="hs-identifier hs-var hs-var">nrows</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049429"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1407"></span><span>    </span><span id="local-6989586621679049428"><span class="annot"><span class="annottext">sum1 :: [a] -&gt; a
</span><a href="#local-6989586621679049428"><span class="hs-identifier hs-var hs-var">sum1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">foldl1'</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-1408"></span><span>
</span><span id="line-1409"></span><span class="hs-comment">-- | Matrix determinant using LU decomposition.</span><span>
</span><span id="line-1410"></span><span class="hs-comment">--   It works even when the input matrix is singular.</span><span>
</span><span id="line-1411"></span><span id="local-6989586621679049426"><span class="annot"><a href="Data.Matrix.html#detLU"><span class="hs-identifier hs-type">detLU</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679049426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679049426"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Matrix.html#Matrix"><span class="hs-identifier hs-type">Matrix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679049426"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679049426"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1412"></span><span id="detLU"><span class="annot"><span class="annottext">detLU :: Matrix a -&gt; a
</span><a href="Data.Matrix.html#detLU"><span class="hs-identifier hs-var hs-var">detLU</span></a></span></span><span> </span><span id="local-6989586621679049425"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049425"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
forall a.
(Ord a, Fractional a) =&gt;
Matrix a -&gt; Maybe (Matrix a, Matrix a, Matrix a, a)
</span><a href="Data.Matrix.html#luDecomp"><span class="hs-identifier hs-var">luDecomp</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049425"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1413"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679049424"><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049424"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Matrix a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679049423"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049423"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679049423"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Matrix a -&gt; a
forall a. Num a =&gt; Matrix a -&gt; a
</span><a href="Data.Matrix.html#diagProd"><span class="hs-identifier hs-var">diagProd</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix a
</span><a href="#local-6989586621679049424"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-1414"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Matrix a, Matrix a, Matrix a, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1415"></span></pre></body></html>