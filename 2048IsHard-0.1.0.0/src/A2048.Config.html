<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : A2048.Config
Description : Rendering configuration.
Copyright   : (c) Xie Ruifeng, 2020
License     : AGPL-3
Maintainer  : krantz.xrf@outlook.com
Stability   : experimental
Portability : portable
-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes     #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE Strict          #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">A2048.Config</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.HexColour</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.SvgTree</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- |How do we show the labels on the tile?</span><span>
</span><span id="line-20"></span><span class="hs-keyword">data</span><span> </span><span id="TileLabelMode"><span class="annot"><a href="A2048.Config.html#TileLabelMode"><span class="hs-identifier hs-var">TileLabelMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Plain"><span class="annot"><a href="A2048.Config.html#Plain"><span class="hs-identifier hs-var">Plain</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Logarithm"><span class="annot"><a href="A2048.Config.html#Logarithm"><span class="hs-identifier hs-var">Logarithm</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Exponent"><span class="annot"><a href="A2048.Config.html#Exponent"><span class="hs-identifier hs-var">Exponent</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679182011"><span id="local-6989586621679182013"><span id="local-6989586621679182015"><span class="annot"><span class="annottext">Int -&gt; TileLabelMode -&gt; ShowS
[TileLabelMode] -&gt; ShowS
TileLabelMode -&gt; String
(Int -&gt; TileLabelMode -&gt; ShowS)
-&gt; (TileLabelMode -&gt; String)
-&gt; ([TileLabelMode] -&gt; ShowS)
-&gt; Show TileLabelMode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TileLabelMode] -&gt; ShowS
$cshowList :: [TileLabelMode] -&gt; ShowS
show :: TileLabelMode -&gt; String
$cshow :: TileLabelMode -&gt; String
showsPrec :: Int -&gt; TileLabelMode -&gt; ShowS
$cshowsPrec :: Int -&gt; TileLabelMode -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679182006"><span id="local-6989586621679182008"><span class="annot"><span class="annottext">TileLabelMode -&gt; TileLabelMode -&gt; Bool
(TileLabelMode -&gt; TileLabelMode -&gt; Bool)
-&gt; (TileLabelMode -&gt; TileLabelMode -&gt; Bool) -&gt; Eq TileLabelMode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TileLabelMode -&gt; TileLabelMode -&gt; Bool
$c/= :: TileLabelMode -&gt; TileLabelMode -&gt; Bool
== :: TileLabelMode -&gt; TileLabelMode -&gt; Bool
$c== :: TileLabelMode -&gt; TileLabelMode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- |Configurations for the 2048 Game.</span><span>
</span><span id="line-23"></span><span class="hs-keyword">data</span><span> </span><span id="Game2048Config"><span class="annot"><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-var">Game2048Config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Game2048Config"><span class="annot"><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-var">Game2048Config</span></a></span></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_tileSize"><span class="annot"><span class="annottext">Game2048Config -&gt; Double
</span><a href="A2048.Config.html#_tileSize"><span class="hs-identifier hs-var hs-var">_tileSize</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tileRadius"><span class="annot"><span class="annottext">Game2048Config -&gt; Double
</span><a href="A2048.Config.html#_tileRadius"><span class="hs-identifier hs-var hs-var">_tileRadius</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tileTextScaleRatio"><span class="annot"><span class="annottext">Game2048Config -&gt; Double
</span><a href="A2048.Config.html#_tileTextScaleRatio"><span class="hs-identifier hs-var hs-var">_tileTextScaleRatio</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tileFillColour"><span class="annot"><span class="annottext">Game2048Config -&gt; [Texture]
</span><a href="A2048.Config.html#_tileFillColour"><span class="hs-identifier hs-var hs-var">_tileFillColour</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span><span class="hs-special">]</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tileTextColour"><span class="annot"><span class="annottext">Game2048Config -&gt; [Texture]
</span><a href="A2048.Config.html#_tileTextColour"><span class="hs-identifier hs-var hs-var">_tileTextColour</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span><span class="hs-special">]</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tileShowLabel"><span class="annot"><span class="annottext">Game2048Config -&gt; Bool
</span><a href="A2048.Config.html#_tileShowLabel"><span class="hs-identifier hs-var hs-var">_tileShowLabel</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_tileLabelMode"><span class="annot"><span class="annottext">Game2048Config -&gt; TileLabelMode
</span><a href="A2048.Config.html#_tileLabelMode"><span class="hs-identifier hs-var hs-var">_tileLabelMode</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="A2048.Config.html#TileLabelMode"><span class="hs-identifier hs-type">TileLabelMode</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boardWidth"><span class="annot"><span class="annottext">Game2048Config -&gt; Int
</span><a href="A2048.Config.html#_boardWidth"><span class="hs-identifier hs-var hs-var">_boardWidth</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boardHeight"><span class="annot"><span class="annottext">Game2048Config -&gt; Int
</span><a href="A2048.Config.html#_boardHeight"><span class="hs-identifier hs-var hs-var">_boardHeight</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boardGapSize"><span class="annot"><span class="annottext">Game2048Config -&gt; Double
</span><a href="A2048.Config.html#_boardGapSize"><span class="hs-identifier hs-var hs-var">_boardGapSize</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boardBorderSize"><span class="annot"><span class="annottext">Game2048Config -&gt; Double
</span><a href="A2048.Config.html#_boardBorderSize"><span class="hs-identifier hs-var hs-var">_boardBorderSize</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boardGridColour"><span class="annot"><span class="annottext">Game2048Config -&gt; Texture
</span><a href="A2048.Config.html#_boardGridColour"><span class="hs-identifier hs-var hs-var">_boardGridColour</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boardFillColour"><span class="annot"><span class="annottext">Game2048Config -&gt; Texture
</span><a href="A2048.Config.html#_boardFillColour"><span class="hs-identifier hs-var hs-var">_boardFillColour</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_motionFillPadding"><span class="annot"><span class="annottext">Game2048Config -&gt; Bool
</span><a href="A2048.Config.html#_motionFillPadding"><span class="hs-identifier hs-var hs-var">_motionFillPadding</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_motionDuration"><span class="annot"><span class="annottext">Game2048Config -&gt; Double
</span><a href="A2048.Config.html#_motionDuration"><span class="hs-identifier hs-var hs-var">_motionDuration</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679181983"><span id="local-6989586621679181985"><span id="local-6989586621679181987"><span class="annot"><span class="annottext">Int -&gt; Game2048Config -&gt; ShowS
[Game2048Config] -&gt; ShowS
Game2048Config -&gt; String
(Int -&gt; Game2048Config -&gt; ShowS)
-&gt; (Game2048Config -&gt; String)
-&gt; ([Game2048Config] -&gt; ShowS)
-&gt; Show Game2048Config
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Game2048Config] -&gt; ShowS
$cshowList :: [Game2048Config] -&gt; ShowS
show :: Game2048Config -&gt; String
$cshow :: Game2048Config -&gt; String
showsPrec :: Int -&gt; Game2048Config -&gt; ShowS
$cshowsPrec :: Int -&gt; Game2048Config -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- |Classy lens for 'Game2048Config'.</span><span>
</span><span id="line-42"></span><span id="tileTextScaleRatio"><span id="tileTextColour"><span id="tileSize"><span id="tileShowLabel"><span id="tileRadius"><span id="tileLabelMode"><span id="tileFillColour"><span id="motionFillPadding"><span id="motionDuration"><span id="boardWidth"><span id="boardHeight"><span id="boardGridColour"><span id="boardGapSize"><span id="boardFillColour"><span id="boardBorderSize"><span id="game2048Config"><span id="local-6989586621679181936"><span id="local-6989586621679181938"><span id="local-6989586621679181940"><span id="local-6989586621679181942"><span id="local-6989586621679181944"><span id="local-6989586621679181946"><span id="local-6989586621679181948"><span id="local-6989586621679181950"><span id="local-6989586621679181952"><span id="local-6989586621679181954"><span id="local-6989586621679181956"><span id="local-6989586621679181958"><span id="local-6989586621679181960"><span id="local-6989586621679181962"><span id="local-6989586621679181964"><span id="local-6989586621679181966"><span id="local-6989586621679181968"><span id="local-6989586621679181969"><span id="local-6989586621679181970"><span id="local-6989586621679181971"><span id="local-6989586621679181972"><span id="local-6989586621679181973"><span id="local-6989586621679181974"><span id="local-6989586621679181975"><span id="local-6989586621679181976"><span id="local-6989586621679181977"><span id="local-6989586621679181978"><span id="local-6989586621679181979"><span id="local-6989586621679181980"><span id="local-6989586621679181981"><span id="local-6989586621679181982"><span id="HasGame2048Config"><span id="local-6989586621679182065"><span class="hs-identifier">makeClassy</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Game2048Config</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- |Default configuration for tiles.</span><span>
</span><span id="line-45"></span><span class="annot"><a href="A2048.Config.html#defaultGame2048Config"><span class="hs-identifier hs-type">defaultGame2048Config</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-type">Game2048Config</span></a></span><span>
</span><span id="line-46"></span><span id="defaultGame2048Config"><span class="annot"><span class="annottext">defaultGame2048Config :: Game2048Config
</span><a href="A2048.Config.html#defaultGame2048Config"><span class="hs-identifier hs-var hs-var">defaultGame2048Config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Game2048Config :: Double
-&gt; Double
-&gt; Double
-&gt; [Texture]
-&gt; [Texture]
-&gt; Bool
-&gt; TileLabelMode
-&gt; Int
-&gt; Int
-&gt; Double
-&gt; Double
-&gt; Texture
-&gt; Texture
-&gt; Bool
-&gt; Double
-&gt; Game2048Config
</span><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-type">Game2048Config</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tileSize :: Double
</span><a href="A2048.Config.html#_tileSize"><span class="hs-identifier hs-var">_tileSize</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.2</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileRadius :: Double
</span><a href="A2048.Config.html#_tileRadius"><span class="hs-identifier hs-var">_tileRadius</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.09</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileTextScaleRatio :: Double
</span><a href="A2048.Config.html#_tileTextScaleRatio"><span class="hs-identifier hs-var">_tileTextScaleRatio</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileFillColour :: [Texture]
</span><a href="A2048.Config.html#_tileFillColour"><span class="hs-identifier hs-var">_tileFillColour</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Texture]
</span><a href="A2048.Config.html#tileBgColours"><span class="hs-identifier hs-var">tileBgColours</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileTextColour :: [Texture]
</span><a href="A2048.Config.html#_tileTextColour"><span class="hs-identifier hs-var">_tileTextColour</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Texture]
</span><a href="A2048.Config.html#tileFgColours"><span class="hs-identifier hs-var">tileFgColours</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileShowLabel :: Bool
</span><a href="A2048.Config.html#_tileShowLabel"><span class="hs-identifier hs-var">_tileShowLabel</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileLabelMode :: TileLabelMode
</span><a href="A2048.Config.html#_tileLabelMode"><span class="hs-identifier hs-var">_tileLabelMode</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TileLabelMode
</span><a href="A2048.Config.html#Plain"><span class="hs-identifier hs-var">Plain</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardWidth :: Int
</span><a href="A2048.Config.html#_boardWidth"><span class="hs-identifier hs-var">_boardWidth</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardHeight :: Int
</span><a href="A2048.Config.html#_boardHeight"><span class="hs-identifier hs-var">_boardHeight</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardGapSize :: Double
</span><a href="A2048.Config.html#_boardGapSize"><span class="hs-identifier hs-var">_boardGapSize</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardBorderSize :: Double
</span><a href="A2048.Config.html#_boardBorderSize"><span class="hs-identifier hs-var">_boardBorderSize</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardGridColour :: Texture
</span><a href="A2048.Config.html#_boardGridColour"><span class="hs-identifier hs-var">_boardGridColour</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[rgba|cdc0b4|]</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardFillColour :: Texture
</span><a href="A2048.Config.html#_boardFillColour"><span class="hs-identifier hs-var">_boardFillColour</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[rgba|bbada0|]</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_motionFillPadding :: Bool
</span><a href="A2048.Config.html#_motionFillPadding"><span class="hs-identifier hs-var">_motionFillPadding</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_motionDuration :: Double
</span><a href="A2048.Config.html#_motionDuration"><span class="hs-identifier hs-var">_motionDuration</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- |Scale the whole game UI.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="A2048.Config.html#scaleGame"><span class="hs-identifier hs-type">scaleGame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-type">Game2048Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-type">Game2048Config</span></a></span><span>
</span><span id="line-66"></span><span id="scaleGame"><span class="annot"><span class="annottext">scaleGame :: Double -&gt; Game2048Config -&gt; Game2048Config
</span><a href="A2048.Config.html#scaleGame"><span class="hs-identifier hs-var hs-var">scaleGame</span></a></span></span><span> </span><span id="local-6989586621679181912"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181912"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679181911"><span class="annot"><span class="annottext">cfg :: Game2048Config
</span><a href="#local-6989586621679181911"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="A2048.Config.html#Game2048Config"><span class="hs-identifier hs-type">Game2048Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621679181896"><span id="local-6989586621679181897"><span id="local-6989586621679181898"><span id="local-6989586621679181899"><span id="local-6989586621679181900"><span id="local-6989586621679181901"><span id="local-6989586621679181902"><span id="local-6989586621679181903"><span id="local-6989586621679181904"><span id="local-6989586621679181905"><span id="local-6989586621679181906"><span id="local-6989586621679181907"><span id="local-6989586621679181908"><span id="local-6989586621679181909"><span id="local-6989586621679181910"><span class="annot"><span class="annottext">Bool
Double
Int
[Texture]
Texture
TileLabelMode
_motionDuration :: Double
_motionFillPadding :: Bool
_boardFillColour :: Texture
_boardGridColour :: Texture
_boardBorderSize :: Double
_boardGapSize :: Double
_boardHeight :: Int
_boardWidth :: Int
_tileLabelMode :: TileLabelMode
_tileShowLabel :: Bool
_tileTextColour :: [Texture]
_tileFillColour :: [Texture]
_tileTextScaleRatio :: Double
_tileRadius :: Double
_tileSize :: Double
_motionDuration :: Game2048Config -&gt; Double
_motionFillPadding :: Game2048Config -&gt; Bool
_boardFillColour :: Game2048Config -&gt; Texture
_boardGridColour :: Game2048Config -&gt; Texture
_boardBorderSize :: Game2048Config -&gt; Double
_boardGapSize :: Game2048Config -&gt; Double
_boardHeight :: Game2048Config -&gt; Int
_boardWidth :: Game2048Config -&gt; Int
_tileLabelMode :: Game2048Config -&gt; TileLabelMode
_tileShowLabel :: Game2048Config -&gt; Bool
_tileTextColour :: Game2048Config -&gt; [Texture]
_tileFillColour :: Game2048Config -&gt; [Texture]
_tileTextScaleRatio :: Game2048Config -&gt; Double
_tileRadius :: Game2048Config -&gt; Double
_tileSize :: Game2048Config -&gt; Double
</span><a href="#local-6989586621679181896"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Game2048Config
</span><a href="#local-6989586621679181911"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_tileSize :: Double
</span><a href="A2048.Config.html#_tileSize"><span class="hs-identifier hs-var">_tileSize</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181912"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181910"><span class="hs-identifier hs-var">_tileSize</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileRadius :: Double
</span><a href="A2048.Config.html#_tileRadius"><span class="hs-identifier hs-var">_tileRadius</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181912"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181909"><span class="hs-identifier hs-var">_tileRadius</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_tileTextScaleRatio :: Double
</span><a href="A2048.Config.html#_tileTextScaleRatio"><span class="hs-identifier hs-var">_tileTextScaleRatio</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181912"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181908"><span class="hs-identifier hs-var">_tileTextScaleRatio</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardGapSize :: Double
</span><a href="A2048.Config.html#_boardGapSize"><span class="hs-identifier hs-var">_boardGapSize</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181912"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181901"><span class="hs-identifier hs-var">_boardGapSize</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_boardBorderSize :: Double
</span><a href="A2048.Config.html#_boardBorderSize"><span class="hs-identifier hs-var">_boardBorderSize</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181912"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679181900"><span class="hs-identifier hs-var">_boardBorderSize</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- |Tile background colours.</span><span>
</span><span id="line-75"></span><span class="annot"><a href="A2048.Config.html#tileBgColours"><span class="hs-identifier hs-type">tileBgColours</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span id="tileBgColours"><span class="annot"><span class="annottext">tileBgColours :: [Texture]
</span><a href="A2048.Config.html#tileBgColours"><span class="hs-identifier hs-var hs-var">tileBgColours</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="">[rgba|eee4da|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|ede0c8|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f2b179|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f59563|]</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f67c5f|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f65e3b|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|edcf72|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|edcc61|]</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|edc850|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|edc53f|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|edc22e|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|3c3a32|]</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- |Tile foreground colours.</span><span>
</span><span id="line-83"></span><span class="annot"><a href="A2048.Config.html#tileFgColours"><span class="hs-identifier hs-type">tileFgColours</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span id="tileFgColours"><span class="annot"><span class="annottext">tileFgColours :: [Texture]
</span><a href="A2048.Config.html#tileFgColours"><span class="hs-identifier hs-var hs-var">tileFgColours</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="">[rgba|776e65|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|776e65|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[rgba|f9f6f2|]</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- |Short-cut for tile background colour.</span><span>
</span><span id="line-91"></span><span id="local-6989586621679181894"><span class="annot"><a href="A2048.Config.html#tileFillColourOf"><span class="hs-identifier hs-type">tileFillColourOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="A2048.Config.html#HasGame2048Config"><span class="hs-identifier hs-type">HasGame2048Config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181894"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181894"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span></span><span>
</span><span id="line-92"></span><span id="tileFillColourOf"><span class="annot"><span class="annottext">tileFillColourOf :: Int -&gt; c -&gt; Texture
</span><a href="A2048.Config.html#tileFillColourOf"><span class="hs-identifier hs-var hs-var">tileFillColourOf</span></a></span></span><span> </span><span id="local-6989586621679181892"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181892"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679181891"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679181891"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting [Texture] c [Texture] -&gt; c -&gt; [Texture]
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting [Texture] c [Texture]
forall c. HasGame2048Config c =&gt; Lens' c [Texture]
</span><a href="A2048.Config.html#tileFillColour"><span class="hs-identifier hs-var">tileFillColour</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679181891"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">[Texture] -&gt; Int -&gt; Texture
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181892"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- |Short-cut for tile foreground colour.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679181888"><span class="annot"><a href="A2048.Config.html#tileTextColourOf"><span class="hs-identifier hs-type">tileTextColourOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="A2048.Config.html#HasGame2048Config"><span class="hs-identifier hs-type">HasGame2048Config</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679181888"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679181888"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Texture</span></span></span><span>
</span><span id="line-96"></span><span id="tileTextColourOf"><span class="annot"><span class="annottext">tileTextColourOf :: Int -&gt; c -&gt; Texture
</span><a href="A2048.Config.html#tileTextColourOf"><span class="hs-identifier hs-var hs-var">tileTextColourOf</span></a></span></span><span> </span><span id="local-6989586621679181886"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181886"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679181885"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679181885"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting [Texture] c [Texture] -&gt; c -&gt; [Texture]
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting [Texture] c [Texture]
forall c. HasGame2048Config c =&gt; Lens' c [Texture]
</span><a href="A2048.Config.html#tileTextColour"><span class="hs-identifier hs-var">tileTextColour</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679181885"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">[Texture] -&gt; Int -&gt; Texture
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679181886"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span></pre></body></html>