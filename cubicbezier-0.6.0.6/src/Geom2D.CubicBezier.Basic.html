<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns, CPP, FlexibleInstances, MultiParamTypeClasses, DeriveTraversable, ViewPatterns, PatternSynonyms, MultiWayIf #-}</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geom2D.CubicBezier.Basic</span><span>
</span><span id="line-4"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier">QuadBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier">AnyBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier">GenericBezier</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier">PathJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier">ClosedPath</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier">OpenPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#anyToCubic"><span class="hs-identifier">anyToCubic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#anyToQuad"><span class="hs-identifier">anyToQuad</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#openPathCurves"><span class="hs-identifier">openPathCurves</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closedPathCurves"><span class="hs-identifier">closedPathCurves</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier">curvesToOpen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#curvesToClosed"><span class="hs-identifier">curvesToClosed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#consOpenPath"><span class="hs-identifier">consOpenPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#consClosedPath"><span class="hs-identifier">consClosedPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#openClosedPath"><span class="hs-identifier">openClosedPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closeOpenPath"><span class="hs-identifier">closeOpenPath</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-8"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParam"><span class="hs-identifier">bezierParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-identifier">bezierParamTolerance</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-identifier">reorient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierToBernstein"><span class="hs-identifier">bezierToBernstein</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-identifier">evalBezierDerivs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-identifier">evalBezier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier">evalBezierDeriv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier">findBezierTangent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#quadToCubic"><span class="hs-identifier">quadToCubic</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierHoriz"><span class="hs-identifier">bezierHoriz</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierVert"><span class="hs-identifier">bezierVert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findBezierInflection"><span class="hs-identifier">findBezierInflection</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findBezierCusp"><span class="hs-identifier">findBezierCusp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierArc"><span class="hs-identifier">bezierArc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLength"><span class="hs-identifier">arcLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLengthParam"><span class="hs-identifier">arcLengthParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier">splitBezier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-identifier">bezierSubsegment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-identifier">splitBezierN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#colinear"><span class="hs-identifier">colinear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closest"><span class="hs-identifier">closest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findX"><span class="hs-identifier">findX</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.html"><span class="hs-identifier">Geom2D</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Numeric.html"><span class="hs-identifier">Geom2D.CubicBezier.Numeric</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Math.BernsteinPoly.html"><span class="hs-identifier">Math.BernsteinPoly</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.Integration.TanhSinh</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Semigroup</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">minimumBy</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.VectorSpace</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed.Mutable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MV</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | A cubic bezier curve.</span><span>
</span><span id="line-31"></span><span class="hs-keyword">data</span><span> </span><span id="CubicBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span></span><span> </span><span id="local-6989586621679237325"><span class="annot"><a href="#local-6989586621679237325"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CubicBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-32"></span><span>  </span><span id="cubicC0"><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC0"><span class="hs-identifier hs-var hs-var">cubicC0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span id="cubicC1"><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC1"><span class="hs-identifier hs-var hs-var">cubicC1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span id="cubicC2"><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC2"><span class="hs-identifier hs-var hs-var">cubicC2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span id="cubicC3"><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC3"><span class="hs-identifier hs-var hs-var">cubicC3</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237005"><span id="local-6989586621679237007"><span class="annot"><span class="annottext">CubicBezier a -&gt; CubicBezier a -&gt; Bool
(CubicBezier a -&gt; CubicBezier a -&gt; Bool)
-&gt; (CubicBezier a -&gt; CubicBezier a -&gt; Bool) -&gt; Eq (CubicBezier a)
forall a. Eq a =&gt; CubicBezier a -&gt; CubicBezier a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CubicBezier a -&gt; CubicBezier a -&gt; Bool
$c/= :: forall a. Eq a =&gt; CubicBezier a -&gt; CubicBezier a -&gt; Bool
== :: CubicBezier a -&gt; CubicBezier a -&gt; Bool
$c== :: forall a. Eq a =&gt; CubicBezier a -&gt; CubicBezier a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236998"><span id="local-6989586621679237000"><span id="local-6989586621679237002"><span class="annot"><span class="annottext">Int -&gt; CubicBezier a -&gt; ShowS
[CubicBezier a] -&gt; ShowS
CubicBezier a -&gt; String
(Int -&gt; CubicBezier a -&gt; ShowS)
-&gt; (CubicBezier a -&gt; String)
-&gt; ([CubicBezier a] -&gt; ShowS)
-&gt; Show (CubicBezier a)
forall a. Show a =&gt; Int -&gt; CubicBezier a -&gt; ShowS
forall a. Show a =&gt; [CubicBezier a] -&gt; ShowS
forall a. Show a =&gt; CubicBezier a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CubicBezier a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [CubicBezier a] -&gt; ShowS
show :: CubicBezier a -&gt; String
$cshow :: forall a. Show a =&gt; CubicBezier a -&gt; String
showsPrec :: Int -&gt; CubicBezier a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; CubicBezier a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236993"><span id="local-6989586621679236995"><span class="annot"><span class="annottext">a -&gt; CubicBezier b -&gt; CubicBezier a
(a -&gt; b) -&gt; CubicBezier a -&gt; CubicBezier b
(forall a b. (a -&gt; b) -&gt; CubicBezier a -&gt; CubicBezier b)
-&gt; (forall a b. a -&gt; CubicBezier b -&gt; CubicBezier a)
-&gt; Functor CubicBezier
forall a b. a -&gt; CubicBezier b -&gt; CubicBezier a
forall a b. (a -&gt; b) -&gt; CubicBezier a -&gt; CubicBezier b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; CubicBezier b -&gt; CubicBezier a
$c&lt;$ :: forall a b. a -&gt; CubicBezier b -&gt; CubicBezier a
fmap :: (a -&gt; b) -&gt; CubicBezier a -&gt; CubicBezier b
$cfmap :: forall a b. (a -&gt; b) -&gt; CubicBezier a -&gt; CubicBezier b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236958"><span id="local-6989586621679236960"><span id="local-6989586621679236962"><span id="local-6989586621679236964"><span id="local-6989586621679236966"><span id="local-6989586621679236968"><span id="local-6989586621679236970"><span id="local-6989586621679236972"><span id="local-6989586621679236974"><span id="local-6989586621679236976"><span id="local-6989586621679236978"><span id="local-6989586621679236980"><span id="local-6989586621679236982"><span id="local-6989586621679236984"><span id="local-6989586621679236986"><span id="local-6989586621679236988"><span id="local-6989586621679236990"><span class="annot"><span class="annottext">CubicBezier a -&gt; Bool
(a -&gt; m) -&gt; CubicBezier a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
(forall m. Monoid m =&gt; CubicBezier m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CubicBezier a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CubicBezier a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a)
-&gt; (forall a. CubicBezier a -&gt; [a])
-&gt; (forall a. CubicBezier a -&gt; Bool)
-&gt; (forall a. CubicBezier a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; CubicBezier a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; CubicBezier a -&gt; a)
-&gt; (forall a. Ord a =&gt; CubicBezier a -&gt; a)
-&gt; (forall a. Num a =&gt; CubicBezier a -&gt; a)
-&gt; (forall a. Num a =&gt; CubicBezier a -&gt; a)
-&gt; Foldable CubicBezier
forall a. Eq a =&gt; a -&gt; CubicBezier a -&gt; Bool
forall a. Num a =&gt; CubicBezier a -&gt; a
forall a. Ord a =&gt; CubicBezier a -&gt; a
forall m. Monoid m =&gt; CubicBezier m -&gt; m
forall a. CubicBezier a -&gt; Bool
forall a. CubicBezier a -&gt; Int
forall a. CubicBezier a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CubicBezier a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: CubicBezier a -&gt; a
$cproduct :: forall a. Num a =&gt; CubicBezier a -&gt; a
sum :: CubicBezier a -&gt; a
$csum :: forall a. Num a =&gt; CubicBezier a -&gt; a
minimum :: CubicBezier a -&gt; a
$cminimum :: forall a. Ord a =&gt; CubicBezier a -&gt; a
maximum :: CubicBezier a -&gt; a
$cmaximum :: forall a. Ord a =&gt; CubicBezier a -&gt; a
elem :: a -&gt; CubicBezier a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; CubicBezier a -&gt; Bool
length :: CubicBezier a -&gt; Int
$clength :: forall a. CubicBezier a -&gt; Int
null :: CubicBezier a -&gt; Bool
$cnull :: forall a. CubicBezier a -&gt; Bool
toList :: CubicBezier a -&gt; [a]
$ctoList :: forall a. CubicBezier a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; CubicBezier a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; CubicBezier a -&gt; b
foldMap' :: (a -&gt; m) -&gt; CubicBezier a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CubicBezier a -&gt; m
foldMap :: (a -&gt; m) -&gt; CubicBezier a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; CubicBezier a -&gt; m
fold :: CubicBezier m -&gt; m
$cfold :: forall m. Monoid m =&gt; CubicBezier m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236947"><span id="local-6989586621679236949"><span id="local-6989586621679236951"><span id="local-6989586621679236953"><span class="annot"><span class="annottext">Functor CubicBezier
Foldable CubicBezier
Functor CubicBezier
-&gt; Foldable CubicBezier
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; CubicBezier a -&gt; f (CubicBezier b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    CubicBezier (f a) -&gt; f (CubicBezier a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; CubicBezier a -&gt; m (CubicBezier b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    CubicBezier (m a) -&gt; m (CubicBezier a))
-&gt; Traversable CubicBezier
(a -&gt; f b) -&gt; CubicBezier a -&gt; f (CubicBezier b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
CubicBezier (m a) -&gt; m (CubicBezier a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
CubicBezier (f a) -&gt; f (CubicBezier a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; CubicBezier a -&gt; m (CubicBezier b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; CubicBezier a -&gt; f (CubicBezier b)
sequence :: CubicBezier (m a) -&gt; m (CubicBezier a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
CubicBezier (m a) -&gt; m (CubicBezier a)
mapM :: (a -&gt; m b) -&gt; CubicBezier a -&gt; m (CubicBezier b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; CubicBezier a -&gt; m (CubicBezier b)
sequenceA :: CubicBezier (f a) -&gt; f (CubicBezier a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
CubicBezier (f a) -&gt; f (CubicBezier a)
traverse :: (a -&gt; f b) -&gt; CubicBezier a -&gt; f (CubicBezier b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; CubicBezier a -&gt; f (CubicBezier b)
$cp2Traversable :: Foldable CubicBezier
$cp1Traversable :: Functor CubicBezier
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | A quadratic bezier curve.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="QuadBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span></span><span> </span><span id="local-6989586621679237315"><span class="annot"><a href="#local-6989586621679237315"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QuadBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-40"></span><span>  </span><span id="quadC0"><span class="annot"><span class="annottext">QuadBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#quadC0"><span class="hs-identifier hs-var hs-var">quadC0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237315"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span id="quadC1"><span class="annot"><span class="annottext">QuadBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#quadC1"><span class="hs-identifier hs-var hs-var">quadC1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237315"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span id="quadC2"><span class="annot"><span class="annottext">QuadBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#quadC2"><span class="hs-identifier hs-var hs-var">quadC2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237315"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236938"><span id="local-6989586621679236940"><span class="annot"><span class="annottext">QuadBezier a -&gt; QuadBezier a -&gt; Bool
(QuadBezier a -&gt; QuadBezier a -&gt; Bool)
-&gt; (QuadBezier a -&gt; QuadBezier a -&gt; Bool) -&gt; Eq (QuadBezier a)
forall a. Eq a =&gt; QuadBezier a -&gt; QuadBezier a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: QuadBezier a -&gt; QuadBezier a -&gt; Bool
$c/= :: forall a. Eq a =&gt; QuadBezier a -&gt; QuadBezier a -&gt; Bool
== :: QuadBezier a -&gt; QuadBezier a -&gt; Bool
$c== :: forall a. Eq a =&gt; QuadBezier a -&gt; QuadBezier a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236932"><span id="local-6989586621679236934"><span id="local-6989586621679236936"><span class="annot"><span class="annottext">Int -&gt; QuadBezier a -&gt; ShowS
[QuadBezier a] -&gt; ShowS
QuadBezier a -&gt; String
(Int -&gt; QuadBezier a -&gt; ShowS)
-&gt; (QuadBezier a -&gt; String)
-&gt; ([QuadBezier a] -&gt; ShowS)
-&gt; Show (QuadBezier a)
forall a. Show a =&gt; Int -&gt; QuadBezier a -&gt; ShowS
forall a. Show a =&gt; [QuadBezier a] -&gt; ShowS
forall a. Show a =&gt; QuadBezier a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [QuadBezier a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [QuadBezier a] -&gt; ShowS
show :: QuadBezier a -&gt; String
$cshow :: forall a. Show a =&gt; QuadBezier a -&gt; String
showsPrec :: Int -&gt; QuadBezier a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; QuadBezier a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236928"><span id="local-6989586621679236930"><span class="annot"><span class="annottext">a -&gt; QuadBezier b -&gt; QuadBezier a
(a -&gt; b) -&gt; QuadBezier a -&gt; QuadBezier b
(forall a b. (a -&gt; b) -&gt; QuadBezier a -&gt; QuadBezier b)
-&gt; (forall a b. a -&gt; QuadBezier b -&gt; QuadBezier a)
-&gt; Functor QuadBezier
forall a b. a -&gt; QuadBezier b -&gt; QuadBezier a
forall a b. (a -&gt; b) -&gt; QuadBezier a -&gt; QuadBezier b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; QuadBezier b -&gt; QuadBezier a
$c&lt;$ :: forall a b. a -&gt; QuadBezier b -&gt; QuadBezier a
fmap :: (a -&gt; b) -&gt; QuadBezier a -&gt; QuadBezier b
$cfmap :: forall a b. (a -&gt; b) -&gt; QuadBezier a -&gt; QuadBezier b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236894"><span id="local-6989586621679236896"><span id="local-6989586621679236898"><span id="local-6989586621679236900"><span id="local-6989586621679236902"><span id="local-6989586621679236904"><span id="local-6989586621679236906"><span id="local-6989586621679236908"><span id="local-6989586621679236910"><span id="local-6989586621679236912"><span id="local-6989586621679236914"><span id="local-6989586621679236916"><span id="local-6989586621679236918"><span id="local-6989586621679236920"><span id="local-6989586621679236922"><span id="local-6989586621679236924"><span id="local-6989586621679236926"><span class="annot"><span class="annottext">QuadBezier a -&gt; Bool
(a -&gt; m) -&gt; QuadBezier a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
(forall m. Monoid m =&gt; QuadBezier m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadBezier a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadBezier a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a)
-&gt; (forall a. QuadBezier a -&gt; [a])
-&gt; (forall a. QuadBezier a -&gt; Bool)
-&gt; (forall a. QuadBezier a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; QuadBezier a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; QuadBezier a -&gt; a)
-&gt; (forall a. Ord a =&gt; QuadBezier a -&gt; a)
-&gt; (forall a. Num a =&gt; QuadBezier a -&gt; a)
-&gt; (forall a. Num a =&gt; QuadBezier a -&gt; a)
-&gt; Foldable QuadBezier
forall a. Eq a =&gt; a -&gt; QuadBezier a -&gt; Bool
forall a. Num a =&gt; QuadBezier a -&gt; a
forall a. Ord a =&gt; QuadBezier a -&gt; a
forall m. Monoid m =&gt; QuadBezier m -&gt; m
forall a. QuadBezier a -&gt; Bool
forall a. QuadBezier a -&gt; Int
forall a. QuadBezier a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadBezier a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: QuadBezier a -&gt; a
$cproduct :: forall a. Num a =&gt; QuadBezier a -&gt; a
sum :: QuadBezier a -&gt; a
$csum :: forall a. Num a =&gt; QuadBezier a -&gt; a
minimum :: QuadBezier a -&gt; a
$cminimum :: forall a. Ord a =&gt; QuadBezier a -&gt; a
maximum :: QuadBezier a -&gt; a
$cmaximum :: forall a. Ord a =&gt; QuadBezier a -&gt; a
elem :: a -&gt; QuadBezier a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; QuadBezier a -&gt; Bool
length :: QuadBezier a -&gt; Int
$clength :: forall a. QuadBezier a -&gt; Int
null :: QuadBezier a -&gt; Bool
$cnull :: forall a. QuadBezier a -&gt; Bool
toList :: QuadBezier a -&gt; [a]
$ctoList :: forall a. QuadBezier a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; QuadBezier a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadBezier a -&gt; b
foldMap' :: (a -&gt; m) -&gt; QuadBezier a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadBezier a -&gt; m
foldMap :: (a -&gt; m) -&gt; QuadBezier a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadBezier a -&gt; m
fold :: QuadBezier m -&gt; m
$cfold :: forall m. Monoid m =&gt; QuadBezier m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236884"><span id="local-6989586621679236886"><span id="local-6989586621679236888"><span id="local-6989586621679236890"><span class="annot"><span class="annottext">Functor QuadBezier
Foldable QuadBezier
Functor QuadBezier
-&gt; Foldable QuadBezier
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; QuadBezier a -&gt; f (QuadBezier b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    QuadBezier (f a) -&gt; f (QuadBezier a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; QuadBezier a -&gt; m (QuadBezier b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    QuadBezier (m a) -&gt; m (QuadBezier a))
-&gt; Traversable QuadBezier
(a -&gt; f b) -&gt; QuadBezier a -&gt; f (QuadBezier b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
QuadBezier (m a) -&gt; m (QuadBezier a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
QuadBezier (f a) -&gt; f (QuadBezier a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; QuadBezier a -&gt; m (QuadBezier b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; QuadBezier a -&gt; f (QuadBezier b)
sequence :: QuadBezier (m a) -&gt; m (QuadBezier a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
QuadBezier (m a) -&gt; m (QuadBezier a)
mapM :: (a -&gt; m b) -&gt; QuadBezier a -&gt; m (QuadBezier b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; QuadBezier a -&gt; m (QuadBezier b)
sequenceA :: QuadBezier (f a) -&gt; f (QuadBezier a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
QuadBezier (f a) -&gt; f (QuadBezier a)
traverse :: (a -&gt; f b) -&gt; QuadBezier a -&gt; f (QuadBezier b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; QuadBezier a -&gt; f (QuadBezier b)
$cp2Traversable :: Foldable QuadBezier
$cp1Traversable :: Functor QuadBezier
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- Use a tuple, because it has 0(1) unzip when using unboxed vectors.</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | A bezier curve of any degree.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">data</span><span> </span><span id="AnyBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-var">AnyBezier</span></a></span></span><span> </span><span id="local-6989586621679237309"><span class="annot"><a href="#local-6989586621679237309"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnyBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-var">AnyBezier</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679237309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679237309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>                   </span><span>
</span><span id="line-49"></span><span class="hs-keyword">class</span><span> </span><span id="GenericBezier"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-var">GenericBezier</span></a></span></span><span> </span><span id="local-6989586621679237345"><span class="annot"><a href="#local-6989586621679237345"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621679237351"><span id="degree"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#degree"><span class="hs-identifier hs-type">degree</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237351"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237345"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237351"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679237349"><span id="toVector"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#toVector"><span class="hs-identifier hs-type">toVector</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237345"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679237349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679237349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679237347"><span id="unsafeFromVector"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#unsafeFromVector"><span class="hs-identifier hs-type">unsafeFromVector</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237347"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679237347"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679237347"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237345"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237347"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679236875"><span class="annot"><span class="annottext">degree :: CubicBezier a -&gt; Int
</span><a href="#local-6989586621679236875"><span class="hs-identifier hs-var hs-var hs-var hs-var">degree</span></a></span></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679236874"><span class="annot"><span class="annottext">toVector :: CubicBezier a -&gt; Vector (a, a)
</span><a href="#local-6989586621679236874"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVector</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236872"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236872"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621679236871"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236871"><span class="hs-identifier hs-var">ay</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236870"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236870"><span class="hs-identifier hs-var">bx</span></a></span></span><span> </span><span id="local-6989586621679236869"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236869"><span class="hs-identifier hs-var">by</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236868"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236868"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679236867"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236867"><span class="hs-identifier hs-var">cy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236866"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236866"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span id="local-6989586621679236865"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236865"><span class="hs-identifier hs-var">dy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s (a, a))) -&gt; Vector (a, a)
forall a. Unbox a =&gt; (forall s. ST s (MVector s a)) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.create</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (MVector s (a, a))) -&gt; Vector (a, a))
-&gt; (forall s. ST s (MVector s (a, a))) -&gt; Vector (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>      </span><span id="local-6989586621679236863"><span class="annot"><span class="annottext">MVector s (a, a)
</span><a href="#local-6989586621679236863"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector (PrimState (ST s)) (a, a))
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.new</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-60"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236863"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236872"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236871"><span class="hs-identifier hs-var">ay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236863"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236870"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236869"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236863"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236868"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236867"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236863"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236866"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236865"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><span class="annottext">MVector s (a, a) -&gt; ST s (MVector s (a, a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
</span><a href="#local-6989586621679236863"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679236860"><span class="annot"><span class="annottext">unsafeFromVector :: Vector (a, a) -&gt; CubicBezier a
</span><a href="#local-6989586621679236860"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeFromVector</span></a></span></span><span> </span><span id="local-6989586621679236859"><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236859"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span>
</span><span id="line-66"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236859"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236859"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236859"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236859"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621679236853"><span class="annot"><span class="annottext">degree :: QuadBezier a -&gt; Int
</span><a href="#local-6989586621679236853"><span class="hs-identifier hs-var hs-var hs-var hs-var">degree</span></a></span></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679236852"><span class="annot"><span class="annottext">toVector :: QuadBezier a -&gt; Vector (a, a)
</span><a href="#local-6989586621679236852"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVector</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236851"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236851"><span class="hs-identifier hs-var">ax</span></a></span></span><span> </span><span id="local-6989586621679236850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236850"><span class="hs-identifier hs-var">ay</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236849"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236849"><span class="hs-identifier hs-var">bx</span></a></span></span><span> </span><span id="local-6989586621679236848"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236848"><span class="hs-identifier hs-var">by</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236847"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236847"><span class="hs-identifier hs-var">cx</span></a></span></span><span> </span><span id="local-6989586621679236846"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236846"><span class="hs-identifier hs-var">cy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s (a, a))) -&gt; Vector (a, a)
forall a. Unbox a =&gt; (forall s. ST s (MVector s a)) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.create</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (MVector s (a, a))) -&gt; Vector (a, a))
-&gt; (forall s. ST s (MVector s (a, a))) -&gt; Vector (a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-76"></span><span>      </span><span id="local-6989586621679236845"><span class="annot"><span class="annottext">MVector s (a, a)
</span><a href="#local-6989586621679236845"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector (PrimState (ST s)) (a, a))
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><span class="hs-identifier hs-var">MV.new</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236845"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236851"><span class="hs-identifier hs-var">ax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236850"><span class="hs-identifier hs-var">ay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236845"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236849"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236848"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (a, a) -&gt; Int -&gt; (a, a) -&gt; ST s ()
forall (m :: * -&gt; *) a.
(PrimMonad m, Unbox a) =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">MV.write</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
MVector (PrimState (ST s)) (a, a)
</span><a href="#local-6989586621679236845"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236847"><span class="hs-identifier hs-var">cx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236846"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>      </span><span class="annot"><span class="annottext">MVector s (a, a) -&gt; ST s (MVector s (a, a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MVector s (a, a)
</span><a href="#local-6989586621679236845"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679236844"><span class="annot"><span class="annottext">unsafeFromVector :: Vector (a, a) -&gt; QuadBezier a
</span><a href="#local-6989586621679236844"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeFromVector</span></a></span></span><span> </span><span id="local-6989586621679236843"><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236843"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span>
</span><span id="line-82"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236843"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236843"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; Point a) -&gt; (a, a) -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236843"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int -&gt; (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679236839"><span class="annot"><span class="annottext">degree :: AnyBezier a -&gt; Int
</span><a href="#local-6989586621679236839"><span class="hs-identifier hs-var hs-var hs-var hs-var">degree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span id="local-6989586621679236838"><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236838"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Int
forall a. Unbox a =&gt; Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236838"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679236836"><span class="annot"><span class="annottext">toVector :: AnyBezier a -&gt; Vector (a, a)
</span><a href="#local-6989586621679236836"><span class="hs-identifier hs-var hs-var hs-var hs-var">toVector</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span id="local-6989586621679236835"><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236835"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236835"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679236834"><span class="annot"><span class="annottext">unsafeFromVector :: Vector (a, a) -&gt; AnyBezier a
</span><a href="#local-6989586621679236834"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeFromVector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; AnyBezier a
forall a. Vector (a, a) -&gt; AnyBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-var">AnyBezier</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">data</span><span> </span><span id="PathJoin"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-var">PathJoin</span></a></span></span><span> </span><span id="local-6989586621679237173"><span class="annot"><a href="#local-6989586621679237173"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="JoinLine"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span></span><span> </span><span class="hs-glyph">|</span><span>
</span><span id="line-92"></span><span>                  </span><span id="JoinCurve"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237173"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237173"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>              </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236826"><span id="local-6989586621679236828"><span id="local-6989586621679236830"><span class="annot"><span class="annottext">Int -&gt; PathJoin a -&gt; ShowS
[PathJoin a] -&gt; ShowS
PathJoin a -&gt; String
(Int -&gt; PathJoin a -&gt; ShowS)
-&gt; (PathJoin a -&gt; String)
-&gt; ([PathJoin a] -&gt; ShowS)
-&gt; Show (PathJoin a)
forall a. Show a =&gt; Int -&gt; PathJoin a -&gt; ShowS
forall a. Show a =&gt; [PathJoin a] -&gt; ShowS
forall a. Show a =&gt; PathJoin a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PathJoin a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [PathJoin a] -&gt; ShowS
show :: PathJoin a -&gt; String
$cshow :: forall a. Show a =&gt; PathJoin a -&gt; String
showsPrec :: Int -&gt; PathJoin a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; PathJoin a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236822"><span id="local-6989586621679236824"><span class="annot"><span class="annottext">a -&gt; PathJoin b -&gt; PathJoin a
(a -&gt; b) -&gt; PathJoin a -&gt; PathJoin b
(forall a b. (a -&gt; b) -&gt; PathJoin a -&gt; PathJoin b)
-&gt; (forall a b. a -&gt; PathJoin b -&gt; PathJoin a) -&gt; Functor PathJoin
forall a b. a -&gt; PathJoin b -&gt; PathJoin a
forall a b. (a -&gt; b) -&gt; PathJoin a -&gt; PathJoin b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; PathJoin b -&gt; PathJoin a
$c&lt;$ :: forall a b. a -&gt; PathJoin b -&gt; PathJoin a
fmap :: (a -&gt; b) -&gt; PathJoin a -&gt; PathJoin b
$cfmap :: forall a b. (a -&gt; b) -&gt; PathJoin a -&gt; PathJoin b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236788"><span id="local-6989586621679236790"><span id="local-6989586621679236792"><span id="local-6989586621679236794"><span id="local-6989586621679236796"><span id="local-6989586621679236798"><span id="local-6989586621679236800"><span id="local-6989586621679236802"><span id="local-6989586621679236804"><span id="local-6989586621679236806"><span id="local-6989586621679236808"><span id="local-6989586621679236810"><span id="local-6989586621679236812"><span id="local-6989586621679236814"><span id="local-6989586621679236816"><span id="local-6989586621679236818"><span id="local-6989586621679236820"><span class="annot"><span class="annottext">PathJoin a -&gt; Bool
(a -&gt; m) -&gt; PathJoin a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
(forall m. Monoid m =&gt; PathJoin m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; PathJoin a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; PathJoin a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a)
-&gt; (forall a. PathJoin a -&gt; [a])
-&gt; (forall a. PathJoin a -&gt; Bool)
-&gt; (forall a. PathJoin a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; PathJoin a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; PathJoin a -&gt; a)
-&gt; (forall a. Ord a =&gt; PathJoin a -&gt; a)
-&gt; (forall a. Num a =&gt; PathJoin a -&gt; a)
-&gt; (forall a. Num a =&gt; PathJoin a -&gt; a)
-&gt; Foldable PathJoin
forall a. Eq a =&gt; a -&gt; PathJoin a -&gt; Bool
forall a. Num a =&gt; PathJoin a -&gt; a
forall a. Ord a =&gt; PathJoin a -&gt; a
forall m. Monoid m =&gt; PathJoin m -&gt; m
forall a. PathJoin a -&gt; Bool
forall a. PathJoin a -&gt; Int
forall a. PathJoin a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; PathJoin a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: PathJoin a -&gt; a
$cproduct :: forall a. Num a =&gt; PathJoin a -&gt; a
sum :: PathJoin a -&gt; a
$csum :: forall a. Num a =&gt; PathJoin a -&gt; a
minimum :: PathJoin a -&gt; a
$cminimum :: forall a. Ord a =&gt; PathJoin a -&gt; a
maximum :: PathJoin a -&gt; a
$cmaximum :: forall a. Ord a =&gt; PathJoin a -&gt; a
elem :: a -&gt; PathJoin a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; PathJoin a -&gt; Bool
length :: PathJoin a -&gt; Int
$clength :: forall a. PathJoin a -&gt; Int
null :: PathJoin a -&gt; Bool
$cnull :: forall a. PathJoin a -&gt; Bool
toList :: PathJoin a -&gt; [a]
$ctoList :: forall a. PathJoin a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; PathJoin a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; PathJoin a -&gt; b
foldMap' :: (a -&gt; m) -&gt; PathJoin a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; PathJoin a -&gt; m
foldMap :: (a -&gt; m) -&gt; PathJoin a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; PathJoin a -&gt; m
fold :: PathJoin m -&gt; m
$cfold :: forall m. Monoid m =&gt; PathJoin m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236778"><span id="local-6989586621679236780"><span id="local-6989586621679236782"><span id="local-6989586621679236784"><span class="annot"><span class="annottext">Functor PathJoin
Foldable PathJoin
Functor PathJoin
-&gt; Foldable PathJoin
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; PathJoin a -&gt; f (PathJoin b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    PathJoin (f a) -&gt; f (PathJoin a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; PathJoin a -&gt; m (PathJoin b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    PathJoin (m a) -&gt; m (PathJoin a))
-&gt; Traversable PathJoin
(a -&gt; f b) -&gt; PathJoin a -&gt; f (PathJoin b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; PathJoin (m a) -&gt; m (PathJoin a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
PathJoin (f a) -&gt; f (PathJoin a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; PathJoin a -&gt; m (PathJoin b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; PathJoin a -&gt; f (PathJoin b)
sequence :: PathJoin (m a) -&gt; m (PathJoin a)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; PathJoin (m a) -&gt; m (PathJoin a)
mapM :: (a -&gt; m b) -&gt; PathJoin a -&gt; m (PathJoin b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; PathJoin a -&gt; m (PathJoin b)
sequenceA :: PathJoin (f a) -&gt; f (PathJoin a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
PathJoin (f a) -&gt; f (PathJoin a)
traverse :: (a -&gt; f b) -&gt; PathJoin a -&gt; f (PathJoin b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; PathJoin a -&gt; f (PathJoin b)
$cp2Traversable :: Foldable PathJoin
$cp1Traversable :: Functor PathJoin
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">data</span><span> </span><span id="OpenPath"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span></span><span> </span><span id="local-6989586621679237186"><span class="annot"><a href="#local-6989586621679237186"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OpenPath"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237186"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237186"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237186"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-95"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236771"><span id="local-6989586621679236773"><span id="local-6989586621679236775"><span class="annot"><span class="annottext">Int -&gt; OpenPath a -&gt; ShowS
[OpenPath a] -&gt; ShowS
OpenPath a -&gt; String
(Int -&gt; OpenPath a -&gt; ShowS)
-&gt; (OpenPath a -&gt; String)
-&gt; ([OpenPath a] -&gt; ShowS)
-&gt; Show (OpenPath a)
forall a. Show a =&gt; Int -&gt; OpenPath a -&gt; ShowS
forall a. Show a =&gt; [OpenPath a] -&gt; ShowS
forall a. Show a =&gt; OpenPath a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OpenPath a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [OpenPath a] -&gt; ShowS
show :: OpenPath a -&gt; String
$cshow :: forall a. Show a =&gt; OpenPath a -&gt; String
showsPrec :: Int -&gt; OpenPath a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; OpenPath a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236767"><span id="local-6989586621679236769"><span class="annot"><span class="annottext">a -&gt; OpenPath b -&gt; OpenPath a
(a -&gt; b) -&gt; OpenPath a -&gt; OpenPath b
(forall a b. (a -&gt; b) -&gt; OpenPath a -&gt; OpenPath b)
-&gt; (forall a b. a -&gt; OpenPath b -&gt; OpenPath a) -&gt; Functor OpenPath
forall a b. a -&gt; OpenPath b -&gt; OpenPath a
forall a b. (a -&gt; b) -&gt; OpenPath a -&gt; OpenPath b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; OpenPath b -&gt; OpenPath a
$c&lt;$ :: forall a b. a -&gt; OpenPath b -&gt; OpenPath a
fmap :: (a -&gt; b) -&gt; OpenPath a -&gt; OpenPath b
$cfmap :: forall a b. (a -&gt; b) -&gt; OpenPath a -&gt; OpenPath b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236733"><span id="local-6989586621679236735"><span id="local-6989586621679236737"><span id="local-6989586621679236739"><span id="local-6989586621679236741"><span id="local-6989586621679236743"><span id="local-6989586621679236745"><span id="local-6989586621679236747"><span id="local-6989586621679236749"><span id="local-6989586621679236751"><span id="local-6989586621679236753"><span id="local-6989586621679236755"><span id="local-6989586621679236757"><span id="local-6989586621679236759"><span id="local-6989586621679236761"><span id="local-6989586621679236763"><span id="local-6989586621679236765"><span class="annot"><span class="annottext">OpenPath a -&gt; Bool
(a -&gt; m) -&gt; OpenPath a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
(forall m. Monoid m =&gt; OpenPath m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenPath a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenPath a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a)
-&gt; (forall a. OpenPath a -&gt; [a])
-&gt; (forall a. OpenPath a -&gt; Bool)
-&gt; (forall a. OpenPath a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; OpenPath a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; OpenPath a -&gt; a)
-&gt; (forall a. Ord a =&gt; OpenPath a -&gt; a)
-&gt; (forall a. Num a =&gt; OpenPath a -&gt; a)
-&gt; (forall a. Num a =&gt; OpenPath a -&gt; a)
-&gt; Foldable OpenPath
forall a. Eq a =&gt; a -&gt; OpenPath a -&gt; Bool
forall a. Num a =&gt; OpenPath a -&gt; a
forall a. Ord a =&gt; OpenPath a -&gt; a
forall m. Monoid m =&gt; OpenPath m -&gt; m
forall a. OpenPath a -&gt; Bool
forall a. OpenPath a -&gt; Int
forall a. OpenPath a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenPath a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: OpenPath a -&gt; a
$cproduct :: forall a. Num a =&gt; OpenPath a -&gt; a
sum :: OpenPath a -&gt; a
$csum :: forall a. Num a =&gt; OpenPath a -&gt; a
minimum :: OpenPath a -&gt; a
$cminimum :: forall a. Ord a =&gt; OpenPath a -&gt; a
maximum :: OpenPath a -&gt; a
$cmaximum :: forall a. Ord a =&gt; OpenPath a -&gt; a
elem :: a -&gt; OpenPath a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; OpenPath a -&gt; Bool
length :: OpenPath a -&gt; Int
$clength :: forall a. OpenPath a -&gt; Int
null :: OpenPath a -&gt; Bool
$cnull :: forall a. OpenPath a -&gt; Bool
toList :: OpenPath a -&gt; [a]
$ctoList :: forall a. OpenPath a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; OpenPath a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenPath a -&gt; b
foldMap' :: (a -&gt; m) -&gt; OpenPath a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenPath a -&gt; m
foldMap :: (a -&gt; m) -&gt; OpenPath a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenPath a -&gt; m
fold :: OpenPath m -&gt; m
$cfold :: forall m. Monoid m =&gt; OpenPath m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236723"><span id="local-6989586621679236725"><span id="local-6989586621679236727"><span id="local-6989586621679236729"><span class="annot"><span class="annottext">Functor OpenPath
Foldable OpenPath
Functor OpenPath
-&gt; Foldable OpenPath
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; OpenPath a -&gt; f (OpenPath b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    OpenPath (f a) -&gt; f (OpenPath a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; OpenPath a -&gt; m (OpenPath b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    OpenPath (m a) -&gt; m (OpenPath a))
-&gt; Traversable OpenPath
(a -&gt; f b) -&gt; OpenPath a -&gt; f (OpenPath b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; OpenPath (m a) -&gt; m (OpenPath a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
OpenPath (f a) -&gt; f (OpenPath a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; OpenPath a -&gt; m (OpenPath b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; OpenPath a -&gt; f (OpenPath b)
sequence :: OpenPath (m a) -&gt; m (OpenPath a)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; OpenPath (m a) -&gt; m (OpenPath a)
mapM :: (a -&gt; m b) -&gt; OpenPath a -&gt; m (OpenPath b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; OpenPath a -&gt; m (OpenPath b)
sequenceA :: OpenPath (f a) -&gt; f (OpenPath a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
OpenPath (f a) -&gt; f (OpenPath a)
traverse :: (a -&gt; f b) -&gt; OpenPath a -&gt; f (OpenPath b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; OpenPath a -&gt; f (OpenPath b)
$cp2Traversable :: Foldable OpenPath
$cp1Traversable :: Functor OpenPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">data</span><span> </span><span id="ClosedPath"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span></span><span> </span><span id="local-6989586621679237166"><span class="annot"><a href="#local-6989586621679237166"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClosedPath"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237166"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237166"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236716"><span id="local-6989586621679236718"><span id="local-6989586621679236720"><span class="annot"><span class="annottext">Int -&gt; ClosedPath a -&gt; ShowS
[ClosedPath a] -&gt; ShowS
ClosedPath a -&gt; String
(Int -&gt; ClosedPath a -&gt; ShowS)
-&gt; (ClosedPath a -&gt; String)
-&gt; ([ClosedPath a] -&gt; ShowS)
-&gt; Show (ClosedPath a)
forall a. Show a =&gt; Int -&gt; ClosedPath a -&gt; ShowS
forall a. Show a =&gt; [ClosedPath a] -&gt; ShowS
forall a. Show a =&gt; ClosedPath a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ClosedPath a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [ClosedPath a] -&gt; ShowS
show :: ClosedPath a -&gt; String
$cshow :: forall a. Show a =&gt; ClosedPath a -&gt; String
showsPrec :: Int -&gt; ClosedPath a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; ClosedPath a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236712"><span id="local-6989586621679236714"><span class="annot"><span class="annottext">a -&gt; ClosedPath b -&gt; ClosedPath a
(a -&gt; b) -&gt; ClosedPath a -&gt; ClosedPath b
(forall a b. (a -&gt; b) -&gt; ClosedPath a -&gt; ClosedPath b)
-&gt; (forall a b. a -&gt; ClosedPath b -&gt; ClosedPath a)
-&gt; Functor ClosedPath
forall a b. a -&gt; ClosedPath b -&gt; ClosedPath a
forall a b. (a -&gt; b) -&gt; ClosedPath a -&gt; ClosedPath b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; ClosedPath b -&gt; ClosedPath a
$c&lt;$ :: forall a b. a -&gt; ClosedPath b -&gt; ClosedPath a
fmap :: (a -&gt; b) -&gt; ClosedPath a -&gt; ClosedPath b
$cfmap :: forall a b. (a -&gt; b) -&gt; ClosedPath a -&gt; ClosedPath b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236678"><span id="local-6989586621679236680"><span id="local-6989586621679236682"><span id="local-6989586621679236684"><span id="local-6989586621679236686"><span id="local-6989586621679236688"><span id="local-6989586621679236690"><span id="local-6989586621679236692"><span id="local-6989586621679236694"><span id="local-6989586621679236696"><span id="local-6989586621679236698"><span id="local-6989586621679236700"><span id="local-6989586621679236702"><span id="local-6989586621679236704"><span id="local-6989586621679236706"><span id="local-6989586621679236708"><span id="local-6989586621679236710"><span class="annot"><span class="annottext">ClosedPath a -&gt; Bool
(a -&gt; m) -&gt; ClosedPath a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
(forall m. Monoid m =&gt; ClosedPath m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedPath a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedPath a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a)
-&gt; (forall a. ClosedPath a -&gt; [a])
-&gt; (forall a. ClosedPath a -&gt; Bool)
-&gt; (forall a. ClosedPath a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; ClosedPath a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; ClosedPath a -&gt; a)
-&gt; (forall a. Ord a =&gt; ClosedPath a -&gt; a)
-&gt; (forall a. Num a =&gt; ClosedPath a -&gt; a)
-&gt; (forall a. Num a =&gt; ClosedPath a -&gt; a)
-&gt; Foldable ClosedPath
forall a. Eq a =&gt; a -&gt; ClosedPath a -&gt; Bool
forall a. Num a =&gt; ClosedPath a -&gt; a
forall a. Ord a =&gt; ClosedPath a -&gt; a
forall m. Monoid m =&gt; ClosedPath m -&gt; m
forall a. ClosedPath a -&gt; Bool
forall a. ClosedPath a -&gt; Int
forall a. ClosedPath a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedPath a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: ClosedPath a -&gt; a
$cproduct :: forall a. Num a =&gt; ClosedPath a -&gt; a
sum :: ClosedPath a -&gt; a
$csum :: forall a. Num a =&gt; ClosedPath a -&gt; a
minimum :: ClosedPath a -&gt; a
$cminimum :: forall a. Ord a =&gt; ClosedPath a -&gt; a
maximum :: ClosedPath a -&gt; a
$cmaximum :: forall a. Ord a =&gt; ClosedPath a -&gt; a
elem :: a -&gt; ClosedPath a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; ClosedPath a -&gt; Bool
length :: ClosedPath a -&gt; Int
$clength :: forall a. ClosedPath a -&gt; Int
null :: ClosedPath a -&gt; Bool
$cnull :: forall a. ClosedPath a -&gt; Bool
toList :: ClosedPath a -&gt; [a]
$ctoList :: forall a. ClosedPath a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; ClosedPath a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedPath a -&gt; b
foldMap' :: (a -&gt; m) -&gt; ClosedPath a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedPath a -&gt; m
foldMap :: (a -&gt; m) -&gt; ClosedPath a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedPath a -&gt; m
fold :: ClosedPath m -&gt; m
$cfold :: forall m. Monoid m =&gt; ClosedPath m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236668"><span id="local-6989586621679236670"><span id="local-6989586621679236672"><span id="local-6989586621679236674"><span class="annot"><span class="annottext">Functor ClosedPath
Foldable ClosedPath
Functor ClosedPath
-&gt; Foldable ClosedPath
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; ClosedPath a -&gt; f (ClosedPath b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    ClosedPath (f a) -&gt; f (ClosedPath a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; ClosedPath a -&gt; m (ClosedPath b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    ClosedPath (m a) -&gt; m (ClosedPath a))
-&gt; Traversable ClosedPath
(a -&gt; f b) -&gt; ClosedPath a -&gt; f (ClosedPath b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
ClosedPath (m a) -&gt; m (ClosedPath a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
ClosedPath (f a) -&gt; f (ClosedPath a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; ClosedPath a -&gt; m (ClosedPath b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; ClosedPath a -&gt; f (ClosedPath b)
sequence :: ClosedPath (m a) -&gt; m (ClosedPath a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
ClosedPath (m a) -&gt; m (ClosedPath a)
mapM :: (a -&gt; m b) -&gt; ClosedPath a -&gt; m (ClosedPath b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; ClosedPath a -&gt; m (ClosedPath b)
sequenceA :: ClosedPath (f a) -&gt; f (ClosedPath a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
ClosedPath (f a) -&gt; f (ClosedPath a)
traverse :: (a -&gt; f b) -&gt; ClosedPath a -&gt; f (ClosedPath b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; ClosedPath a -&gt; f (ClosedPath b)
$cp2Traversable :: Foldable ClosedPath
$cp1Traversable :: Functor ClosedPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679236667"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679236662"><span id="local-6989586621679236664"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236667"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679236660"><span class="annot"><span class="annottext">OpenPath a
</span><a href="#local-6989586621679236660"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679236659"><span class="annot"><span class="annottext">&lt;&gt; :: OpenPath a -&gt; OpenPath a -&gt; OpenPath a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenPath a
</span><a href="#local-6989586621679236660"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679236658"><span class="annot"><span class="annottext">OpenPath a
</span><a href="#local-6989586621679236658"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenPath a
</span><a href="#local-6989586621679236658"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236657"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236657"><span class="hs-identifier hs-var">joins1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236656"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236656"><span class="hs-identifier hs-var">joins2</span></a></span></span><span> </span><span id="local-6989586621679236655"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236655"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236657"><span class="hs-identifier hs-var">joins1</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236656"><span class="hs-identifier hs-var">joins2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236655"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679236654"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679236648"><span id="local-6989586621679236650"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236654"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679236646"><span class="annot"><span class="annottext">mempty :: OpenPath a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Point a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty path&quot;</span></span><span class="hs-special">)</span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span>  </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-111"></span><span id="local-6989586621679236644"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier hs-type">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236644"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679236644"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679236641"><span class="annot"><span class="annottext">transform :: Transform a -&gt; PathJoin a -&gt; PathJoin a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var hs-var hs-var hs-var">transform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathJoin a
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span id="local-6989586621679236639"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236639"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679236638"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236638"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679236637"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236637"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; PathJoin a
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236639"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236638"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236639"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236637"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621679236636"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier hs-type">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679236636"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621679236634"><span class="annot"><span class="annottext">transform :: Transform a -&gt; OpenPath a -&gt; OpenPath a
</span><a href="#local-6989586621679236634"><span class="hs-identifier hs-var hs-var hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679236633"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236633"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236632"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236632"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679236631"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236631"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Point a, PathJoin a) -&gt; (Point a, PathJoin a))
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; (Point a, PathJoin a) -&gt; (Point a, PathJoin a)
forall a.
Num a =&gt;
Transform a -&gt; (Point a, PathJoin a) -&gt; (Point a, PathJoin a)
</span><a href="Geom2D.CubicBezier.Basic.html#transformSeg"><span class="hs-identifier hs-var">transformSeg</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236633"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236632"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236633"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236631"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span id="local-6989586621679237169"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#transformSeg"><span class="hs-identifier hs-type">transformSeg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679237169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-119"></span><span id="transformSeg"><span class="annot"><span class="annottext">transformSeg :: Transform a -&gt; (Point a, PathJoin a) -&gt; (Point a, PathJoin a)
</span><a href="Geom2D.CubicBezier.Basic.html#transformSeg"><span class="hs-identifier hs-var hs-var">transformSeg</span></a></span></span><span> </span><span id="local-6989586621679236629"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236629"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236628"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236628"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236627"><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236627"><span class="hs-identifier hs-var">jn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236629"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236628"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; PathJoin a -&gt; PathJoin a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236629"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236627"><span class="hs-identifier hs-var">jn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621679236626"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier hs-type">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679236626"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679236624"><span class="annot"><span class="annottext">transform :: Transform a -&gt; ClosedPath a -&gt; ClosedPath a
</span><a href="#local-6989586621679236624"><span class="hs-identifier hs-var hs-var hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679236623"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236623"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span id="local-6989586621679236622"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236622"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; ClosedPath a
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Point a, PathJoin a) -&gt; (Point a, PathJoin a))
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; (Point a, PathJoin a) -&gt; (Point a, PathJoin a)
forall a.
Num a =&gt;
Transform a -&gt; (Point a, PathJoin a) -&gt; (Point a, PathJoin a)
</span><a href="Geom2D.CubicBezier.Basic.html#transformSeg"><span class="hs-identifier hs-var">transformSeg</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236623"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236622"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621679236621"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier hs-type">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679236621"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.html#transform"><span class="hs-pragma hs-type">transform</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-pragma hs-type">Transform</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679236619"><span class="annot"><span class="annottext">transform :: Transform a -&gt; CubicBezier a -&gt; CubicBezier a
</span><a href="#local-6989586621679236619"><span class="hs-identifier hs-var hs-var hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679236618"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236618"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236617"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236617"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621679236616"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236616"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679236615"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236615"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span id="local-6989586621679236614"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236614"><span class="hs-identifier hs-var">c3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236618"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236617"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236618"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236616"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236618"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236615"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236618"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236614"><span class="hs-identifier hs-var">c3</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621679236613"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier hs-type">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236613"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679236613"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.html#transform"><span class="hs-pragma hs-type">transform</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-pragma hs-type">Transform</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679236611"><span class="annot"><span class="annottext">transform :: Transform a -&gt; QuadBezier a -&gt; QuadBezier a
</span><a href="#local-6989586621679236611"><span class="hs-identifier hs-var hs-var hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679236610"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236610"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236609"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236609"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621679236608"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236608"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679236607"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236607"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236610"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236609"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236610"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236608"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679236610"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236607"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | construct an open path</span><span>
</span><span id="line-135"></span><span id="local-6989586621679236606"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#consOpenPath"><span class="hs-identifier hs-type">consOpenPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236606"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236606"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-136"></span><span id="consOpenPath"><span class="annot"><span class="annottext">consOpenPath :: Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#consOpenPath"><span class="hs-identifier hs-var hs-var">consOpenPath</span></a></span></span><span> </span><span id="local-6989586621679236605"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236605"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679236604"><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236604"><span class="hs-identifier hs-var">join</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236603"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236603"><span class="hs-identifier hs-var">joins</span></a></span></span><span> </span><span id="local-6989586621679236602"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236602"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236605"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236604"><span class="hs-identifier hs-var">join</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point a, PathJoin a)
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236603"><span class="hs-identifier hs-var">joins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236602"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | construct a closed path</span><span>
</span><span id="line-140"></span><span id="local-6989586621679236601"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#consClosedPath"><span class="hs-identifier hs-type">consClosedPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236601"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236601"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236601"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236601"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-141"></span><span id="consClosedPath"><span class="annot"><span class="annottext">consClosedPath :: Point a -&gt; PathJoin a -&gt; ClosedPath a -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#consClosedPath"><span class="hs-identifier hs-var hs-var">consClosedPath</span></a></span></span><span> </span><span id="local-6989586621679236600"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236600"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679236599"><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236599"><span class="hs-identifier hs-var">join</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span id="local-6989586621679236598"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236598"><span class="hs-identifier hs-var">joins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; ClosedPath a
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236600"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236599"><span class="hs-identifier hs-var">join</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point a, PathJoin a)
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236598"><span class="hs-identifier hs-var">joins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Return the open path as a list of curves.</span><span>
</span><span id="line-145"></span><span id="local-6989586621679237155"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#openPathCurves"><span class="hs-identifier hs-type">openPathCurves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679237155"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237155"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237155"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-146"></span><span id="openPathCurves"><span class="annot"><span class="annottext">openPathCurves :: OpenPath a -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Basic.html#openPathCurves"><span class="hs-identifier hs-var hs-var">openPathCurves</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236597"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236597"><span class="hs-identifier hs-var">curves</span></a></span></span><span> </span><span id="local-6989586621679236596"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236596"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; [CubicBezier a]
forall a.
Fractional a =&gt;
[(Point a, PathJoin a)] -&gt; Point a -&gt; [CubicBezier a]
</span><a href="#local-6989586621679236595"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236597"><span class="hs-identifier hs-var">curves</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236596"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679236595"><span class="annot"><span class="annottext">go :: [(Point a, PathJoin a)] -&gt; Point a -&gt; [CubicBezier a]
</span><a href="#local-6989586621679236595"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="#local-6989586621679236595"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679236594"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236594"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236593"><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236593"><span class="hs-identifier hs-var">jn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679236592"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236592"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point a -&gt; PathJoin a -&gt; Point a -&gt; CubicBezier a
forall a.
Fractional a =&gt;
Point a -&gt; PathJoin a -&gt; Point a -&gt; CubicBezier a
</span><a href="#local-6989586621679236591"><span class="hs-identifier hs-var">makeCB</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236594"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236593"><span class="hs-identifier hs-var">jn</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236592"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="#local-6989586621679236595"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679236590"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236590"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236589"><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236589"><span class="hs-identifier hs-var">jn</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679236588"><span class="annot"><span class="annottext">rest :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679236588"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679236587"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236587"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PathJoin a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236586"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236586"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">Point a -&gt; PathJoin a -&gt; Point a -&gt; CubicBezier a
forall a.
Fractional a =&gt;
Point a -&gt; PathJoin a -&gt; Point a -&gt; CubicBezier a
</span><a href="#local-6989586621679236591"><span class="hs-identifier hs-var">makeCB</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236590"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="#local-6989586621679236589"><span class="hs-identifier hs-var">jn</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236587"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a -&gt; [CubicBezier a] -&gt; [CubicBezier a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; [CubicBezier a]
</span><a href="#local-6989586621679236595"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236588"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236586"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679236591"><span class="annot"><span class="annottext">makeCB :: Point a -&gt; PathJoin a -&gt; Point a -&gt; CubicBezier a
</span><a href="#local-6989586621679236591"><span class="hs-identifier hs-var hs-var">makeCB</span></a></span></span><span> </span><span id="local-6989586621679236585"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236585"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span> </span><span id="local-6989586621679236584"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236584"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236585"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236585"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236584"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236585"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236584"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236584"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="#local-6989586621679236591"><span class="hs-identifier hs-var">makeCB</span></a></span><span> </span><span id="local-6989586621679236581"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236581"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679236580"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236580"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679236579"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236579"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236578"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236578"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236581"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236580"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236579"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236578"><span class="hs-identifier hs-var">p3</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Return the closed path as a list of curves</span><span>
</span><span id="line-159"></span><span id="local-6989586621679236577"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closedPathCurves"><span class="hs-identifier hs-type">closedPathCurves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236577"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-160"></span><span id="closedPathCurves"><span class="annot"><span class="annottext">closedPathCurves :: ClosedPath a -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Basic.html#closedPathCurves"><span class="hs-identifier hs-var hs-var">closedPathCurves</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closedPathCurves"><span class="hs-identifier hs-var">closedPathCurves</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236576"><span class="annot"><span class="annottext">cs :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679236576"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679236575"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236575"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">OpenPath a -&gt; [CubicBezier a]
forall a. Fractional a =&gt; OpenPath a -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Basic.html#openPathCurves"><span class="hs-identifier hs-var">openPathCurves</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236576"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236575"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Make an open path from a list of curves.  The last control point</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- of each curve except the last is ignored.</span><span>
</span><span id="line-166"></span><span id="local-6989586621679237151"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-type">curvesToOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237151"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237151"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-167"></span><span id="curvesToOpen"><span class="annot"><span class="annottext">curvesToOpen :: [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var hs-var">curvesToOpen</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236573"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236573"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span id="local-6989586621679236572"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236572"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679236571"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236571"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679236570"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236570"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236573"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; PathJoin a
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236572"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236571"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236570"><span class="hs-identifier hs-var">p3</span></a></span><span>
</span><span id="line-170"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236569"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236569"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span id="local-6989586621679236568"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236568"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679236567"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236567"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679236566"><span class="annot"><span class="annottext">[CubicBezier a]
</span><a href="#local-6989586621679236566"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236569"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; PathJoin a
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236568"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236567"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point a, PathJoin a)
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236565"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236564"><span class="hs-identifier hs-var">lastP</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236565"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236565"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span id="local-6989586621679236564"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236564"><span class="hs-identifier hs-var">lastP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CubicBezier a] -&gt; OpenPath a
forall a. [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[CubicBezier a]
</span><a href="#local-6989586621679236566"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Make an open path from a list of curves.  The last control point</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- of each curve is ignored.</span><span>
</span><span id="line-177"></span><span id="local-6989586621679236563"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#curvesToClosed"><span class="hs-identifier hs-type">curvesToClosed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236563"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236563"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-178"></span><span id="curvesToClosed"><span class="annot"><span class="annottext">curvesToClosed :: [CubicBezier a] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToClosed"><span class="hs-identifier hs-var hs-var">curvesToClosed</span></a></span></span><span> </span><span id="local-6989586621679236562"><span class="annot"><span class="annottext">[CubicBezier a]
</span><a href="#local-6989586621679236562"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; ClosedPath a
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236561"><span class="hs-identifier hs-var">cs2</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236561"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236561"><span class="hs-identifier hs-var">cs2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CubicBezier a] -&gt; OpenPath a
forall a. [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[CubicBezier a]
</span><a href="#local-6989586621679236562"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | close an open path, discarding the last point</span><span>
</span><span id="line-183"></span><span id="local-6989586621679236560"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closeOpenPath"><span class="hs-identifier hs-type">closeOpenPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236560"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-184"></span><span id="closeOpenPath"><span class="annot"><span class="annottext">closeOpenPath :: OpenPath a -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#closeOpenPath"><span class="hs-identifier hs-var hs-var">closeOpenPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679236559"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236559"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679236558"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236558"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; ClosedPath a
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236559"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | open a closed path</span><span>
</span><span id="line-187"></span><span id="local-6989586621679236557"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#openClosedPath"><span class="hs-identifier hs-type">openClosedPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236557"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-188"></span><span id="openClosedPath"><span class="annot"><span class="annottext">openClosedPath :: ClosedPath a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#openClosedPath"><span class="hs-identifier hs-var hs-var">openClosedPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Point a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty path&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#openClosedPath"><span class="hs-identifier hs-var">openClosedPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span id="local-6989586621679236556"><span class="annot"><span class="annottext">j :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679236556"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679236555"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236555"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PathJoin a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679236556"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236555"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | safely convert from `AnyBezier' to `CubicBezier`</span><span>
</span><span id="line-194"></span><span id="local-6989586621679236554"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#anyToCubic"><span class="hs-identifier hs-type">anyToCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679236554"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236554"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236554"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-195"></span><span id="anyToCubic"><span class="annot"><span class="annottext">anyToCubic :: AnyBezier a -&gt; Maybe (CubicBezier a)
</span><a href="Geom2D.CubicBezier.Basic.html#anyToCubic"><span class="hs-identifier hs-var hs-var">anyToCubic</span></a></span></span><span> </span><span id="local-6989586621679236553"><span class="annot"><span class="annottext">b :: AnyBezier a
</span><a href="#local-6989586621679236553"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span id="local-6989586621679236552"><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236552"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AnyBezier a -&gt; Int
forall (b :: * -&gt; *) a. (GenericBezier b, Unbox a) =&gt; b a -&gt; Int
</span><a href="Geom2D.CubicBezier.Basic.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">AnyBezier a
</span><a href="#local-6989586621679236553"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier a -&gt; Maybe (CubicBezier a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CubicBezier a -&gt; Maybe (CubicBezier a))
-&gt; CubicBezier a -&gt; Maybe (CubicBezier a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; CubicBezier a
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
Vector (a, a) -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#unsafeFromVector"><span class="hs-identifier hs-var">unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236552"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CubicBezier a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | safely convert from `AnyBezier' to `QuadBezier`</span><span>
</span><span id="line-200"></span><span id="local-6989586621679236551"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#anyToQuad"><span class="hs-identifier hs-type">anyToQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679236551"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236551"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-201"></span><span id="anyToQuad"><span class="annot"><span class="annottext">anyToQuad :: AnyBezier a -&gt; Maybe (QuadBezier a)
</span><a href="Geom2D.CubicBezier.Basic.html#anyToQuad"><span class="hs-identifier hs-var hs-var">anyToQuad</span></a></span></span><span> </span><span id="local-6989586621679236550"><span class="annot"><span class="annottext">b :: AnyBezier a
</span><a href="#local-6989586621679236550"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-identifier hs-type">AnyBezier</span></a></span><span> </span><span id="local-6989586621679236549"><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236549"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AnyBezier a -&gt; Int
forall (b :: * -&gt; *) a. (GenericBezier b, Unbox a) =&gt; b a -&gt; Int
</span><a href="Geom2D.CubicBezier.Basic.html#degree"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">AnyBezier a
</span><a href="#local-6989586621679236550"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuadBezier a -&gt; Maybe (QuadBezier a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(QuadBezier a -&gt; Maybe (QuadBezier a))
-&gt; QuadBezier a -&gt; Maybe (QuadBezier a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; QuadBezier a
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
Vector (a, a) -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#unsafeFromVector"><span class="hs-identifier hs-var">unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (a, a)
</span><a href="#local-6989586621679236549"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (QuadBezier a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621679236548"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsCubic"><span class="hs-identifier hs-type">evalBezierDerivsCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-206"></span><span>                         </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236548"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236548"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-207"></span><span id="evalBezierDerivsCubic"><span class="annot"><span class="annottext">evalBezierDerivsCubic :: CubicBezier a -&gt; a -&gt; [Point a]
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsCubic"><span class="hs-identifier hs-var hs-var">evalBezierDerivsCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236546"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236546"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236545"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236545"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236544"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236544"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236543"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236543"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236542"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236541"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [Point a] -&gt; [Point a]
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236540"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [Point a] -&gt; [Point a]
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236539"><span class="hs-identifier hs-var">p''</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [Point a] -&gt; [Point a]
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236538"><span class="hs-identifier hs-var">p'''</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; [Point a] -&gt; [Point a]
</span><span class="hs-operator hs-var">`seq`</span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236541"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236540"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236539"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236538"><span class="hs-identifier hs-var">p'''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679236537"><span class="annot"><span class="annottext">u :: a
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679236536"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679236536"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679236534"><span class="annot"><span class="annottext">t3 :: a
</span><a href="#local-6989586621679236534"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236536"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679236533"><span class="annot"><span class="annottext">da :: Point a
</span><a href="#local-6989586621679236533"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236545"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236546"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679236530"><span class="annot"><span class="annottext">db :: Point a
</span><a href="#local-6989586621679236530"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236544"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236545"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679236529"><span class="annot"><span class="annottext">dc :: Point a
</span><a href="#local-6989586621679236529"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236543"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236544"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679236541"><span class="annot"><span class="annottext">p :: Point a
</span><a href="#local-6989586621679236541"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236546"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236545"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236536"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236544"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236534"><span class="hs-identifier hs-var">t3</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236543"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679236540"><span class="annot"><span class="annottext">p' :: Point a
</span><a href="#local-6989586621679236540"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236533"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236530"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236536"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236529"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679236539"><span class="annot"><span class="annottext">p'' :: Point a
</span><a href="#local-6989586621679236539"><span class="hs-identifier hs-var hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236537"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236530"><span class="hs-identifier hs-var">db</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236533"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236542"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236529"><span class="hs-identifier hs-var">dc</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236530"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679236538"><span class="annot"><span class="annottext">p''' :: Point a
</span><a href="#local-6989586621679236538"><span class="hs-identifier hs-var hs-var">p'''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236529"><span class="hs-identifier hs-var">dc</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236530"><span class="hs-identifier hs-var">db</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236533"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsCubic"><span class="hs-pragma hs-type">evalBezierDerivsCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>    </span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span id="local-6989586621679236526"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivCubic"><span class="hs-identifier hs-type">evalBezierDerivCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-224"></span><span>                         </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-225"></span><span id="evalBezierDerivCubic"><span class="annot"><span class="annottext">evalBezierDerivCubic :: CubicBezier a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivCubic"><span class="hs-identifier hs-var hs-var">evalBezierDerivCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236524"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236524"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236523"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236523"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236522"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236522"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236521"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236521"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236520"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236519"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; (Point a, Point a) -&gt; (Point a, Point a)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236518"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; (Point a, Point a) -&gt; (Point a, Point a)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236519"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236518"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679236517"><span class="annot"><span class="annottext">u :: a
</span><a href="#local-6989586621679236517"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679236516"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679236516"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679236515"><span class="annot"><span class="annottext">t3 :: a
</span><a href="#local-6989586621679236515"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236516"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679236514"><span class="annot"><span class="annottext">da :: Point a
</span><a href="#local-6989586621679236514"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236523"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236524"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679236513"><span class="annot"><span class="annottext">db :: Point a
</span><a href="#local-6989586621679236513"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236522"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236523"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679236512"><span class="annot"><span class="annottext">dc :: Point a
</span><a href="#local-6989586621679236512"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236521"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236522"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679236519"><span class="annot"><span class="annottext">p :: Point a
</span><a href="#local-6989586621679236519"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236517"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236517"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236517"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236524"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236523"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236516"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236522"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236515"><span class="hs-identifier hs-var">t3</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236521"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679236518"><span class="annot"><span class="annottext">p' :: Point a
</span><a href="#local-6989586621679236518"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236517"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236517"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236514"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236520"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236513"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236516"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236512"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-235"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivCubic"><span class="hs-pragma hs-type">evalBezierDerivCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>    </span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span id="local-6989586621679236511"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsQuad"><span class="hs-identifier hs-type">evalBezierDerivsQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236511"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-238"></span><span>                        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236511"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236511"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-239"></span><span id="evalBezierDerivsQuad"><span class="annot"><span class="annottext">evalBezierDerivsQuad :: QuadBezier a -&gt; a -&gt; [Point a]
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsQuad"><span class="hs-identifier hs-var hs-var">evalBezierDerivsQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236509"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236509"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236508"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236508"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236507"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236507"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236506"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236506"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236505"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236504"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236503"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679236502"><span class="annot"><span class="annottext">u :: a
</span><a href="#local-6989586621679236502"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236506"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679236501"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679236501"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236506"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236506"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679236505"><span class="annot"><span class="annottext">p :: Point a
</span><a href="#local-6989586621679236505"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236502"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236502"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236509"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236506"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236508"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236501"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236507"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679236504"><span class="annot"><span class="annottext">p' :: Point a
</span><a href="#local-6989586621679236504"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236502"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236508"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236509"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236506"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236507"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236508"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679236503"><span class="annot"><span class="annottext">p'' :: Point a
</span><a href="#local-6989586621679236503"><span class="hs-identifier hs-var hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236507"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236508"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236509"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsQuad"><span class="hs-pragma hs-type">evalBezierDerivsQuad</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>        </span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span id="local-6989586621679236500"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivQuad"><span class="hs-identifier hs-type">evalBezierDerivQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679236500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-249"></span><span>                        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236500"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236500"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-250"></span><span id="evalBezierDerivQuad"><span class="annot"><span class="annottext">evalBezierDerivQuad :: QuadBezier a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivQuad"><span class="hs-identifier hs-var hs-var">evalBezierDerivQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236498"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236498"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236497"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236497"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236496"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236496"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236495"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236495"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236494"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; (Point a, Point a) -&gt; (Point a, Point a)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236493"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; (Point a, Point a) -&gt; (Point a, Point a)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236494"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236493"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679236492"><span class="annot"><span class="annottext">u :: a
</span><a href="#local-6989586621679236492"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236495"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679236491"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679236491"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236495"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236495"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679236494"><span class="annot"><span class="annottext">p :: Point a
</span><a href="#local-6989586621679236494"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236492"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236492"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236498"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236495"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236497"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236491"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236496"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679236493"><span class="annot"><span class="annottext">p' :: Point a
</span><a href="#local-6989586621679236493"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236492"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236497"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236498"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236495"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236496"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236497"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivQuad"><span class="hs-pragma hs-type">evalBezierDerivQuad</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>        </span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Evaluate the bezier and all its derivatives using the modified horner algorithm.</span><span>
</span><span id="line-259"></span><span id="local-6989586621679237097"><span id="local-6989586621679237098"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-identifier hs-type">evalBezierDerivs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237098"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679237097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-260"></span><span>                    </span><span class="annot"><a href="#local-6989586621679237098"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-261"></span><span id="evalBezierDerivs"><span class="annot"><span class="annottext">evalBezierDerivs :: b a -&gt; a -&gt; [Point a]
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-identifier hs-var hs-var">evalBezierDerivs</span></a></span></span><span> </span><span id="local-6989586621679236490"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236490"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236489"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236489"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Point a) -&gt; [a] -&gt; [a] -&gt; [Point a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; a -&gt; [a]
forall t. (Unbox t, Fractional t) =&gt; BernsteinPoly t -&gt; t -&gt; [t]
</span><a href="Math.BernsteinPoly.html#bernsteinEvalDerivs"><span class="hs-identifier hs-var">bernsteinEvalDerivs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; BernsteinPoly a
forall a. Vector a -&gt; BernsteinPoly a
</span><a href="Math.BernsteinPoly.html#BernsteinPoly"><span class="hs-identifier hs-var">BernsteinPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236485"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236489"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; a -&gt; [a]
forall t. (Unbox t, Fractional t) =&gt; BernsteinPoly t -&gt; t -&gt; [t]
</span><a href="Math.BernsteinPoly.html#bernsteinEvalDerivs"><span class="hs-identifier hs-var">bernsteinEvalDerivs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; BernsteinPoly a
forall a. Vector a -&gt; BernsteinPoly a
</span><a href="Math.BernsteinPoly.html#BernsteinPoly"><span class="hs-identifier hs-var">BernsteinPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236484"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236489"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236485"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236485"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236484"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236484"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; (Vector a, Vector a)
forall a b.
(Unbox a, Unbox b) =&gt;
Vector (a, b) -&gt; (Vector a, Vector b)
</span><span class="hs-identifier hs-var">V.unzip</span></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a) -&gt; (Vector a, Vector a))
-&gt; Vector (a, a) -&gt; (Vector a, Vector a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; Vector (a, a)
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
b a -&gt; Vector (a, a)
</span><a href="Geom2D.CubicBezier.Basic.html#toVector"><span class="hs-identifier hs-var">toVector</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236490"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-265"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-pragma hs-type">evalBezierDerivs</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-266"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-pragma hs-type">evalBezierDerivs</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-267"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;evalBezierDerivs/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-pragma hs-type">evalBezierDerivs</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsCubic"><span class="hs-pragma hs-type">evalBezierDerivsCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-268"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;evalBezierDerivs/quad&quot;</span></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-pragma hs-type">evalBezierDerivs</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivsQuad"><span class="hs-pragma hs-type">evalBezierDerivsQuad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Return True if the param lies on the curve, iff it's in the interval @[0, 1]@.</span><span>
</span><span id="line-271"></span><span id="local-6989586621679237091"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParam"><span class="hs-identifier hs-type">bezierParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679237091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679237091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237091"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-272"></span><span id="bezierParam"><span class="annot"><span class="annottext">bezierParam :: a -&gt; Bool
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParam"><span class="hs-identifier hs-var hs-var">bezierParam</span></a></span></span><span> </span><span id="local-6989586621679236482"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236482"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236482"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236482"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | Convert a tolerance from the codomain to the domain of the bezier</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- curve, by dividing by the maximum velocity on the curve.  The</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- estimate is conservative, but holds for any value on the curve.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679237051"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-identifier hs-type">bezierParamTolerance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237051"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237051"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-278"></span><span id="bezierParamTolerance"><span class="annot"><span class="annottext">bezierParamTolerance :: b Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-identifier hs-var hs-var">bezierParamTolerance</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b Double -&gt; Vector (Double, Double)
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
b a -&gt; Vector (a, a)
</span><a href="Geom2D.CubicBezier.Basic.html#toVector"><span class="hs-identifier hs-var">toVector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679236479"><span class="annot"><span class="annottext">Vector (Double, Double)
</span><a href="#local-6989586621679236479"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236478"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236478"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236478"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236477"><span class="hs-identifier hs-var">maxVel</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679236477"><span class="annot"><span class="annottext">maxVel :: Double
</span><a href="#local-6989586621679236477"><span class="hs-identifier hs-var hs-var">maxVel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. (Unbox a, Ord a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.maximum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Double)
-&gt; Vector (Point Double) -&gt; Vector (Point Double) -&gt; Vector Double
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Double, Double) -&gt; Point Double)
-&gt; Vector (Double, Double) -&gt; Vector (Point Double)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Point Double)
-&gt; (Double, Double) -&gt; Point Double
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Double, Double)
</span><a href="#local-6989586621679236479"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Double, Double) -&gt; Point Double)
-&gt; Vector (Double, Double) -&gt; Vector (Point Double)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Point Double)
-&gt; (Double, Double) -&gt; Point Double
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (Double, Double) -&gt; Vector (Point Double))
-&gt; Vector (Double, Double) -&gt; Vector (Point Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Double, Double) -&gt; Vector (Double, Double)
forall a. Unbox a =&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.tail</span></span><span> </span><span class="annot"><span class="annottext">Vector (Double, Double)
</span><a href="#local-6989586621679236479"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-pragma hs-type">bezierParamTolerance</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>             </span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span id="local-6989586621679236471"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceCubic"><span class="hs-identifier hs-type">bezierParamToleranceCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679236471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679236471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236471"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-285"></span><span id="bezierParamToleranceCubic"><span class="annot"><span class="annottext">bezierParamToleranceCubic :: CubicBezier a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceCubic"><span class="hs-identifier hs-var hs-var">bezierParamToleranceCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236469"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236469"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span id="local-6989586621679236468"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236468"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679236467"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236467"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679236466"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236466"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236465"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236465"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236465"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236464"><span class="hs-identifier hs-var">maxVel</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236464"><span class="annot"><span class="annottext">maxVel :: a
</span><a href="#local-6989586621679236464"><span class="hs-identifier hs-var hs-var">maxVel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236469"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236468"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-287"></span><span>                 </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236468"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236467"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236467"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236466"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceCubic"><span class="hs-pragma hs-type">bezierParamToleranceCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-290"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;bezierParamTolerance/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-pragma hs-type">bezierParamTolerance</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceCubic"><span class="hs-pragma hs-type">bezierParamToleranceCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span id="local-6989586621679236462"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceQuad"><span class="hs-identifier hs-type">bezierParamToleranceQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679236462"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679236462"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236462"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236462"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-293"></span><span id="bezierParamToleranceQuad"><span class="annot"><span class="annottext">bezierParamToleranceQuad :: QuadBezier a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceQuad"><span class="hs-identifier hs-var hs-var">bezierParamToleranceQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236460"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236460"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span id="local-6989586621679236459"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236459"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679236458"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236458"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236457"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236457"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236457"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236456"><span class="hs-identifier hs-var">maxVel</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236456"><span class="annot"><span class="annottext">maxVel :: a
</span><a href="#local-6989586621679236456"><span class="hs-identifier hs-var hs-var">maxVel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236460"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236459"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236459"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236458"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceQuad"><span class="hs-pragma hs-type">bezierParamToleranceQuad</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;bezierParamTolerance/quad&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-pragma hs-type">bezierParamTolerance</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierParamToleranceQuad"><span class="hs-pragma hs-type">bezierParamToleranceQuad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | Reorient to the curve B(1-t).</span><span>
</span><span id="line-300"></span><span id="local-6989586621679236454"><span id="local-6989586621679236455"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-identifier hs-type">reorient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236455"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679236454"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236455"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236455"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236454"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-301"></span><span id="reorient"><span class="annot"><span class="annottext">reorient :: b a -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-identifier hs-var hs-var">reorient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; b a
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
Vector (a, a) -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#unsafeFromVector"><span class="hs-identifier hs-var">unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a) -&gt; b a) -&gt; (b a -&gt; Vector (a, a)) -&gt; b a -&gt; b a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; Vector (a, a)
forall a. Unbox a =&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a) -&gt; Vector (a, a))
-&gt; (b a -&gt; Vector (a, a)) -&gt; b a -&gt; Vector (a, a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; Vector (a, a)
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
b a -&gt; Vector (a, a)
</span><a href="Geom2D.CubicBezier.Basic.html#toVector"><span class="hs-identifier hs-var">toVector</span></a></span><span>
</span><span id="line-302"></span><span id="local-6989586621679236451"><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-pragma hs-type">reorient</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679236451"><span class="hs-pragma hs-type">a</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236451"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236451"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-303"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-pragma hs-type">reorient</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span id="local-6989586621679236450"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorientCubic"><span class="hs-identifier hs-type">reorientCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236450"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-306"></span><span id="reorientCubic"><span class="annot"><span class="annottext">reorientCubic :: CubicBezier a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#reorientCubic"><span class="hs-identifier hs-var hs-var">reorientCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236448"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236448"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236447"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236447"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236446"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236446"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236445"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236445"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236445"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236446"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236447"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236448"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span id="local-6989586621679236444"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorientQuad"><span class="hs-identifier hs-type">reorientQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236444"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236444"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-309"></span><span id="reorientQuad"><span class="annot"><span class="annottext">reorientQuad :: QuadBezier a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#reorientQuad"><span class="hs-identifier hs-var hs-var">reorientQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236442"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236442"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236441"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236441"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236440"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236440"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236440"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236441"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236442"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-310"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;reorient/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-pragma hs-type">reorient</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorientCubic"><span class="hs-pragma hs-type">reorientCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-311"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;reorient/quad&quot;</span></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorient"><span class="hs-pragma hs-type">reorient</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#reorientQuad"><span class="hs-pragma hs-type">reorientQuad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | Give the bernstein polynomial for each coordinate.</span><span>
</span><span id="line-314"></span><span id="local-6989586621679237071"><span id="local-6989586621679237072"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierToBernstein"><span class="hs-identifier hs-type">bezierToBernstein</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237072"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MV.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-315"></span><span>                     </span><span class="annot"><a href="#local-6989586621679237072"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Math.BernsteinPoly.html#BernsteinPoly"><span class="hs-identifier hs-type">BernsteinPoly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Math.BernsteinPoly.html#BernsteinPoly"><span class="hs-identifier hs-type">BernsteinPoly</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-316"></span><span id="bezierToBernstein"><span class="annot"><span class="annottext">bezierToBernstein :: b a -&gt; (BernsteinPoly a, BernsteinPoly a)
</span><a href="Geom2D.CubicBezier.Basic.html#bezierToBernstein"><span class="hs-identifier hs-var hs-var">bezierToBernstein</span></a></span></span><span> </span><span id="local-6989586621679236439"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236439"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; BernsteinPoly a
forall a. Vector a -&gt; BernsteinPoly a
</span><a href="Math.BernsteinPoly.html#BernsteinPoly"><span class="hs-identifier hs-var">BernsteinPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236438"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; BernsteinPoly a
forall a. Vector a -&gt; BernsteinPoly a
</span><a href="Math.BernsteinPoly.html#BernsteinPoly"><span class="hs-identifier hs-var">BernsteinPoly</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236437"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236438"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236438"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236437"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679236437"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; (Vector a, Vector a)
forall a b.
(Unbox a, Unbox b) =&gt;
Vector (a, b) -&gt; (Vector a, Vector b)
</span><span class="hs-identifier hs-var">V.unzip</span></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a) -&gt; (Vector a, Vector a))
-&gt; Vector (a, a) -&gt; (Vector a, Vector a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; Vector (a, a)
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
b a -&gt; Vector (a, a)
</span><a href="Geom2D.CubicBezier.Basic.html#toVector"><span class="hs-identifier hs-var">toVector</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236439"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Calculate a value on the bezier curve.</span><span>
</span><span id="line-320"></span><span id="local-6989586621679236435"><span id="local-6989586621679236436"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-identifier hs-type">evalBezier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236436"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MV.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679236435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236435"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-321"></span><span>              </span><span class="annot"><a href="#local-6989586621679236436"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236435"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-322"></span><span id="evalBezier"><span class="annot"><span class="annottext">evalBezier :: b a -&gt; a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-identifier hs-var hs-var">evalBezier</span></a></span></span><span> </span><span id="local-6989586621679236434"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236434"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span id="local-6989586621679236433"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236433"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point a] -&gt; Point a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Point a] -&gt; Point a) -&gt; [Point a] -&gt; Point a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; [Point a]
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a, Fractional a) =&gt;
b a -&gt; a -&gt; [Point a]
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-identifier hs-var">evalBezierDerivs</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236434"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236433"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-323"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-pragma hs-type">evalBezier</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-324"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-pragma hs-type">evalBezier</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span id="local-6989586621679236431"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierCubic"><span class="hs-identifier hs-type">evalBezierCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-327"></span><span>                   </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236431"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236431"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-328"></span><span id="evalBezierCubic"><span class="annot"><span class="annottext">evalBezierCubic :: CubicBezier a -&gt; a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierCubic"><span class="hs-identifier hs-var hs-var">evalBezierCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236429"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236429"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236428"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236428"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236427"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236427"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236426"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236426"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236425"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236424"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236424"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236424"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236429"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236425"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236428"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236423"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236427"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236422"><span class="hs-identifier hs-var">t3</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236426"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679236424"><span class="annot"><span class="annottext">u :: a
</span><a href="#local-6989586621679236424"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236425"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679236423"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679236423"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236425"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236425"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679236422"><span class="annot"><span class="annottext">t3 :: a
</span><a href="#local-6989586621679236422"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236423"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236425"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-334"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierCubic"><span class="hs-pragma hs-type">evalBezierCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-335"></span><span>    </span><span>
</span><span id="line-336"></span><span id="local-6989586621679236421"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierQuad"><span class="hs-identifier hs-type">evalBezierQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236421"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-337"></span><span>                  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236421"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236421"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236421"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-338"></span><span id="evalBezierQuad"><span class="annot"><span class="annottext">evalBezierQuad :: QuadBezier a -&gt; a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierQuad"><span class="hs-identifier hs-var hs-var">evalBezierQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236419"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236419"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236418"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236418"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236417"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236417"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236416"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236416"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236415"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236415"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236419"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236416"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236418"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679236414"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236417"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679236415"><span class="annot"><span class="annottext">u :: a
</span><a href="#local-6989586621679236415"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236416"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679236414"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679236414"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236416"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236416"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-343"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierQuad"><span class="hs-pragma hs-type">evalBezierQuad</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;evalBezier/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-pragma hs-type">evalBezier</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierCubic"><span class="hs-pragma hs-type">evalBezierCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-346"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;evalBezier/quad&quot;</span></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-pragma hs-type">evalBezier</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierQuad"><span class="hs-pragma hs-type">evalBezierQuad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- | Calculate a value and the first derivative on the curve.</span><span>
</span><span id="line-349"></span><span id="local-6989586621679237087"><span id="local-6989586621679237088"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-type">evalBezierDeriv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679237088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-350"></span><span>                   </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237087"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237087"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-351"></span><span id="evalBezierDeriv"><span class="annot"><span class="annottext">evalBezierDeriv :: b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var hs-var">evalBezierDeriv</span></a></span></span><span> </span><span id="local-6989586621679236413"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236413"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span id="local-6989586621679236412"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236412"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236411"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236410"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236411"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236411"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679236410"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236410"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Point a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; [Point a]
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a, Fractional a) =&gt;
b a -&gt; a -&gt; [Point a]
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs"><span class="hs-identifier hs-var">evalBezierDerivs</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236413"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236412"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-354"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-pragma hs-type">evalBezierDeriv</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>    </span><span>
</span><span id="line-355"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;evalBezierDeriv/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-pragma hs-type">evalBezierDeriv</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivCubic"><span class="hs-pragma hs-type">evalBezierDerivCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-356"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;evalBezierDeriv/quad&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-pragma hs-type">evalBezierDeriv</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivQuad"><span class="hs-pragma hs-type">evalBezierDerivQuad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | @findBezierTangent p b@ finds the parameters where</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- the tangent of the bezier curve @b@ has the same direction as vector p.</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- Use the formula tx * B'y(t) - ty * B'x(t) = 0 where</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- B'x is the x value of the derivative of the Bezier curve.</span><span>
</span><span id="line-363"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-type">findBezierTangent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-364"></span><span id="findBezierTangent"><span class="annot"><span class="annottext">findBezierTangent :: Point Double -&gt; CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-var hs-var">findBezierTangent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236409"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236409"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679236408"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236408"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236407"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236407"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679236406"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236406"><span class="hs-identifier hs-var">y0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236405"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236405"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679236404"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236404"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236403"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236403"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679236402"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236402"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236401"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236401"><span class="hs-identifier hs-var">x3</span></a></span></span><span> </span><span id="local-6989586621679236400"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236400"><span class="hs-identifier hs-var">y3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Bool) -&gt; [Double] -&gt; [Double]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. (Ord a, Num a) =&gt; a -&gt; Bool
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParam"><span class="hs-identifier hs-var">bezierParam</span></a></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; [Double]) -&gt; [Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Numeric.html#quadraticRoot"><span class="hs-identifier hs-var">quadraticRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236398"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236397"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236396"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>      </span><span id="local-6989586621679236398"><span class="annot"><span class="annottext">a :: Double
</span><a href="#local-6989586621679236398"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236409"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236400"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236406"><span class="hs-identifier hs-var">y0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236404"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236402"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236408"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236401"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236407"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236405"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236403"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>      </span><span id="local-6989586621679236397"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679236397"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236409"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236402"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236406"><span class="hs-identifier hs-var">y0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236404"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236408"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236403"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236407"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236405"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>      </span><span id="local-6989586621679236396"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679236396"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236409"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236404"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236406"><span class="hs-identifier hs-var">y0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236408"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236405"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236407"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Find the parameter where the bezier curve is horizontal.</span><span>
</span><span id="line-372"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierHoriz"><span class="hs-identifier hs-type">bezierHoriz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span id="bezierHoriz"><span class="annot"><span class="annottext">bezierHoriz :: CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#bezierHoriz"><span class="hs-identifier hs-var hs-var">bezierHoriz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-var">findBezierTangent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- | Find the parameter where the bezier curve is vertical.</span><span>
</span><span id="line-376"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierVert"><span class="hs-identifier hs-type">bezierVert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span id="bezierVert"><span class="annot"><span class="annottext">bezierVert :: CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#bezierVert"><span class="hs-identifier hs-var hs-var">bezierVert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-var">findBezierTangent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Find inflection points on the curve.</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- Use the formula B_x''(t) * B_y'(t) - B_y''(t) * B_x'(t) = 0 with</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- B_x'(t) the x value of the first derivative at t, B_y''(t) the y</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- value of the second derivative at t</span><span>
</span><span id="line-383"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findBezierInflection"><span class="hs-identifier hs-type">findBezierInflection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-384"></span><span id="findBezierInflection"><span class="annot"><span class="annottext">findBezierInflection :: CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierInflection"><span class="hs-identifier hs-var hs-var">findBezierInflection</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236394"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236394"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679236393"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236393"><span class="hs-identifier hs-var">y0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236392"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236392"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679236391"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236391"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236390"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236390"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679236389"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236389"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236388"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236388"><span class="hs-identifier hs-var">x3</span></a></span></span><span> </span><span id="local-6989586621679236387"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236387"><span class="hs-identifier hs-var">y3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Bool) -&gt; [Double] -&gt; [Double]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. (Ord a, Num a) =&gt; a -&gt; Bool
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParam"><span class="hs-identifier hs-var">bezierParam</span></a></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; [Double]) -&gt; [Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Numeric.html#quadraticRoot"><span class="hs-identifier hs-var">quadraticRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236384"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-387"></span><span>      </span><span id="local-6989586621679236383"><span class="annot"><span class="annottext">ax :: Double
</span><a href="#local-6989586621679236383"><span class="hs-identifier hs-var hs-var">ax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236392"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236394"><span class="hs-identifier hs-var">x0</span></a></span><span>
</span><span id="line-388"></span><span>      </span><span id="local-6989586621679236382"><span class="annot"><span class="annottext">bx :: Double
</span><a href="#local-6989586621679236382"><span class="hs-identifier hs-var hs-var">bx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236388"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236392"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236383"><span class="hs-identifier hs-var">ax</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span id="local-6989586621679236381"><span class="annot"><span class="annottext">cx :: Double
</span><a href="#local-6989586621679236381"><span class="hs-identifier hs-var hs-var">cx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236388"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236390"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236383"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236382"><span class="hs-identifier hs-var">bx</span></a></span><span>
</span><span id="line-390"></span><span>      </span><span id="local-6989586621679236380"><span class="annot"><span class="annottext">ay :: Double
</span><a href="#local-6989586621679236380"><span class="hs-identifier hs-var hs-var">ay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236391"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236393"><span class="hs-identifier hs-var">y0</span></a></span><span>
</span><span id="line-391"></span><span>      </span><span id="local-6989586621679236379"><span class="annot"><span class="annottext">by :: Double
</span><a href="#local-6989586621679236379"><span class="hs-identifier hs-var hs-var">by</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236389"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236391"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236380"><span class="hs-identifier hs-var">ay</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span id="local-6989586621679236378"><span class="annot"><span class="annottext">cy :: Double
</span><a href="#local-6989586621679236378"><span class="hs-identifier hs-var hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236387"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236389"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236380"><span class="hs-identifier hs-var">ay</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236379"><span class="hs-identifier hs-var">by</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span id="local-6989586621679236386"><span class="annot"><span class="annottext">a :: Double
</span><a href="#local-6989586621679236386"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236382"><span class="hs-identifier hs-var">bx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236378"><span class="hs-identifier hs-var">cy</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236379"><span class="hs-identifier hs-var">by</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236381"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span id="local-6989586621679236385"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679236385"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236383"><span class="hs-identifier hs-var">ax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236378"><span class="hs-identifier hs-var">cy</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236380"><span class="hs-identifier hs-var">ay</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236381"><span class="hs-identifier hs-var">cx</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621679236384"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679236384"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236383"><span class="hs-identifier hs-var">ax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236379"><span class="hs-identifier hs-var">by</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236380"><span class="hs-identifier hs-var">ay</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236382"><span class="hs-identifier hs-var">bx</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Find the cusps of a bezier.</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- find a cusp.  We look for points where the tangent is both horizontal</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- and vertical, which is only true for the zero vector.</span><span>
</span><span id="line-401"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findBezierCusp"><span class="hs-identifier hs-type">findBezierCusp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span id="findBezierCusp"><span class="annot"><span class="annottext">findBezierCusp :: CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierCusp"><span class="hs-identifier hs-var hs-var">findBezierCusp</span></a></span></span><span> </span><span id="local-6989586621679236377"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236377"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Bool) -&gt; [Double] -&gt; [Double]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="#local-6989586621679236376"><span class="hs-identifier hs-var">vertical</span></a></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; [Double]) -&gt; [Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#bezierHoriz"><span class="hs-identifier hs-var">bezierHoriz</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236377"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236376"><span class="annot"><span class="annottext">vertical :: Double -&gt; Bool
</span><a href="#local-6989586621679236376"><span class="hs-identifier hs-var hs-var">vertical</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Bool) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Double)
-&gt; (Double -&gt; Point Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, Point Double) -&gt; Point Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point Double, Point Double) -&gt; Point Double)
-&gt; (Double -&gt; (Point Double, Point Double))
-&gt; Double
-&gt; Point Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (Point Double, Point Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236377"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-- | @bezierArc startAngle endAngle@ approximates an arc on the unit circle with</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- a single cubic b&#233;zi&#233;r curve.  Maximum deviation is &lt;0.03% for arcs</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- 90&#176; degrees or less.</span><span>
</span><span id="line-408"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierArc"><span class="hs-identifier hs-type">bezierArc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-409"></span><span id="bezierArc"><span class="annot"><span class="annottext">bezierArc :: Double -&gt; Double -&gt; CubicBezier Double
</span><a href="Geom2D.CubicBezier.Basic.html#bezierArc"><span class="hs-identifier hs-var hs-var">bezierArc</span></a></span></span><span> </span><span id="local-6989586621679236374"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236374"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679236373"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236373"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
-&gt; Point Double
-&gt; Point Double
-&gt; Point Double
-&gt; CubicBezier Double
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236372"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236371"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236370"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236369"><span class="hs-identifier hs-var">p3</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679236372"><span class="annot"><span class="annottext">p0 :: Point Double
</span><a href="#local-6989586621679236372"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Point Double
forall a. Floating a =&gt; a -&gt; Point a
</span><a href="Geom2D.html#dirVector"><span class="hs-identifier hs-var">dirVector</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236374"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621679236369"><span class="annot"><span class="annottext">p3 :: Point Double
</span><a href="#local-6989586621679236369"><span class="hs-identifier hs-var hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Point Double
forall a. Floating a =&gt; a -&gt; Point a
</span><a href="Geom2D.html#dirVector"><span class="hs-identifier hs-var">dirVector</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236373"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679236371"><span class="annot"><span class="annottext">p1 :: Point Double
</span><a href="#local-6989586621679236371"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236372"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236367"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform Double
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90L"><span class="hs-identifier hs-var">rotate90L</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; Point Double -&gt; Point Double
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236372"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679236370"><span class="annot"><span class="annottext">p2 :: Point Double
</span><a href="#local-6989586621679236370"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236371"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236367"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform Double
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90R"><span class="hs-identifier hs-var">rotate90R</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; Point Double -&gt; Point Double
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236369"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621679236367"><span class="annot"><span class="annottext">k :: Double
</span><a href="#local-6989586621679236367"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236373"><span class="hs-identifier hs-var">end</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236374"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | @arcLength c t tol finds the arclength of the bezier c at t, within given tolerance tol.</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLength"><span class="hs-identifier hs-type">arcLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-420"></span><span id="arcLength"><span class="annot"><span class="annottext">arcLength :: CubicBezier Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLength"><span class="hs-identifier hs-var hs-var">arcLength</span></a></span></span><span> </span><span id="local-6989586621679236362"><span class="annot"><span class="annottext">b :: CubicBezier Double
</span><a href="#local-6989586621679236362"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236361"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236361"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621679236360"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236360"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679236359"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236359"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span id="local-6989586621679236358"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236358"><span class="hs-identifier hs-var">c3</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236357"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236357"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679236356"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236356"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236356"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236361"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236360"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-422"></span><span>                    </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236360"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236359"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-423"></span><span>                    </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236359"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236358"><span class="hs-identifier hs-var">c3</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-10</span></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236357"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, (Double, Double)) -&gt; Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Double, (Double, Double)) -&gt; Double)
-&gt; (Double, (Double, Double)) -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-425"></span><span>       </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (Double, (Double, Double))
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthEstimate"><span class="hs-identifier hs-var">arcLengthEstimate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CubicBezier Double, CubicBezier Double) -&gt; CubicBezier Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((CubicBezier Double, CubicBezier Double) -&gt; CubicBezier Double)
-&gt; (CubicBezier Double, CubicBezier Double) -&gt; CubicBezier Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; (CubicBezier Double, CubicBezier Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236362"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236357"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236356"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthQuad"><span class="hs-identifier hs-var">arcLengthQuad</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236362"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236357"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236356"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLengthQuad"><span class="hs-identifier hs-type">arcLengthQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-429"></span><span id="arcLengthQuad"><span class="annot"><span class="annottext">arcLengthQuad :: CubicBezier Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthQuad"><span class="hs-identifier hs-var hs-var">arcLengthQuad</span></a></span></span><span> </span><span id="local-6989586621679236350"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236350"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236349"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236349"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679236348"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236348"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Double
</span><span class="hs-identifier hs-var hs-var">result</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Double) -&gt; Result -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Result] -&gt; Result
</span><span class="hs-identifier hs-var">absolute</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236348"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">([Result] -&gt; Result) -&gt; [Result] -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-430"></span><span>                        </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double -&gt; [Result]
</span><span class="hs-identifier hs-var">trap</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236344"><span class="hs-identifier hs-var">distDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236349"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236344"><span class="annot"><span class="annottext">distDeriv :: Double -&gt; Double
</span><a href="#local-6989586621679236344"><span class="hs-identifier hs-var hs-var">distDeriv</span></a></span></span><span> </span><span id="local-6989586621679236343"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236343"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorMag"><span class="hs-identifier hs-var">vectorMag</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Double) -&gt; Point Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, Point Double) -&gt; Point Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point Double, Point Double) -&gt; Point Double)
-&gt; (Point Double, Point Double) -&gt; Point Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; (Point Double, Point Double)
</span><a href="#local-6989586621679236341"><span class="hs-identifier hs-var">evalD</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236343"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span id="local-6989586621679236341"><span class="annot"><span class="annottext">evalD :: Double -&gt; (Point Double, Point Double)
</span><a href="#local-6989586621679236341"><span class="hs-identifier hs-var hs-var">evalD</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (Point Double, Point Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236350"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#outline"><span class="hs-identifier hs-type">outline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-435"></span><span id="outline"><span class="annot"><span class="annottext">outline :: CubicBezier Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#outline"><span class="hs-identifier hs-var hs-var">outline</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236339"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236339"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621679236338"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236338"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679236337"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236337"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span id="local-6989586621679236336"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236336"><span class="hs-identifier hs-var">c3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236339"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236338"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236338"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236337"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236337"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236336"><span class="hs-identifier hs-var">c3</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLengthEstimate"><span class="hs-identifier hs-type">arcLengthEstimate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span id="arcLengthEstimate"><span class="annot"><span class="annottext">arcLengthEstimate :: CubicBezier Double -&gt; Double -&gt; (Double, (Double, Double))
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthEstimate"><span class="hs-identifier hs-var hs-var">arcLengthEstimate</span></a></span></span><span> </span><span id="local-6989586621679236335"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236335"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236334"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236334"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236333"><span class="hs-identifier hs-var">arclen</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236332"><span class="hs-identifier hs-var">estimate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236331"><span class="hs-identifier hs-var">ol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-443"></span><span>    </span><span id="local-6989586621679236332"><span class="annot"><span class="annottext">estimate :: Double
</span><a href="#local-6989586621679236332"><span class="hs-identifier hs-var hs-var">estimate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236330"><span class="hs-identifier hs-var">olL</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236329"><span class="hs-identifier hs-var">olR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236331"><span class="hs-identifier hs-var">ol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236328"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236328"><span class="hs-identifier hs-var">bl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236327"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236327"><span class="hs-identifier hs-var">br</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; (CubicBezier Double, CubicBezier Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236335"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621679236331"><span class="annot"><span class="annottext">ol :: Double
</span><a href="#local-6989586621679236331"><span class="hs-identifier hs-var hs-var">ol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#outline"><span class="hs-identifier hs-var">outline</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236335"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236326"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236326"><span class="hs-identifier hs-var">arcL</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236325"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236325"><span class="hs-identifier hs-var">estL</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236330"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236330"><span class="hs-identifier hs-var">olL</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (Double, (Double, Double))
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthEstimate"><span class="hs-identifier hs-var">arcLengthEstimate</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236328"><span class="hs-identifier hs-var">bl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236334"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236324"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236324"><span class="hs-identifier hs-var">arcR</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236323"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236323"><span class="hs-identifier hs-var">estR</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236329"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236329"><span class="hs-identifier hs-var">olR</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (Double, (Double, Double))
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthEstimate"><span class="hs-identifier hs-var">arcLengthEstimate</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236327"><span class="hs-identifier hs-var">br</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236334"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679236333"><span class="annot"><span class="annottext">arclen :: Double
</span><a href="#local-6989586621679236333"><span class="hs-identifier hs-var hs-var">arclen</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236325"><span class="hs-identifier hs-var">estL</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236323"><span class="hs-identifier hs-var">estR</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236332"><span class="hs-identifier hs-var">estimate</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236334"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236325"><span class="hs-identifier hs-var">estL</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236323"><span class="hs-identifier hs-var">estR</span></a></span><span>
</span><span id="line-449"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236326"><span class="hs-identifier hs-var">arcL</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236324"><span class="hs-identifier hs-var">arcR</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- | arcLengthParam c len tol finds the parameter where the curve c has the arclength len,</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- within tolerance tol.</span><span>
</span><span id="line-453"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLengthParam"><span class="hs-identifier hs-type">arcLengthParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-454"></span><span id="arcLengthParam"><span class="annot"><span class="annottext">arcLengthParam :: CubicBezier Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthParam"><span class="hs-identifier hs-var hs-var">arcLengthParam</span></a></span></span><span> </span><span id="local-6989586621679236320"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236320"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236319"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236319"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679236318"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236318"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthP"><span class="hs-identifier hs-var">arcLengthP</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236320"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236319"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236316"><span class="hs-identifier hs-var">ol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236319"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236316"><span class="hs-identifier hs-var">ol</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236318"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236316"><span class="annot"><span class="annottext">ol :: Double
</span><a href="#local-6989586621679236316"><span class="hs-identifier hs-var hs-var">ol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#outline"><span class="hs-identifier hs-var">outline</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236320"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- Use the Newton rootfinding method.  Start with large tolerance</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- values, and decrease tolerance as we go closer to the root.</span><span>
</span><span id="line-460"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#arcLengthP"><span class="hs-identifier hs-type">arcLengthP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-461"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-462"></span><span id="arcLengthP"><span class="annot"><span class="annottext">arcLengthP :: CubicBezier Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthP"><span class="hs-identifier hs-var hs-var">arcLengthP</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236315"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236315"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236314"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236314"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236313"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236313"><span class="hs-identifier hs-var">tot</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236312"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236312"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236311"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236311"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236310"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236310"><span class="hs-identifier hs-var">eps</span></a></span></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236309"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236310"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236312"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236308"><span class="hs-identifier hs-var">newDt</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLengthP"><span class="hs-identifier hs-var">arcLengthP</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236315"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236314"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236313"><span class="hs-identifier hs-var">tot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236312"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236308"><span class="hs-identifier hs-var">newDt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236308"><span class="hs-identifier hs-var">newDt</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236310"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236309"><span class="annot"><span class="annottext">diff :: Double
</span><a href="#local-6989586621679236309"><span class="hs-identifier hs-var hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#arcLength"><span class="hs-identifier hs-var">arcLength</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236315"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236312"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236311"><span class="hs-identifier hs-var">dt</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236313"><span class="hs-identifier hs-var">tot</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236310"><span class="hs-identifier hs-var">eps</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236314"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621679236308"><span class="annot"><span class="annottext">newDt :: Double
</span><a href="#local-6989586621679236308"><span class="hs-identifier hs-var hs-var">newDt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236309"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorMag"><span class="hs-identifier hs-var">vectorMag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, Point Double) -&gt; Point Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Point Double, Point Double) -&gt; Point Double)
-&gt; (Point Double, Point Double) -&gt; Point Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (Point Double, Point Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236315"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236312"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">-- | Convert a quadratic bezier to a cubic bezier.</span><span>
</span><span id="line-469"></span><span id="local-6989586621679236307"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#quadToCubic"><span class="hs-identifier hs-type">quadToCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236307"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-470"></span><span>               </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236307"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236307"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-471"></span><span id="quadToCubic"><span class="annot"><span class="annottext">quadToCubic :: QuadBezier a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#quadToCubic"><span class="hs-identifier hs-var hs-var">quadToCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236306"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236306"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236305"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236305"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236304"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236304"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236306"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236306"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236305"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scalar (Point a)
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236305"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236304"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236304"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | Split a bezier curve into two curves.</span><span>
</span><span id="line-475"></span><span id="local-6989586621679237080"><span id="local-6989586621679237081"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-type">splitBezier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237081"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679237081"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-476"></span><span>               </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237080"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237080"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237081"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679237080"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237081"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679237080"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237081"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-477"></span><span id="splitBezier"><span class="annot"><span class="annottext">splitBezier :: b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var hs-var">splitBezier</span></a></span></span><span> </span><span id="local-6989586621679236303"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236303"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236302"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236302"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (a, a) -&gt; b a
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
Vector (a, a) -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#unsafeFromVector"><span class="hs-identifier hs-var">unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a) -&gt; b a) -&gt; Vector (a, a) -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a -&gt; Vector (a, a)
forall a b.
(Unbox a, Unbox b) =&gt;
Vector a -&gt; Vector b -&gt; Vector (a, b)
</span><span class="hs-identifier hs-var">V.zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; Vector a
forall a. BernsteinPoly a -&gt; Vector a
</span><a href="Math.BernsteinPoly.html#bernsteinCoeffs"><span class="hs-identifier hs-var hs-var">bernsteinCoeffs</span></a></span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236299"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; Vector a
forall a. BernsteinPoly a -&gt; Vector a
</span><a href="Math.BernsteinPoly.html#bernsteinCoeffs"><span class="hs-identifier hs-var hs-var">bernsteinCoeffs</span></a></span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236298"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-479"></span><span>   </span><span class="annot"><span class="annottext">Vector (a, a) -&gt; b a
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
Vector (a, a) -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#unsafeFromVector"><span class="hs-identifier hs-var">unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a) -&gt; b a) -&gt; Vector (a, a) -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a -&gt; Vector (a, a)
forall a b.
(Unbox a, Unbox b) =&gt;
Vector a -&gt; Vector b -&gt; Vector (a, b)
</span><span class="hs-identifier hs-var">V.zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; Vector a
forall a. BernsteinPoly a -&gt; Vector a
</span><a href="Math.BernsteinPoly.html#bernsteinCoeffs"><span class="hs-identifier hs-var hs-var">bernsteinCoeffs</span></a></span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236297"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; Vector a
forall a. BernsteinPoly a -&gt; Vector a
</span><a href="Math.BernsteinPoly.html#bernsteinCoeffs"><span class="hs-identifier hs-var hs-var">bernsteinCoeffs</span></a></span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236296"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236295"><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236295"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236294"><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236294"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b a -&gt; (BernsteinPoly a, BernsteinPoly a)
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a) =&gt;
b a -&gt; (BernsteinPoly a, BernsteinPoly a)
</span><a href="Geom2D.CubicBezier.Basic.html#bezierToBernstein"><span class="hs-identifier hs-var">bezierToBernstein</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236303"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236299"><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236299"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236297"><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236297"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; a -&gt; (BernsteinPoly a, BernsteinPoly a)
forall a.
(Unbox a, Num a) =&gt;
BernsteinPoly a -&gt; a -&gt; (BernsteinPoly a, BernsteinPoly a)
</span><a href="Math.BernsteinPoly.html#bernsteinSplit"><span class="hs-identifier hs-var">bernsteinSplit</span></a></span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236295"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236302"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236298"><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236298"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236296"><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236296"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a -&gt; a -&gt; (BernsteinPoly a, BernsteinPoly a)
forall a.
(Unbox a, Num a) =&gt;
BernsteinPoly a -&gt; a -&gt; (BernsteinPoly a, BernsteinPoly a)
</span><a href="Math.BernsteinPoly.html#bernsteinSplit"><span class="hs-identifier hs-var">bernsteinSplit</span></a></span><span> </span><span class="annot"><span class="annottext">BernsteinPoly a
</span><a href="#local-6989586621679236294"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236302"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-484"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-pragma hs-type">splitBezier</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-485"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-pragma hs-type">splitBezier</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#AnyBezier"><span class="hs-pragma hs-type">AnyBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">-- | Split a bezier curve into two curves.</span><span>
</span><span id="line-488"></span><span id="local-6989586621679236292"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierCubic"><span class="hs-identifier hs-type">splitBezierCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236292"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236292"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236292"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-489"></span><span id="splitBezierCubic"><span class="annot"><span class="annottext">splitBezierCubic :: CubicBezier a -&gt; a -&gt; (CubicBezier a, CubicBezier a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezierCubic"><span class="hs-identifier hs-var hs-var">splitBezierCubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236290"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236290"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236289"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236289"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236288"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236288"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236287"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236287"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236286"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679236285"><span class="annot"><span class="annottext">ab :: Point a
</span><a href="#local-6989586621679236285"><span class="hs-identifier hs-var hs-var">ab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236290"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236289"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span id="local-6989586621679236284"><span class="annot"><span class="annottext">bc :: Point a
</span><a href="#local-6989586621679236284"><span class="hs-identifier hs-var hs-var">bc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236289"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236288"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-492"></span><span>      </span><span id="local-6989586621679236283"><span class="annot"><span class="annottext">cd :: Point a
</span><a href="#local-6989586621679236283"><span class="hs-identifier hs-var hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236288"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236287"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-493"></span><span>      </span><span id="local-6989586621679236282"><span class="annot"><span class="annottext">abbc :: Point a
</span><a href="#local-6989586621679236282"><span class="hs-identifier hs-var hs-var">abbc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236285"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236284"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-494"></span><span>      </span><span id="local-6989586621679236281"><span class="annot"><span class="annottext">bccd :: Point a
</span><a href="#local-6989586621679236281"><span class="hs-identifier hs-var hs-var">bccd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236284"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236283"><span class="hs-identifier hs-var">cd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-495"></span><span>      </span><span id="local-6989586621679236280"><span class="annot"><span class="annottext">mid :: Point a
</span><a href="#local-6989586621679236280"><span class="hs-identifier hs-var hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236282"><span class="hs-identifier hs-var">abbc</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236281"><span class="hs-identifier hs-var">bccd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236286"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236280"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
-&gt; (CubicBezier a, CubicBezier a) -&gt; (CubicBezier a, CubicBezier a)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236290"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236285"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236282"><span class="hs-identifier hs-var">abbc</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236280"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236280"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236281"><span class="hs-identifier hs-var">bccd</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236283"><span class="hs-identifier hs-var">cd</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236287"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierCubic"><span class="hs-pragma hs-type">splitBezierCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>     </span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Split a bezier curve into two curves.</span><span>
</span><span id="line-500"></span><span id="local-6989586621679236279"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierQuad"><span class="hs-identifier hs-type">splitBezierQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-501"></span><span id="splitBezierQuad"><span class="annot"><span class="annottext">splitBezierQuad :: QuadBezier a -&gt; a -&gt; (QuadBezier a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezierQuad"><span class="hs-identifier hs-var hs-var">splitBezierQuad</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span id="local-6989586621679236277"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236277"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236276"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236276"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236275"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236275"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236274"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236274"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679236273"><span class="annot"><span class="annottext">ab :: Point a
</span><a href="#local-6989586621679236273"><span class="hs-identifier hs-var hs-var">ab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236277"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236276"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236274"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-503"></span><span>      </span><span id="local-6989586621679236272"><span class="annot"><span class="annottext">bc :: Point a
</span><a href="#local-6989586621679236272"><span class="hs-identifier hs-var hs-var">bc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236276"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236275"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236274"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-504"></span><span>      </span><span id="local-6989586621679236271"><span class="annot"><span class="annottext">mid :: Point a
</span><a href="#local-6989586621679236271"><span class="hs-identifier hs-var hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236273"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236272"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236274"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236277"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236273"><span class="hs-identifier hs-var">ab</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236271"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236271"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236272"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236275"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierQuad"><span class="hs-pragma hs-type">splitBezierQuad</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-507"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;splitBezier/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-pragma hs-type">splitBezier</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierCubic"><span class="hs-pragma hs-type">splitBezierCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-508"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;splitBezier/quad&quot;</span></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-pragma hs-type">splitBezier</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierQuad"><span class="hs-pragma hs-type">splitBezierQuad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | Return the subsegment between the two parameters.</span><span>
</span><span id="line-511"></span><span id="local-6989586621679237064"><span id="local-6989586621679237065"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-identifier hs-type">bezierSubsegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237064"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-512"></span><span>                    </span><span class="annot"><a href="#local-6989586621679237064"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237064"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237065"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-513"></span><span id="bezierSubsegment"><span class="annot"><span class="annottext">bezierSubsegment :: b a -&gt; a -&gt; a -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-identifier hs-var hs-var">bezierSubsegment</span></a></span></span><span> </span><span id="local-6989586621679236270"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236270"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236269"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236269"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679236268"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236268"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236269"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236268"><span class="hs-identifier hs-var">t2</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; a -&gt; b a
forall a (b :: * -&gt; *).
(Ord a, Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; a -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-identifier hs-var">bezierSubsegment</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236270"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236268"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236269"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236268"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b a, b a) -&gt; b a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((b a, b a) -&gt; b a) -&gt; (b a, b a) -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; (b a, b a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236270"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236269"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b a, b a) -&gt; b a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((b a, b a) -&gt; b a) -&gt; (b a, b a) -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(b a -&gt; a -&gt; (b a, b a)) -&gt; a -&gt; b a -&gt; (b a, b a)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; (b a, b a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236269"><span class="hs-identifier hs-var">t1</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236268"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(b a -&gt; (b a, b a)) -&gt; b a -&gt; (b a, b a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-517"></span><span>                </span><span class="annot"><span class="annottext">(b a, b a) -&gt; b a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((b a, b a) -&gt; b a) -&gt; (b a, b a) -&gt; b a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; (b a, b a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236270"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236268"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-518"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-pragma hs-type">bezierSubsegment</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-519"></span><span class="hs-pragma">{-# NOINLINE</span><span class="hs-pragma">[</span><span class="hs-pragma">2</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-pragma hs-type">bezierSubsegment</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="hs-comment">-- | Return the subsegment between the two parameters.</span><span>
</span><span id="line-522"></span><span id="local-6989586621679236266"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegmentCubic"><span class="hs-identifier hs-type">bezierSubsegmentCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679236266"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679236266"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679236266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679236266"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-523"></span><span id="bezierSubsegmentCubic"><span class="annot"><span class="annottext">bezierSubsegmentCubic :: CubicBezier a -&gt; a -&gt; a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegmentCubic"><span class="hs-identifier hs-var hs-var">bezierSubsegmentCubic</span></a></span></span><span> </span><span id="local-6989586621679236264"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679236264"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236263"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236263"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679236262"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236262"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-524"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236261"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236261"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236260"><span class="hs-identifier hs-var">b1'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; a -&gt; Point a
forall v s. (VectorSpace v, s ~ Scalar v) =&gt; v -&gt; s -&gt; v
</span><span class="hs-operator hs-var">^*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236262"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236263"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236258"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236257"><span class="hs-identifier hs-var">b2'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; a -&gt; Point a
forall v s. (VectorSpace v, s ~ Scalar v) =&gt; v -&gt; s -&gt; v
</span><span class="hs-operator hs-var">^*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236262"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236263"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236258"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236261"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236261"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236260"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236260"><span class="hs-identifier hs-var">b1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier a -&gt; a -&gt; (Point a, Point a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679236264"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236263"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-527"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679236258"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236258"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236257"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679236257"><span class="hs-identifier hs-var">b2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier a -&gt; a -&gt; (Point a, Point a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679236264"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236262"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-528"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegmentCubic"><span class="hs-pragma hs-type">bezierSubsegmentCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-529"></span><span class="hs-pragma">{-# RULES</span><span> </span><span class="annot"><span class="hs-pragma">&quot;bezierSubsegment/cubic&quot;</span></span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-pragma hs-type">bezierSubsegment</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegmentCubic"><span class="hs-pragma hs-type">bezierSubsegmentCubic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- | Split a bezier curve into a list of beziers</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- The parameters should be in ascending order or</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- the result is unpredictable.</span><span>
</span><span id="line-535"></span><span id="local-6989586621679237053"><span id="local-6989586621679237054"><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-identifier hs-type">splitBezierN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679237054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679237054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679237054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-536"></span><span>                </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#GenericBezier"><span class="hs-identifier hs-type">GenericBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237053"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679237053"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679237054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679237053"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-537"></span><span id="splitBezierN"><span class="annot"><span class="annottext">splitBezierN :: b a -&gt; [a] -&gt; [b a]
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-identifier hs-var hs-var">splitBezierN</span></a></span></span><span> </span><span id="local-6989586621679236256"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236256"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236256"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-identifier hs-var">splitBezierN</span></a></span><span> </span><span id="local-6989586621679236255"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236255"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679236254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236254"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236253"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236252"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679236253"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236253"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236252"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236252"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; (b a, b a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236255"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236254"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-540"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-identifier hs-var">splitBezierN</span></a></span><span> </span><span id="local-6989586621679236251"><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236251"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679236250"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236250"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679236249"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236249"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679236248"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679236248"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-541"></span><span>  </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; a -&gt; b a
forall a (b :: * -&gt; *).
(Ord a, Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; a -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-identifier hs-var">bezierSubsegment</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236251"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236250"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">b a -&gt; [b a] -&gt; [b a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><span class="annottext">b a -&gt; a -&gt; a -&gt; b a
forall a (b :: * -&gt; *).
(Ord a, Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; a -&gt; b a
</span><a href="Geom2D.CubicBezier.Basic.html#bezierSubsegment"><span class="hs-identifier hs-var">bezierSubsegment</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236251"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236250"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236249"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">b a -&gt; [b a] -&gt; [b a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-543"></span><span>  </span><span class="annot"><span class="annottext">[b a] -&gt; [b a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b a -&gt; [a] -&gt; [b a]
forall a (b :: * -&gt; *).
(Ord a, Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; [a] -&gt; [b a]
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-identifier hs-var">splitBezierN</span></a></span><span> </span><span class="annot"><span class="annottext">b a
</span><a href="#local-6989586621679236251"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [b a]) -&gt; [a] -&gt; [b a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679236249"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679236248"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-pragma hs-type">splitBezierN</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-545"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#splitBezierN"><span class="hs-pragma hs-type">splitBezierN</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs2Cubic"><span class="hs-identifier hs-type">evalBezierDerivs2Cubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span id="evalBezierDerivs2Cubic"><span class="annot"><span class="annottext">evalBezierDerivs2Cubic :: CubicBezier Double
-&gt; Double -&gt; (Point Double, Point Double, Point Double)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs2Cubic"><span class="hs-identifier hs-var hs-var">evalBezierDerivs2Cubic</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679236245"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236245"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236244"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236244"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236243"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236243"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236242"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236242"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236241"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236240"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
-&gt; (Point Double, Point Double, Point Double)
-&gt; (Point Double, Point Double, Point Double)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236239"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
-&gt; (Point Double, Point Double, Point Double)
-&gt; (Point Double, Point Double, Point Double)
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236238"><span class="hs-identifier hs-var">p''</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
-&gt; (Point Double, Point Double, Point Double)
-&gt; (Point Double, Point Double, Point Double)
</span><span class="hs-operator hs-var">`seq`</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236240"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236239"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236238"><span class="hs-identifier hs-var">p''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621679236237"><span class="annot"><span class="annottext">u :: Double
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621679236236"><span class="annot"><span class="annottext">t2 :: Double
</span><a href="#local-6989586621679236236"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span id="local-6989586621679236235"><span class="annot"><span class="annottext">t3 :: Double
</span><a href="#local-6989586621679236235"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236236"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621679236234"><span class="annot"><span class="annottext">da :: Point Double
</span><a href="#local-6989586621679236234"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236244"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236245"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621679236233"><span class="annot"><span class="annottext">db :: Point Double
</span><a href="#local-6989586621679236233"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236243"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236244"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679236232"><span class="annot"><span class="annottext">dc :: Point Double
</span><a href="#local-6989586621679236232"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double)
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236242"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236243"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span id="local-6989586621679236240"><span class="annot"><span class="annottext">p :: Point Double
</span><a href="#local-6989586621679236240"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236245"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236244"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236236"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236243"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236235"><span class="hs-identifier hs-var">t3</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236242"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679236239"><span class="annot"><span class="annottext">p' :: Point Double
</span><a href="#local-6989586621679236239"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236234"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236233"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679236236"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236232"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621679236238"><span class="annot"><span class="annottext">p'' :: Point Double
</span><a href="#local-6989586621679236238"><span class="hs-identifier hs-var hs-var">p''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236237"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236233"><span class="hs-identifier hs-var">db</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236234"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236241"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236232"><span class="hs-identifier hs-var">dc</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236233"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- estimate the next approximation for the point closest to p by</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- dividing the approximate arclength on the osculating circle at t by the</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- speed at t.</span><span>
</span><span id="line-564"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closestBezierCurve"><span class="hs-identifier hs-type">closestBezierCurve</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-565"></span><span id="closestBezierCurve"><span class="annot"><span class="annottext">closestBezierCurve :: CubicBezier Double -&gt; Point Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#closestBezierCurve"><span class="hs-identifier hs-var hs-var">closestBezierCurve</span></a></span></span><span> </span><span id="local-6989586621679236230"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236230"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679236229"><span class="annot"><span class="annottext">p :: Point Double
</span><a href="#local-6989586621679236229"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236228"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236228"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679236227"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236227"><span class="hs-identifier hs-var">py</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236226"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236226"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-566"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236225"><span class="hs-identifier hs-var">vSqr</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-567"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236224"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236224"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span id="local-6989586621679236223"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236223"><span class="hs-identifier hs-var">dy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Point Double
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC3"><span class="hs-identifier hs-var hs-var">cubicC3</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236230"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Point Double
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC0"><span class="hs-identifier hs-var hs-var">cubicC0</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236230"><span class="hs-identifier hs-var">cb</span></a></span><span>
</span><span id="line-568"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236228"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236222"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236224"><span class="hs-identifier hs-var">dx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236227"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236221"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236223"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorMagSquare"><span class="hs-identifier hs-var">vectorMagSquare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236229"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236219"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236225"><span class="hs-identifier hs-var">vSqr</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236218"><span class="hs-identifier hs-var">r_v</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236218"><span class="hs-identifier hs-var">r_v</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-570"></span><span>     </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236217"><span class="hs-identifier hs-var">closestLinePt</span></a></span><span> </span><span>
</span><span id="line-571"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-572"></span><span>   </span><span class="hs-comment">-- circular arc divided by velocity</span><span>
</span><span id="line-573"></span><span>   </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#fastVectorAngle"><span class="hs-identifier hs-var">fastVectorAngle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; Transform Double
forall a. Num a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateScaleVec"><span class="hs-identifier hs-var">rotateScaleVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236214"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236229"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; Point Double -&gt; Point Double
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236213"><span class="hs-identifier hs-var">by'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236212"><span class="hs-identifier hs-var">bx'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double -&gt; Point Double
forall v s. (VectorSpace v, s ~ Scalar v) =&gt; v -&gt; s -&gt; v
</span><span class="hs-operator hs-var">^*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236218"><span class="hs-identifier hs-var">r_v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236218"><span class="hs-identifier hs-var">r_v</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="#local-6989586621679236217"><span class="hs-identifier hs-type">closestLinePt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621679236217"><span class="annot"><span class="annottext">closestLinePt :: Double
</span><a href="#local-6989586621679236217"><span class="hs-identifier hs-var hs-var">closestLinePt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236228"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236222"><span class="hs-identifier hs-var">bx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236212"><span class="hs-identifier hs-var">bx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236227"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236221"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236213"><span class="hs-identifier hs-var">by'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236225"><span class="hs-identifier hs-var">vSqr</span></a></span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679236219"><span class="annot"><span class="annottext">b :: Point Double
</span><a href="#local-6989586621679236219"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236222"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236222"><span class="hs-identifier hs-var">bx</span></a></span></span><span> </span><span id="local-6989586621679236221"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236221"><span class="hs-identifier hs-var">by</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236211"><span class="annot"><span class="annottext">b' :: Point Double
</span><a href="#local-6989586621679236211"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236212"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236212"><span class="hs-identifier hs-var">bx'</span></a></span></span><span> </span><span id="local-6989586621679236213"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236213"><span class="hs-identifier hs-var">by'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236210"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236210"><span class="hs-identifier hs-var">bx''</span></a></span></span><span> </span><span id="local-6989586621679236209"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236209"><span class="hs-identifier hs-var">by''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; (Point Double, Point Double, Point Double)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDerivs2Cubic"><span class="hs-identifier hs-var">evalBezierDerivs2Cubic</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236230"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236226"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-comment">-- radius of curvature / velocity</span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621679236218"><span class="annot"><span class="annottext">r_v :: Double
</span><a href="#local-6989586621679236218"><span class="hs-identifier hs-var hs-var">r_v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236225"><span class="hs-identifier hs-var">vSqr</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236208"><span class="hs-identifier hs-var">denom</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span id="local-6989586621679236225"><span class="annot"><span class="annottext">vSqr :: Double
</span><a href="#local-6989586621679236225"><span class="hs-identifier hs-var hs-var">vSqr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236212"><span class="hs-identifier hs-var">bx'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236212"><span class="hs-identifier hs-var">bx'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236213"><span class="hs-identifier hs-var">by'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236213"><span class="hs-identifier hs-var">by'</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621679236208"><span class="annot"><span class="annottext">denom :: Double
</span><a href="#local-6989586621679236208"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236210"><span class="hs-identifier hs-var">bx''</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236213"><span class="hs-identifier hs-var">by'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236212"><span class="hs-identifier hs-var">bx'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236209"><span class="hs-identifier hs-var">by''</span></a></span><span>
</span><span id="line-582"></span><span>    </span><span class="hs-comment">-- center of osculating circle</span><span>
</span><span id="line-583"></span><span>    </span><span id="local-6989586621679236214"><span class="annot"><span class="annottext">c :: Point Double
</span><a href="#local-6989586621679236214"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236219"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform Double
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90R"><span class="hs-identifier hs-var">rotate90R</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; Point Double -&gt; Point Double
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236211"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double -&gt; Point Double
forall v s. (VectorSpace v, s ~ Scalar v) =&gt; v -&gt; s -&gt; v
</span><span class="hs-operator hs-var">^*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236218"><span class="hs-identifier hs-var">r_v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-comment">-- approximation of vectorAngle, fastVectorAngle &#952; &#8778; vectorAngle &#952; for</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- small |&#952;|. This avoids a costly atan2 instruction, and I measured a</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- performance increase upto 33%.</span><span>
</span><span id="line-588"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#fastVectorAngle"><span class="hs-identifier hs-type">fastVectorAngle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-589"></span><span id="fastVectorAngle"><span class="annot"><span class="annottext">fastVectorAngle :: Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#fastVectorAngle"><span class="hs-identifier hs-var hs-var">fastVectorAngle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236207"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236207"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679236206"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236206"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236206"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236207"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236206"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236207"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236207"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236206"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236206"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236207"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236206"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>    </span><span>
</span><span id="line-593"></span><span class="hs-comment">-- | Find the closest value on the bezier to the given point, within tolerance.  Return the first value found.</span><span>
</span><span id="line-594"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#closest"><span class="hs-identifier hs-type">closest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-595"></span><span id="closest"><span class="annot"><span class="annottext">closest :: CubicBezier Double -&gt; Point Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#closest"><span class="hs-identifier hs-var hs-var">closest</span></a></span></span><span> </span><span id="local-6989586621679236204"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236204"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679236203"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236203"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679236202"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236202"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-596"></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Point Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#closestBezierCurve"><span class="hs-identifier hs-var">closestBezierCurve</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236204"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236203"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; Double
forall (b :: * -&gt; *).
GenericBezier b =&gt;
b Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#bezierParamTolerance"><span class="hs-identifier hs-var">bezierParamTolerance</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679236204"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236202"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-597"></span><span>  </span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- iterate, fallback to bisection if the approximation doesn't converge.  </span><span>
</span><span id="line-600"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-type">iter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>  </span><span>
</span><span id="line-601"></span><span id="iter"><span class="annot"><span class="annottext">iter :: (Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var hs-var">iter</span></a></span></span><span> </span><span id="local-6989586621679236200"><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679236199"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span id="local-6989586621679236198"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span></span><span> </span><span id="local-6989586621679236197"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236197"><span class="hs-identifier hs-var">maxt</span></a></span></span><span> </span><span id="local-6989586621679236196"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-605"></span><span>           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-606"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-607"></span><span>           </span><span class="hs-comment">-- bisect</span><span>
</span><span id="line-608"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-609"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679236194"><span class="annot"><span class="annottext">dT :: Double
</span><a href="#local-6989586621679236194"><span class="hs-identifier hs-var hs-var">dT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-610"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236194"><span class="hs-identifier hs-var">dT</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236194"><span class="hs-identifier hs-var">dT</span></a></span><span>
</span><span id="line-611"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236194"><span class="hs-identifier hs-var">dT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-613"></span><span>             </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236198"><span class="hs-identifier hs-var">mint</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-615"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236197"><span class="hs-identifier hs-var">maxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-616"></span><span>           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236197"><span class="hs-identifier hs-var">maxt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-617"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-618"></span><span>           </span><span class="hs-comment">--bisect</span><span>
</span><span id="line-619"></span><span>           </span><span class="hs-keyword">else</span><span>
</span><span id="line-620"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679236193"><span class="annot"><span class="annottext">dT :: Double
</span><a href="#local-6989586621679236193"><span class="hs-identifier hs-var hs-var">dT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236197"><span class="hs-identifier hs-var">maxt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-621"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236193"><span class="hs-identifier hs-var">dT</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236193"><span class="hs-identifier hs-var">dT</span></a></span><span>
</span><span id="line-622"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236197"><span class="hs-identifier hs-var">maxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236193"><span class="hs-identifier hs-var">dT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-624"></span><span>             </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236199"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236197"><span class="hs-identifier hs-var">maxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-626"></span><span>    </span><span id="local-6989586621679236195"><span class="annot"><span class="annottext">dt :: Double
</span><a href="#local-6989586621679236195"><span class="hs-identifier hs-var hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236200"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236196"><span class="hs-identifier hs-var">curt</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="hs-comment">-- | Find the x value of the cubic bezier.  The bezier must be</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- monotonically increasing in the X coordinate.</span><span>
</span><span id="line-630"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#findX"><span class="hs-identifier hs-type">findX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-631"></span><span id="findX"><span class="annot"><span class="annottext">findX :: CubicBezier Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#findX"><span class="hs-identifier hs-var hs-var">findX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236192"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236192"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236191"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236191"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236190"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236190"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679236189"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236189"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236188"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236188"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-632"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#find0"><span class="hs-identifier hs-var">find0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236192"><span class="hs-identifier hs-var">p0</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236188"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236191"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236188"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236190"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236188"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236189"><span class="hs-identifier hs-var">p3</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236188"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#find0"><span class="hs-identifier hs-type">find0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-635"></span><span id="find0"><span class="annot"><span class="annottext">find0 :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#find0"><span class="hs-identifier hs-var hs-var">find0</span></a></span></span><span> </span><span id="local-6989586621679236186"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236186"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679236185"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236185"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679236184"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236184"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679236183"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236183"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679236182"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236182"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-636"></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; Double -&gt; Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Geom2D.CubicBezier.Basic.html#iter"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679236181"><span class="hs-identifier hs-var">bezierZero</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236182"><span class="hs-identifier hs-var">eps</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621679236181"><span class="annot"><span class="annottext">bezierZero :: Double -&gt; Double
</span><a href="#local-6989586621679236181"><span class="hs-identifier hs-var hs-var">bezierZero</span></a></span></span><span> </span><span id="local-6989586621679236180"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-639"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236179"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-640"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236179"><span class="hs-identifier hs-var">bx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236178"><span class="hs-identifier hs-var">bx'</span></a></span><span>
</span><span id="line-641"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-642"></span><span>        </span><span id="local-6989586621679236177"><span class="annot"><span class="annottext">u :: Double
</span><a href="#local-6989586621679236177"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-643"></span><span>        </span><span id="local-6989586621679236176"><span class="annot"><span class="annottext">t2 :: Double
</span><a href="#local-6989586621679236176"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-644"></span><span>        </span><span id="local-6989586621679236175"><span class="annot"><span class="annottext">t3 :: Double
</span><a href="#local-6989586621679236175"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236176"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-645"></span><span>        </span><span id="local-6989586621679236174"><span class="annot"><span class="annottext">da :: Double
</span><a href="#local-6989586621679236174"><span class="hs-identifier hs-var hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar Double -&gt; Double -&gt; Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236185"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236186"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>        </span><span id="local-6989586621679236173"><span class="annot"><span class="annottext">db :: Double
</span><a href="#local-6989586621679236173"><span class="hs-identifier hs-var hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar Double -&gt; Double -&gt; Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236184"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236185"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>        </span><span id="local-6989586621679236172"><span class="annot"><span class="annottext">dc :: Double
</span><a href="#local-6989586621679236172"><span class="hs-identifier hs-var hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scalar Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Scalar Double -&gt; Double -&gt; Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236183"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236184"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>        </span><span id="local-6989586621679236179"><span class="annot"><span class="annottext">bx :: Double
</span><a href="#local-6989586621679236179"><span class="hs-identifier hs-var hs-var">bx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236177"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236177"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236177"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236186"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236185"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236176"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236184"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236175"><span class="hs-identifier hs-var">t3</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236183"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-649"></span><span>        </span><span id="local-6989586621679236178"><span class="annot"><span class="annottext">bx' :: Double
</span><a href="#local-6989586621679236178"><span class="hs-identifier hs-var hs-var">bx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236177"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236177"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236174"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236180"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236173"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236176"><span class="hs-identifier hs-var">t2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236172"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span>
</span><span id="line-651"></span><span class="hs-comment">-- | Return False if some points fall outside a line with a thickness of the given tolerance.</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span class="hs-comment">-- fat line calculation taken from the bezier-clipping algorithm (Sederberg)</span><span>
</span><span id="line-654"></span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#colinear"><span class="hs-identifier hs-type">colinear</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-655"></span><span id="colinear"><span class="annot"><span class="annottext">colinear :: CubicBezier Double -&gt; Double -&gt; Bool
</span><a href="Geom2D.CubicBezier.Basic.html#colinear"><span class="hs-identifier hs-var hs-var">colinear</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236171"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236171"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236170"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236170"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236169"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236169"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679236168"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236168"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679236167"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236167"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236166"><span class="hs-identifier hs-var">dmax</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236165"><span class="hs-identifier hs-var">dmin</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236167"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679236164"><span class="annot"><span class="annottext">ld :: Point Double -&gt; Double
</span><a href="#local-6989586621679236164"><span class="hs-identifier hs-var hs-var">ld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Line Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Line a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#lineDistance"><span class="hs-identifier hs-var">lineDistance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Line Double
forall a. Point a -&gt; Point a -&gt; Line a
</span><a href="Geom2D.html#Line"><span class="hs-identifier hs-var">Line</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236171"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236168"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>        </span><span id="local-6989586621679236161"><span class="annot"><span class="annottext">d1 :: Double
</span><a href="#local-6989586621679236161"><span class="hs-identifier hs-var hs-var">d1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
</span><a href="#local-6989586621679236164"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236170"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-658"></span><span>        </span><span id="local-6989586621679236160"><span class="annot"><span class="annottext">d2 :: Double
</span><a href="#local-6989586621679236160"><span class="hs-identifier hs-var hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
</span><a href="#local-6989586621679236164"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679236169"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679236165"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236165"><span class="hs-identifier hs-var">dmin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679236166"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236166"><span class="hs-identifier hs-var">dmax</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236161"><span class="hs-identifier hs-var">d1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236160"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236161"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236160"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-660"></span><span>                                    </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236161"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236160"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236161"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236160"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-662"></span><span>                                    </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236161"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679236160"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-663"></span></pre></body></html>