<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geom2D.CubicBezier.Stroke</span><span>
</span><span id="line-3"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penCircle"><span class="hs-identifier">penCircle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen"><span class="hs-identifier">pathToPen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penStrokeOpen"><span class="hs-identifier">penStrokeOpen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penStrokeClosed"><span class="hs-identifier">penStrokeClosed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier">Pen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#bezierOffset"><span class="hs-identifier">bezierOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.html"><span class="hs-identifier">Geom2D</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.html"><span class="hs-identifier">Geom2D.CubicBezier</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">data</span><span> </span><span id="Pen"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-var">Pen</span></a></span></span><span> </span><span id="local-6989586621679240718"><span class="annot"><a href="#local-6989586621679240718"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PenEllipse"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenEllipse"><span class="hs-identifier hs-var">PenEllipse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="PenPath"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-var">PenPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240718"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">data</span><span> </span><span id="PenSegment"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-var">PenSegment</span></a></span></span><span> </span><span id="local-6989586621679240702"><span class="annot"><a href="#local-6989586621679240702"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PenCorner"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-var">PenCorner</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240702"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240702"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="PenCurve"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-var">PenCurve</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240702"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240702"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">-- | A circular pen with unit radius.</span><span>
</span><span id="line-18"></span><span id="local-6989586621679240614"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penCircle"><span class="hs-identifier hs-type">penCircle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240614"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240614"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-19"></span><span id="penCircle"><span class="annot"><span class="annottext">penCircle :: Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#penCircle"><span class="hs-identifier hs-var hs-var">penCircle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Transform a -&gt; Transform a -&gt; Pen a
forall a. Transform a -&gt; Transform a -&gt; Transform a -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenEllipse"><span class="hs-identifier hs-var">PenEllipse</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
forall a. Num a =&gt; Transform a
</span><a href="Geom2D.html#idTrans"><span class="hs-identifier hs-var">idTrans</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90L"><span class="hs-identifier hs-var">rotate90L</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90R"><span class="hs-identifier hs-var">rotate90R</span></a></span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penCircle"><span class="hs-pragma hs-type">penCircle</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-pragma hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | Create a pen from a path.  For predictable results the path</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- should be convex.</span><span>
</span><span id="line-24"></span><span id="local-6989586621679240689"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen"><span class="hs-identifier hs-type">pathToPen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240689"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240689"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-25"></span><span id="pathToPen"><span class="annot"><span class="annottext">pathToPen :: ClosedPath a -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen"><span class="hs-identifier hs-var hs-var">pathToPen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment a] -&gt; Pen a
forall a. [PenSegment a] -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-var">PenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-26"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen"><span class="hs-identifier hs-var">pathToPen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span id="local-6989586621679240609"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240609"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="annottext">[PenSegment a] -&gt; Pen a
forall a. [PenSegment a] -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-var">PenPath</span></a></span><span> </span><span class="annot"><span class="annottext">([PenSegment a] -&gt; Pen a) -&gt; [PenSegment a] -&gt; Pen a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; [PenSegment a]
forall a. Num a =&gt; [(Point a, PathJoin a)] -&gt; [PenSegment a]
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="annot"><span class="annottext">([(Point a, PathJoin a)] -&gt; [PenSegment a])
-&gt; [(Point a, PathJoin a)] -&gt; [PenSegment a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240609"><span class="hs-identifier hs-var">nodes</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
-&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Point a, PathJoin a)] -&gt; [(Point a, PathJoin a)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240609"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span id="local-6989586621679240706"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-type">pathToPen'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240706"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240706"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-30"></span><span id="pathToPen%27"><span class="annot"><span class="annottext">pathToPen' :: [(Point a, PathJoin a)] -&gt; [PenSegment a]
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var hs-var">pathToPen'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-31"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point a, PathJoin a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-32"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point a, PathJoin a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Point a, PathJoin a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-33"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240606"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240606"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240604"><span class="annot"><span class="annottext">tl :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679240604"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240603"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240603"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; PenSegment a
forall a. Point a -&gt; Point a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-var">PenCorner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240603"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240606"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240603"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment a -&gt; [PenSegment a] -&gt; [PenSegment a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; [PenSegment a]
forall a. Num a =&gt; [(Point a, PathJoin a)] -&gt; [PenSegment a]
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240604"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240600"><span class="annot"><span class="annottext">tl :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679240600"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; [PenSegment a]
forall a. Num a =&gt; [(Point a, PathJoin a)] -&gt; [PenSegment a]
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240600"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240599"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240599"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240598"><span class="annot"><span class="annottext">tl :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679240598"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240597"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240597"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679240596"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240596"><span class="hs-identifier hs-var">q2</span></a></span></span><span> </span><span id="local-6989586621679240595"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240595"><span class="hs-identifier hs-var">q3</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679240594"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240594"><span class="hs-identifier hs-var">q4</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; CubicBezier a -&gt; PenSegment a
forall a. Point a -&gt; CubicBezier a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-var">PenCurve</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240597"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240599"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240597"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240596"><span class="hs-identifier hs-var">q2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240595"><span class="hs-identifier hs-var">q3</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240594"><span class="hs-identifier hs-var">q4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PenSegment a -&gt; [PenSegment a] -&gt; [PenSegment a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; [PenSegment a]
forall a. Num a =&gt; [(Point a, PathJoin a)] -&gt; [PenSegment a]
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240598"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240592"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240592"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240591"><span class="annot"><span class="annottext">tl :: [(Point a, PathJoin a)]
</span><a href="#local-6989586621679240591"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240590"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240590"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679240589"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240589"><span class="hs-identifier hs-var">q2</span></a></span></span><span> </span><span id="local-6989586621679240588"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240588"><span class="hs-identifier hs-var">q3</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679240587"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240587"><span class="hs-identifier hs-var">q4</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; CubicBezier a -&gt; PenSegment a
forall a. Point a -&gt; CubicBezier a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-var">PenCurve</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240590"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240592"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240590"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240589"><span class="hs-identifier hs-var">q2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240588"><span class="hs-identifier hs-var">q3</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240587"><span class="hs-identifier hs-var">q4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PenSegment a -&gt; [PenSegment a] -&gt; [PenSegment a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; [PenSegment a]
forall a. Num a =&gt; [(Point a, PathJoin a)] -&gt; [PenSegment a]
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen%27"><span class="hs-identifier hs-var">pathToPen'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679240591"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>  </span><span>
</span><span id="line-48"></span><span id="local-6989586621679240690"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#noTranslate"><span class="hs-identifier hs-type">noTranslate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240690"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240690"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240690"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-49"></span><span id="noTranslate"><span class="annot"><span class="annottext">noTranslate :: Transform a -&gt; Transform a
</span><a href="Geom2D.CubicBezier.Stroke.html#noTranslate"><span class="hs-identifier hs-var hs-var">noTranslate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679240584"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240584"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679240583"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240583"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240582"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240582"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240581"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240581"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Transform a
forall a. a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Transform a
</span><a href="Geom2D.html#Transform"><span class="hs-identifier hs-var">Transform</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240583"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240582"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240581"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621679240580"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679240580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#AffineTransform"><span class="hs-identifier hs-type">AffineTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679240580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.html#transform"><span class="hs-pragma hs-type">transform</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-pragma hs-type">Transform</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-pragma hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-pragma hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679240576"><span class="annot"><span class="annottext">transform :: Transform a -&gt; Pen a -&gt; Pen a
</span><a href="#local-6989586621679240576"><span class="hs-identifier hs-var hs-var hs-var hs-var">transform</span></a></span></span><span> </span><span id="local-6989586621679240575"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240575"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenEllipse"><span class="hs-identifier hs-type">PenEllipse</span></a></span><span> </span><span id="local-6989586621679240574"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240574"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679240573"><span class="annot"><span class="annottext">t2 :: Transform a
</span><a href="#local-6989586621679240573"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span id="local-6989586621679240572"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679240571"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240571"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679240570"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240570"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240569"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679240568"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240568"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679240567"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240567"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Transform a -&gt; Transform a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240575"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240574"><span class="hs-identifier hs-var">trans</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Maybe (Transform a)
forall a.
(Eq a, Fractional a) =&gt;
Transform a -&gt; Maybe (Transform a)
</span><a href="Geom2D.html#inverse"><span class="hs-identifier hs-var">inverse</span></a></span><span> </span><span class="annot"><span class="annottext">(Transform a -&gt; Maybe (Transform a))
-&gt; Transform a -&gt; Maybe (Transform a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Transform a
forall a. Num a =&gt; Transform a -&gt; Transform a
</span><a href="Geom2D.CubicBezier.Stroke.html#noTranslate"><span class="hs-identifier hs-var">noTranslate</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240573"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Transform a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedPath a -&gt; Pen a
forall a. Floating a =&gt; ClosedPath a -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#pathToPen"><span class="hs-identifier hs-var">pathToPen</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedPath a -&gt; Pen a) -&gt; ClosedPath a -&gt; Pen a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; ClosedPath a
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240570"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240567"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240563"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240570"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240567"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240563"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin a
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>          </span><span id="local-6989586621679240563"><span class="annot"><span class="annottext">p :: Point a
</span><a href="#local-6989586621679240563"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240571"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-63"></span><span>                </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240571"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240571"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-64"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240568"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-65"></span><span>                </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240568"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240568"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240572"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240569"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-67"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240571"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240571"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240568"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>              </span><span class="hs-comment">-- singular point: create tiny pen instead of an error</span><span>
</span><span id="line-69"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1e-5</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1e-5</span></span><span>
</span><span id="line-70"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679240555"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240555"><span class="hs-identifier hs-var">inv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">Transform a -&gt; Transform a -&gt; Transform a -&gt; Pen a
forall a. Transform a -&gt; Transform a -&gt; Transform a -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenEllipse"><span class="hs-identifier hs-var">PenEllipse</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240573"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Transform a -&gt; Transform a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90L"><span class="hs-identifier hs-var">rotate90L</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240555"><span class="hs-identifier hs-var">inv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Transform a -&gt; Transform a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90R"><span class="hs-identifier hs-var">rotate90R</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240555"><span class="hs-identifier hs-var">inv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span id="local-6989586621679240554"><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240554"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-type">PenPath</span></a></span><span> </span><span id="local-6989586621679240553"><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240553"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="annottext">[PenSegment a] -&gt; Pen a
forall a. [PenSegment a] -&gt; Pen a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-var">PenPath</span></a></span><span> </span><span class="annot"><span class="annottext">([PenSegment a] -&gt; Pen a) -&gt; [PenSegment a] -&gt; Pen a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PenSegment a -&gt; PenSegment a) -&gt; [PenSegment a] -&gt; [PenSegment a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; PenSegment a -&gt; PenSegment a
forall b. Num b =&gt; Transform b -&gt; PenSegment b -&gt; PenSegment b
</span><a href="Geom2D.CubicBezier.Stroke.html#transformSegment"><span class="hs-identifier hs-var">transformSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a
</span><a href="#local-6989586621679240554"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240553"><span class="hs-identifier hs-var">segments</span></a></span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="local-6989586621679240676"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#transformSegment"><span class="hs-identifier hs-type">transformSegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240676"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240676"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240676"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240676"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-77"></span><span id="transformSegment"><span class="annot"><span class="annottext">transformSegment :: Transform b -&gt; PenSegment b -&gt; PenSegment b
</span><a href="Geom2D.CubicBezier.Stroke.html#transformSegment"><span class="hs-identifier hs-var hs-var">transformSegment</span></a></span></span><span> </span><span id="local-6989586621679240551"><span class="annot"><span class="annottext">Transform b
</span><a href="#local-6989586621679240551"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span id="local-6989586621679240550"><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240550"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679240549"><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240549"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">Point b -&gt; Point b -&gt; PenSegment b
forall a. Point a -&gt; Point a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-var">PenCorner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform b -&gt; Point b -&gt; Point b
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform b
</span><a href="#local-6989586621679240551"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240549"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">Point b -&gt; Point b -&gt; Point b
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240550"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point b -&gt; Point b -&gt; Point b
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240548"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240548"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240548"><span class="annot"><span class="annottext">q' :: Point b
</span><a href="#local-6989586621679240548"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform b -&gt; Point b -&gt; Point b
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform b
</span><a href="#local-6989586621679240551"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240549"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#transformSegment"><span class="hs-identifier hs-var">transformSegment</span></a></span><span> </span><span id="local-6989586621679240547"><span class="annot"><span class="annottext">Transform b
</span><a href="#local-6989586621679240547"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span id="local-6989586621679240546"><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240546"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679240545"><span class="annot"><span class="annottext">CubicBezier b
</span><a href="#local-6989586621679240545"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="annottext">Point b -&gt; CubicBezier b -&gt; PenSegment b
forall a. Point a -&gt; CubicBezier a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-var">PenCurve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform b -&gt; Point b -&gt; Point b
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform b
</span><a href="#local-6989586621679240547"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier b -&gt; Point b
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC0"><span class="hs-identifier hs-var hs-var">cubicC0</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier b
</span><a href="#local-6989586621679240545"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Point b -&gt; Point b -&gt; Point b
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point b
</span><a href="#local-6989586621679240546"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point b -&gt; Point b -&gt; Point b
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier b -&gt; Point b
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC0"><span class="hs-identifier hs-var hs-var">cubicC0</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier b
</span><a href="#local-6989586621679240543"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">CubicBezier b
</span><a href="#local-6989586621679240543"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240543"><span class="annot"><span class="annottext">c' :: CubicBezier b
</span><a href="#local-6989586621679240543"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Transform b -&gt; CubicBezier b -&gt; CubicBezier b
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform b
</span><a href="#local-6989586621679240547"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier b
</span><a href="#local-6989586621679240545"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679240671"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#offsetPoint"><span class="hs-identifier hs-type">offsetPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240671"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>  </span><span class="annot"><a href="#local-6989586621679240671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240671"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240671"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-86"></span><span id="offsetPoint"><span class="annot"><span class="annottext">offsetPoint :: a -&gt; Point a -&gt; Point a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#offsetPoint"><span class="hs-identifier hs-var hs-var">offsetPoint</span></a></span></span><span> </span><span id="local-6989586621679240541"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240541"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679240540"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240540"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679240539"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240539"><span class="hs-identifier hs-var">tangent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240540"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a
forall s. Floating s =&gt; Transform s
</span><a href="Geom2D.html#rotate90L"><span class="hs-identifier hs-var">rotate90L</span></a></span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679240541"><span class="hs-identifier hs-var">dist</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a
forall a. Floating a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#normVector"><span class="hs-identifier hs-var">normVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240539"><span class="hs-identifier hs-var">tangent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#bezierOffsetPoint"><span class="hs-identifier hs-type">bezierOffsetPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span id="bezierOffsetPoint"><span class="annot"><span class="annottext">bezierOffsetPoint :: CubicBezier Double -&gt; Double -&gt; Double -&gt; (DPoint, DPoint)
</span><a href="Geom2D.CubicBezier.Stroke.html#bezierOffsetPoint"><span class="hs-identifier hs-var hs-var">bezierOffsetPoint</span></a></span></span><span> </span><span id="local-6989586621679240535"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240535"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679240534"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240534"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679240533"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240533"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; DPoint -&gt; DPoint -&gt; DPoint
forall a. Floating a =&gt; a -&gt; Point a -&gt; Point a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#offsetPoint"><span class="hs-identifier hs-var">offsetPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240534"><span class="hs-identifier hs-var">dist</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240532"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240531"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240531"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240532"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240532"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240531"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240531"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (DPoint, DPoint)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240535"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240533"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Calculate an offset path from the bezier curve to within</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- tolerance.  If the distance is positive offset to the left,</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- otherwise to the right. A smaller tolerance may require more bezier</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- curves in the path to approximate the offset curve</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#bezierOffset"><span class="hs-identifier hs-type">bezierOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-comment">-- ^ The curve</span><span>
</span><span id="line-98"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>      </span><span class="hs-comment">-- ^ Offset distance.</span><span>
</span><span id="line-99"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>   </span><span class="hs-comment">-- ^ maximum subcurves</span><span>
</span><span id="line-100"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>      </span><span class="hs-comment">-- ^ Tolerance.</span><span>
</span><span id="line-101"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>        </span><span class="hs-comment">-- ^ Calculate the curve faster but with</span><span>
</span><span id="line-102"></span><span>                            </span><span class="hs-comment">-- more subcurves</span><span>
</span><span id="line-103"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>        </span><span class="hs-comment">-- ^ The offset curve</span><span>
</span><span id="line-104"></span><span id="bezierOffset"><span class="annot"><span class="annottext">bezierOffset :: CubicBezier Double
-&gt; Double -&gt; Maybe Int -&gt; Double -&gt; Bool -&gt; [CubicBezier Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#bezierOffset"><span class="hs-identifier hs-var hs-var">bezierOffset</span></a></span></span><span> </span><span id="local-6989586621679240529"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240529"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679240528"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240528"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679240527"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240527"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240526"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240526"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240525"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240525"><span class="hs-identifier hs-var">faster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="annottext">Int
-&gt; (Double -&gt; (DPoint, DPoint))
-&gt; Int
-&gt; Double
-&gt; Double
-&gt; Double
-&gt; Bool
-&gt; [CubicBezier Double]
forall a.
(Unbox a, Floating a, Ord a) =&gt;
Int
-&gt; (a -&gt; (Point a, Point a))
-&gt; Int
-&gt; a
-&gt; a
-&gt; a
-&gt; Bool
-&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePathMax"><span class="hs-identifier hs-var">approximatePathMax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240527"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; Double -&gt; (DPoint, DPoint)
</span><a href="Geom2D.CubicBezier.Stroke.html#bezierOffsetPoint"><span class="hs-identifier hs-var">bezierOffsetPoint</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240529"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240528"><span class="hs-identifier hs-var">dist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240526"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240525"><span class="hs-identifier hs-var">faster</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#bezierOffset"><span class="hs-identifier hs-var">bezierOffset</span></a></span><span> </span><span id="local-6989586621679240523"><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240523"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span id="local-6989586621679240522"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240522"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679240521"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240521"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240520"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240520"><span class="hs-identifier hs-var">faster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">(Double -&gt; (DPoint, DPoint))
-&gt; Int
-&gt; Double
-&gt; Double
-&gt; Double
-&gt; Bool
-&gt; [CubicBezier Double]
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-identifier hs-var">approximatePath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; Double -&gt; (DPoint, DPoint)
</span><a href="Geom2D.CubicBezier.Stroke.html#bezierOffsetPoint"><span class="hs-identifier hs-var">bezierOffsetPoint</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240523"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240522"><span class="hs-identifier hs-var">dist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240521"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240520"><span class="hs-identifier hs-var">faster</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penOffset"><span class="hs-identifier hs-type">penOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-111"></span><span id="penOffset"><span class="annot"><span class="annottext">penOffset :: Pen Double -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffset"><span class="hs-identifier hs-var hs-var">penOffset</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenEllipse"><span class="hs-identifier hs-type">PenEllipse</span></a></span><span> </span><span id="local-6989586621679240517"><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240517"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span id="local-6989586621679240516"><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240516"><span class="hs-identifier hs-var">leftInv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240515"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240515"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="annottext">Transform Double -&gt; DPoint -&gt; DPoint
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#transform"><span class="hs-identifier hs-var">transform</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240517"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; DPoint) -&gt; DPoint -&gt; DPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint
forall a. Floating a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#normVector"><span class="hs-identifier hs-var">normVector</span></a></span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; DPoint) -&gt; DPoint -&gt; DPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240516"><span class="hs-identifier hs-var">leftInv</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; DPoint -&gt; DPoint
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240515"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penOffset"><span class="hs-identifier hs-var">penOffset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-type">PenPath</span></a></span><span> </span><span id="local-6989586621679240514"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240514"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240513"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240513"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; [PenSegment Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240514"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240513"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penOffsetFun"><span class="hs-identifier hs-type">penOffsetFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span id="penOffsetFun"><span class="annot"><span class="annottext">penOffsetFun :: Pen Double
-&gt; (Double -&gt; (DPoint, DPoint)) -&gt; Double -&gt; (DPoint, DPoint)
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffsetFun"><span class="hs-identifier hs-var hs-var">penOffsetFun</span></a></span></span><span> </span><span id="local-6989586621679240509"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240509"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span id="local-6989586621679240508"><span class="annot"><span class="annottext">Double -&gt; (DPoint, DPoint)
</span><a href="#local-6989586621679240508"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240507"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240507"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240506"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffset"><span class="hs-identifier hs-var">penOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240509"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240505"><span class="hs-identifier hs-var">px'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240505"><span class="hs-identifier hs-var">px'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679240506"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240506"><span class="hs-identifier hs-var">px</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240505"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240505"><span class="hs-identifier hs-var">px'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; (DPoint, DPoint)
</span><a href="#local-6989586621679240508"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240507"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679240660"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-type">firstPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240660"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240660"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-124"></span><span id="firstPoint"><span class="annot"><span class="annottext">firstPoint :: PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var hs-var">firstPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240503"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240503"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240503"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240502"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679240502"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC0"><span class="hs-identifier hs-var hs-var">cubicC0</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679240502"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-type">pathOffsetPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-128"></span><span id="pathOffsetPoint"><span class="annot"><span class="annottext">pathOffsetPoint :: [PenSegment Double] -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var hs-var">pathOffsetPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span id="local-6989586621679240501"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240501"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240500"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240500"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240499"><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240499"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240498"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240498"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240497"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240497"><span class="hs-identifier hs-var">dir</span></a></span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240497"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240501"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240499"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240498"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240497"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240497"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double -&gt; DPoint
forall a. PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240499"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240500"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240500"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240499"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240498"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240497"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span>
</span><span id="line-133"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span id="local-6989586621679240494"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240494"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240493"><span class="annot"><span class="annottext">curve :: CubicBezier Double
</span><a href="#local-6989586621679240493"><span class="hs-identifier hs-var">curve</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679240492"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240492"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679240491"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240491"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240490"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240490"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679240489"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240489"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240488"><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240488"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240487"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240487"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240486"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240494"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240488"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240487"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240491"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240492"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240492"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240490"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240489"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-var">findBezierTangent</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240493"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679240484"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240484"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; DPoint
forall (b :: * -&gt; *) a.
(GenericBezier b, Unbox a, Fractional a) =&gt;
b a -&gt; a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezier"><span class="hs-identifier hs-var">evalBezier</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240493"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240484"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240489"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double -&gt; DPoint
forall a. PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240488"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240489"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240489"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240488"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240487"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240486"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#pathOffsetPoint"><span class="hs-identifier hs-var">pathOffsetPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DPoint
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unexpected end of list&quot;</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-type">segDirs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span id="segDirs"><span class="annot"><span class="annottext">segDirs :: [(DPoint, PathJoin Double)] -&gt; DPoint -&gt; [(DPoint, DPoint)]
</span><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var hs-var">segDirs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679240480"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240480"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679240479"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240479"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240478"><span class="hs-identifier hs-var">dp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240478"><span class="hs-identifier hs-var">dp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240478"><span class="annot"><span class="annottext">dp :: DPoint
</span><a href="#local-6989586621679240478"><span class="hs-identifier hs-var hs-var">dp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240479"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240480"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679240477"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240477"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679240476"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240476"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240475"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240475"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679240474"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240474"><span class="hs-identifier hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240476"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240477"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240474"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240475"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240473"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240473"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240472"><span class="annot"><span class="annottext">r :: [(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240472"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240471"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240471"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240470"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240470"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240469"><span class="hs-identifier hs-var">dp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240469"><span class="hs-identifier hs-var">dp</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; [(DPoint, DPoint)] -&gt; [(DPoint, DPoint)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; DPoint -&gt; [(DPoint, DPoint)]
</span><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240472"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240470"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240469"><span class="annot"><span class="annottext">dp :: DPoint
</span><a href="#local-6989586621679240469"><span class="hs-identifier hs-var hs-var">dp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240471"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240473"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240468"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240468"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679240467"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240467"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240466"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240466"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240465"><span class="annot"><span class="annottext">r :: [(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240465"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679240464"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240464"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PathJoin Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240463"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240463"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240467"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240468"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240464"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240466"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; [(DPoint, DPoint)] -&gt; [(DPoint, DPoint)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; DPoint -&gt; [(DPoint, DPoint)]
</span><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240465"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240463"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penStrokeOpen"><span class="hs-identifier hs-type">penStrokeOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span id="penStrokeOpen"><span class="annot"><span class="annottext">penStrokeOpen :: Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; OpenPath Double
-&gt; [ClosedPath Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#penStrokeOpen"><span class="hs-identifier hs-var hs-var">penStrokeOpen</span></a></span></span><span> </span><span id="local-6989586621679240462"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240462"><span class="hs-identifier hs-var">samples</span></a></span></span><span> </span><span id="local-6989586621679240461"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240461"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240460"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240460"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span id="local-6989586621679240459"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679240457"><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240457"><span class="hs-identifier hs-var">segments</span></a></span></span><span> </span><span id="local-6989586621679240456"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240456"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">[ClosedPath Double] -&gt; FillRule -&gt; Double -&gt; [ClosedPath Double]
</span><a href="Geom2D.CubicBezier.Overlap.html#union"><span class="hs-identifier hs-var">union</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OpenPath Double -&gt; ClosedPath Double
forall a. OpenPath a -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#closeOpenPath"><span class="hs-identifier hs-var">closeOpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">OpenPath Double
</span><a href="#local-6989586621679240453"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FillRule
</span><a href="Geom2D.CubicBezier.Overlap.html#NonZero"><span class="hs-identifier hs-var">NonZero</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240461"><span class="hs-identifier hs-var">tol</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679240451"><span class="annot"><span class="annottext">dirs :: [(DPoint, DPoint)]
</span><a href="#local-6989586621679240451"><span class="hs-identifier hs-var hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; DPoint -&gt; [(DPoint, DPoint)]
</span><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240457"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint)
-&gt; (DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; (DPoint, PathJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240457"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679240449"><span class="annot"><span class="annottext">fdirs :: [DPoint]
</span><a href="#local-6989586621679240449"><span class="hs-identifier hs-var hs-var">fdirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, DPoint) -&gt; DPoint) -&gt; [(DPoint, DPoint)] -&gt; [DPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DPoint, DPoint)] -&gt; [(DPoint, DPoint)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240451"><span class="hs-identifier hs-var">dirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679240447"><span class="annot"><span class="annottext">fd :: DPoint
</span><a href="#local-6989586621679240447"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DPoint, DPoint) -&gt; DPoint) -&gt; (DPoint, DPoint) -&gt; DPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)] -&gt; (DPoint, DPoint)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240451"><span class="hs-identifier hs-var">dirs</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679240446"><span class="annot"><span class="annottext">ld :: DPoint
</span><a href="#local-6989586621679240446"><span class="hs-identifier hs-var hs-var">ld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((DPoint, DPoint) -&gt; DPoint) -&gt; (DPoint, DPoint) -&gt; DPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)] -&gt; (DPoint, DPoint)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240451"><span class="hs-identifier hs-var">dirs</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679240444"><span class="annot"><span class="annottext">ldirs :: [DPoint]
</span><a href="#local-6989586621679240444"><span class="hs-identifier hs-var hs-var">ldirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, DPoint) -&gt; DPoint) -&gt; [(DPoint, DPoint)] -&gt; [DPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240451"><span class="hs-identifier hs-var">dirs</span></a></span><span> </span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679240443"><span class="annot"><span class="annottext">pts :: [DPoint]
</span><a href="#local-6989586621679240443"><span class="hs-identifier hs-var hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint)
-&gt; [(DPoint, PathJoin Double)] -&gt; [DPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; [(DPoint, PathJoin Double)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240457"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint] -&gt; [DPoint] -&gt; [DPoint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240456"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679240442"><span class="annot"><span class="annottext">leftJoins :: [OpenPath Double]
</span><a href="#local-6989586621679240442"><span class="hs-identifier hs-var hs-var">leftJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; DPoint -&gt; OpenPath Double)
-&gt; [DPoint] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinLeft"><span class="hs-identifier hs-var">penJoinLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240444"><span class="hs-identifier hs-var">ldirs</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240449"><span class="hs-identifier hs-var">fdirs</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679240439"><span class="annot"><span class="annottext">leftStrokes :: [OpenPath Double]
</span><a href="#local-6989586621679240439"><span class="hs-identifier hs-var hs-var">leftStrokes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint -&gt; OpenPath Double)
-&gt; [(DPoint, PathJoin Double)] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; (DPoint, PathJoin Double)
-&gt; DPoint
-&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#strokeLeft"><span class="hs-identifier hs-var">strokeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240462"><span class="hs-identifier hs-var">samples</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240461"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240460"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240457"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240443"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679240437"><span class="annot"><span class="annottext">rightJoins :: [OpenPath Double]
</span><a href="#local-6989586621679240437"><span class="hs-identifier hs-var hs-var">rightJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; DPoint -&gt; OpenPath Double)
-&gt; [DPoint] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinRight"><span class="hs-identifier hs-var">penJoinRight</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240444"><span class="hs-identifier hs-var">ldirs</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240449"><span class="hs-identifier hs-var">fdirs</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679240435"><span class="annot"><span class="annottext">rightStrokes :: [OpenPath Double]
</span><a href="#local-6989586621679240435"><span class="hs-identifier hs-var hs-var">rightStrokes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint -&gt; OpenPath Double)
-&gt; [(DPoint, PathJoin Double)] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; (DPoint, PathJoin Double)
-&gt; DPoint
-&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#strokeRight"><span class="hs-identifier hs-var">strokeRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240462"><span class="hs-identifier hs-var">samples</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240461"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240460"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240457"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240443"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span id="local-6989586621679240453"><span class="annot"><span class="annottext">path :: OpenPath Double
</span><a href="#local-6989586621679240453"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; OpenPath Double
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([OpenPath Double] -&gt; OpenPath Double)
-&gt; [OpenPath Double] -&gt; OpenPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinLeft"><span class="hs-identifier hs-var">penJoinLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#turnAround"><span class="hs-identifier hs-var">turnAround</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240447"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240447"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="annot"><span class="annottext">OpenPath Double -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240439"><span class="hs-identifier hs-var">leftStrokes</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240442"><span class="hs-identifier hs-var">leftJoins</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinLeft"><span class="hs-identifier hs-var">penJoinLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240459"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240446"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#turnAround"><span class="hs-identifier hs-var">turnAround</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240446"><span class="hs-identifier hs-var">ld</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OpenPath Double -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240435"><span class="hs-identifier hs-var">rightStrokes</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240437"><span class="hs-identifier hs-var">rightJoins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679240430"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-type">interleave</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679240430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679240430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679240430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-176"></span><span id="interleave"><span class="annot"><span class="annottext">interleave :: [a] -&gt; [a] -&gt; [a]
</span><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679240429"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240429"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240429"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span id="local-6989586621679240428"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240428"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240428"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240427"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240427"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240426"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240426"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240425"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240425"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240424"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240424"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240427"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240425"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240426"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679240424"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">--penStrokeClosed :: ClosedPath Double -&gt; Pen Double -&gt; Double -&gt; [ClosedPath Double]</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penStrokeClosed"><span class="hs-identifier hs-type">penStrokeClosed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span id="penStrokeClosed"><span class="annot"><span class="annottext">penStrokeClosed :: Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; ClosedPath Double
-&gt; [ClosedPath Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#penStrokeClosed"><span class="hs-identifier hs-var hs-var">penStrokeClosed</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; ClosedPath Double
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penStrokeClosed"><span class="hs-identifier hs-var">penStrokeClosed</span></a></span><span> </span><span id="local-6989586621679240423"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240423"><span class="hs-identifier hs-var">samples</span></a></span></span><span> </span><span id="local-6989586621679240422"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240422"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240421"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240421"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span id="local-6989586621679240420"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240420"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span id="local-6989586621679240419"><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">[ClosedPath Double] -&gt; FillRule -&gt; Double -&gt; [ClosedPath Double]
</span><a href="Geom2D.CubicBezier.Overlap.html#union"><span class="hs-identifier hs-var">union</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OpenPath Double -&gt; ClosedPath Double
forall a. OpenPath a -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#closeOpenPath"><span class="hs-identifier hs-var">closeOpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">OpenPath Double
</span><a href="#local-6989586621679240418"><span class="hs-identifier hs-var">leftPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OpenPath Double -&gt; ClosedPath Double
forall a. OpenPath a -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#closeOpenPath"><span class="hs-identifier hs-var">closeOpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">OpenPath Double
</span><a href="#local-6989586621679240417"><span class="hs-identifier hs-var">rightPath</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FillRule
</span><a href="Geom2D.CubicBezier.Overlap.html#NonZero"><span class="hs-identifier hs-var">NonZero</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240422"><span class="hs-identifier hs-var">tol</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679240416"><span class="annot"><span class="annottext">dirs :: [(DPoint, DPoint)]
</span><a href="#local-6989586621679240416"><span class="hs-identifier hs-var hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; DPoint -&gt; [(DPoint, DPoint)]
</span><a href="Geom2D.CubicBezier.Stroke.html#segDirs"><span class="hs-identifier hs-var">segDirs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint)
-&gt; (DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; (DPoint, PathJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679240415"><span class="annot"><span class="annottext">fdirs :: [DPoint]
</span><a href="#local-6989586621679240415"><span class="hs-identifier hs-var hs-var">fdirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, DPoint) -&gt; DPoint) -&gt; [(DPoint, DPoint)] -&gt; [DPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DPoint, DPoint)] -&gt; [(DPoint, DPoint)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240416"><span class="hs-identifier hs-var">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint] -&gt; [DPoint] -&gt; [DPoint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DPoint, DPoint)] -&gt; (DPoint, DPoint)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240416"><span class="hs-identifier hs-var">dirs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679240414"><span class="annot"><span class="annottext">ldirs :: [DPoint]
</span><a href="#local-6989586621679240414"><span class="hs-identifier hs-var hs-var">ldirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, DPoint) -&gt; DPoint) -&gt; [(DPoint, DPoint)] -&gt; [DPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DPoint, DPoint) -&gt; DPoint
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, DPoint)]
</span><a href="#local-6989586621679240416"><span class="hs-identifier hs-var">dirs</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679240413"><span class="annot"><span class="annottext">pts :: [DPoint]
</span><a href="#local-6989586621679240413"><span class="hs-identifier hs-var hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint)
-&gt; [(DPoint, PathJoin Double)] -&gt; [DPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; [(DPoint, PathJoin Double)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint] -&gt; [DPoint] -&gt; [DPoint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(DPoint, PathJoin Double) -&gt; DPoint
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; (DPoint, PathJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679240412"><span class="annot"><span class="annottext">leftJoins :: [OpenPath Double]
</span><a href="#local-6989586621679240412"><span class="hs-identifier hs-var hs-var">leftJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; DPoint -&gt; OpenPath Double)
-&gt; [DPoint] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinLeft"><span class="hs-identifier hs-var">penJoinLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240420"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240414"><span class="hs-identifier hs-var">ldirs</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240415"><span class="hs-identifier hs-var">fdirs</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679240411"><span class="annot"><span class="annottext">leftStrokes :: [OpenPath Double]
</span><a href="#local-6989586621679240411"><span class="hs-identifier hs-var hs-var">leftStrokes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint -&gt; OpenPath Double)
-&gt; [(DPoint, PathJoin Double)] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; (DPoint, PathJoin Double)
-&gt; DPoint
-&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#strokeLeft"><span class="hs-identifier hs-var">strokeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240423"><span class="hs-identifier hs-var">samples</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240422"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240421"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240420"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240413"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679240410"><span class="annot"><span class="annottext">rightJoins :: [OpenPath Double]
</span><a href="#local-6989586621679240410"><span class="hs-identifier hs-var hs-var">rightJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; DPoint -&gt; OpenPath Double)
-&gt; [DPoint] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinRight"><span class="hs-identifier hs-var">penJoinRight</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240420"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240414"><span class="hs-identifier hs-var">ldirs</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240415"><span class="hs-identifier hs-var">fdirs</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679240409"><span class="annot"><span class="annottext">rightStrokes :: [OpenPath Double]
</span><a href="#local-6989586621679240409"><span class="hs-identifier hs-var hs-var">rightStrokes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DPoint, PathJoin Double) -&gt; DPoint -&gt; OpenPath Double)
-&gt; [(DPoint, PathJoin Double)] -&gt; [DPoint] -&gt; [OpenPath Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; (DPoint, PathJoin Double)
-&gt; DPoint
-&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#strokeRight"><span class="hs-identifier hs-var">strokeRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240423"><span class="hs-identifier hs-var">samples</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240422"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240421"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240420"><span class="hs-identifier hs-var">pen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)]
</span><a href="#local-6989586621679240419"><span class="hs-identifier hs-var">segments</span></a></span><span> </span><span class="annot"><span class="annottext">[DPoint]
</span><a href="#local-6989586621679240413"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679240418"><span class="annot"><span class="annottext">leftPath :: OpenPath Double
</span><a href="#local-6989586621679240418"><span class="hs-identifier hs-var hs-var">leftPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; OpenPath Double
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([OpenPath Double] -&gt; OpenPath Double)
-&gt; [OpenPath Double] -&gt; OpenPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240411"><span class="hs-identifier hs-var">leftStrokes</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240412"><span class="hs-identifier hs-var">leftJoins</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621679240417"><span class="annot"><span class="annottext">rightPath :: OpenPath Double
</span><a href="#local-6989586621679240417"><span class="hs-identifier hs-var hs-var">rightPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>      </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; OpenPath Double
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([OpenPath Double] -&gt; OpenPath Double)
-&gt; [OpenPath Double] -&gt; OpenPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([OpenPath Double] -&gt; [OpenPath Double])
-&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [OpenPath Double] -&gt; [OpenPath Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Geom2D.CubicBezier.Stroke.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240409"><span class="hs-identifier hs-var">rightStrokes</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenPath Double]
</span><a href="#local-6989586621679240410"><span class="hs-identifier hs-var">rightJoins</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#strokeLeft"><span class="hs-identifier hs-type">strokeLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-201"></span><span id="strokeLeft"><span class="annot"><span class="annottext">strokeLeft :: Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; (DPoint, PathJoin Double)
-&gt; DPoint
-&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#strokeLeft"><span class="hs-identifier hs-var hs-var">strokeLeft</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240408"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240408"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240407"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240407"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240406"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240406"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; DPoint -&gt; OpenPath Double
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240407"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240405"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240406"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240405"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240405"><span class="annot"><span class="annottext">offset :: DPoint
</span><a href="#local-6989586621679240405"><span class="hs-identifier hs-var hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffset"><span class="hs-identifier hs-var">penOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240408"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240406"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240407"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#strokeLeft"><span class="hs-identifier hs-var">strokeLeft</span></a></span><span> </span><span id="local-6989586621679240404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240404"><span class="hs-identifier hs-var">samples</span></a></span></span><span> </span><span id="local-6989586621679240403"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240403"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240402"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240402"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span id="local-6989586621679240401"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240401"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240400"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240400"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679240399"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240399"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240398"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240398"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240397"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240397"><span class="hs-identifier hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><span class="annottext">[CubicBezier Double] -&gt; OpenPath Double
forall a. [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="annot"><span class="annottext">([CubicBezier Double] -&gt; OpenPath Double)
-&gt; [CubicBezier Double] -&gt; OpenPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; (DPoint, DPoint))
-&gt; Int
-&gt; Double
-&gt; Double
-&gt; Double
-&gt; Bool
-&gt; [CubicBezier Double]
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-identifier hs-var">approximatePath</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pen Double
-&gt; (Double -&gt; (DPoint, DPoint)) -&gt; Double -&gt; (DPoint, DPoint)
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffsetFun"><span class="hs-identifier hs-var">penOffsetFun</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240401"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (DPoint, DPoint)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint -&gt; DPoint -&gt; CubicBezier Double
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240400"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240399"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240398"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240397"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240404"><span class="hs-identifier hs-var">samples</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240403"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240402"><span class="hs-identifier hs-var">fast</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#strokeRight"><span class="hs-identifier hs-type">strokeRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-211"></span><span id="strokeRight"><span class="annot"><span class="annottext">strokeRight :: Int
-&gt; Double
-&gt; Bool
-&gt; Pen Double
-&gt; (DPoint, PathJoin Double)
-&gt; DPoint
-&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#strokeRight"><span class="hs-identifier hs-var hs-var">strokeRight</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240395"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240395"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240394"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240394"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240393"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240393"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">[(DPoint, PathJoin Double)] -&gt; DPoint -&gt; OpenPath Double
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240393"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240392"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240394"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240392"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240392"><span class="annot"><span class="annottext">offset :: DPoint
</span><a href="#local-6989586621679240392"><span class="hs-identifier hs-var hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffset"><span class="hs-identifier hs-var">penOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240395"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240394"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240393"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#strokeRight"><span class="hs-identifier hs-var">strokeRight</span></a></span><span> </span><span id="local-6989586621679240391"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240391"><span class="hs-identifier hs-var">samples</span></a></span></span><span> </span><span id="local-6989586621679240390"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240390"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240389"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240389"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span id="local-6989586621679240388"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240388"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240387"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240387"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-type">JoinCurve</span></a></span><span> </span><span id="local-6989586621679240386"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240386"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240385"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240385"><span class="hs-identifier hs-var">p3</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240384"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240384"><span class="hs-identifier hs-var">p4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><span class="annottext">[CubicBezier Double] -&gt; OpenPath Double
forall a. [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="annot"><span class="annottext">([CubicBezier Double] -&gt; OpenPath Double)
-&gt; [CubicBezier Double] -&gt; OpenPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; (DPoint, DPoint))
-&gt; Int
-&gt; Double
-&gt; Double
-&gt; Double
-&gt; Bool
-&gt; [CubicBezier Double]
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-identifier hs-var">approximatePath</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pen Double
-&gt; (Double -&gt; (DPoint, DPoint)) -&gt; Double -&gt; (DPoint, DPoint)
</span><a href="Geom2D.CubicBezier.Stroke.html#penOffsetFun"><span class="hs-identifier hs-var">penOffsetFun</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240388"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double -&gt; Double -&gt; (DPoint, DPoint)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint -&gt; DPoint -&gt; CubicBezier Double
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240384"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240385"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240386"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240387"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240391"><span class="hs-identifier hs-var">samples</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240390"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240389"><span class="hs-identifier hs-var">fast</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penJoinLeft"><span class="hs-identifier hs-type">penJoinLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-221"></span><span id="penJoinLeft"><span class="annot"><span class="annottext">penJoinLeft :: Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinLeft"><span class="hs-identifier hs-var hs-var">penJoinLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoin"><span class="hs-identifier hs-var">penJoin</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penJoinRight"><span class="hs-identifier hs-type">penJoinRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-224"></span><span id="penJoinRight"><span class="annot"><span class="annottext">penJoinRight :: Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoinRight"><span class="hs-identifier hs-var hs-var">penJoinRight</span></a></span></span><span> </span><span id="local-6989586621679240382"><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240382"><span class="hs-identifier hs-var">pen</span></a></span></span><span> </span><span id="local-6989586621679240381"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240381"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679240380"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240380"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoin"><span class="hs-identifier hs-var">penJoin</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240382"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#turnAround"><span class="hs-identifier hs-var">turnAround</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240380"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#turnAround"><span class="hs-identifier hs-var">turnAround</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240381"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#ellipticArc"><span class="hs-identifier hs-type">ellipticArc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Transform"><span class="hs-identifier hs-type">Transform</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-228"></span><span id="ellipticArc"><span class="annot"><span class="annottext">ellipticArc :: Transform Double
-&gt; Transform Double -&gt; DPoint -&gt; DPoint -&gt; CubicBezier Double
</span><a href="Geom2D.CubicBezier.Stroke.html#ellipticArc"><span class="hs-identifier hs-var hs-var">ellipticArc</span></a></span></span><span> </span><span id="local-6989586621679240378"><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240378"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span id="local-6989586621679240377"><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240377"><span class="hs-identifier hs-var">leftInv</span></a></span></span><span> </span><span id="local-6989586621679240376"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240376"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679240375"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240375"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240378"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; CubicBezier Double -&gt; CubicBezier Double
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; CubicBezier Double
</span><a href="Geom2D.CubicBezier.Basic.html#bezierArc"><span class="hs-identifier hs-var">bezierArc</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; Double
forall a. RealFloat a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorAngle"><span class="hs-identifier hs-var">vectorAngle</span></a></span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; Double) -&gt; DPoint -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240377"><span class="hs-identifier hs-var">leftInv</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; DPoint -&gt; DPoint
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240376"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint -&gt; Double
forall a. RealFloat a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorAngle"><span class="hs-identifier hs-var">vectorAngle</span></a></span><span> </span><span class="annot"><span class="annottext">(DPoint -&gt; Double) -&gt; DPoint -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240377"><span class="hs-identifier hs-var">leftInv</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; DPoint -&gt; DPoint
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240375"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span id="local-6989586621679240635"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-type">segmentsToPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679240635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240635"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-234"></span><span id="segmentsToPath"><span class="annot"><span class="annottext">segmentsToPath :: [PenSegment a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var hs-var">segmentsToPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240371"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240371"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240371"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679240370"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240370"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679240369"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240369"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240368"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240368"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679240367"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240367"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240370"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; PathJoin a
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240369"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240368"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240367"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span>
</span><span id="line-239"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679240366"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240366"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240365"><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240365"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
forall a. Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#consOpenPath"><span class="hs-identifier hs-var">consOpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240366"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PathJoin a
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PenSegment a] -&gt; OpenPath a
forall a. Eq a =&gt; [PenSegment a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240365"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679240363"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240363"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679240362"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240362"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240361"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240361"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679240360"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240360"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240359"><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240359"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
forall a. Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#consOpenPath"><span class="hs-identifier hs-var">consOpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240363"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; PathJoin a
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240362"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240361"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OpenPath a -&gt; OpenPath a) -&gt; OpenPath a -&gt; OpenPath a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240359"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679240358"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240358"><span class="hs-identifier hs-var">q1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[PenSegment a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240360"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240358"><span class="hs-identifier hs-var">q1</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
forall a. Point a -&gt; PathJoin a -&gt; OpenPath a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#consOpenPath"><span class="hs-identifier hs-var">consOpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240360"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">PathJoin a
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span> </span><span class="annot"><span class="annottext">(OpenPath a -&gt; OpenPath a) -&gt; OpenPath a -&gt; OpenPath a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PenSegment a] -&gt; OpenPath a
forall a. Eq a =&gt; [PenSegment a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240359"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">[PenSegment a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[PenSegment a] -&gt; OpenPath a
forall a. Eq a =&gt; [PenSegment a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="annot"><span class="annottext">[PenSegment a]
</span><a href="#local-6989586621679240359"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenPath a
forall a. OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#emptyOpenPath"><span class="hs-identifier hs-var">emptyOpenPath</span></a></span><span>  </span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span id="local-6989586621679240634"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#emptyOpenPath"><span class="hs-identifier hs-type">emptyOpenPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240634"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-252"></span><span id="emptyOpenPath"><span class="annot"><span class="annottext">emptyOpenPath :: OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#emptyOpenPath"><span class="hs-identifier hs-var hs-var">emptyOpenPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Point a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;empty path&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span>
</span><span id="line-254"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penJoin"><span class="hs-identifier hs-type">penJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#Pen"><span class="hs-identifier hs-type">Pen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-256"></span><span id="penJoin"><span class="annot"><span class="annottext">penJoin :: Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoin"><span class="hs-identifier hs-var hs-var">penJoin</span></a></span></span><span> </span><span id="local-6989586621679240356"><span class="annot"><span class="annottext">pen :: Pen Double
</span><a href="#local-6989586621679240356"><span class="hs-identifier hs-var">pen</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenEllipse"><span class="hs-identifier hs-type">PenEllipse</span></a></span><span> </span><span id="local-6989586621679240355"><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240355"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span id="local-6989586621679240354"><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240354"><span class="hs-identifier hs-var">leftInv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240353"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240353"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679240352"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240352"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240351"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpenPath Double
forall a. OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#emptyOpenPath"><span class="hs-identifier hs-var">emptyOpenPath</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240351"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Bool
forall a. (Num a, Eq a) =&gt; Point a -&gt; Point a -&gt; Bool
</span><a href="Geom2D.CubicBezier.Stroke.html#sameQuadrant"><span class="hs-identifier hs-var">sameQuadrant</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240353"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240352"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">[CubicBezier Double] -&gt; OpenPath Double
forall a. [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Transform Double
-&gt; Transform Double -&gt; DPoint -&gt; DPoint -&gt; CubicBezier Double
</span><a href="Geom2D.CubicBezier.Stroke.html#ellipticArc"><span class="hs-identifier hs-var">ellipticArc</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240355"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240354"><span class="hs-identifier hs-var">leftInv</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240353"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240352"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">[CubicBezier Double] -&gt; OpenPath Double
forall a. [CubicBezier a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#curvesToOpen"><span class="hs-identifier hs-var">curvesToOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Transform Double
-&gt; Transform Double -&gt; DPoint -&gt; DPoint -&gt; CubicBezier Double
</span><a href="Geom2D.CubicBezier.Stroke.html#ellipticArc"><span class="hs-identifier hs-var">ellipticArc</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240355"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double
</span><a href="#local-6989586621679240354"><span class="hs-identifier hs-var">leftInv</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240353"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240349"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OpenPath Double -&gt; OpenPath Double -&gt; OpenPath Double
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">Pen Double -&gt; DPoint -&gt; DPoint -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.Stroke.html#penJoin"><span class="hs-identifier hs-var">penJoin</span></a></span><span> </span><span class="annot"><span class="annottext">Pen Double
</span><a href="#local-6989586621679240356"><span class="hs-identifier hs-var">pen</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240349"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240352"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240349"><span class="annot"><span class="annottext">next :: DPoint
</span><a href="#local-6989586621679240349"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint
forall a1 a. (Ord a1, Num a1, Num a) =&gt; Point a1 -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#nextVector"><span class="hs-identifier hs-var">nextVector</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240353"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-265"></span><span>            </span><span id="local-6989586621679240351"><span class="annot"><span class="annottext">dir :: Double
</span><a href="#local-6989586621679240351"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240353"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240352"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#penJoin"><span class="hs-identifier hs-var">penJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenPath"><span class="hs-identifier hs-type">PenPath</span></a></span><span> </span><span id="local-6989586621679240347"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240347"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240346"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240346"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679240345"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240345"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; OpenPath Double
forall a. Eq a =&gt; [PenSegment a] -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Stroke.html#segmentsToPath"><span class="hs-identifier hs-var">segmentsToPath</span></a></span><span> </span><span class="annot"><span class="annottext">([PenSegment Double] -&gt; OpenPath Double)
-&gt; [PenSegment Double] -&gt; OpenPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-var">nextSegments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; [PenSegment Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240347"><span class="hs-identifier hs-var">segments</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240346"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240345"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-type">firstSegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span id="firstSegment"><span class="annot"><span class="annottext">firstSegment :: [PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var hs-var">firstSegment</span></a></span></span><span> </span><span id="local-6989586621679240342"><span class="annot"><span class="annottext">segments :: [PenSegment Double]
</span><a href="#local-6989586621679240342"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span id="local-6989586621679240341"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240341"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240340"><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240340"><span class="hs-identifier hs-var">q</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240339"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240339"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240338"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240338"><span class="hs-identifier hs-var">from</span></a></span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240338"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240341"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240340"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240339"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240338"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240342"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span id="local-6989586621679240337"><span class="annot"><span class="annottext">segments :: [PenSegment Double]
</span><a href="#local-6989586621679240337"><span class="hs-identifier hs-var">segments</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span id="local-6989586621679240336"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240336"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240335"><span class="annot"><span class="annottext">curve :: CubicBezier Double
</span><a href="#local-6989586621679240335"><span class="hs-identifier hs-var">curve</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679240334"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240334"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679240333"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240333"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240332"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240332"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679240331"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240331"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240330"><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240329"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240329"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240328"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240336"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240329"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240333"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240334"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240337"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240331"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240332"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-var">findBezierTangent</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240335"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679240327"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240327"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; CubicBezier Double -&gt; PenSegment Double
forall a. Point a -&gt; CubicBezier a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-var">PenCurve</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CubicBezier Double, CubicBezier Double) -&gt; CubicBezier Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; (CubicBezier Double, CubicBezier Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240335"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240327"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240329"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240329"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double -&gt; DPoint
forall a. PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240331"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; PenSegment Double
forall a. Point a -&gt; Point a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-var">PenCorner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double -&gt; DPoint
forall a. PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240331"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240331"><span class="hs-identifier hs-var">p4</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240329"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240330"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240329"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240328"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [PenSegment Double]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;firstsegment: finite list&quot;</span></span><span>  </span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-type">nextSegments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenSegment"><span class="hs-identifier hs-type">PenSegment</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span id="nextSegments"><span class="annot"><span class="annottext">nextSegments :: [PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-var hs-var">nextSegments</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-type">PenCorner</span></a></span><span> </span><span id="local-6989586621679240325"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240325"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240324"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240324"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240323"><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240323"><span class="hs-identifier hs-var">q</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240322"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240322"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240321"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240321"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240321"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240325"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; PenSegment Double
forall a. Point a -&gt; Point a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-var">PenCorner</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240325"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240324"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-var">nextSegments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240323"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240322"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240321"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-var">nextSegments</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240320"><span class="annot"><span class="annottext">pc :: PenSegment Double
</span><a href="#local-6989586621679240320"><span class="hs-identifier hs-var">pc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-type">PenCurve</span></a></span><span> </span><span id="local-6989586621679240319"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240319"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679240318"><span class="annot"><span class="annottext">curve :: CubicBezier Double
</span><a href="#local-6989586621679240318"><span class="hs-identifier hs-var">curve</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679240317"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240317"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679240316"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240316"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679240315"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240315"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679240314"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240314"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240313"><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240313"><span class="hs-identifier hs-var">q</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679240312"><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240312"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679240311"><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span></span><span>  </span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240319"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240320"><span class="hs-identifier hs-var">pc</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-var">nextSegments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240313"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240312"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240316"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240317"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240314"><span class="hs-identifier hs-var">p4</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240315"><span class="hs-identifier hs-var">p3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; CubicBezier Double -&gt; [Double]
</span><a href="Geom2D.CubicBezier.Basic.html#findBezierTangent"><span class="hs-identifier hs-var">findBezierTangent</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240318"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679240310"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240310"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPoint -&gt; CubicBezier Double -&gt; PenSegment Double
forall a. Point a -&gt; CubicBezier a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCurve"><span class="hs-identifier hs-var">PenCurve</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240319"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CubicBezier Double, CubicBezier Double) -&gt; CubicBezier Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier Double
-&gt; Double -&gt; (CubicBezier Double, CubicBezier Double)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (b a, b a)
</span><a href="Geom2D.CubicBezier.Basic.html#splitBezier"><span class="hs-identifier hs-var">splitBezier</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier Double
</span><a href="#local-6989586621679240318"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679240310"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; Double
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorCross"><span class="hs-identifier hs-var">vectorCross</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double -&gt; DPoint
forall a. PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240313"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240314"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; PenSegment Double
forall a. Point a -&gt; Point a -&gt; PenSegment a
</span><a href="Geom2D.CubicBezier.Stroke.html#PenCorner"><span class="hs-identifier hs-var">PenCorner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double -&gt; DPoint
forall a. PenSegment a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#firstPoint"><span class="hs-identifier hs-var">firstPoint</span></a></span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240313"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">DPoint -&gt; DPoint -&gt; DPoint
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240314"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240314"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240320"><span class="hs-identifier hs-var">pc</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double] -&gt; DPoint -&gt; [PenSegment Double]
</span><a href="Geom2D.CubicBezier.Stroke.html#firstSegment"><span class="hs-identifier hs-var">firstSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PenSegment Double
</span><a href="#local-6989586621679240313"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">PenSegment Double -&gt; [PenSegment Double] -&gt; [PenSegment Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[PenSegment Double]
</span><a href="#local-6989586621679240312"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPoint
</span><a href="#local-6989586621679240311"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#nextSegments"><span class="hs-identifier hs-var">nextSegments</span></a></span><span> </span><span class="annot"><span class="annottext">[PenSegment Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [PenSegment Double]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;nextSegments: finite list&quot;</span></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621679240632"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#sameQuadrant"><span class="hs-identifier hs-type">sameQuadrant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240632"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679240632"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240632"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-310"></span><span id="sameQuadrant"><span class="annot"><span class="annottext">sameQuadrant :: Point a -&gt; Point a -&gt; Bool
</span><a href="Geom2D.CubicBezier.Stroke.html#sameQuadrant"><span class="hs-identifier hs-var hs-var">sameQuadrant</span></a></span></span><span> </span><span id="local-6989586621679240309"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240309"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679240308"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240308"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240309"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240308"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240309"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240308"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span id="local-6989586621679240629"><span id="local-6989586621679240630"><span class="annot"><a href="Geom2D.CubicBezier.Stroke.html#nextVector"><span class="hs-identifier hs-type">nextVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240630"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240630"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240629"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240630"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240629"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-315"></span><span id="nextVector"><span class="annot"><span class="annottext">nextVector :: Point a1 -&gt; Point a
</span><a href="Geom2D.CubicBezier.Stroke.html#nextVector"><span class="hs-identifier hs-var hs-var">nextVector</span></a></span></span><span> </span><span id="local-6989586621679240304"><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point a1 -&gt; a1
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a1 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">Point a1 -&gt; a1
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a1 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point a1 -&gt; a1
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a1 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">Point a1 -&gt; a1
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a1 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point a1 -&gt; a1
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a1 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">Point a1 -&gt; a1
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a1
</span><a href="#local-6989586621679240304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a1 -&gt; a1 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a1
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-323"></span><span>  </span><span>
</span><span id="line-324"></span></pre></body></html>