<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFoldable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns, DeriveFunctor #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | This module implements an extension to paths as used in</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- D.E.Knuth's /Metafont/.  Metafont gives an alternate way</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- to specify paths using bezier curves.  I'll give a brief overview of</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- the metafont curves.  A more in depth explanation can be found in </span><span>
</span><span id="line-8"></span><span class="hs-comment">-- /The MetafontBook/.</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- </span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Each spline has a tension parameter, which is a relative measure of</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- the length of the curve.  You can specify the tension for the left</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- side and the right side of the spline separately.  By default</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- metafont gives a tension of 1, which gives a good looking curve.</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Tensions shouldn't be less than 3/4, but this implementation</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- doesn't check for it.  If you want to avoid points of inflection on</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- the spline, you can use @TensionAtLeast@ instead of @Tension@,</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- which will adjust the length of the control points so they fall</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- into the /bounding triangle/, if such a triangle exist.</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- You can either give directions for each node, or let metafont find</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- them.  Metafont will solve a set of equations to find the</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- directions.  You can also let metafont find directions at corner</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- points by setting the /curl/, which is how much the point /curls/</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- at that point.  At endpoints a curl of 1 is implied when it is not</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- given.</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- Metafont will then find the control points from the path for you.</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- You can also specify the control points explicitly.</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Here is an example path from the metafont program text:</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- </span><span>
</span><span id="line-32"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- z0..z1..tension atleast 1..{curl 2}z2..z3{-1,-2}..tension 3 and 4..z4..controls z45 and z54..z5</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- </span><span>
</span><span id="line-36"></span><span class="hs-comment">-- This path is equivalent to:</span><span>
</span><span id="line-37"></span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- z0{curl 1}..tension atleast 1 and atleast 1..{curl 2}z2{curl 2}..tension 1 and 1..</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- {-1,-2}z3{-1,-2}..tension 3 and 4..z4..controls z45 and z54..z5</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- This path can be used with the following datatype:</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- </span><span>
</span><span id="line-45"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- OpenMetaPath [ (z0, MetaJoin Open (Tension 1) (Tension 1) Open)</span><span>
</span><span id="line-47"></span><span class="hs-comment">--              , (z1, MetaJoin Open (TensionAtLeast 1) (TensionAtLeast 1) (Curl 2))</span><span>
</span><span id="line-48"></span><span class="hs-comment">--              , (z2, MetaJoin Open (Tension 1) (Tension 1) Open)</span><span>
</span><span id="line-49"></span><span class="hs-comment">--              , (z3, MetaJoin (Direction (Point (-1) (-2))) (Tension 3) (Tension 4) Open)</span><span>
</span><span id="line-50"></span><span class="hs-comment">--              , (z4, Controls z45 z54)</span><span>
</span><span id="line-51"></span><span class="hs-comment">--              ] z5</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Cyclic paths are similar, but use the @CyclicMetaPath@ contructor.</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- There is no ending point, since the ending point will be the same</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- as the first point.</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geom2D.CubicBezier.MetaPath</span><span>
</span><span id="line-59"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen"><span class="hs-identifier">unmetaOpen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaClosed"><span class="hs-identifier">unmetaClosed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier">ClosedMetaPath</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier">OpenMetaPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaNodeType"><span class="hs-identifier">MetaNodeType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier">Tension</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.html"><span class="hs-identifier">Geom2D</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html"><span class="hs-identifier">Geom2D.CubicBezier.Basic</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Numeric.html"><span class="hs-identifier">Geom2D.CubicBezier.Numeric</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="OpenMetaPath"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-var">OpenMetaPath</span></a></span></span><span> </span><span id="local-6989586621679238171"><span class="annot"><a href="#local-6989586621679238171"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OpenMetaPath"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-var">OpenMetaPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238171"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238171"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238171"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>                        </span><span class="hs-comment">-- ^ A metapath with endpoints</span><span>
</span><span id="line-71"></span><span>                    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679238110"><span id="local-6989586621679238112"><span class="annot"><span class="annottext">a -&gt; OpenMetaPath b -&gt; OpenMetaPath a
(a -&gt; b) -&gt; OpenMetaPath a -&gt; OpenMetaPath b
(forall a b. (a -&gt; b) -&gt; OpenMetaPath a -&gt; OpenMetaPath b)
-&gt; (forall a b. a -&gt; OpenMetaPath b -&gt; OpenMetaPath a)
-&gt; Functor OpenMetaPath
forall a b. a -&gt; OpenMetaPath b -&gt; OpenMetaPath a
forall a b. (a -&gt; b) -&gt; OpenMetaPath a -&gt; OpenMetaPath b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; OpenMetaPath b -&gt; OpenMetaPath a
$c&lt;$ :: forall a b. a -&gt; OpenMetaPath b -&gt; OpenMetaPath a
fmap :: (a -&gt; b) -&gt; OpenMetaPath a -&gt; OpenMetaPath b
$cfmap :: forall a b. (a -&gt; b) -&gt; OpenMetaPath a -&gt; OpenMetaPath b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238099"><span id="local-6989586621679238101"><span id="local-6989586621679238103"><span id="local-6989586621679238105"><span class="annot"><span class="annottext">Functor OpenMetaPath
Foldable OpenMetaPath
Functor OpenMetaPath
-&gt; Foldable OpenMetaPath
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; OpenMetaPath a -&gt; f (OpenMetaPath b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    OpenMetaPath (f a) -&gt; f (OpenMetaPath a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; OpenMetaPath a -&gt; m (OpenMetaPath b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    OpenMetaPath (m a) -&gt; m (OpenMetaPath a))
-&gt; Traversable OpenMetaPath
(a -&gt; f b) -&gt; OpenMetaPath a -&gt; f (OpenMetaPath b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
OpenMetaPath (m a) -&gt; m (OpenMetaPath a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
OpenMetaPath (f a) -&gt; f (OpenMetaPath a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; OpenMetaPath a -&gt; m (OpenMetaPath b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; OpenMetaPath a -&gt; f (OpenMetaPath b)
sequence :: OpenMetaPath (m a) -&gt; m (OpenMetaPath a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
OpenMetaPath (m a) -&gt; m (OpenMetaPath a)
mapM :: (a -&gt; m b) -&gt; OpenMetaPath a -&gt; m (OpenMetaPath b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; OpenMetaPath a -&gt; m (OpenMetaPath b)
sequenceA :: OpenMetaPath (f a) -&gt; f (OpenMetaPath a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
OpenMetaPath (f a) -&gt; f (OpenMetaPath a)
traverse :: (a -&gt; f b) -&gt; OpenMetaPath a -&gt; f (OpenMetaPath b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; OpenMetaPath a -&gt; f (OpenMetaPath b)
$cp2Traversable :: Foldable OpenMetaPath
$cp1Traversable :: Functor OpenMetaPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238064"><span id="local-6989586621679238066"><span id="local-6989586621679238068"><span id="local-6989586621679238070"><span id="local-6989586621679238072"><span id="local-6989586621679238074"><span id="local-6989586621679238076"><span id="local-6989586621679238078"><span id="local-6989586621679238080"><span id="local-6989586621679238082"><span id="local-6989586621679238084"><span id="local-6989586621679238086"><span id="local-6989586621679238088"><span id="local-6989586621679238090"><span id="local-6989586621679238092"><span id="local-6989586621679238094"><span id="local-6989586621679238096"><span class="annot"><span class="annottext">OpenMetaPath a -&gt; Bool
(a -&gt; m) -&gt; OpenMetaPath a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
(forall m. Monoid m =&gt; OpenMetaPath m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenMetaPath a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenMetaPath a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a)
-&gt; (forall a. OpenMetaPath a -&gt; [a])
-&gt; (forall a. OpenMetaPath a -&gt; Bool)
-&gt; (forall a. OpenMetaPath a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; OpenMetaPath a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; OpenMetaPath a -&gt; a)
-&gt; (forall a. Ord a =&gt; OpenMetaPath a -&gt; a)
-&gt; (forall a. Num a =&gt; OpenMetaPath a -&gt; a)
-&gt; (forall a. Num a =&gt; OpenMetaPath a -&gt; a)
-&gt; Foldable OpenMetaPath
forall a. Eq a =&gt; a -&gt; OpenMetaPath a -&gt; Bool
forall a. Num a =&gt; OpenMetaPath a -&gt; a
forall a. Ord a =&gt; OpenMetaPath a -&gt; a
forall m. Monoid m =&gt; OpenMetaPath m -&gt; m
forall a. OpenMetaPath a -&gt; Bool
forall a. OpenMetaPath a -&gt; Int
forall a. OpenMetaPath a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenMetaPath a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: OpenMetaPath a -&gt; a
$cproduct :: forall a. Num a =&gt; OpenMetaPath a -&gt; a
sum :: OpenMetaPath a -&gt; a
$csum :: forall a. Num a =&gt; OpenMetaPath a -&gt; a
minimum :: OpenMetaPath a -&gt; a
$cminimum :: forall a. Ord a =&gt; OpenMetaPath a -&gt; a
maximum :: OpenMetaPath a -&gt; a
$cmaximum :: forall a. Ord a =&gt; OpenMetaPath a -&gt; a
elem :: a -&gt; OpenMetaPath a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; OpenMetaPath a -&gt; Bool
length :: OpenMetaPath a -&gt; Int
$clength :: forall a. OpenMetaPath a -&gt; Int
null :: OpenMetaPath a -&gt; Bool
$cnull :: forall a. OpenMetaPath a -&gt; Bool
toList :: OpenMetaPath a -&gt; [a]
$ctoList :: forall a. OpenMetaPath a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; OpenMetaPath a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; OpenMetaPath a -&gt; b
foldMap' :: (a -&gt; m) -&gt; OpenMetaPath a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenMetaPath a -&gt; m
foldMap :: (a -&gt; m) -&gt; OpenMetaPath a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; OpenMetaPath a -&gt; m
fold :: OpenMetaPath m -&gt; m
$cfold :: forall m. Monoid m =&gt; OpenMetaPath m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">data</span><span> </span><span id="ClosedMetaPath"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier hs-var">ClosedMetaPath</span></a></span></span><span> </span><span id="local-6989586621679238062"><span class="annot"><a href="#local-6989586621679238062"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClosedMetaPath"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier hs-var">ClosedMetaPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>                        </span><span class="hs-comment">-- ^ A metapath with cycles.  The last join</span><span>
</span><span id="line-76"></span><span>                        </span><span class="hs-comment">-- joins the last point with the first.</span><span>
</span><span id="line-77"></span><span>                      </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679238057"><span id="local-6989586621679238059"><span class="annot"><span class="annottext">ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool
(ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool)
-&gt; (ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool)
-&gt; Eq (ClosedMetaPath a)
forall a. Eq a =&gt; ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool
$c/= :: forall a. Eq a =&gt; ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool
== :: ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool
$c== :: forall a. Eq a =&gt; ClosedMetaPath a -&gt; ClosedMetaPath a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238052"><span id="local-6989586621679238054"><span class="annot"><span class="annottext">a -&gt; ClosedMetaPath b -&gt; ClosedMetaPath a
(a -&gt; b) -&gt; ClosedMetaPath a -&gt; ClosedMetaPath b
(forall a b. (a -&gt; b) -&gt; ClosedMetaPath a -&gt; ClosedMetaPath b)
-&gt; (forall a b. a -&gt; ClosedMetaPath b -&gt; ClosedMetaPath a)
-&gt; Functor ClosedMetaPath
forall a b. a -&gt; ClosedMetaPath b -&gt; ClosedMetaPath a
forall a b. (a -&gt; b) -&gt; ClosedMetaPath a -&gt; ClosedMetaPath b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; ClosedMetaPath b -&gt; ClosedMetaPath a
$c&lt;$ :: forall a b. a -&gt; ClosedMetaPath b -&gt; ClosedMetaPath a
fmap :: (a -&gt; b) -&gt; ClosedMetaPath a -&gt; ClosedMetaPath b
$cfmap :: forall a b. (a -&gt; b) -&gt; ClosedMetaPath a -&gt; ClosedMetaPath b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238042"><span id="local-6989586621679238044"><span id="local-6989586621679238046"><span id="local-6989586621679238048"><span class="annot"><span class="annottext">Functor ClosedMetaPath
Foldable ClosedMetaPath
Functor ClosedMetaPath
-&gt; Foldable ClosedMetaPath
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; ClosedMetaPath a -&gt; f (ClosedMetaPath b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    ClosedMetaPath (f a) -&gt; f (ClosedMetaPath a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; ClosedMetaPath a -&gt; m (ClosedMetaPath b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    ClosedMetaPath (m a) -&gt; m (ClosedMetaPath a))
-&gt; Traversable ClosedMetaPath
(a -&gt; f b) -&gt; ClosedMetaPath a -&gt; f (ClosedMetaPath b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
ClosedMetaPath (m a) -&gt; m (ClosedMetaPath a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
ClosedMetaPath (f a) -&gt; f (ClosedMetaPath a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; ClosedMetaPath a -&gt; m (ClosedMetaPath b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; ClosedMetaPath a -&gt; f (ClosedMetaPath b)
sequence :: ClosedMetaPath (m a) -&gt; m (ClosedMetaPath a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
ClosedMetaPath (m a) -&gt; m (ClosedMetaPath a)
mapM :: (a -&gt; m b) -&gt; ClosedMetaPath a -&gt; m (ClosedMetaPath b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; ClosedMetaPath a -&gt; m (ClosedMetaPath b)
sequenceA :: ClosedMetaPath (f a) -&gt; f (ClosedMetaPath a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
ClosedMetaPath (f a) -&gt; f (ClosedMetaPath a)
traverse :: (a -&gt; f b) -&gt; ClosedMetaPath a -&gt; f (ClosedMetaPath b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; ClosedMetaPath a -&gt; f (ClosedMetaPath b)
$cp2Traversable :: Foldable ClosedMetaPath
$cp1Traversable :: Functor ClosedMetaPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238008"><span id="local-6989586621679238010"><span id="local-6989586621679238012"><span id="local-6989586621679238014"><span id="local-6989586621679238016"><span id="local-6989586621679238018"><span id="local-6989586621679238020"><span id="local-6989586621679238022"><span id="local-6989586621679238024"><span id="local-6989586621679238026"><span id="local-6989586621679238028"><span id="local-6989586621679238030"><span id="local-6989586621679238032"><span id="local-6989586621679238034"><span id="local-6989586621679238036"><span id="local-6989586621679238038"><span id="local-6989586621679238040"><span class="annot"><span class="annottext">ClosedMetaPath a -&gt; Bool
(a -&gt; m) -&gt; ClosedMetaPath a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
(forall m. Monoid m =&gt; ClosedMetaPath m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a)
-&gt; (forall a. ClosedMetaPath a -&gt; [a])
-&gt; (forall a. ClosedMetaPath a -&gt; Bool)
-&gt; (forall a. ClosedMetaPath a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; ClosedMetaPath a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; ClosedMetaPath a -&gt; a)
-&gt; (forall a. Ord a =&gt; ClosedMetaPath a -&gt; a)
-&gt; (forall a. Num a =&gt; ClosedMetaPath a -&gt; a)
-&gt; (forall a. Num a =&gt; ClosedMetaPath a -&gt; a)
-&gt; Foldable ClosedMetaPath
forall a. Eq a =&gt; a -&gt; ClosedMetaPath a -&gt; Bool
forall a. Num a =&gt; ClosedMetaPath a -&gt; a
forall a. Ord a =&gt; ClosedMetaPath a -&gt; a
forall m. Monoid m =&gt; ClosedMetaPath m -&gt; m
forall a. ClosedMetaPath a -&gt; Bool
forall a. ClosedMetaPath a -&gt; Int
forall a. ClosedMetaPath a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: ClosedMetaPath a -&gt; a
$cproduct :: forall a. Num a =&gt; ClosedMetaPath a -&gt; a
sum :: ClosedMetaPath a -&gt; a
$csum :: forall a. Num a =&gt; ClosedMetaPath a -&gt; a
minimum :: ClosedMetaPath a -&gt; a
$cminimum :: forall a. Ord a =&gt; ClosedMetaPath a -&gt; a
maximum :: ClosedMetaPath a -&gt; a
$cmaximum :: forall a. Ord a =&gt; ClosedMetaPath a -&gt; a
elem :: a -&gt; ClosedMetaPath a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; ClosedMetaPath a -&gt; Bool
length :: ClosedMetaPath a -&gt; Int
$clength :: forall a. ClosedMetaPath a -&gt; Int
null :: ClosedMetaPath a -&gt; Bool
$cnull :: forall a. ClosedMetaPath a -&gt; Bool
toList :: ClosedMetaPath a -&gt; [a]
$ctoList :: forall a. ClosedMetaPath a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; ClosedMetaPath a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; ClosedMetaPath a -&gt; b
foldMap' :: (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m
foldMap :: (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; ClosedMetaPath a -&gt; m
fold :: ClosedMetaPath m -&gt; m
$cfold :: forall m. Monoid m =&gt; ClosedMetaPath m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span> </span><span id="MetaJoin"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span></span><span> </span><span id="local-6989586621679238163"><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MetaJoin"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="metaTypeL"><span class="annot"><span class="annottext">MetaJoin a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#metaTypeL"><span class="hs-identifier hs-var hs-var">metaTypeL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaNodeType"><span class="hs-identifier hs-type">MetaNodeType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-80"></span><span>                           </span><span class="hs-comment">-- ^ The nodetype going out of the</span><span>
</span><span id="line-81"></span><span>                           </span><span class="hs-comment">-- previous point.  The metafont default is</span><span>
</span><span id="line-82"></span><span>                           </span><span class="hs-comment">-- @Open@.</span><span>
</span><span id="line-83"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="tensionL"><span class="annot"><span class="annottext">MetaJoin a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionL"><span class="hs-identifier hs-var hs-var">tensionL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-84"></span><span>                             </span><span class="hs-comment">-- ^ The tension going out of the previous point.</span><span>
</span><span id="line-85"></span><span>                             </span><span class="hs-comment">-- The metafont default is 1.</span><span>
</span><span id="line-86"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="tensionR"><span class="annot"><span class="annottext">MetaJoin a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionR"><span class="hs-identifier hs-var hs-var">tensionR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-87"></span><span>                             </span><span class="hs-comment">-- ^ The tension going into the next point.</span><span>
</span><span id="line-88"></span><span>                             </span><span class="hs-comment">-- The metafont default is 1.</span><span>
</span><span id="line-89"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="metaTypeR"><span class="annot"><span class="annottext">MetaJoin a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#metaTypeR"><span class="hs-identifier hs-var hs-var">metaTypeR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaNodeType"><span class="hs-identifier hs-type">MetaNodeType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-90"></span><span>                             </span><span class="hs-comment">-- ^ The nodetype going into the next point.</span><span>
</span><span id="line-91"></span><span>                             </span><span class="hs-comment">-- The metafont default is @Open@.</span><span>
</span><span id="line-92"></span><span>                           </span><span class="hs-special">}</span><span>
</span><span id="line-93"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Controls"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-var">Controls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238163"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                  </span><span class="hs-comment">-- ^ Specify the control points explicitly.</span><span>
</span><span id="line-95"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237996"><span id="local-6989586621679237998"><span id="local-6989586621679238000"><span class="annot"><span class="annottext">Int -&gt; MetaJoin a -&gt; ShowS
[MetaJoin a] -&gt; ShowS
MetaJoin a -&gt; String
(Int -&gt; MetaJoin a -&gt; ShowS)
-&gt; (MetaJoin a -&gt; String)
-&gt; ([MetaJoin a] -&gt; ShowS)
-&gt; Show (MetaJoin a)
forall a. Show a =&gt; Int -&gt; MetaJoin a -&gt; ShowS
forall a. Show a =&gt; [MetaJoin a] -&gt; ShowS
forall a. Show a =&gt; MetaJoin a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MetaJoin a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [MetaJoin a] -&gt; ShowS
show :: MetaJoin a -&gt; String
$cshow :: forall a. Show a =&gt; MetaJoin a -&gt; String
showsPrec :: Int -&gt; MetaJoin a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; MetaJoin a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237991"><span id="local-6989586621679237993"><span class="annot"><span class="annottext">MetaJoin a -&gt; MetaJoin a -&gt; Bool
(MetaJoin a -&gt; MetaJoin a -&gt; Bool)
-&gt; (MetaJoin a -&gt; MetaJoin a -&gt; Bool) -&gt; Eq (MetaJoin a)
forall a. Eq a =&gt; MetaJoin a -&gt; MetaJoin a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MetaJoin a -&gt; MetaJoin a -&gt; Bool
$c/= :: forall a. Eq a =&gt; MetaJoin a -&gt; MetaJoin a -&gt; Bool
== :: MetaJoin a -&gt; MetaJoin a -&gt; Bool
$c== :: forall a. Eq a =&gt; MetaJoin a -&gt; MetaJoin a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237987"><span id="local-6989586621679237989"><span class="annot"><span class="annottext">a -&gt; MetaJoin b -&gt; MetaJoin a
(a -&gt; b) -&gt; MetaJoin a -&gt; MetaJoin b
(forall a b. (a -&gt; b) -&gt; MetaJoin a -&gt; MetaJoin b)
-&gt; (forall a b. a -&gt; MetaJoin b -&gt; MetaJoin a) -&gt; Functor MetaJoin
forall a b. a -&gt; MetaJoin b -&gt; MetaJoin a
forall a b. (a -&gt; b) -&gt; MetaJoin a -&gt; MetaJoin b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; MetaJoin b -&gt; MetaJoin a
$c&lt;$ :: forall a b. a -&gt; MetaJoin b -&gt; MetaJoin a
fmap :: (a -&gt; b) -&gt; MetaJoin a -&gt; MetaJoin b
$cfmap :: forall a b. (a -&gt; b) -&gt; MetaJoin a -&gt; MetaJoin b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237977"><span id="local-6989586621679237979"><span id="local-6989586621679237981"><span id="local-6989586621679237983"><span class="annot"><span class="annottext">Functor MetaJoin
Foldable MetaJoin
Functor MetaJoin
-&gt; Foldable MetaJoin
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; MetaJoin a -&gt; f (MetaJoin b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    MetaJoin (f a) -&gt; f (MetaJoin a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; MetaJoin a -&gt; m (MetaJoin b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    MetaJoin (m a) -&gt; m (MetaJoin a))
-&gt; Traversable MetaJoin
(a -&gt; f b) -&gt; MetaJoin a -&gt; f (MetaJoin b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; MetaJoin (m a) -&gt; m (MetaJoin a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
MetaJoin (f a) -&gt; f (MetaJoin a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MetaJoin a -&gt; m (MetaJoin b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MetaJoin a -&gt; f (MetaJoin b)
sequence :: MetaJoin (m a) -&gt; m (MetaJoin a)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; MetaJoin (m a) -&gt; m (MetaJoin a)
mapM :: (a -&gt; m b) -&gt; MetaJoin a -&gt; m (MetaJoin b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MetaJoin a -&gt; m (MetaJoin b)
sequenceA :: MetaJoin (f a) -&gt; f (MetaJoin a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
MetaJoin (f a) -&gt; f (MetaJoin a)
traverse :: (a -&gt; f b) -&gt; MetaJoin a -&gt; f (MetaJoin b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MetaJoin a -&gt; f (MetaJoin b)
$cp2Traversable :: Foldable MetaJoin
$cp1Traversable :: Functor MetaJoin
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237943"><span id="local-6989586621679237945"><span id="local-6989586621679237947"><span id="local-6989586621679237949"><span id="local-6989586621679237951"><span id="local-6989586621679237953"><span id="local-6989586621679237955"><span id="local-6989586621679237957"><span id="local-6989586621679237959"><span id="local-6989586621679237961"><span id="local-6989586621679237963"><span id="local-6989586621679237965"><span id="local-6989586621679237967"><span id="local-6989586621679237969"><span id="local-6989586621679237971"><span id="local-6989586621679237973"><span id="local-6989586621679237975"><span class="annot"><span class="annottext">MetaJoin a -&gt; Bool
(a -&gt; m) -&gt; MetaJoin a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
(forall m. Monoid m =&gt; MetaJoin m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaJoin a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaJoin a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a)
-&gt; (forall a. MetaJoin a -&gt; [a])
-&gt; (forall a. MetaJoin a -&gt; Bool)
-&gt; (forall a. MetaJoin a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; MetaJoin a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; MetaJoin a -&gt; a)
-&gt; (forall a. Ord a =&gt; MetaJoin a -&gt; a)
-&gt; (forall a. Num a =&gt; MetaJoin a -&gt; a)
-&gt; (forall a. Num a =&gt; MetaJoin a -&gt; a)
-&gt; Foldable MetaJoin
forall a. Eq a =&gt; a -&gt; MetaJoin a -&gt; Bool
forall a. Num a =&gt; MetaJoin a -&gt; a
forall a. Ord a =&gt; MetaJoin a -&gt; a
forall m. Monoid m =&gt; MetaJoin m -&gt; m
forall a. MetaJoin a -&gt; Bool
forall a. MetaJoin a -&gt; Int
forall a. MetaJoin a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaJoin a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: MetaJoin a -&gt; a
$cproduct :: forall a. Num a =&gt; MetaJoin a -&gt; a
sum :: MetaJoin a -&gt; a
$csum :: forall a. Num a =&gt; MetaJoin a -&gt; a
minimum :: MetaJoin a -&gt; a
$cminimum :: forall a. Ord a =&gt; MetaJoin a -&gt; a
maximum :: MetaJoin a -&gt; a
$cmaximum :: forall a. Ord a =&gt; MetaJoin a -&gt; a
elem :: a -&gt; MetaJoin a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; MetaJoin a -&gt; Bool
length :: MetaJoin a -&gt; Int
$clength :: forall a. MetaJoin a -&gt; Int
null :: MetaJoin a -&gt; Bool
$cnull :: forall a. MetaJoin a -&gt; Bool
toList :: MetaJoin a -&gt; [a]
$ctoList :: forall a. MetaJoin a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; MetaJoin a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaJoin a -&gt; b
foldMap' :: (a -&gt; m) -&gt; MetaJoin a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaJoin a -&gt; m
foldMap :: (a -&gt; m) -&gt; MetaJoin a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaJoin a -&gt; m
fold :: MetaJoin m -&gt; m
$cfold :: forall m. Monoid m =&gt; MetaJoin m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>                         </span><span>
</span><span id="line-97"></span><span class="hs-keyword">data</span><span> </span><span id="MetaNodeType"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaNodeType"><span class="hs-identifier hs-var">MetaNodeType</span></a></span></span><span> </span><span id="local-6989586621679238147"><span class="annot"><a href="#local-6989586621679238147"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Open"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span></span><span>
</span><span id="line-98"></span><span>                    </span><span class="hs-comment">-- ^ An open node has no direction specified.  If</span><span>
</span><span id="line-99"></span><span>                    </span><span class="hs-comment">-- it is an internal node, the curve will keep the</span><span>
</span><span id="line-100"></span><span>                    </span><span class="hs-comment">-- same direction going into and going out from</span><span>
</span><span id="line-101"></span><span>                    </span><span class="hs-comment">-- the node.  If it is an endpoint or corner</span><span>
</span><span id="line-102"></span><span>                    </span><span class="hs-comment">-- point, it will have curl of 1.</span><span>
</span><span id="line-103"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Curl"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span></span><span> </span><span class="hs-special">{</span><span id="curlgamma"><span class="annot"><span class="annottext">MetaNodeType a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#curlgamma"><span class="hs-identifier hs-var hs-var">curlgamma</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679238147"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>                    </span><span class="hs-comment">-- ^ The node becomes and endpoint or a corner</span><span>
</span><span id="line-105"></span><span>                    </span><span class="hs-comment">-- point.  The curl specifies how much the segment</span><span>
</span><span id="line-106"></span><span>                    </span><span class="hs-comment">-- `curves`.  A curl of `gamma` means that the</span><span>
</span><span id="line-107"></span><span>                    </span><span class="hs-comment">-- curvature is `gamma` times that of the</span><span>
</span><span id="line-108"></span><span>                    </span><span class="hs-comment">-- following node.</span><span>
</span><span id="line-109"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Direction"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span></span><span> </span><span class="hs-special">{</span><span id="nodedir"><span class="annot"><span class="annottext">MetaNodeType a -&gt; Point a
</span><a href="Geom2D.CubicBezier.MetaPath.html#nodedir"><span class="hs-identifier hs-var hs-var">nodedir</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238147"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>                    </span><span class="hs-comment">-- ^ The node has a given direction.</span><span>
</span><span id="line-111"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237934"><span id="local-6989586621679237936"><span class="annot"><span class="annottext">MetaNodeType a -&gt; MetaNodeType a -&gt; Bool
(MetaNodeType a -&gt; MetaNodeType a -&gt; Bool)
-&gt; (MetaNodeType a -&gt; MetaNodeType a -&gt; Bool)
-&gt; Eq (MetaNodeType a)
forall a. Eq a =&gt; MetaNodeType a -&gt; MetaNodeType a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MetaNodeType a -&gt; MetaNodeType a -&gt; Bool
$c/= :: forall a. Eq a =&gt; MetaNodeType a -&gt; MetaNodeType a -&gt; Bool
== :: MetaNodeType a -&gt; MetaNodeType a -&gt; Bool
$c== :: forall a. Eq a =&gt; MetaNodeType a -&gt; MetaNodeType a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237928"><span id="local-6989586621679237930"><span id="local-6989586621679237932"><span class="annot"><span class="annottext">Int -&gt; MetaNodeType a -&gt; ShowS
[MetaNodeType a] -&gt; ShowS
MetaNodeType a -&gt; String
(Int -&gt; MetaNodeType a -&gt; ShowS)
-&gt; (MetaNodeType a -&gt; String)
-&gt; ([MetaNodeType a] -&gt; ShowS)
-&gt; Show (MetaNodeType a)
forall a. Show a =&gt; Int -&gt; MetaNodeType a -&gt; ShowS
forall a. Show a =&gt; [MetaNodeType a] -&gt; ShowS
forall a. Show a =&gt; MetaNodeType a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MetaNodeType a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [MetaNodeType a] -&gt; ShowS
show :: MetaNodeType a -&gt; String
$cshow :: forall a. Show a =&gt; MetaNodeType a -&gt; String
showsPrec :: Int -&gt; MetaNodeType a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; MetaNodeType a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237924"><span id="local-6989586621679237926"><span class="annot"><span class="annottext">a -&gt; MetaNodeType b -&gt; MetaNodeType a
(a -&gt; b) -&gt; MetaNodeType a -&gt; MetaNodeType b
(forall a b. (a -&gt; b) -&gt; MetaNodeType a -&gt; MetaNodeType b)
-&gt; (forall a b. a -&gt; MetaNodeType b -&gt; MetaNodeType a)
-&gt; Functor MetaNodeType
forall a b. a -&gt; MetaNodeType b -&gt; MetaNodeType a
forall a b. (a -&gt; b) -&gt; MetaNodeType a -&gt; MetaNodeType b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; MetaNodeType b -&gt; MetaNodeType a
$c&lt;$ :: forall a b. a -&gt; MetaNodeType b -&gt; MetaNodeType a
fmap :: (a -&gt; b) -&gt; MetaNodeType a -&gt; MetaNodeType b
$cfmap :: forall a b. (a -&gt; b) -&gt; MetaNodeType a -&gt; MetaNodeType b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237890"><span id="local-6989586621679237892"><span id="local-6989586621679237894"><span id="local-6989586621679237896"><span id="local-6989586621679237898"><span id="local-6989586621679237900"><span id="local-6989586621679237902"><span id="local-6989586621679237904"><span id="local-6989586621679237906"><span id="local-6989586621679237908"><span id="local-6989586621679237910"><span id="local-6989586621679237912"><span id="local-6989586621679237914"><span id="local-6989586621679237916"><span id="local-6989586621679237918"><span id="local-6989586621679237920"><span id="local-6989586621679237922"><span class="annot"><span class="annottext">MetaNodeType a -&gt; Bool
(a -&gt; m) -&gt; MetaNodeType a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
(forall m. Monoid m =&gt; MetaNodeType m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaNodeType a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaNodeType a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a)
-&gt; (forall a. MetaNodeType a -&gt; [a])
-&gt; (forall a. MetaNodeType a -&gt; Bool)
-&gt; (forall a. MetaNodeType a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; MetaNodeType a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; MetaNodeType a -&gt; a)
-&gt; (forall a. Ord a =&gt; MetaNodeType a -&gt; a)
-&gt; (forall a. Num a =&gt; MetaNodeType a -&gt; a)
-&gt; (forall a. Num a =&gt; MetaNodeType a -&gt; a)
-&gt; Foldable MetaNodeType
forall a. Eq a =&gt; a -&gt; MetaNodeType a -&gt; Bool
forall a. Num a =&gt; MetaNodeType a -&gt; a
forall a. Ord a =&gt; MetaNodeType a -&gt; a
forall m. Monoid m =&gt; MetaNodeType m -&gt; m
forall a. MetaNodeType a -&gt; Bool
forall a. MetaNodeType a -&gt; Int
forall a. MetaNodeType a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaNodeType a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: MetaNodeType a -&gt; a
$cproduct :: forall a. Num a =&gt; MetaNodeType a -&gt; a
sum :: MetaNodeType a -&gt; a
$csum :: forall a. Num a =&gt; MetaNodeType a -&gt; a
minimum :: MetaNodeType a -&gt; a
$cminimum :: forall a. Ord a =&gt; MetaNodeType a -&gt; a
maximum :: MetaNodeType a -&gt; a
$cmaximum :: forall a. Ord a =&gt; MetaNodeType a -&gt; a
elem :: a -&gt; MetaNodeType a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; MetaNodeType a -&gt; Bool
length :: MetaNodeType a -&gt; Int
$clength :: forall a. MetaNodeType a -&gt; Int
null :: MetaNodeType a -&gt; Bool
$cnull :: forall a. MetaNodeType a -&gt; Bool
toList :: MetaNodeType a -&gt; [a]
$ctoList :: forall a. MetaNodeType a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; MetaNodeType a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; MetaNodeType a -&gt; b
foldMap' :: (a -&gt; m) -&gt; MetaNodeType a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaNodeType a -&gt; m
foldMap :: (a -&gt; m) -&gt; MetaNodeType a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; MetaNodeType a -&gt; m
fold :: MetaNodeType m -&gt; m
$cfold :: forall m. Monoid m =&gt; MetaNodeType m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237880"><span id="local-6989586621679237882"><span id="local-6989586621679237884"><span id="local-6989586621679237886"><span class="annot"><span class="annottext">Functor MetaNodeType
Foldable MetaNodeType
Functor MetaNodeType
-&gt; Foldable MetaNodeType
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; MetaNodeType a -&gt; f (MetaNodeType b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    MetaNodeType (f a) -&gt; f (MetaNodeType a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; MetaNodeType a -&gt; m (MetaNodeType b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    MetaNodeType (m a) -&gt; m (MetaNodeType a))
-&gt; Traversable MetaNodeType
(a -&gt; f b) -&gt; MetaNodeType a -&gt; f (MetaNodeType b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
MetaNodeType (m a) -&gt; m (MetaNodeType a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
MetaNodeType (f a) -&gt; f (MetaNodeType a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MetaNodeType a -&gt; m (MetaNodeType b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MetaNodeType a -&gt; f (MetaNodeType b)
sequence :: MetaNodeType (m a) -&gt; m (MetaNodeType a)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
MetaNodeType (m a) -&gt; m (MetaNodeType a)
mapM :: (a -&gt; m b) -&gt; MetaNodeType a -&gt; m (MetaNodeType b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; MetaNodeType a -&gt; m (MetaNodeType b)
sequenceA :: MetaNodeType (f a) -&gt; f (MetaNodeType a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
MetaNodeType (f a) -&gt; f (MetaNodeType a)
traverse :: (a -&gt; f b) -&gt; MetaNodeType a -&gt; f (MetaNodeType b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; MetaNodeType a -&gt; f (MetaNodeType b)
$cp2Traversable :: Foldable MetaNodeType
$cp1Traversable :: Functor MetaNodeType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="Tension"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-var">Tension</span></a></span></span><span> </span><span id="local-6989586621679238203"><span class="annot"><a href="#local-6989586621679238203"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Tension"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-var">Tension</span></a></span></span><span> </span><span class="hs-special">{</span><span id="tensionValue"><span class="annot"><span class="annottext">Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679238203"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-114"></span><span>               </span><span class="hs-comment">-- ^ The tension value specifies how /tense/ the curve is.</span><span>
</span><span id="line-115"></span><span>               </span><span class="hs-comment">-- A higher value means the curve approaches a line</span><span>
</span><span id="line-116"></span><span>               </span><span class="hs-comment">-- segment, while a lower value means the curve is more</span><span>
</span><span id="line-117"></span><span>               </span><span class="hs-comment">-- round.  Metafont doesn't allow values below 3/4.</span><span>
</span><span id="line-118"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="TensionAtLeast"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#TensionAtLeast"><span class="hs-identifier hs-var">TensionAtLeast</span></a></span></span><span> </span><span class="hs-special">{</span><span id="tensionValue"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var">tensionValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679238203"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-119"></span><span>               </span><span class="hs-comment">-- ^ Like @Tension@, but keep the segment inside the</span><span>
</span><span id="line-120"></span><span>               </span><span class="hs-comment">-- bounding triangle defined by the control points, if</span><span>
</span><span id="line-121"></span><span>               </span><span class="hs-comment">-- there is one.</span><span>
</span><span id="line-122"></span><span>             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237873"><span id="local-6989586621679237875"><span class="annot"><span class="annottext">Tension a -&gt; Tension a -&gt; Bool
(Tension a -&gt; Tension a -&gt; Bool)
-&gt; (Tension a -&gt; Tension a -&gt; Bool) -&gt; Eq (Tension a)
forall a. Eq a =&gt; Tension a -&gt; Tension a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Tension a -&gt; Tension a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Tension a -&gt; Tension a -&gt; Bool
== :: Tension a -&gt; Tension a -&gt; Bool
$c== :: forall a. Eq a =&gt; Tension a -&gt; Tension a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237867"><span id="local-6989586621679237869"><span id="local-6989586621679237871"><span class="annot"><span class="annottext">Int -&gt; Tension a -&gt; ShowS
[Tension a] -&gt; ShowS
Tension a -&gt; String
(Int -&gt; Tension a -&gt; ShowS)
-&gt; (Tension a -&gt; String)
-&gt; ([Tension a] -&gt; ShowS)
-&gt; Show (Tension a)
forall a. Show a =&gt; Int -&gt; Tension a -&gt; ShowS
forall a. Show a =&gt; [Tension a] -&gt; ShowS
forall a. Show a =&gt; Tension a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Tension a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Tension a] -&gt; ShowS
show :: Tension a -&gt; String
$cshow :: forall a. Show a =&gt; Tension a -&gt; String
showsPrec :: Int -&gt; Tension a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Tension a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237863"><span id="local-6989586621679237865"><span class="annot"><span class="annottext">a -&gt; Tension b -&gt; Tension a
(a -&gt; b) -&gt; Tension a -&gt; Tension b
(forall a b. (a -&gt; b) -&gt; Tension a -&gt; Tension b)
-&gt; (forall a b. a -&gt; Tension b -&gt; Tension a) -&gt; Functor Tension
forall a b. a -&gt; Tension b -&gt; Tension a
forall a b. (a -&gt; b) -&gt; Tension a -&gt; Tension b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Tension b -&gt; Tension a
$c&lt;$ :: forall a b. a -&gt; Tension b -&gt; Tension a
fmap :: (a -&gt; b) -&gt; Tension a -&gt; Tension b
$cfmap :: forall a b. (a -&gt; b) -&gt; Tension a -&gt; Tension b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237829"><span id="local-6989586621679237831"><span id="local-6989586621679237833"><span id="local-6989586621679237835"><span id="local-6989586621679237837"><span id="local-6989586621679237839"><span id="local-6989586621679237841"><span id="local-6989586621679237843"><span id="local-6989586621679237845"><span id="local-6989586621679237847"><span id="local-6989586621679237849"><span id="local-6989586621679237851"><span id="local-6989586621679237853"><span id="local-6989586621679237855"><span id="local-6989586621679237857"><span id="local-6989586621679237859"><span id="local-6989586621679237861"><span class="annot"><span class="annottext">Tension a -&gt; Bool
(a -&gt; m) -&gt; Tension a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b
(forall m. Monoid m =&gt; Tension m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Tension a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Tension a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a)
-&gt; (forall a. Tension a -&gt; [a])
-&gt; (forall a. Tension a -&gt; Bool)
-&gt; (forall a. Tension a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Tension a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Tension a -&gt; a)
-&gt; (forall a. Ord a =&gt; Tension a -&gt; a)
-&gt; (forall a. Num a =&gt; Tension a -&gt; a)
-&gt; (forall a. Num a =&gt; Tension a -&gt; a)
-&gt; Foldable Tension
forall a. Eq a =&gt; a -&gt; Tension a -&gt; Bool
forall a. Num a =&gt; Tension a -&gt; a
forall a. Ord a =&gt; Tension a -&gt; a
forall m. Monoid m =&gt; Tension m -&gt; m
forall a. Tension a -&gt; Bool
forall a. Tension a -&gt; Int
forall a. Tension a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Tension a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: Tension a -&gt; a
$cproduct :: forall a. Num a =&gt; Tension a -&gt; a
sum :: Tension a -&gt; a
$csum :: forall a. Num a =&gt; Tension a -&gt; a
minimum :: Tension a -&gt; a
$cminimum :: forall a. Ord a =&gt; Tension a -&gt; a
maximum :: Tension a -&gt; a
$cmaximum :: forall a. Ord a =&gt; Tension a -&gt; a
elem :: a -&gt; Tension a -&gt; Bool
$celem :: forall a. Eq a =&gt; a -&gt; Tension a -&gt; Bool
length :: Tension a -&gt; Int
$clength :: forall a. Tension a -&gt; Int
null :: Tension a -&gt; Bool
$cnull :: forall a. Tension a -&gt; Bool
toList :: Tension a -&gt; [a]
$ctoList :: forall a. Tension a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Tension a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Tension a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Tension a -&gt; b
foldMap' :: (a -&gt; m) -&gt; Tension a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Tension a -&gt; m
foldMap :: (a -&gt; m) -&gt; Tension a -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Tension a -&gt; m
fold :: Tension m -&gt; m
$cfold :: forall m. Monoid m =&gt; Tension m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237819"><span id="local-6989586621679237821"><span id="local-6989586621679237823"><span id="local-6989586621679237825"><span class="annot"><span class="annottext">Functor Tension
Foldable Tension
Functor Tension
-&gt; Foldable Tension
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; Tension a -&gt; f (Tension b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    Tension (f a) -&gt; f (Tension a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Tension a -&gt; m (Tension b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    Tension (m a) -&gt; m (Tension a))
-&gt; Traversable Tension
(a -&gt; f b) -&gt; Tension a -&gt; f (Tension b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Tension (m a) -&gt; m (Tension a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Tension (f a) -&gt; f (Tension a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Tension a -&gt; m (Tension b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Tension a -&gt; f (Tension b)
sequence :: Tension (m a) -&gt; m (Tension a)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Tension (m a) -&gt; m (Tension a)
mapM :: (a -&gt; m b) -&gt; Tension a -&gt; m (Tension b)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Tension a -&gt; m (Tension b)
sequenceA :: Tension (f a) -&gt; f (Tension a)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
Tension (f a) -&gt; f (Tension a)
traverse :: (a -&gt; f b) -&gt; Tension a -&gt; f (Tension b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Tension a -&gt; f (Tension b)
$cp2Traversable :: Foldable Tension
$cp1Traversable :: Functor Tension
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621679237818"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679237813"><span id="local-6989586621679237816"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679237818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679237818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier hs-type">ClosedMetaPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237818"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679237812"><span class="annot"><span class="annottext">show :: ClosedMetaPath a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier hs-type">ClosedMetaPath</span></a></span><span> </span><span id="local-6989586621679237810"><span class="annot"><span class="annottext">[(Point a, MetaJoin a)]
</span><a href="#local-6989586621679237810"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">[(Point a, MetaJoin a)] -&gt; String
forall a. (Show a, Real a) =&gt; [(Point a, MetaJoin a)] -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPath"><span class="hs-identifier hs-var">showPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, MetaJoin a)]
</span><a href="#local-6989586621679237810"><span class="hs-identifier hs-var">nodes</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cycle&quot;</span></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621679237808"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679237803"><span id="local-6989586621679237806"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679237808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679237808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679237808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679237802"><span class="annot"><span class="annottext">show :: OpenMetaPath a -&gt; String
</span><a href="#local-6989586621679237802"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span id="local-6989586621679237801"><span class="annot"><span class="annottext">[(Point a, MetaJoin a)]
</span><a href="#local-6989586621679237801"><span class="hs-identifier hs-var">nodes</span></a></span></span><span> </span><span id="local-6989586621679237800"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237800"><span class="hs-identifier hs-var">lastpoint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">[(Point a, MetaJoin a)] -&gt; String
forall a. (Show a, Real a) =&gt; [(Point a, MetaJoin a)] -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPath"><span class="hs-identifier hs-var">showPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point a, MetaJoin a)]
</span><a href="#local-6989586621679237801"><span class="hs-identifier hs-var">nodes</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; String
forall a. Show a =&gt; Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var">showPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237800"><span class="hs-identifier hs-var">lastpoint</span></a></span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679238214"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#showPath"><span class="hs-identifier hs-type">showPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679238214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679238214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238214"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-133"></span><span id="showPath"><span class="annot"><span class="annottext">showPath :: [(Point a, MetaJoin a)] -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPath"><span class="hs-identifier hs-var hs-var">showPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point a, MetaJoin a) -&gt; String)
-&gt; [(Point a, MetaJoin a)] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Point a, MetaJoin a) -&gt; String
forall a a.
(Show a, Show a, Real a) =&gt;
(Point a, MetaJoin a) -&gt; String
</span><a href="#local-6989586621679237797"><span class="hs-identifier hs-var">showNodes</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679237797"><span class="annot"><span class="annottext">showNodes :: (Point a, MetaJoin a) -&gt; String
</span><a href="#local-6989586621679237797"><span class="hs-identifier hs-var hs-var">showNodes</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237796"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237796"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-type">Controls</span></a></span><span> </span><span id="local-6989586621679237795"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237795"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679237794"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237794"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><span class="annottext">Point a -&gt; String
forall a. Show a =&gt; Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var">showPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237796"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;..controls &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; String
forall a. Show a =&gt; Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var">showPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237795"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; String
forall a. Show a =&gt; Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var">showPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237794"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;..&quot;</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="#local-6989586621679237797"><span class="hs-identifier hs-var">showNodes</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237793"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237793"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237792"><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237792"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679237791"><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679237790"><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237790"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679237789"><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237789"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">Point a -&gt; String
forall a. Show a =&gt; Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var">showPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237793"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a -&gt; String
forall a. (Real a, Show a) =&gt; MetaNodeType a -&gt; String
</span><a href="#local-6989586621679237788"><span class="hs-identifier hs-var">typename</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237792"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;..&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679237787"><span class="hs-identifier hs-var">tensions</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a -&gt; String
forall a. (Real a, Show a) =&gt; MetaNodeType a -&gt; String
</span><a href="#local-6989586621679237788"><span class="hs-identifier hs-var">typename</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237789"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>        </span><span id="local-6989586621679237787"><span class="annot"><span class="annottext">tensions :: String
</span><a href="#local-6989586621679237787"><span class="hs-identifier hs-var hs-var">tensions</span></a></span></span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a -&gt; Tension a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237790"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a -&gt; Tension a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Tension a
forall a. a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-var">Tension</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a -&gt; Tension a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237790"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tension %s..&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension a -&gt; String
forall a. Real a =&gt; Tension a -&gt; String
</span><a href="#local-6989586621679237784"><span class="hs-identifier hs-var">showTension</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; ShowS
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tension %s and %s..&quot;</span></span><span>
</span><span id="line-144"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension a -&gt; String
forall a. Real a =&gt; Tension a -&gt; String
</span><a href="#local-6989586621679237784"><span class="hs-identifier hs-var">showTension</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237791"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension a -&gt; String
forall a. Real a =&gt; Tension a -&gt; String
</span><a href="#local-6989586621679237784"><span class="hs-identifier hs-var">showTension</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237790"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679237784"><span class="annot"><span class="annottext">showTension :: Tension a -&gt; String
</span><a href="#local-6989586621679237784"><span class="hs-identifier hs-var hs-var">showTension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#TensionAtLeast"><span class="hs-identifier hs-type">TensionAtLeast</span></a></span><span> </span><span id="local-6989586621679237783"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237783"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atleast %.3f&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237783"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="#local-6989586621679237784"><span class="hs-identifier hs-var">showTension</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span id="local-6989586621679237782"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237782"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%.3f&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237782"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679237788"><span class="annot"><span class="annottext">typename :: MetaNodeType a -&gt; String
</span><a href="#local-6989586621679237788"><span class="hs-identifier hs-var hs-var">typename</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><a href="#local-6989586621679237788"><span class="hs-identifier hs-var">typename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237781"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237781"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{curl %.3f}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237781"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="#local-6989586621679237788"><span class="hs-identifier hs-var">typename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237780"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237780"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{%s}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; String
forall a. Show a =&gt; Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var">showPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679237780"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-150"></span><span>    </span><span>
</span><span id="line-151"></span><span id="local-6989586621679238211"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-type">showPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679238211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-152"></span><span id="showPoint"><span class="annot"><span class="annottext">showPoint :: Point a -&gt; String
</span><a href="Geom2D.CubicBezier.MetaPath.html#showPoint"><span class="hs-identifier hs-var hs-var">showPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679237778"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237778"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679237777"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237777"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237778"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237777"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Create a normal path from a metapath.</span><span>
</span><span id="line-155"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen"><span class="hs-identifier hs-type">unmetaOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-156"></span><span id="unmetaOpen"><span class="annot"><span class="annottext">unmetaOpen :: OpenMetaPath Double -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen"><span class="hs-identifier hs-var hs-var">unmetaOpen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span id="local-6989586621679237776"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237776"><span class="hs-identifier hs-var">nodes</span></a></span></span><span> </span><span id="local-6989586621679237775"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237775"><span class="hs-identifier hs-var">endpoint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen%27"><span class="hs-identifier hs-var">unmetaOpen'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)]
 -&gt; Point Double -&gt; [(Point Double, MetaJoin Double)])
-&gt; Point Double
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237775"><span class="hs-identifier hs-var">endpoint</span></a></span><span> </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)]
 -&gt; [(Point Double, MetaJoin Double)])
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-158"></span><span>              </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#removeEmptyDirs"><span class="hs-identifier hs-var">removeEmptyDirs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237776"><span class="hs-identifier hs-var">nodes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237775"><span class="hs-identifier hs-var">endpoint</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen%27"><span class="hs-identifier hs-type">unmetaOpen'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-162"></span><span id="unmetaOpen%27"><span class="annot"><span class="annottext">unmetaOpen' :: [(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen%27"><span class="hs-identifier hs-var hs-var">unmetaOpen'</span></a></span></span><span> </span><span id="local-6989586621679237769"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237769"><span class="hs-identifier hs-var">nodes</span></a></span></span><span> </span><span id="local-6989586621679237768"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237768"><span class="hs-identifier hs-var">endpoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237767"><span class="annot"><span class="annottext">subsegs :: [OpenMetaPath Double]
</span><a href="#local-6989586621679237767"><span class="hs-identifier hs-var hs-var">subsegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [OpenMetaPath Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#openSubSegments"><span class="hs-identifier hs-var">openSubSegments</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237769"><span class="hs-identifier hs-var">nodes</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237768"><span class="hs-identifier hs-var">endpoint</span></a></span><span>
</span><span id="line-164"></span><span>      </span><span id="local-6989586621679237765"><span class="annot"><span class="annottext">path :: [(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237765"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OpenPath Double] -&gt; [(Point Double, PathJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#joinSegments"><span class="hs-identifier hs-var">joinSegments</span></a></span><span> </span><span class="annot"><span class="annottext">([OpenPath Double] -&gt; [(Point Double, PathJoin Double)])
-&gt; [OpenPath Double] -&gt; [(Point Double, PathJoin Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(OpenMetaPath Double -&gt; OpenPath Double)
-&gt; [OpenMetaPath Double] -&gt; [OpenPath Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">OpenMetaPath Double -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaSubSegment"><span class="hs-identifier hs-var">unmetaSubSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[OpenMetaPath Double]
</span><a href="#local-6989586621679237767"><span class="hs-identifier hs-var">subsegs</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
-&gt; Point Double -&gt; OpenPath Double
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237765"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237768"><span class="hs-identifier hs-var">endpoint</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaClosed"><span class="hs-identifier hs-type">unmetaClosed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier hs-type">ClosedMetaPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-168"></span><span id="unmetaClosed"><span class="annot"><span class="annottext">unmetaClosed :: ClosedMetaPath Double -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaClosed"><span class="hs-identifier hs-var hs-var">unmetaClosed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#ClosedMetaPath"><span class="hs-identifier hs-type">ClosedMetaPath</span></a></span><span> </span><span id="local-6989586621679237761"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237761"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)] -&gt; Bool)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; ([(Point Double, MetaJoin Double)],
    [(Point Double, MetaJoin Double)])
forall a. ([a] -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Geom2D.CubicBezier.MetaPath.html#spanList"><span class="hs-identifier hs-var">spanList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)] -&gt; Bool
</span><a href="Geom2D.CubicBezier.MetaPath.html#bothOpen"><span class="hs-identifier hs-var">bothOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#removeEmptyDirs"><span class="hs-identifier hs-var">removeEmptyDirs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237761"><span class="hs-identifier hs-var">nodes</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ClosedPath Double
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;empty metapath&quot;</span></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679237757"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; (Point Double, MetaJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; (Point Double, MetaJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)] -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaAsOpen"><span class="hs-identifier hs-var">unmetaAsOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)] -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaCyclic"><span class="hs-identifier hs-var">unmetaCyclic</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237757"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679237752"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237752"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237751"><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">m</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237750"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237750"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)] -&gt; Bool
</span><a href="Geom2D.CubicBezier.MetaPath.html#leftOpen"><span class="hs-identifier hs-var">leftOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237750"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)] -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaAsOpen"><span class="hs-identifier hs-var">unmetaAsOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237752"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237750"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)] -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaAsOpen"><span class="hs-identifier hs-var">unmetaAsOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237752"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237751"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237750"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- solve a cyclic metapath as an open path if possible.</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- rotate to the defined node, and rotate back after</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- solving the path.</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaAsOpen"><span class="hs-identifier hs-type">unmetaAsOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-183"></span><span id="unmetaAsOpen"><span class="annot"><span class="annottext">unmetaAsOpen :: [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)] -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaAsOpen"><span class="hs-identifier hs-var hs-var">unmetaAsOpen</span></a></span></span><span> </span><span id="local-6989586621679237748"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237748"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679237747"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237747"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)] -&gt; ClosedPath Double
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237745"><span class="hs-identifier hs-var">l'</span></a></span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
-&gt; [(Point Double, PathJoin Double)]
-&gt; [(Point Double, PathJoin Double)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237744"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679237743"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679237743"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237747"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679237741"><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237741"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-186"></span><span>          </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaOpen%27"><span class="hs-identifier hs-var">unmetaOpen'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitizeCycle"><span class="hs-identifier hs-var">sanitizeCycle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237747"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237748"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; Point Double)
-&gt; (Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; (Point Double, MetaJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237747"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237748"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679237744"><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237744"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679237745"><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237745"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; [(Point Double, PathJoin Double)]
-&gt; ([(Point Double, PathJoin Double)],
    [(Point Double, PathJoin Double)])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237743"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
</span><a href="#local-6989586621679237741"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- decompose into a list of subsegments that need to be solved.</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#openSubSegments"><span class="hs-identifier hs-type">openSubSegments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span id="openSubSegments"><span class="annot"><span class="annottext">openSubSegments :: [(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [OpenMetaPath Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#openSubSegments"><span class="hs-identifier hs-var hs-var">openSubSegments</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#openSubSegments"><span class="hs-identifier hs-var">openSubSegments</span></a></span><span> </span><span id="local-6989586621679237738"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237738"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679237737"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237737"><span class="hs-identifier hs-var">lastPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)] -&gt; Bool)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; ([(Point Double, MetaJoin Double)],
    [(Point Double, MetaJoin Double)])
forall a. ([a] -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Geom2D.CubicBezier.MetaPath.html#spanList"><span class="hs-identifier hs-var">spanList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ([(Point Double, MetaJoin Double)] -&gt; Bool)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)] -&gt; Bool
</span><a href="Geom2D.CubicBezier.MetaPath.html#breakPoint"><span class="hs-identifier hs-var">breakPoint</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237738"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679237733"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237733"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237732"><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237732"><span class="hs-identifier hs-var">n</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237731"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237731"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237730"><span class="annot"><span class="annottext">point :: Point Double
</span><a href="#local-6989586621679237730"><span class="hs-identifier hs-var hs-var">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237731"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679237729"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237729"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MetaJoin Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237729"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237737"><span class="hs-identifier hs-var">lastPoint</span></a></span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; OpenMetaPath Double
forall a. [(Point a, MetaJoin a)] -&gt; Point a -&gt; OpenMetaPath a
</span><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-var">OpenMetaPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237733"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237732"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237730"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="annot"><span class="annottext">OpenMetaPath Double
-&gt; [OpenMetaPath Double] -&gt; [OpenMetaPath Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-199"></span><span>         </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [OpenMetaPath Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#openSubSegments"><span class="hs-identifier hs-var">openSubSegments</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237731"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237737"><span class="hs-identifier hs-var">lastPoint</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)],
 [(Point Double, MetaJoin Double)])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [OpenMetaPath Double]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;openSubSegments': unexpected end of segments&quot;</span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- join subsegments into one segment</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#joinSegments"><span class="hs-identifier hs-type">joinSegments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span id="joinSegments"><span class="annot"><span class="annottext">joinSegments :: [OpenPath Double] -&gt; [(Point Double, PathJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#joinSegments"><span class="hs-identifier hs-var hs-var">joinSegments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(OpenPath Double -&gt; [(Point Double, PathJoin Double)])
-&gt; [OpenPath Double] -&gt; [(Point Double, PathJoin Double)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">OpenPath Double -&gt; [(Point Double, PathJoin Double)]
forall a. OpenPath a -&gt; [(Point a, PathJoin a)]
</span><a href="#local-6989586621679237728"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679237728"><span class="annot"><span class="annottext">nodes :: OpenPath a -&gt; [(Point a, PathJoin a)]
</span><a href="#local-6989586621679237728"><span class="hs-identifier hs-var hs-var">nodes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span id="local-6989586621679237727"><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679237727"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point a, PathJoin a)]
</span><a href="#local-6989586621679237727"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-comment">--nodes (ClosedPath n) = n</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- solve a cyclic metapath where all angles depend on the each other.</span><span>
</span><span id="line-209"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaCyclic"><span class="hs-identifier hs-type">unmetaCyclic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-type">ClosedPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-210"></span><span id="unmetaCyclic"><span class="annot"><span class="annottext">unmetaCyclic :: [(Point Double, MetaJoin Double)] -&gt; ClosedPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaCyclic"><span class="hs-identifier hs-var hs-var">unmetaCyclic</span></a></span></span><span> </span><span id="local-6989586621679237726"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237726"><span class="hs-identifier hs-var">nodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237725"><span class="annot"><span class="annottext">points :: [Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; Point Double)
-&gt; [(Point Double, MetaJoin Double)] -&gt; [Point Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237726"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-212"></span><span>      </span><span id="local-6989586621679237724"><span class="annot"><span class="annottext">chords :: [Point Double]
</span><a href="#local-6989586621679237724"><span class="hs-identifier hs-var hs-var">chords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Point Double)
-&gt; [Point Double] -&gt; [Point Double] -&gt; [Point Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">(^-^)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([Point Double] -&gt; [Point Double])
-&gt; [Point Double] -&gt; [Point Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-213"></span><span>      </span><span id="local-6989586621679237719"><span class="annot"><span class="annottext">tensionsA :: [Tension Double]
</span><a href="#local-6989586621679237719"><span class="hs-identifier hs-var hs-var">tensionsA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; Tension Double)
-&gt; [(Point Double, MetaJoin Double)] -&gt; [Tension Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaJoin Double -&gt; Tension Double
forall a. MetaJoin a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionL"><span class="hs-identifier hs-var hs-var">tensionL</span></a></span><span> </span><span class="annot"><span class="annottext">(MetaJoin Double -&gt; Tension Double)
-&gt; ((Point Double, MetaJoin Double) -&gt; MetaJoin Double)
-&gt; (Point Double, MetaJoin Double)
-&gt; Tension Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; MetaJoin Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237726"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span id="local-6989586621679237718"><span class="annot"><span class="annottext">tensionsB :: [Tension Double]
</span><a href="#local-6989586621679237718"><span class="hs-identifier hs-var hs-var">tensionsB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; Tension Double)
-&gt; [(Point Double, MetaJoin Double)] -&gt; [Tension Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaJoin Double -&gt; Tension Double
forall a. MetaJoin a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionR"><span class="hs-identifier hs-var hs-var">tensionR</span></a></span><span> </span><span class="annot"><span class="annottext">(MetaJoin Double -&gt; Tension Double)
-&gt; ((Point Double, MetaJoin Double) -&gt; MetaJoin Double)
-&gt; (Point Double, MetaJoin Double)
-&gt; Tension Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; MetaJoin Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237726"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-215"></span><span>      </span><span id="local-6989586621679237717"><span class="annot"><span class="annottext">turnAngles :: [Double]
</span><a href="#local-6989586621679237717"><span class="hs-identifier hs-var hs-var">turnAngles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Double)
-&gt; [Point Double] -&gt; [Point Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237724"><span class="hs-identifier hs-var">chords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([Point Double] -&gt; [Point Double])
-&gt; [Point Double] -&gt; [Point Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237724"><span class="hs-identifier hs-var">chords</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>      </span><span id="local-6989586621679237715"><span class="annot"><span class="annottext">thetas :: [Double]
</span><a href="#local-6989586621679237715"><span class="hs-identifier hs-var hs-var">thetas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double, Double, Double)] -&gt; [Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#solveCyclicTriD2"><span class="hs-identifier hs-var">solveCyclicTriD2</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double, Double, Double)] -&gt; [Double])
-&gt; [(Double, Double, Double, Double)] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-217"></span><span>               </span><span class="annot"><span class="annottext">[Tension Double]
-&gt; [Point Double]
-&gt; [Tension Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqsCycle"><span class="hs-identifier hs-var">eqsCycle</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237719"><span class="hs-identifier hs-var">tensionsA</span></a></span><span>
</span><span id="line-218"></span><span>               </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-219"></span><span>               </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237718"><span class="hs-identifier hs-var">tensionsB</span></a></span><span>
</span><span id="line-220"></span><span>               </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237717"><span class="hs-identifier hs-var">turnAngles</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span id="local-6989586621679237712"><span class="annot"><span class="annottext">phis :: [Double]
</span><a href="#local-6989586621679237712"><span class="hs-identifier hs-var hs-var">phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; [Double] -&gt; [Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679237711"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237711"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679237710"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237710"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237711"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237710"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237717"><span class="hs-identifier hs-var">turnAngles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; [Double]) -&gt; [Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237715"><span class="hs-identifier hs-var">thetas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)] -&gt; ClosedPath Double
forall a. [(Point a, PathJoin a)] -&gt; ClosedPath a
</span><a href="Geom2D.CubicBezier.Basic.html#ClosedPath"><span class="hs-identifier hs-var">ClosedPath</span></a></span><span> </span><span class="annot"><span class="annottext">([(Point Double, PathJoin Double)] -&gt; ClosedPath Double)
-&gt; [(Point Double, PathJoin Double)] -&gt; ClosedPath Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
-&gt; [PathJoin Double] -&gt; [(Point Double, PathJoin Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">([PathJoin Double] -&gt; [(Point Double, PathJoin Double)])
-&gt; [PathJoin Double] -&gt; [(Point Double, PathJoin Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-223"></span><span>     </span><span class="annot"><span class="annottext">(Point Double
 -&gt; Point Double
 -&gt; Double
 -&gt; Double
 -&gt; Tension Double
 -&gt; Tension Double
 -&gt; PathJoin Double)
-&gt; [Point Double]
-&gt; [Point Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Tension Double]
-&gt; [Tension Double]
-&gt; [PathJoin Double]
forall a b c d e f g.
(a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; f -&gt; g)
-&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; [e] -&gt; [f] -&gt; [g]
</span><span class="hs-identifier hs-var">zipWith6</span></span><span> </span><span class="annot"><span class="annottext">Point Double
-&gt; Point Double
-&gt; Double
-&gt; Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; PathJoin Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaJoin"><span class="hs-identifier hs-var">unmetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([Point Double] -&gt; [Point Double])
-&gt; [Point Double] -&gt; [Point Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237725"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>     </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237715"><span class="hs-identifier hs-var">thetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237712"><span class="hs-identifier hs-var">phis</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237719"><span class="hs-identifier hs-var">tensionsA</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237718"><span class="hs-identifier hs-var">tensionsB</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- solve a subsegment</span><span>
</span><span id="line-227"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaSubSegment"><span class="hs-identifier hs-type">unmetaSubSegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-type">OpenPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- the simple case where the control points are already given.</span><span>
</span><span id="line-230"></span><span id="unmetaSubSegment"><span class="annot"><span class="annottext">unmetaSubSegment :: OpenMetaPath Double -&gt; OpenPath Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaSubSegment"><span class="hs-identifier hs-var hs-var">unmetaSubSegment</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679237706"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237706"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-type">Controls</span></a></span><span> </span><span id="local-6989586621679237705"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237705"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679237704"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237704"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679237703"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237703"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
-&gt; Point Double -&gt; OpenPath Double
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237706"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; PathJoin Double
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237705"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237704"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237703"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- otherwise solve the angles, and find the control points</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaSubSegment"><span class="hs-identifier hs-var">unmetaSubSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#OpenMetaPath"><span class="hs-identifier hs-type">OpenMetaPath</span></a></span><span> </span><span id="local-6989586621679237701"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237701"><span class="hs-identifier hs-var">nodes</span></a></span></span><span> </span><span id="local-6989586621679237700"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237700"><span class="hs-identifier hs-var">lastpoint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237699"><span class="annot"><span class="annottext">points :: [Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; Point Double)
-&gt; [(Point Double, MetaJoin Double)] -&gt; [Point Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237701"><span class="hs-identifier hs-var">nodes</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237700"><span class="hs-identifier hs-var">lastpoint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>      </span><span id="local-6989586621679237698"><span class="annot"><span class="annottext">joins :: [MetaJoin Double]
</span><a href="#local-6989586621679237698"><span class="hs-identifier hs-var hs-var">joins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)] -&gt; [MetaJoin Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; MetaJoin Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237701"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span id="local-6989586621679237697"><span class="annot"><span class="annottext">chords :: [Point Double]
</span><a href="#local-6989586621679237697"><span class="hs-identifier hs-var hs-var">chords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Point Double)
-&gt; [Point Double] -&gt; [Point Double] -&gt; [Point Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">(^-^)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621679237696"><span class="annot"><span class="annottext">tensionsA :: [Tension Double]
</span><a href="#local-6989586621679237696"><span class="hs-identifier hs-var hs-var">tensionsA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MetaJoin Double -&gt; Tension Double)
-&gt; [MetaJoin Double] -&gt; [Tension Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MetaJoin Double -&gt; Tension Double
forall a. MetaJoin a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionL"><span class="hs-identifier hs-var hs-var">tensionL</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237698"><span class="hs-identifier hs-var">joins</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span id="local-6989586621679237695"><span class="annot"><span class="annottext">tensionsB :: [Tension Double]
</span><a href="#local-6989586621679237695"><span class="hs-identifier hs-var hs-var">tensionsB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MetaJoin Double -&gt; Tension Double)
-&gt; [MetaJoin Double] -&gt; [Tension Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MetaJoin Double -&gt; Tension Double
forall a. MetaJoin a -&gt; Tension a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionR"><span class="hs-identifier hs-var hs-var">tensionR</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237698"><span class="hs-identifier hs-var">joins</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span id="local-6989586621679237694"><span class="annot"><span class="annottext">turnAngles :: [Double]
</span><a href="#local-6989586621679237694"><span class="hs-identifier hs-var hs-var">turnAngles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Double)
-&gt; [Point Double] -&gt; [Point Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237697"><span class="hs-identifier hs-var">chords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237697"><span class="hs-identifier hs-var">chords</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>      </span><span id="local-6989586621679237693"><span class="annot"><span class="annottext">thetas :: [Double]
</span><a href="#local-6989586621679237693"><span class="hs-identifier hs-var hs-var">thetas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double, Double, Double)] -&gt; [Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#solveTriDiagonal2"><span class="hs-identifier hs-var">solveTriDiagonal2</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double, Double, Double)] -&gt; [Double])
-&gt; [(Double, Double, Double, Double)] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-242"></span><span>               </span><span class="annot"><span class="annottext">[Point Double]
-&gt; [MetaJoin Double]
-&gt; [Point Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqsOpen"><span class="hs-identifier hs-var">eqsOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237698"><span class="hs-identifier hs-var">joins</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237697"><span class="hs-identifier hs-var">chords</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237694"><span class="hs-identifier hs-var">turnAngles</span></a></span><span>
</span><span id="line-243"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tension Double -&gt; Double) -&gt; [Tension Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237696"><span class="hs-identifier hs-var">tensionsA</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tension Double -&gt; Double) -&gt; [Tension Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237695"><span class="hs-identifier hs-var">tensionsB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>      </span><span id="local-6989586621679237690"><span class="annot"><span class="annottext">phis :: [Double]
</span><a href="#local-6989586621679237690"><span class="hs-identifier hs-var hs-var">phis</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; [Double] -&gt; [Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679237689"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237689"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679237688"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237688"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237689"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237688"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237694"><span class="hs-identifier hs-var">turnAngles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237693"><span class="hs-identifier hs-var">thetas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>      </span><span id="local-6989586621679237687"><span class="annot"><span class="annottext">pathjoins :: [PathJoin Double]
</span><a href="#local-6989586621679237687"><span class="hs-identifier hs-var hs-var">pathjoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="annottext">(Point Double
 -&gt; Point Double
 -&gt; Double
 -&gt; Double
 -&gt; Tension Double
 -&gt; Tension Double
 -&gt; PathJoin Double)
-&gt; [Point Double]
-&gt; [Point Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Tension Double]
-&gt; [Tension Double]
-&gt; [PathJoin Double]
forall a b c d e f g.
(a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; f -&gt; g)
-&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; [e] -&gt; [f] -&gt; [g]
</span><span class="hs-identifier hs-var">zipWith6</span></span><span> </span><span class="annot"><span class="annottext">Point Double
-&gt; Point Double
-&gt; Double
-&gt; Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; PathJoin Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaJoin"><span class="hs-identifier hs-var">unmetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237693"><span class="hs-identifier hs-var">thetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237690"><span class="hs-identifier hs-var">phis</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237696"><span class="hs-identifier hs-var">tensionsA</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237695"><span class="hs-identifier hs-var">tensionsB</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(Point Double, PathJoin Double)]
-&gt; Point Double -&gt; OpenPath Double
forall a. [(Point a, PathJoin a)] -&gt; Point a -&gt; OpenPath a
</span><a href="Geom2D.CubicBezier.Basic.html#OpenPath"><span class="hs-identifier hs-var">OpenPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double]
-&gt; [PathJoin Double] -&gt; [(Point Double, PathJoin Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237699"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">[PathJoin Double]
</span><a href="#local-6989586621679237687"><span class="hs-identifier hs-var">pathjoins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237700"><span class="hs-identifier hs-var">lastpoint</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#removeEmptyDirs"><span class="hs-identifier hs-type">removeEmptyDirs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-251"></span><span id="removeEmptyDirs"><span class="annot"><span class="annottext">removeEmptyDirs :: [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#removeEmptyDirs"><span class="hs-identifier hs-var hs-var">removeEmptyDirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double)
 -&gt; (Point Double, MetaJoin Double))
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; (Point Double, MetaJoin Double)
forall a a. (Eq a, Num a) =&gt; (a, MetaJoin a) -&gt; (a, MetaJoin a)
</span><a href="#local-6989586621679237686"><span class="hs-identifier hs-var">remove</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679237686"><span class="annot"><span class="annottext">remove :: (a, MetaJoin a) -&gt; (a, MetaJoin a)
</span><a href="#local-6989586621679237686"><span class="hs-identifier hs-var hs-var">remove</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237685"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237685"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679237684"><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237684"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679237683"><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237683"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679237682"><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237682"><span class="hs-identifier hs-var">jr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, MetaJoin a) -&gt; (a, MetaJoin a)
</span><a href="#local-6989586621679237686"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237685"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
forall a. MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237684"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237683"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237682"><span class="hs-identifier hs-var">jr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><a href="#local-6989586621679237686"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237681"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237681"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237680"><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237680"><span class="hs-identifier hs-var">jl</span></a></span></span><span> </span><span id="local-6989586621679237679"><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237679"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679237678"><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237678"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237681"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237680"><span class="hs-identifier hs-var">jl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237679"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension a
</span><a href="#local-6989586621679237678"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
forall a. MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><a href="#local-6989586621679237686"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span id="local-6989586621679237677"><span class="annot"><span class="annottext">(a, MetaJoin a)
</span><a href="#local-6989586621679237677"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, MetaJoin a)
</span><a href="#local-6989586621679237677"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- if p == q, it will become a control point</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#bothOpen"><span class="hs-identifier hs-type">bothOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-258"></span><span id="bothOpen"><span class="annot"><span class="annottext">bothOpen :: [(Point Double, MetaJoin Double)] -&gt; Bool
</span><a href="Geom2D.CubicBezier.MetaPath.html#bothOpen"><span class="hs-identifier hs-var hs-var">bothOpen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679237676"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237676"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679237675"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237675"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237676"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237675"><span class="hs-identifier hs-var">q</span></a></span><span>  </span><span>
</span><span id="line-259"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#bothOpen"><span class="hs-identifier hs-var">bothOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#bothOpen"><span class="hs-identifier hs-var">bothOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#leftOpen"><span class="hs-identifier hs-type">leftOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-263"></span><span id="leftOpen"><span class="annot"><span class="annottext">leftOpen :: [(Point Double, MetaJoin Double)] -&gt; Bool
</span><a href="Geom2D.CubicBezier.MetaPath.html#leftOpen"><span class="hs-identifier hs-var hs-var">leftOpen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679237673"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237673"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span id="local-6989586621679237672"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237672"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237673"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237672"><span class="hs-identifier hs-var">q</span></a></span><span>  </span><span>
</span><span id="line-264"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#leftOpen"><span class="hs-identifier hs-var">leftOpen</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#leftOpen"><span class="hs-identifier hs-var">leftOpen</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitizeCycle"><span class="hs-identifier hs-type">sanitizeCycle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span id="sanitizeCycle"><span class="annot"><span class="annottext">sanitizeCycle :: [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitizeCycle"><span class="hs-identifier hs-var hs-var">sanitizeCycle</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitizeCycle"><span class="hs-identifier hs-var">sanitizeCycle</span></a></span><span> </span><span id="local-6989586621679237671"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237671"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237669"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)]
 -&gt; [(Point Double, MetaJoin Double)])
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)]
 -&gt; [(Point Double, MetaJoin Double)])
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-270"></span><span>                  </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679237669"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Point Double, MetaJoin Double)]
 -&gt; [(Point Double, MetaJoin Double)])
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237671"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point Double, MetaJoin Double) -&gt; Point Double)
-&gt; (Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; (Point Double, MetaJoin Double)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237671"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679237669"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679237669"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237671"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-type">sanitize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span id="sanitize"><span class="annot"><span class="annottext">sanitize :: [(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var hs-var">sanitize</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- ending open =&gt; curl</span><span>
</span><span id="line-277"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679237667"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237667"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237666"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237666"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679237665"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237665"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679237664"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237664"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679237663"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237663"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237667"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237663"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237667"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; MetaJoin Double
forall a. Point a -&gt; Point a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-var">Controls</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237667"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237667"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237667"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237666"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237665"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237664"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679237662"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237662"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237661"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237661"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679237660"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237660"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679237659"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237659"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679237658"><span class="annot"><span class="annottext">rest :: [(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237658"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679237657"><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237657"><span class="hs-identifier hs-var">node2</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237656"><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237656"><span class="hs-identifier hs-var">node3</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679237655"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237655"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237657"><span class="hs-identifier hs-var">node2</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; Point Double
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237656"><span class="hs-identifier hs-var">node3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaJoin Double -&gt; MetaNodeType Double
forall a. MetaJoin a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#metaTypeL"><span class="hs-identifier hs-var hs-var">metaTypeL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double) -&gt; MetaJoin Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237657"><span class="hs-identifier hs-var">node2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double -&gt; MetaNodeType Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
forall a. MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237662"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237661"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237660"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237659"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237658"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237655"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span>
</span><span id="line-286"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237654"><span class="annot"><span class="annottext">node1 :: (Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237654"><span class="hs-identifier hs-var">node1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679237653"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237652"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237652"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679237651"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237651"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679237650"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237650"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679237649"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237649"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679237648"><span class="annot"><span class="annottext">node2 :: (Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237648"><span class="hs-identifier hs-var">node2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679237647"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237646"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237646"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679237645"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237645"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679237644"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237644"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679237643"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237643"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679237642"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679237641"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-comment">-- if two consecutive points are the same, just make a curve with all control points the same</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-comment">-- we still have to propagate a curl or given direction.</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237640"><span class="annot"><span class="annottext">newnode :: (Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237640"><span class="hs-identifier hs-var hs-var">newnode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; MetaJoin Double
forall a. Point a -&gt; Point a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-var">Controls</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237649"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237646"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237639"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237639"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- curl, open =&gt; explicit, curl</span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237640"><span class="hs-identifier hs-var">newnode</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237639"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237645"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237644"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237643"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237638"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237638"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-comment">-- given, open =&gt; explicit, given</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237640"><span class="hs-identifier hs-var">newnode</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; MetaNodeType Double
forall a. Point a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237638"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237645"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237644"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237643"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-comment">-- open, open =&gt; explicit, curl</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237640"><span class="hs-identifier hs-var">newnode</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237645"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237644"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237643"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><span class="annottext">(MetaNodeType Double, MetaNodeType Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237640"><span class="hs-identifier hs-var">newnode</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237648"><span class="hs-identifier hs-var">node2</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237649"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237646"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237637"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237637"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- curl, open =&gt; curl, curl</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237654"><span class="hs-identifier hs-var">node1</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237637"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237645"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237644"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237643"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237636"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237636"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- open, curl =&gt; curl, curl</span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237652"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237651"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237650"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237636"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237648"><span class="hs-identifier hs-var">node2</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237635"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237635"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-comment">-- given, open =&gt; given, given</span><span>
</span><span id="line-306"></span><span>        </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237654"><span class="hs-identifier hs-var">node1</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237647"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; MetaNodeType Double
forall a. Point a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237635"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237645"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237644"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237643"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237634"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237634"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>   </span><span class="hs-comment">-- open, given =&gt; given, given</span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237653"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237652"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237651"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237650"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; MetaNodeType Double
forall a. Point a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237634"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237648"><span class="hs-identifier hs-var">node2</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">(MetaNodeType Double, MetaNodeType Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237654"><span class="hs-identifier hs-var">node1</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237648"><span class="hs-identifier hs-var">node2</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237642"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237641"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679237633"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237632"><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237632"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237631"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237630"><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237630"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679237629"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237629"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679237628"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237628"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237632"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237630"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-type">Controls</span></a></span><span> </span><span id="local-6989586621679237627"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237627"><span class="hs-identifier hs-var">_u</span></a></span></span><span> </span><span id="local-6989586621679237626"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237626"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span id="local-6989586621679237625"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237625"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679237624"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237624"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679237623"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237623"><span class="hs-identifier hs-var">mt2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- explicit, open =&gt; explicit, given</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237626"><span class="hs-identifier hs-var">v</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237632"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237625"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237624"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237623"><span class="hs-identifier hs-var">mt2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237629"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237628"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237632"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; MetaNodeType Double
forall a. Point a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237626"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237625"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237624"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237623"><span class="hs-identifier hs-var">mt2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237629"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237628"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237622"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237622"><span class="hs-identifier hs-var">mt1</span></a></span></span><span> </span><span id="local-6989586621679237621"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237621"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679237620"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237620"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-type">Controls</span></a></span><span> </span><span id="local-6989586621679237619"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237619"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679237618"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237618"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- open, explicit =&gt; given, explicit</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237619"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237622"><span class="hs-identifier hs-var">mt1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237621"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237620"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; MetaNodeType Double
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237630"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237629"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; MetaNodeType Double
-&gt; MetaJoin Double
forall a.
MetaNodeType a
-&gt; Tension a -&gt; Tension a -&gt; MetaNodeType a -&gt; MetaJoin a
</span><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-var">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237622"><span class="hs-identifier hs-var">mt1</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237621"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237620"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double -&gt; MetaNodeType Double
forall a. Point a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237619"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237630"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237629"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237628"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">(MetaJoin Double, MetaJoin Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237633"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237632"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237631"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237630"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237629"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237628"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237617"><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237617"><span class="hs-identifier hs-var">n</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237616"><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237616"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679237615"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237615"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
</span><a href="#local-6989586621679237617"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">(Point Double, MetaJoin Double)
-&gt; [(Point Double, MetaJoin Double)]
-&gt; [(Point Double, MetaJoin Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
-&gt; Point Double -&gt; [(Point Double, MetaJoin Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><a href="#local-6989586621679237616"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237615"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679238184"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#spanList"><span class="hs-identifier hs-type">spanList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679238184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679238184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679238184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679238184"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-324"></span><span id="spanList"><span class="annot"><span class="annottext">spanList :: ([a] -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Geom2D.CubicBezier.MetaPath.html#spanList"><span class="hs-identifier hs-var hs-var">spanList</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679237614"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679237614"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237614"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237614"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#spanList"><span class="hs-identifier hs-var">spanList</span></a></span><span> </span><span id="local-6989586621679237613"><span class="annot"><span class="annottext">[a] -&gt; Bool
</span><a href="#local-6989586621679237613"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679237612"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679237612"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679237611"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237611"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237610"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237610"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
</span><a href="#local-6989586621679237613"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237612"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237609"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237609"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679237608"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237608"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
forall a. ([a] -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="Geom2D.CubicBezier.MetaPath.html#spanList"><span class="hs-identifier hs-var">spanList</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
</span><a href="#local-6989586621679237613"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237610"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679237611"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237609"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237608"><span class="hs-identifier hs-var">zs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679237612"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- break the subsegment if the angle to the left or the right is defined or a curl.</span><span>
</span><span id="line-330"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#breakPoint"><span class="hs-identifier hs-type">breakPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-331"></span><span id="breakPoint"><span class="annot"><span class="annottext">breakPoint :: [(Point Double, MetaJoin Double)] -&gt; Bool
</span><a href="Geom2D.CubicBezier.MetaPath.html#breakPoint"><span class="hs-identifier hs-var hs-var">breakPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#breakPoint"><span class="hs-identifier hs-var">breakPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point Double, MetaJoin Double)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- solve the tridiagonal system for t[i]:</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- a[n] t[i-1] + b[n] t[i] + c[n] t[i+1] = d[i]</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- where a[0] = c[n] = 0</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- by first rewriting it into</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- the system t[i] + u[i] t[i+1] = v[i]</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- where u[n] = 0</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- then solving for t[n]</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- see metafont the program: &#182; 283</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#solveTriDiagonal2"><span class="hs-identifier hs-type">solveTriDiagonal2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-343"></span><span id="solveTriDiagonal2"><span class="annot"><span class="annottext">solveTriDiagonal2 :: [(Double, Double, Double, Double)] -&gt; [Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#solveTriDiagonal2"><span class="hs-identifier hs-var hs-var">solveTriDiagonal2</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [Double]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;solveTriDiagonal: not enough equations&quot;</span></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#solveTriDiagonal2"><span class="hs-identifier hs-var">solveTriDiagonal2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237607"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237607"><span class="hs-identifier hs-var">b0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237606"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237606"><span class="hs-identifier hs-var">c0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237605"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237605"><span class="hs-identifier hs-var">d0</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679237604"><span class="annot"><span class="annottext">[(Double, Double, Double, Double)]
</span><a href="#local-6989586621679237604"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><span class="annottext">Vector Double -&gt; [Double]
forall a. Unbox a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector Double -&gt; [Double]) -&gt; Vector Double -&gt; [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double)
-&gt; Vector (Double, Double, Double, Double) -&gt; Vector Double
forall a.
(Unbox a, Fractional a) =&gt;
(a, a, a) -&gt; Vector (a, a, a, a) -&gt; Vector a
</span><a href="Geom2D.CubicBezier.Numeric.html#solveTriDiagonal"><span class="hs-identifier hs-var">solveTriDiagonal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237607"><span class="hs-identifier hs-var">b0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237606"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237605"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Double, Double, Double, Double)]
-&gt; Vector (Double, Double, Double, Double)
forall a. Unbox a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double, Double, Double)]
</span><a href="#local-6989586621679237604"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- test = ((80.0,58.0,51.0),[(-432.0,78.0,102.0,503.0),(71.0,-82.0,20.0,2130.0),(52.39,-10.43,4.0,56.0),(34.0,38.0,0.0,257.0)])</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- [-15.726940528143576,22.571642107784243,-78.93751365259996,-297.27313545829384,272.74438435742667]</span><span>
</span><span id="line-349"></span><span>      </span><span>
</span><span id="line-350"></span><span class="hs-comment">-- solve the cyclic tridiagonal system.</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- see metafont the program: &#182; 286</span><span>
</span><span id="line-352"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#solveCyclicTriD2"><span class="hs-identifier hs-type">solveCyclicTriD2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span id="solveCyclicTriD2"><span class="annot"><span class="annottext">solveCyclicTriD2 :: [(Double, Double, Double, Double)] -&gt; [Double]
</span><a href="Geom2D.CubicBezier.MetaPath.html#solveCyclicTriD2"><span class="hs-identifier hs-var hs-var">solveCyclicTriD2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; [Double]
forall a. Unbox a =&gt; Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector Double -&gt; [Double])
-&gt; ([(Double, Double, Double, Double)] -&gt; Vector Double)
-&gt; [(Double, Double, Double, Double)]
-&gt; [Double]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (Double, Double, Double, Double) -&gt; Vector Double
forall a.
(Unbox a, Fractional a) =&gt;
Vector (a, a, a, a) -&gt; Vector a
</span><a href="Geom2D.CubicBezier.Numeric.html#solveCyclicTriD"><span class="hs-identifier hs-var">solveCyclicTriD</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Double, Double, Double, Double) -&gt; Vector Double)
-&gt; ([(Double, Double, Double, Double)]
    -&gt; Vector (Double, Double, Double, Double))
-&gt; [(Double, Double, Double, Double)]
-&gt; Vector Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double, Double, Double)]
-&gt; Vector (Double, Double, Double, Double)
forall a. Unbox a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-type">turnAngle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-356"></span><span id="turnAngle"><span class="annot"><span class="annottext">turnAngle :: Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var hs-var">turnAngle</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679237599"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237599"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679237598"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237598"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679237597"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237597"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Double
forall a. RealFloat a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorAngle"><span class="hs-identifier hs-var">vectorAngle</span></a></span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Double) -&gt; Point Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Transform Double
forall a. Floating a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateVec"><span class="hs-identifier hs-var">rotateVec</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237594"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Transform Double -&gt; Point Double -&gt; Point Double
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237597"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679237594"><span class="annot"><span class="annottext">p :: Point Double
</span><a href="#local-6989586621679237594"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237598"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span id="local-6989586621679238125"><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-type">zipNext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679238125"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679238125"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679238125"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-361"></span><span id="zipNext"><span class="annot"><span class="annottext">zipNext :: [b] -&gt; [(b, b)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-var hs-var">zipNext</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-362"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-var">zipNext</span></a></span><span> </span><span id="local-6989586621679237591"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679237591"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [(b, b)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679237591"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b] -&gt; [b]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b]) -&gt; [b] -&gt; [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679237591"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- find the equations for a cycle containing only open points</span><span>
</span><span id="line-365"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#eqsCycle"><span class="hs-identifier hs-type">eqsCycle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-366"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span id="eqsCycle"><span class="annot"><span class="annottext">eqsCycle :: [Tension Double]
-&gt; [Point Double]
-&gt; [Tension Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqsCycle"><span class="hs-identifier hs-var hs-var">eqsCycle</span></a></span></span><span> </span><span id="local-6989586621679237590"><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237590"><span class="hs-identifier hs-var">tensionsA</span></a></span></span><span> </span><span id="local-6989586621679237589"><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237589"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span id="local-6989586621679237588"><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237588"><span class="hs-identifier hs-var">tensionsB</span></a></span></span><span> </span><span id="local-6989586621679237587"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237587"><span class="hs-identifier hs-var">turnAngles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><span class="annottext">((Double, Double)
 -&gt; (Double, Double)
 -&gt; (Double, Double)
 -&gt; (Double, Double)
 -&gt; (Double, Double, Double, Double))
-&gt; [(Double, Double)]
-&gt; [(Double, Double)]
-&gt; [(Double, Double)]
-&gt; [(Double, Double)]
-&gt; [(Double, Double, Double, Double)]
forall a b c d e.
(a -&gt; b -&gt; c -&gt; d -&gt; e) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d] -&gt; [e]
</span><span class="hs-identifier hs-var">zipWith4</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqTension"><span class="hs-identifier hs-var">eqTension</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [(Double, Double)]
forall b. [b] -&gt; [(b, b)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-var">zipNext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tension Double -&gt; Double) -&gt; [Tension Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237590"><span class="hs-identifier hs-var">tensionsA</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [(Double, Double)]
forall b. [b] -&gt; [(b, b)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-var">zipNext</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237584"><span class="hs-identifier hs-var">dists</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [(Double, Double)]
forall b. [b] -&gt; [(b, b)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-var">zipNext</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237587"><span class="hs-identifier hs-var">turnAngles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [(Double, Double)]
forall b. [b] -&gt; [(b, b)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#zipNext"><span class="hs-identifier hs-var">zipNext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tension Double -&gt; Double) -&gt; [Tension Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">[Tension Double]
</span><a href="#local-6989586621679237588"><span class="hs-identifier hs-var">tensionsB</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679237584"><span class="annot"><span class="annottext">dists :: [Double]
</span><a href="#local-6989586621679237584"><span class="hs-identifier hs-var hs-var">dists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Double)
-&gt; [Point Double] -&gt; [Point Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237589"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([Point Double] -&gt; [Point Double])
-&gt; [Point Double] -&gt; [Point Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237589"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- find the equations for an path with open points.</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- The first and last node should be a curl or a given angle</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#eqsOpen"><span class="hs-identifier hs-type">eqsOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-381"></span><span id="eqsOpen"><span class="annot"><span class="annottext">eqsOpen :: [Point Double]
-&gt; [MetaJoin Double]
-&gt; [Point Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqsOpen"><span class="hs-identifier hs-var hs-var">eqsOpen</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span id="local-6989586621679237582"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237582"><span class="hs-identifier hs-var">mt1</span></a></span></span><span> </span><span id="local-6989586621679237581"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237581"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679237580"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237580"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679237579"><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237579"><span class="hs-identifier hs-var">mt2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679237578"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237578"><span class="hs-identifier hs-var">delta</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679237577"><span class="annot"><span class="annottext">replaceType :: MetaNodeType a -&gt; MetaNodeType a
</span><a href="#local-6989586621679237577"><span class="hs-identifier hs-var hs-var">replaceType</span></a></span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; MetaNodeType a
forall a. a -&gt; MetaNodeType a
</span><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-var">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><a href="#local-6989586621679237577"><span class="hs-identifier hs-var">replaceType</span></a></span><span> </span><span id="local-6989586621679237576"><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237576"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaNodeType a
</span><a href="#local-6989586621679237576"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaNodeType Double -&gt; MetaNodeType Double
forall a. Num a =&gt; MetaNodeType a -&gt; MetaNodeType a
</span><a href="#local-6989586621679237577"><span class="hs-identifier hs-var">replaceType</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237582"><span class="hs-identifier hs-var">mt1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double -&gt; MetaNodeType Double
forall a. Num a =&gt; MetaNodeType a -&gt; MetaNodeType a
</span><a href="#local-6989586621679237577"><span class="hs-identifier hs-var">replaceType</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="#local-6989586621679237579"><span class="hs-identifier hs-var">mt2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237575"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237575"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237574"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237574"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
-&gt; Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurl0"><span class="hs-identifier hs-var">eqCurl0</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237575"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237581"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237580"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>
</span><span id="line-387"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237578"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237574"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237572"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237572"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237571"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237571"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-389"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237578"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237572"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-390"></span><span>       </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurlN"><span class="hs-identifier hs-var">eqCurlN</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237571"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237581"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237580"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237569"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237569"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237568"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237568"><span class="hs-identifier hs-var">dir2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237578"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237569"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-393"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237578"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237568"><span class="hs-identifier hs-var">dir2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><span class="annottext">(MetaNodeType Double, MetaNodeType Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Double, Double, Double, Double)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;illegal end of open path&quot;</span></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#eqsOpen"><span class="hs-identifier hs-var">eqsOpen</span></a></span><span> </span><span id="local-6989586621679237567"><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237567"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span id="local-6989586621679237566"><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237566"><span class="hs-identifier hs-var">joins</span></a></span></span><span> </span><span id="local-6989586621679237565"><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237565"><span class="hs-identifier hs-var">chords</span></a></span></span><span> </span><span id="local-6989586621679237564"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237564"><span class="hs-identifier hs-var">turnAngles</span></a></span></span><span> </span><span id="local-6989586621679237563"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237563"><span class="hs-identifier hs-var">tensionsA</span></a></span></span><span> </span><span id="local-6989586621679237562"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237562"><span class="hs-identifier hs-var">tensionsB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">(Double, Double, Double, Double)
</span><a href="#local-6989586621679237561"><span class="hs-identifier hs-var">eq0</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double, Double)
-&gt; [(Double, Double, Double, Double)]
-&gt; [(Double, Double, Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="#local-6989586621679237560"><span class="hs-identifier hs-var">restEquations</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237566"><span class="hs-identifier hs-var">joins</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237563"><span class="hs-identifier hs-var">tensionsA</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237559"><span class="hs-identifier hs-var">dists</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237564"><span class="hs-identifier hs-var">turnAngles</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237562"><span class="hs-identifier hs-var">tensionsB</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679237559"><span class="annot"><span class="annottext">dists :: [Double]
</span><a href="#local-6989586621679237559"><span class="hs-identifier hs-var hs-var">dists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point Double -&gt; Point Double -&gt; Double)
-&gt; [Point Double] -&gt; [Point Double] -&gt; [Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237567"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; [Point Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237567"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span>      </span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679237561"><span class="annot"><span class="annottext">eq0 :: (Double, Double, Double, Double)
</span><a href="#local-6989586621679237561"><span class="hs-identifier hs-var hs-var">eq0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double] -&gt; MetaJoin Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237566"><span class="hs-identifier hs-var">joins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237558"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237558"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
-&gt; Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurl0"><span class="hs-identifier hs-var">eqCurl0</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237558"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237563"><span class="hs-identifier hs-var">tensionsA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237562"><span class="hs-identifier hs-var">tensionsB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237564"><span class="hs-identifier hs-var">turnAngles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237557"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237557"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; Point Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237565"><span class="hs-identifier hs-var">chords</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237557"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
-&gt; Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurl0"><span class="hs-identifier hs-var">eqCurl0</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237563"><span class="hs-identifier hs-var">tensionsA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237562"><span class="hs-identifier hs-var">tensionsB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237564"><span class="hs-identifier hs-var">turnAngles</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-type">Controls</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Double, Double, Double, Double)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eqsOpen: illegal join&quot;</span></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679237560"><span class="annot"><span class="annottext">restEquations :: [MetaJoin Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="#local-6989586621679237560"><span class="hs-identifier hs-var hs-var">restEquations</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679237556"><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237556"><span class="hs-identifier hs-var">lastnode</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237555"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237555"><span class="hs-identifier hs-var">tensionA</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237554"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237554"><span class="hs-identifier hs-var">tensionB</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MetaJoin Double
</span><a href="#local-6989586621679237556"><span class="hs-identifier hs-var">lastnode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Curl"><span class="hs-identifier hs-type">Curl</span></a></span><span> </span><span id="local-6989586621679237553"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237553"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurlN"><span class="hs-identifier hs-var">eqCurlN</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237553"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237555"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237554"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#Open"><span class="hs-identifier hs-var">Open</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurlN"><span class="hs-identifier hs-var">eqCurlN</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237555"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237554"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#MetaJoin"><span class="hs-identifier hs-type">MetaJoin</span></a></span><span> </span><span class="annot"><span class="annottext">MetaNodeType Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span id="local-6989586621679237552"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237552"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#turnAngle"><span class="hs-identifier hs-var">turnAngle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point Double] -&gt; Point Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Point Double]
</span><a href="#local-6989586621679237565"><span class="hs-identifier hs-var">chords</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237552"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Controls"><span class="hs-identifier hs-type">Controls</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Double, Double, Double, Double)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eqsOpen: illegal join&quot;</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><a href="#local-6989586621679237560"><span class="hs-identifier hs-var">restEquations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaJoin Double
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237551"><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237551"><span class="hs-identifier hs-var">othernodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237550"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237550"><span class="hs-identifier hs-var">tensionA</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237549"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237549"><span class="hs-identifier hs-var">restTA</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237548"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237548"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237547"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237547"><span class="hs-identifier hs-var">restD</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237546"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237546"><span class="hs-identifier hs-var">turn</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237545"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237545"><span class="hs-identifier hs-var">restTurn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237544"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237544"><span class="hs-identifier hs-var">tensionB</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679237543"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237543"><span class="hs-identifier hs-var">restTB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><span class="annottext">(Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqTension"><span class="hs-identifier hs-var">eqTension</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237550"><span class="hs-identifier hs-var">tensionA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237549"><span class="hs-identifier hs-var">restTA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237548"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237547"><span class="hs-identifier hs-var">restD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237546"><span class="hs-identifier hs-var">turn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237545"><span class="hs-identifier hs-var">restTurn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237544"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237543"><span class="hs-identifier hs-var">restTB</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double, Double)
-&gt; [(Double, Double, Double, Double)]
-&gt; [(Double, Double, Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><span class="annottext">[MetaJoin Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [Double]
-&gt; [(Double, Double, Double, Double)]
</span><a href="#local-6989586621679237560"><span class="hs-identifier hs-var">restEquations</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><a href="#local-6989586621679237551"><span class="hs-identifier hs-var">othernodes</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237549"><span class="hs-identifier hs-var">restTA</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237547"><span class="hs-identifier hs-var">restD</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237545"><span class="hs-identifier hs-var">restTurn</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679237543"><span class="hs-identifier hs-var">restTB</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="#local-6989586621679237560"><span class="hs-identifier hs-var">restEquations</span></a></span><span> </span><span class="annot"><span class="annottext">[MetaJoin Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Double, Double, Double, Double)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eqsOpen: illegal rest equations&quot;</span></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">-- the equation for an open node</span><span>
</span><span id="line-422"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#eqTension"><span class="hs-identifier hs-type">eqTension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span id="eqTension"><span class="annot"><span class="annottext">eqTension :: (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqTension"><span class="hs-identifier hs-var hs-var">eqTension</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237542"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237542"><span class="hs-identifier hs-var">tensionA'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237541"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237541"><span class="hs-identifier hs-var">tensionA</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237540"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237540"><span class="hs-identifier hs-var">dist'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237539"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237539"><span class="hs-identifier hs-var">dist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237538"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237538"><span class="hs-identifier hs-var">psi'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237537"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237537"><span class="hs-identifier hs-var">psi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679237536"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237536"><span class="hs-identifier hs-var">tensionB'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679237535"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237535"><span class="hs-identifier hs-var">tensionB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237534"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237533"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237532"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237531"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237533"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237538"><span class="hs-identifier hs-var">psi'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237531"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237537"><span class="hs-identifier hs-var">psi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679237534"><span class="annot"><span class="annottext">a :: Double
</span><a href="#local-6989586621679237534"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237536"><span class="hs-identifier hs-var">tensionB'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237536"><span class="hs-identifier hs-var">tensionB'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237542"><span class="hs-identifier hs-var">tensionA'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237540"><span class="hs-identifier hs-var">dist'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679237533"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679237533"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237542"><span class="hs-identifier hs-var">tensionA'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237536"><span class="hs-identifier hs-var">tensionB'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237536"><span class="hs-identifier hs-var">tensionB'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237540"><span class="hs-identifier hs-var">dist'</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679237532"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679237532"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237535"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237541"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237541"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237539"><span class="hs-identifier hs-var">dist</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621679237531"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679237531"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237541"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237541"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237535"><span class="hs-identifier hs-var">tensionB</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237539"><span class="hs-identifier hs-var">dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- the equation for a starting curl</span><span>
</span><span id="line-434"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#eqCurl0"><span class="hs-identifier hs-type">eqCurl0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span id="eqCurl0"><span class="annot"><span class="annottext">eqCurl0 :: Double
-&gt; Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurl0"><span class="hs-identifier hs-var hs-var">eqCurl0</span></a></span></span><span> </span><span id="local-6989586621679237528"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237528"><span class="hs-identifier hs-var">gamma</span></a></span></span><span> </span><span id="local-6989586621679237527"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237527"><span class="hs-identifier hs-var">tensionA</span></a></span></span><span> </span><span id="local-6989586621679237526"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237526"><span class="hs-identifier hs-var">tensionB</span></a></span></span><span> </span><span id="local-6989586621679237525"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237525"><span class="hs-identifier hs-var">psi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237524"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237523"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237522"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621679237524"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679237524"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237521"><span class="hs-identifier hs-var">chi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237527"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237526"><span class="hs-identifier hs-var">tensionB</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621679237523"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679237523"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237527"><span class="hs-identifier hs-var">tensionA</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237521"><span class="hs-identifier hs-var">chi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237526"><span class="hs-identifier hs-var">tensionB</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621679237521"><span class="annot"><span class="annottext">chi :: Double
</span><a href="#local-6989586621679237521"><span class="hs-identifier hs-var hs-var">chi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237528"><span class="hs-identifier hs-var">gamma</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237526"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237526"><span class="hs-identifier hs-var">tensionB</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237527"><span class="hs-identifier hs-var">tensionA</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237527"><span class="hs-identifier hs-var">tensionA</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679237522"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679237522"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237523"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237525"><span class="hs-identifier hs-var">psi</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- the equation for an ending curl</span><span>
</span><span id="line-444"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#eqCurlN"><span class="hs-identifier hs-type">eqCurlN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span id="eqCurlN"><span class="annot"><span class="annottext">eqCurlN :: Double -&gt; Double -&gt; Double -&gt; (Double, Double, Double, Double)
</span><a href="Geom2D.CubicBezier.MetaPath.html#eqCurlN"><span class="hs-identifier hs-var hs-var">eqCurlN</span></a></span></span><span> </span><span id="local-6989586621679237520"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237520"><span class="hs-identifier hs-var">gamma</span></a></span></span><span> </span><span id="local-6989586621679237519"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237519"><span class="hs-identifier hs-var">tensionA</span></a></span></span><span> </span><span id="local-6989586621679237518"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237518"><span class="hs-identifier hs-var">tensionB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237517"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237516"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679237517"><span class="annot"><span class="annottext">a :: Double
</span><a href="#local-6989586621679237517"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237518"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237515"><span class="hs-identifier hs-var">chi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237519"><span class="hs-identifier hs-var">tensionA</span></a></span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621679237516"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679237516"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237515"><span class="hs-identifier hs-var">chi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237518"><span class="hs-identifier hs-var">tensionB</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237519"><span class="hs-identifier hs-var">tensionA</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span id="local-6989586621679237515"><span class="annot"><span class="annottext">chi :: Double
</span><a href="#local-6989586621679237515"><span class="hs-identifier hs-var hs-var">chi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237520"><span class="hs-identifier hs-var">gamma</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237519"><span class="hs-identifier hs-var">tensionA</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237519"><span class="hs-identifier hs-var">tensionA</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237518"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237518"><span class="hs-identifier hs-var">tensionB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- getting the control points</span><span>
</span><span id="line-453"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#unmetaJoin"><span class="hs-identifier hs-type">unmetaJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-identifier hs-type">DPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-454"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#PathJoin"><span class="hs-identifier hs-type">PathJoin</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-455"></span><span id="unmetaJoin"><span class="annot"><span class="annottext">unmetaJoin :: Point Double
-&gt; Point Double
-&gt; Double
-&gt; Double
-&gt; Tension Double
-&gt; Tension Double
-&gt; PathJoin Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#unmetaJoin"><span class="hs-identifier hs-var hs-var">unmetaJoin</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679237514"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237514"><span class="hs-identifier hs-var">z0</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679237513"><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237513"><span class="hs-identifier hs-var">z1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679237512"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237512"><span class="hs-identifier hs-var">theta</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679237511"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237511"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679237510"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237510"><span class="hs-identifier hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679237509"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237509"><span class="hs-identifier hs-var">beta</span></a></span></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237511"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-4</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237512"><span class="hs-identifier hs-var">theta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-4</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathJoin Double
forall a. PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinLine"><span class="hs-identifier hs-var">JoinLine</span></a></span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; PathJoin Double
forall a. Point a -&gt; Point a -&gt; PathJoin a
</span><a href="Geom2D.CubicBezier.Basic.html#JoinCurve"><span class="hs-identifier hs-var">JoinCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237505"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237504"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679237503"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237503"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span id="local-6989586621679237502"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237502"><span class="hs-identifier hs-var">dy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237513"><span class="hs-identifier hs-var">z1</span></a></span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237514"><span class="hs-identifier hs-var">z0</span></a></span><span>
</span><span id="line-459"></span><span>        </span><span id="local-6989586621679237501"><span class="annot"><span class="annottext">bounded :: Bool
</span><a href="#local-6989586621679237501"><span class="hs-identifier hs-var hs-var">bounded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-460"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>        </span><span id="local-6989586621679237496"><span class="annot"><span class="annottext">rr' :: Double
</span><a href="#local-6989586621679237496"><span class="hs-identifier hs-var hs-var">rr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Tension Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#velocity"><span class="hs-identifier hs-var">velocity</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237494"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237493"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237510"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-462"></span><span>        </span><span id="local-6989586621679237492"><span class="annot"><span class="annottext">ss' :: Double
</span><a href="#local-6989586621679237492"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double -&gt; Tension Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#velocity"><span class="hs-identifier hs-var">velocity</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237493"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237494"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237509"><span class="hs-identifier hs-var">beta</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621679237491"><span class="annot"><span class="annottext">stf :: Double
</span><a href="#local-6989586621679237491"><span class="hs-identifier hs-var hs-var">stf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237493"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237494"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="hs-comment">-- sin (theta + phi)</span><span>
</span><span id="line-464"></span><span>        </span><span id="local-6989586621679237498"><span class="annot"><span class="annottext">st :: Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237512"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679237500"><span class="annot"><span class="annottext">sf :: Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var hs-var">sf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237511"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621679237494"><span class="annot"><span class="annottext">ct :: Double
</span><a href="#local-6989586621679237494"><span class="hs-identifier hs-var hs-var">ct</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237512"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-467"></span><span>        </span><span id="local-6989586621679237493"><span class="annot"><span class="annottext">cf :: Double
</span><a href="#local-6989586621679237493"><span class="hs-identifier hs-var hs-var">cf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237511"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-468"></span><span>        </span><span id="local-6989586621679237488"><span class="annot"><span class="annottext">rr :: Double
</span><a href="#local-6989586621679237488"><span class="hs-identifier hs-var hs-var">rr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237510"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-469"></span><span>          </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#TensionAtLeast"><span class="hs-identifier hs-type">TensionAtLeast</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679237501"><span class="hs-identifier hs-var">bounded</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-470"></span><span>            </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237496"><span class="hs-identifier hs-var">rr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237491"><span class="hs-identifier hs-var">stf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>          </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237496"><span class="hs-identifier hs-var">rr'</span></a></span><span>
</span><span id="line-472"></span><span>        </span><span id="local-6989586621679237486"><span class="annot"><span class="annottext">ss :: Double
</span><a href="#local-6989586621679237486"><span class="hs-identifier hs-var hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237509"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-473"></span><span>          </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#TensionAtLeast"><span class="hs-identifier hs-type">TensionAtLeast</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679237501"><span class="hs-identifier hs-var">bounded</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-474"></span><span>            </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237492"><span class="hs-identifier hs-var">ss'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237491"><span class="hs-identifier hs-var">stf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>          </span><span class="annot"><span class="annottext">Tension Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237492"><span class="hs-identifier hs-var">ss'</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span class="hs-comment">-- u = z0 + rr * (rotate theta chord)</span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621679237505"><span class="annot"><span class="annottext">u :: Point Double
</span><a href="#local-6989586621679237505"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237514"><span class="hs-identifier hs-var">z0</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679237488"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237503"><span class="hs-identifier hs-var">dx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237494"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237502"><span class="hs-identifier hs-var">dy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237502"><span class="hs-identifier hs-var">dy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237494"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237503"><span class="hs-identifier hs-var">dx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237498"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>        </span><span class="hs-comment">-- v = z1 - ss * (rotate (-phi) chord)</span><span>
</span><span id="line-479"></span><span>        </span><span id="local-6989586621679237504"><span class="annot"><span class="annottext">v :: Point Double
</span><a href="#local-6989586621679237504"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point Double
</span><a href="#local-6989586621679237513"><span class="hs-identifier hs-var">z1</span></a></span><span> </span><span class="annot"><span class="annottext">Point Double -&gt; Point Double -&gt; Point Double
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Double
Scalar (Point Double)
</span><a href="#local-6989586621679237486"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Scalar (Point Double) -&gt; Point Double -&gt; Point Double
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Point Double
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237503"><span class="hs-identifier hs-var">dx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237493"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237502"><span class="hs-identifier hs-var">dy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237502"><span class="hs-identifier hs-var">dy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237493"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237503"><span class="hs-identifier hs-var">dx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237500"><span class="hs-identifier hs-var">sf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#constant1"><span class="hs-identifier hs-type">constant1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#constant2"><span class="hs-identifier hs-type">constant2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#sqrt2"><span class="hs-identifier hs-type">sqrt2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-482"></span><span id="constant1"><span class="annot"><span class="annottext">constant1 :: Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#constant1"><span class="hs-identifier hs-var hs-var">constant1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-483"></span><span id="constant2"><span class="annot"><span class="annottext">constant2 :: Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#constant2"><span class="hs-identifier hs-var hs-var">constant2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-484"></span><span id="sqrt2"><span class="annot"><span class="annottext">sqrt2 :: Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#sqrt2"><span class="hs-identifier hs-var hs-var">sqrt2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- another magic formula by John Hobby.</span><span>
</span><span id="line-487"></span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#velocity"><span class="hs-identifier hs-type">velocity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-488"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.MetaPath.html#Tension"><span class="hs-identifier hs-type">Tension</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-489"></span><span id="velocity"><span class="annot"><span class="annottext">velocity :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; Tension Double -&gt; Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#velocity"><span class="hs-identifier hs-var hs-var">velocity</span></a></span></span><span> </span><span id="local-6989586621679237479"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237479"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679237478"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237478"><span class="hs-identifier hs-var">sf</span></a></span></span><span> </span><span id="local-6989586621679237477"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237477"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span id="local-6989586621679237476"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237476"><span class="hs-identifier hs-var">cf</span></a></span></span><span> </span><span id="local-6989586621679237475"><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237475"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237479"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237478"><span class="hs-identifier hs-var">sf</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237478"><span class="hs-identifier hs-var">sf</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237479"><span class="hs-identifier hs-var">st</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237477"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237476"><span class="hs-identifier hs-var">cf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#constant1"><span class="hs-identifier hs-var">constant1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237477"><span class="hs-identifier hs-var">ct</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Geom2D.CubicBezier.MetaPath.html#constant2"><span class="hs-identifier hs-var">constant2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679237476"><span class="hs-identifier hs-var">cf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Tension Double -&gt; Double
forall a. Tension a -&gt; a
</span><a href="Geom2D.CubicBezier.MetaPath.html#tensionValue"><span class="hs-identifier hs-var hs-var">tensionValue</span></a></span><span> </span><span class="annot"><span class="annottext">Tension Double
</span><a href="#local-6989586621679237475"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span></pre></body></html>