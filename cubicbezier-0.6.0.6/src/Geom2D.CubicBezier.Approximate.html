<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, MultiWayIf #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geom2D.CubicBezier.Approximate</span><span>
</span><span id="line-3"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-identifier">approximatePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPath"><span class="hs-identifier">approximateQuadPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePathMax"><span class="hs-identifier">approximatePathMax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPathMax"><span class="hs-identifier">approximateQuadPathMax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>        </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic"><span class="hs-identifier">approximateCubic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.html"><span class="hs-identifier">Geom2D</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html"><span class="hs-identifier">Geom2D.CubicBezier.Basic</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Numeric.html"><span class="hs-identifier">Geom2D.CubicBezier.Numeric</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span id="local-6989586621679240232"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-type">interpolate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679240232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240232"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-16"></span><span id="interpolate"><span class="annot"><span class="annottext">interpolate :: a -&gt; a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-var hs-var">interpolate</span></a></span></span><span> </span><span id="local-6989586621679240091"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240091"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679240090"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240090"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679240089"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240089"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240089"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240091"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240089"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240090"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- | Approximate a function with piecewise cubic bezier splines using</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- a least-squares fit, within the given tolerance.  Each subcurve is</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- approximated by using a finite number of samples.  It is recommended</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- to avoid changes in direction by subdividing the original function</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- at points of inflection.</span><span>
</span><span id="line-23"></span><span id="local-6989586621679240086"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-identifier hs-type">approximatePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-24"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The function to approximate and it's derivative</span><span>
</span><span id="line-25"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-26"></span><span>                   </span><span class="hs-comment">-- ^ The number of discrete samples taken to</span><span>
</span><span id="line-27"></span><span>                   </span><span class="hs-comment">-- approximate each subcurve.  More samples are</span><span>
</span><span id="line-28"></span><span>                   </span><span class="hs-comment">-- more precise but take more time to calculate.</span><span>
</span><span id="line-29"></span><span>                   </span><span class="hs-comment">-- For good precision 16 is a good candidate.</span><span>
</span><span id="line-30"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The tolerance</span><span>
</span><span id="line-31"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The lower parameter of the function      </span><span>
</span><span id="line-32"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The upper parameter of the function</span><span>
</span><span id="line-33"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-34"></span><span>                </span><span class="hs-comment">-- ^ Calculate the result faster, but with more</span><span>
</span><span id="line-35"></span><span>                </span><span class="hs-comment">-- subcurves.  Runs typically 10 times faster, but</span><span>
</span><span id="line-36"></span><span>                </span><span class="hs-comment">-- generates 50% more subcurves.   Useful for interactive use.</span><span>
</span><span id="line-37"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240086"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-38"></span><span id="approximatePath"><span class="annot"><span class="annottext">approximatePath :: (a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-identifier hs-var hs-var">approximatePath</span></a></span></span><span> </span><span id="local-6989586621679240085"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240085"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240084"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240084"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679240083"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240083"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240082"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240082"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679240081"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240081"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679240080"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240080"><span class="hs-identifier hs-var">fast</span></a></span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240079"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240083"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679240077"><span class="hs-identifier hs-var">curve</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath%27"><span class="hs-identifier hs-var">approximatePath'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240084"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240083"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240082"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240081"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240080"><span class="hs-identifier hs-var">fast</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679240077"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679240077"><span class="hs-identifier hs-var">curve</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240079"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240079"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1cubic"><span class="hs-identifier hs-var">approx1cubic</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240084"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240085"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240082"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240081"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240080"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePath"><span class="hs-pragma hs-type">approximatePath</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span>
</span><span id="line-44"></span><span>                               </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Approximate a function with piecewise quadratic bezier splines</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- using a least-squares fit, within the given tolerance.  It is</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- recommended to avoid changes in direction by subdividing the</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- original function at points of inflection.</span><span>
</span><span id="line-50"></span><span id="local-6989586621679240073"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPath"><span class="hs-identifier hs-type">approximateQuadPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-51"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The function to approximate and it's derivative</span><span>
</span><span id="line-52"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The tolerance</span><span>
</span><span id="line-53"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The lower parameter of the function      </span><span>
</span><span id="line-54"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The upper parameter of the function</span><span>
</span><span id="line-55"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                      </span><span>
</span><span id="line-56"></span><span>                </span><span class="hs-comment">-- ^ Calculate the result faster, but with more</span><span>
</span><span id="line-57"></span><span>                </span><span class="hs-comment">-- subcurves.</span><span>
</span><span id="line-58"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240073"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-59"></span><span id="approximateQuadPath"><span class="annot"><span class="annottext">approximateQuadPath :: (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPath"><span class="hs-identifier hs-var hs-var">approximateQuadPath</span></a></span></span><span> </span><span id="local-6989586621679240072"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240072"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240071"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240071"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679240070"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240070"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679240069"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240069"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679240068"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240068"><span class="hs-identifier hs-var">fast</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240067"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240071"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240066"><span class="hs-identifier hs-var">curve</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateQuad%27"><span class="hs-identifier hs-var">approximateQuad'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240072"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240071"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240070"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240069"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240068"><span class="hs-identifier hs-var">fast</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679240066"><span class="annot"><span class="annottext">curve :: QuadBezier a
</span><a href="#local-6989586621679240066"><span class="hs-identifier hs-var hs-var">curve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
forall a.
(Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1quad"><span class="hs-identifier hs-var">approx1quad</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240072"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240070"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240069"><span class="hs-identifier hs-var">tmax</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679240067"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679240067"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#maxDist"><span class="hs-identifier hs-var">maxDist</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240072"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240066"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240070"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240069"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679240068"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPath"><span class="hs-pragma hs-type">approximateQuadPath</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#DPoint"><span class="hs-pragma hs-type">DPoint</span></a></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-67"></span><span>      </span><span>
</span><span id="line-68"></span><span class="hs-comment">-- find the distance between the function at t and the quadratic bezier.</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- calculate the value and derivative at t, and improve the closeness of t.</span><span>
</span><span id="line-70"></span><span id="local-6989586621679240220"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#quadDist"><span class="hs-identifier hs-type">quadDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-71"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-72"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240220"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-73"></span><span id="quadDist"><span class="annot"><span class="annottext">quadDist :: (a -&gt; (Point a, Point a))
-&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#quadDist"><span class="hs-identifier hs-var hs-var">quadDist</span></a></span></span><span> </span><span id="local-6989586621679240061"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240061"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240060"><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240060"><span class="hs-identifier hs-var">qb</span></a></span></span><span> </span><span id="local-6989586621679240059"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240059"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679240058"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240058"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679240057"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240057"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span id="local-6989586621679240056"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240056"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; QuadBezier a
-&gt; a
-&gt; a
-&gt; a
-&gt; Point a
-&gt; Int
-&gt; (Point a, Point a)
-&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; QuadBezier a
-&gt; a
-&gt; a
-&gt; a
-&gt; Point a
-&gt; Int
-&gt; (Point a, Point a)
-&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#quadDist%27"><span class="hs-identifier hs-var">quadDist'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240061"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240060"><span class="hs-identifier hs-var">qb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240059"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240058"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240056"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point a, Point a) -&gt; Point a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240061"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; (Point a, Point a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-var">interpolate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240059"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240058"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240056"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240057"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QuadBezier a -&gt; a -&gt; (Point a, Point a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240060"><span class="hs-identifier hs-var">qb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240056"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="local-6989586621679240238"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#quadDist%27"><span class="hs-identifier hs-type">quadDist'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-77"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240238"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-79"></span><span id="quadDist%27"><span class="annot"><span class="annottext">quadDist' :: (a -&gt; (Point a, Point a))
-&gt; QuadBezier a
-&gt; a
-&gt; a
-&gt; a
-&gt; Point a
-&gt; Int
-&gt; (Point a, Point a)
-&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#quadDist%27"><span class="hs-identifier hs-var hs-var">quadDist'</span></a></span></span><span> </span><span id="local-6989586621679240053"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240053"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240052"><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240052"><span class="hs-identifier hs-var">qb</span></a></span></span><span> </span><span id="local-6989586621679240051"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240051"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679240050"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240050"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679240049"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240049"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679240048"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240048"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679240047"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240047"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240046"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240046"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240045"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240045"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240047"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240041"><span class="hs-identifier hs-var">err2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240040"><span class="hs-identifier hs-var">err1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240040"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240041"><span class="hs-identifier hs-var">err2</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; QuadBezier a
-&gt; a
-&gt; a
-&gt; a
-&gt; Point a
-&gt; Int
-&gt; (Point a, Point a)
-&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; QuadBezier a
-&gt; a
-&gt; a
-&gt; a
-&gt; Point a
-&gt; Int
-&gt; (Point a, Point a)
-&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#quadDist%27"><span class="hs-identifier hs-var">quadDist'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240053"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240052"><span class="hs-identifier hs-var">qb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240051"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240050"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240049"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240038"><span class="hs-identifier hs-var">ndist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240048"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240047"><span class="hs-identifier hs-var">maxiter</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240037"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240036"><span class="hs-identifier hs-var">b2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679240035"><span class="annot"><span class="annottext">dp :: Point a
</span><a href="#local-6989586621679240035"><span class="hs-identifier hs-var hs-var">dp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240048"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240046"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span id="local-6989586621679240040"><span class="annot"><span class="annottext">err1 :: a
</span><a href="#local-6989586621679240040"><span class="hs-identifier hs-var hs-var">err1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorMag"><span class="hs-identifier hs-var">vectorMag</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240035"><span class="hs-identifier hs-var">dp</span></a></span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-comment">-- distance from p to the normal at b(t) / velocity at t</span><span>
</span><span id="line-85"></span><span>        </span><span id="local-6989586621679240038"><span class="annot"><span class="annottext">ndist :: a
</span><a href="#local-6989586621679240038"><span class="hs-identifier hs-var hs-var">ndist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240035"><span class="hs-identifier hs-var">dp</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#%5E.%5E"><span class="hs-operator hs-var">^.^</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240045"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240045"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#%5E.%5E"><span class="hs-operator hs-var">^.^</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240045"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679240037"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240037"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240036"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240036"><span class="hs-identifier hs-var">b2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuadBezier a -&gt; a -&gt; (Point a, Point a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240052"><span class="hs-identifier hs-var">qb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240049"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240038"><span class="hs-identifier hs-var">ndist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>        </span><span id="local-6989586621679240041"><span class="annot"><span class="annottext">err2 :: a
</span><a href="#local-6989586621679240041"><span class="hs-identifier hs-var hs-var">err2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240048"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240037"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span>
</span><span id="line-89"></span><span class="hs-comment">-- find maximum distance using golden section search</span><span>
</span><span id="line-90"></span><span id="local-6989586621679240240"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#maxDist"><span class="hs-identifier hs-type">maxDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-91"></span><span>           </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>           </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240240"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-93"></span><span id="maxDist"><span class="annot"><span class="annottext">maxDist :: (a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#maxDist"><span class="hs-identifier hs-var hs-var">maxDist</span></a></span></span><span> </span><span id="local-6989586621679240030"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240030"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240029"><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240029"><span class="hs-identifier hs-var">qb</span></a></span></span><span> </span><span id="local-6989586621679240028"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240028"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679240027"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240027"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679240026"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240026"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a -&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#quadDist"><span class="hs-identifier hs-var">quadDist</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240030"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240029"><span class="hs-identifier hs-var">qb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240028"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240027"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240026"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Int -&gt; a
forall a. (Ord a, Floating a) =&gt; (a -&gt; a) -&gt; Int -&gt; a
</span><a href="Geom2D.CubicBezier.Numeric.html#goldSearch"><span class="hs-identifier hs-var">goldSearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a -&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#quadDist"><span class="hs-identifier hs-var">quadDist</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240030"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679240029"><span class="hs-identifier hs-var">qb</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240028"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240027"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679240026"><span class="hs-identifier hs-var">maxiter</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span id="local-6989586621679240203"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approxquad"><span class="hs-identifier hs-type">approxquad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-98"></span><span>              </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240203"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-99"></span><span id="approxquad"><span class="annot"><span class="annottext">approxquad :: Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approxquad"><span class="hs-identifier hs-var hs-var">approxquad</span></a></span></span><span> </span><span id="local-6989586621679240023"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240023"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span id="local-6989586621679240022"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240022"><span class="hs-identifier hs-var">p0'</span></a></span></span><span> </span><span id="local-6989586621679240021"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240021"><span class="hs-identifier hs-var">p1'</span></a></span></span><span> </span><span id="local-6989586621679240020"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240020"><span class="hs-identifier hs-var">p1</span></a></span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240018"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240018"><span class="hs-identifier hs-var">q'</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1e-3</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240023"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#interpolateVector"><span class="hs-identifier hs-var">interpolateVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240023"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240020"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240020"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-var">QuadBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240023"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240020"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240021"><span class="hs-identifier hs-var">p1'</span></a></span><span class="annot"><span class="annottext">Point a -&gt; a -&gt; Point a
forall v s. (VectorSpace v, s ~ Scalar v) =&gt; v -&gt; s -&gt; v
</span><span class="hs-operator hs-var">^*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240012"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240020"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679240011"><span class="annot"><span class="annottext">q :: Point a
</span><a href="#local-6989586621679240011"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Transform a
forall a. Floating a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateVec"><span class="hs-identifier hs-var">rotateVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#flipVector"><span class="hs-identifier hs-var">flipVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240022"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240020"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240023"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679240018"><span class="annot"><span class="annottext">q' :: Point a
</span><a href="#local-6989586621679240018"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Transform a
forall a. Floating a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateVec"><span class="hs-identifier hs-var">rotateVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#flipVector"><span class="hs-identifier hs-var">flipVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240022"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240021"><span class="hs-identifier hs-var">p1'</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679240012"><span class="annot"><span class="annottext">t :: a
</span><a href="#local-6989586621679240012"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240011"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240018"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679240241"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approx1quad"><span class="hs-identifier hs-type">approx1quad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-109"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240241"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-110"></span><span id="approx1quad"><span class="annot"><span class="annottext">approx1quad :: (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1quad"><span class="hs-identifier hs-var hs-var">approx1quad</span></a></span></span><span> </span><span id="local-6989586621679240007"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240007"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679240006"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240006"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679240005"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240005"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a.
(Ord a, Floating a) =&gt;
Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approxquad"><span class="hs-identifier hs-var">approxquad</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240004"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240003"><span class="hs-identifier hs-var">p0'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240002"><span class="hs-identifier hs-var">p1'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240001"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679240004"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240004"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240003"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240003"><span class="hs-identifier hs-var">p0'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240007"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240006"><span class="hs-identifier hs-var">tmin</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679240001"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240001"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679240002"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679240002"><span class="hs-identifier hs-var">p1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679240007"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679240005"><span class="hs-identifier hs-var">tmax</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621679240197"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#splitQuad"><span class="hs-identifier hs-type">splitQuad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-116"></span><span>                </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240197"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-118"></span><span id="splitQuad"><span class="annot"><span class="annottext">splitQuad :: a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitQuad"><span class="hs-identifier hs-var hs-var">splitQuad</span></a></span></span><span> </span><span id="local-6989586621679239999"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239999"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679239998"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239998"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span id="local-6989586621679239997"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239997"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239996"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239996"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239995"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239995"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239994"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239994"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitQuad%27"><span class="hs-identifier hs-var">splitQuad'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239999"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239998"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239997"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239996"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239995"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239994"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239994"><span class="hs-identifier hs-var">maxiter</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span>
</span><span id="line-121"></span><span id="local-6989586621679240201"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#splitQuad%27"><span class="hs-identifier hs-type">splitQuad'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-122"></span><span>                </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-124"></span><span id="splitQuad%27"><span class="annot"><span class="annottext">splitQuad' :: a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitQuad%27"><span class="hs-identifier hs-var hs-var">splitQuad'</span></a></span></span><span> </span><span id="local-6989586621679239992"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239992"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679239991"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239991"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span id="local-6989586621679239990"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239990"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239989"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239989"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239988"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239988"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239987"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span id="local-6989586621679239986"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239986"><span class="hs-identifier hs-var">maxiter2</span></a></span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239987"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239985"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239984"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239985"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239984"><span class="hs-identifier hs-var">err1</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239981"><span class="hs-identifier hs-var">tmid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239985"><span class="hs-identifier hs-var">err0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239980"><span class="hs-identifier hs-var">curve0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239984"><span class="hs-identifier hs-var">err1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239979"><span class="hs-identifier hs-var">curve1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitQuad%27"><span class="hs-identifier hs-var">splitQuad'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239985"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239984"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239992"><span class="hs-identifier hs-var">node</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239991"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239992"><span class="hs-identifier hs-var">node</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239991"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239991"><span class="hs-identifier hs-var">offset</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239990"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239989"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239988"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239987"><span class="hs-identifier hs-var">maxiter</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239986"><span class="hs-identifier hs-var">maxiter2</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679239981"><span class="annot"><span class="annottext">tmid :: a
</span><a href="#local-6989586621679239981"><span class="hs-identifier hs-var hs-var">tmid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-var">interpolate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239989"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239988"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239992"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621679239980"><span class="annot"><span class="annottext">curve0 :: QuadBezier a
</span><a href="#local-6989586621679239980"><span class="hs-identifier hs-var hs-var">curve0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
forall a.
(Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1quad"><span class="hs-identifier hs-var">approx1quad</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239990"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239989"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239981"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679239985"><span class="annot"><span class="annottext">err0 :: a
</span><a href="#local-6989586621679239985"><span class="hs-identifier hs-var hs-var">err0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#maxDist"><span class="hs-identifier hs-var">maxDist</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239990"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239980"><span class="hs-identifier hs-var">curve0</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239989"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239981"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239986"><span class="hs-identifier hs-var">maxiter2</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679239979"><span class="annot"><span class="annottext">curve1 :: QuadBezier a
</span><a href="#local-6989586621679239979"><span class="hs-identifier hs-var hs-var">curve1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
forall a.
(Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1quad"><span class="hs-identifier hs-var">approx1quad</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239990"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239981"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239988"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679239984"><span class="annot"><span class="annottext">err1 :: a
</span><a href="#local-6989586621679239984"><span class="hs-identifier hs-var hs-var">err1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#maxDist"><span class="hs-identifier hs-var">maxDist</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239990"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239979"><span class="hs-identifier hs-var">curve1</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239981"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239988"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239986"><span class="hs-identifier hs-var">maxiter2</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679240242"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuad%27"><span class="hs-identifier hs-type">approximateQuad'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-138"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span>
</span><span id="line-139"></span><span>                    </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>                    </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-141"></span><span id="approximateQuad%27"><span class="annot"><span class="annottext">approximateQuad' :: (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateQuad%27"><span class="hs-identifier hs-var hs-var">approximateQuad'</span></a></span></span><span> </span><span id="local-6989586621679239978"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239978"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239977"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239977"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679239976"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239976"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239975"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239975"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239974"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239974"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239973"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239977"><span class="hs-identifier hs-var">tol</span></a></span><span>
</span><span id="line-143"></span><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239972"><span class="hs-identifier hs-var">curve0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateQuad%27"><span class="hs-identifier hs-var">approximateQuad'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239978"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239977"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239976"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239971"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239974"><span class="hs-identifier hs-var">fast</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QuadBezier a] -&gt; [QuadBezier a] -&gt; [QuadBezier a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239970"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239977"><span class="hs-identifier hs-var">tol</span></a></span><span>
</span><span id="line-146"></span><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239969"><span class="hs-identifier hs-var">curve1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [QuadBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateQuad%27"><span class="hs-identifier hs-var">approximateQuad'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239978"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239977"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239971"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239975"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239974"><span class="hs-identifier hs-var">fast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679239971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239971"><span class="hs-identifier hs-var">tmid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239973"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239973"><span class="hs-identifier hs-var">err0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239972"><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239972"><span class="hs-identifier hs-var">curve0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239970"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239970"><span class="hs-identifier hs-var">err1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239969"><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239969"><span class="hs-identifier hs-var">curve1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>     </span><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitQuad"><span class="hs-identifier hs-var">splitQuad</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.25</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239978"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239976"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239975"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239974"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621679240247"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePath%27"><span class="hs-identifier hs-type">approximatePath'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-153"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>                    </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>                    </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240247"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-156"></span><span id="approximatePath%27"><span class="annot"><span class="annottext">approximatePath' :: (a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath%27"><span class="hs-identifier hs-var hs-var">approximatePath'</span></a></span></span><span> </span><span id="local-6989586621679239968"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239968"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239967"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239967"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679239966"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239966"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679239965"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239965"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239964"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239964"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239963"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239963"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239962"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239966"><span class="hs-identifier hs-var">tol</span></a></span><span>
</span><span id="line-158"></span><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239961"><span class="hs-identifier hs-var">curve0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath%27"><span class="hs-identifier hs-var">approximatePath'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239968"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239966"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239965"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239960"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239963"><span class="hs-identifier hs-var">fast</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CubicBezier a] -&gt; [CubicBezier a] -&gt; [CubicBezier a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239959"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239966"><span class="hs-identifier hs-var">tol</span></a></span><span>
</span><span id="line-161"></span><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239958"><span class="hs-identifier hs-var">curve1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; Int -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePath%27"><span class="hs-identifier hs-var">approximatePath'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239968"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239966"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239960"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239964"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239963"><span class="hs-identifier hs-var">fast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679239960"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239960"><span class="hs-identifier hs-var">tmid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239962"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239962"><span class="hs-identifier hs-var">err0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239961"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239961"><span class="hs-identifier hs-var">curve0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239959"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239959"><span class="hs-identifier hs-var">err1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239958"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239958"><span class="hs-identifier hs-var">curve1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitCubic"><span class="hs-identifier hs-var">splitCubic</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.25</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239968"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239965"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239964"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239963"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span class="hs-comment">--{-# SPECIALIZE approximatePath' :: (Double -&gt; (Point Double, Point Double)) -&gt; Int -&gt; Double -&gt; Double -&gt; Double -&gt; [CubicBezier Double]  #-}      </span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Like approximatePath, but limit the number of subcurves.</span><span>
</span><span id="line-169"></span><span id="local-6989586621679239956"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePathMax"><span class="hs-identifier hs-type">approximatePathMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-170"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                        </span><span class="hs-comment">-- ^ The maximum number of subcurves</span><span>
</span><span id="line-171"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ The function to approximate and it's derivative</span><span>
</span><span id="line-172"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-173"></span><span>                   </span><span class="hs-comment">-- ^ The number of discrete samples taken to</span><span>
</span><span id="line-174"></span><span>                   </span><span class="hs-comment">-- approximate each subcurve.  More samples are</span><span>
</span><span id="line-175"></span><span>                   </span><span class="hs-comment">-- more precise but take more time to calculate.</span><span>
</span><span id="line-176"></span><span>                   </span><span class="hs-comment">-- For good precision 16 is a good candidate.</span><span>
</span><span id="line-177"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span>                          </span><span class="hs-comment">-- ^ The tolerance</span><span>
</span><span id="line-178"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span>                          </span><span class="hs-comment">-- ^ The lower parameter of the function      </span><span>
</span><span id="line-179"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span>                          </span><span class="hs-comment">-- ^ The upper parameter of the function</span><span>
</span><span id="line-180"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-181"></span><span>                   </span><span class="hs-comment">-- ^ Calculate the result faster, but with more</span><span>
</span><span id="line-182"></span><span>                   </span><span class="hs-comment">-- subcurves.  Runs faster (typically 10 times),</span><span>
</span><span id="line-183"></span><span>                   </span><span class="hs-comment">-- but generates more subcurves (about 50%).</span><span>
</span><span id="line-184"></span><span>                   </span><span class="hs-comment">-- Useful for interactive use.</span><span>
</span><span id="line-185"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679239956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-186"></span><span id="approximatePathMax"><span class="annot"><span class="annottext">approximatePathMax :: Int
-&gt; (a -&gt; (Point a, Point a))
-&gt; Int
-&gt; a
-&gt; a
-&gt; a
-&gt; Bool
-&gt; [CubicBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximatePathMax"><span class="hs-identifier hs-var hs-var">approximatePathMax</span></a></span></span><span> </span><span id="local-6989586621679239955"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239955"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679239954"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239954"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239953"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239953"><span class="hs-identifier hs-var">samples</span></a></span></span><span> </span><span id="local-6989586621679239952"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239952"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679239951"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239951"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239950"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239950"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239949"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239949"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, CubicBezier a, a, CubicBezier a))
-&gt; Map a (FunctionSegment (CubicBezier a) a)
-&gt; [CubicBezier a]
forall a b.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, b, a, b))
-&gt; Map a (FunctionSegment b a)
-&gt; [b]
</span><a href="Geom2D.CubicBezier.Approximate.html#approxMax"><span class="hs-identifier hs-var">approxMax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239954"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239952"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239955"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239949"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitCubic"><span class="hs-identifier hs-var">splitCubic</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239953"><span class="hs-identifier hs-var">samples</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map a (FunctionSegment (CubicBezier a) a)
</span><a href="#local-6989586621679239947"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679239947"><span class="annot"><span class="annottext">segments :: Map a (FunctionSegment (CubicBezier a) a)
</span><a href="#local-6989586621679239947"><span class="hs-identifier hs-var hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
-&gt; FunctionSegment (CubicBezier a) a
-&gt; Map a (FunctionSegment (CubicBezier a) a)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239945"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; CubicBezier a -&gt; FunctionSegment (CubicBezier a) a
forall b a. a -&gt; a -&gt; b -&gt; FunctionSegment b a
</span><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-var">FunctionSegment</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239951"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239950"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239943"><span class="hs-identifier hs-var">outline</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679239942"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239942"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239941"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239941"><span class="hs-identifier hs-var">p0'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239954"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239951"><span class="hs-identifier hs-var">tmin</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679239940"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239940"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239939"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239939"><span class="hs-identifier hs-var">p1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239954"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239950"><span class="hs-identifier hs-var">tmax</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span id="local-6989586621679239938"><span class="annot"><span class="annottext">ts :: Vector a
</span><a href="#local-6989586621679239938"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; Vector Int -&gt; Vector a
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239936"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239936"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239936"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239953"><span class="hs-identifier hs-var">samples</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`asTypeOf`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239951"><span class="hs-identifier hs-var">tmin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector Int -&gt; Vector a) -&gt; Vector Int -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-192"></span><span>             </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector Int
forall a. (Unbox a, Num a) =&gt; a -&gt; Int -&gt; Vector a
</span><span class="hs-identifier hs-var">V.enumFromN</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239953"><span class="hs-identifier hs-var">samples</span></a></span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679239933"><span class="annot"><span class="annottext">points :: Vector (Point a)
</span><a href="#local-6989586621679239933"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Point a) -&gt; Vector a -&gt; Vector (Point a)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point a, Point a) -&gt; Point a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point a, Point a) -&gt; Point a)
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; Point a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239954"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; (a -&gt; a) -&gt; a -&gt; (Point a, Point a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-var">interpolate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239951"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239950"><span class="hs-identifier hs-var">tmax</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239938"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621679239931"><span class="annot"><span class="annottext">curveCb :: CubicBezier a
</span><a href="#local-6989586621679239931"><span class="hs-identifier hs-var hs-var">curveCb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239942"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239942"><span class="hs-identifier hs-var">p0</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239941"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239940"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239939"><span class="hs-identifier hs-var">p1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239940"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679239943"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239943"><span class="hs-identifier hs-var">outline</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239945"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239945"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>          </span><span class="annot"><span class="annottext">CubicBezier a
-&gt; Vector (Point a)
-&gt; Maybe (Vector a)
-&gt; Int
-&gt; (CubicBezier a, a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
CubicBezier a
-&gt; Vector (Point a)
-&gt; Maybe (Vector a)
-&gt; Int
-&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic"><span class="hs-identifier hs-var">approximateCubic</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239931"><span class="hs-identifier hs-var">curveCb</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239933"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Maybe (Vector a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239938"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239949"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximatePathMax"><span class="hs-pragma hs-type">approximatePathMax</span></a></span><span> </span><span class="hs-pragma">::</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span>                      </span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-200"></span><span class="hs-keyword">data</span><span> </span><span id="FunctionSegment"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-var">FunctionSegment</span></a></span></span><span> </span><span id="local-6989586621679240186"><span class="annot"><a href="#local-6989586621679240186"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679240187"><span class="annot"><a href="#local-6989586621679240187"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FunctionSegment"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-var">FunctionSegment</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-201"></span><span>  </span><span id="fsTmin"><span class="annot"><span class="annottext">FunctionSegment b a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#fsTmin"><span class="hs-identifier hs-var hs-var">fsTmin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679240187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- the least t param of the segment in the original curve</span><span>
</span><span id="line-202"></span><span>  </span><span id="_fsTmax"><span class="annot"><span class="annottext">FunctionSegment b a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#_fsTmax"><span class="hs-identifier hs-var hs-var">_fsTmax</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679240187"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- the max t param of the segment in the original curve</span><span>
</span><span id="line-203"></span><span>  </span><span id="fsCurve"><span class="annot"><span class="annottext">FunctionSegment b a -&gt; b
</span><a href="Geom2D.CubicBezier.Approximate.html#fsCurve"><span class="hs-identifier hs-var hs-var">fsCurve</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679240186"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-comment">-- the curve segment</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Like approximateQuadPath, but limit the number of subcurves.</span><span>
</span><span id="line-207"></span><span id="local-6989586621679239926"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPathMax"><span class="hs-identifier hs-type">approximateQuadPathMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-208"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                        </span><span class="hs-comment">-- ^ The maximum number of subcurves</span><span>
</span><span id="line-209"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ The function to approximate and it's derivative</span><span>
</span><span id="line-210"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span>                          </span><span class="hs-comment">-- ^ The tolerance</span><span>
</span><span id="line-211"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span>                          </span><span class="hs-comment">-- ^ The lower parameter of the function      </span><span>
</span><span id="line-212"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span>                          </span><span class="hs-comment">-- ^ The upper parameter of the function</span><span>
</span><span id="line-213"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-214"></span><span>                   </span><span class="hs-comment">-- ^ Calculate the result faster, but with more</span><span>
</span><span id="line-215"></span><span>                   </span><span class="hs-comment">-- subcurves.  Runs faster, but generates more</span><span>
</span><span id="line-216"></span><span>                   </span><span class="hs-comment">-- subcurves.  Useful for interactive use.</span><span>
</span><span id="line-217"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-identifier hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679239926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-218"></span><span id="approximateQuadPathMax"><span class="annot"><span class="annottext">approximateQuadPathMax :: Int
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; a
-&gt; Bool
-&gt; [QuadBezier a]
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPathMax"><span class="hs-identifier hs-var hs-var">approximateQuadPathMax</span></a></span></span><span> </span><span id="local-6989586621679239925"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239925"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679239924"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239924"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239923"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239923"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679239922"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239922"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239921"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239921"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239920"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239920"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, QuadBezier a, a, QuadBezier a))
-&gt; Map a (FunctionSegment (QuadBezier a) a)
-&gt; [QuadBezier a]
forall a b.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, b, a, b))
-&gt; Map a (FunctionSegment b a)
-&gt; [b]
</span><a href="Geom2D.CubicBezier.Approximate.html#approxMax"><span class="hs-identifier hs-var">approxMax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239924"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239923"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239925"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239920"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
forall a.
(Show a, Unbox a, Ord a, Floating a) =&gt;
a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, QuadBezier a, a, QuadBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitQuad"><span class="hs-identifier hs-var">splitQuad</span></a></span><span> </span><span class="annot"><span class="annottext">Map a (FunctionSegment (QuadBezier a) a)
</span><a href="#local-6989586621679239919"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679239919"><span class="annot"><span class="annottext">segments :: Map a (FunctionSegment (QuadBezier a) a)
</span><a href="#local-6989586621679239919"><span class="hs-identifier hs-var hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
-&gt; FunctionSegment (QuadBezier a) a
-&gt; Map a (FunctionSegment (QuadBezier a) a)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239918"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; QuadBezier a -&gt; FunctionSegment (QuadBezier a) a
forall b a. a -&gt; a -&gt; b -&gt; FunctionSegment b a
</span><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-var">FunctionSegment</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239922"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239921"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239917"><span class="hs-identifier hs-var">curveQd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679239916"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239916"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239915"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239915"><span class="hs-identifier hs-var">p0'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239924"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239922"><span class="hs-identifier hs-var">tmin</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679239914"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239914"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239913"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239913"><span class="hs-identifier hs-var">p1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239924"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239921"><span class="hs-identifier hs-var">tmax</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span id="local-6989586621679239917"><span class="annot"><span class="annottext">curveQd :: QuadBezier a
</span><a href="#local-6989586621679239917"><span class="hs-identifier hs-var hs-var">curveQd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
forall a.
(Ord a, Floating a) =&gt;
Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; QuadBezier a
</span><a href="Geom2D.CubicBezier.Approximate.html#approxquad"><span class="hs-identifier hs-var">approxquad</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239916"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239915"><span class="hs-identifier hs-var">p0'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239913"><span class="hs-identifier hs-var">p1'</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239914"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621679239918"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679239918"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
forall a.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a)) -&gt; QuadBezier a -&gt; a -&gt; a -&gt; Int -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#maxDist"><span class="hs-identifier hs-var">maxDist</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239924"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QuadBezier a
</span><a href="#local-6989586621679239917"><span class="hs-identifier hs-var">curveQd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239922"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239921"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239920"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateQuadPathMax"><span class="hs-pragma hs-type">approximateQuadPathMax</span></a></span><span> </span><span class="hs-pragma">::</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Bool</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#QuadBezier"><span class="hs-pragma hs-type">QuadBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- Keep a map from maxError to FunctionSegment for each subsegment to keep</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- track of the segment with the maximum error.  This ensures a n</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- log(n) execution time, rather than n^2 when a list is used.</span><span>
</span><span id="line-231"></span><span id="local-6989586621679240190"><span id="local-6989586621679240191"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approxMax"><span class="hs-identifier hs-type">approxMax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-232"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240190"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240190"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-type">FunctionSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240190"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679240190"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-236"></span><span id="approxMax"><span class="annot"><span class="annottext">approxMax :: (a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, b, a, b))
-&gt; Map a (FunctionSegment b a)
-&gt; [b]
</span><a href="Geom2D.CubicBezier.Approximate.html#approxMax"><span class="hs-identifier hs-var hs-var">approxMax</span></a></span></span><span> </span><span id="local-6989586621679239912"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239912"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239911"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239911"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679239910"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239910"><span class="hs-identifier hs-var">maxCurves</span></a></span></span><span> </span><span id="local-6989586621679239909"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239909"><span class="hs-identifier hs-var">fast</span></a></span></span><span> </span><span id="local-6989586621679239908"><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, b, a, b)
</span><a href="#local-6989586621679239908"><span class="hs-identifier hs-var">splitBez</span></a></span></span><span> </span><span id="local-6989586621679239907"><span class="annot"><span class="annottext">Map a (FunctionSegment b a)
</span><a href="#local-6989586621679239907"><span class="hs-identifier hs-var">segments</span></a></span></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239910"><span class="hs-identifier hs-var">maxCurves</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239906"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239911"><span class="hs-identifier hs-var">tol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">(FunctionSegment b a -&gt; b) -&gt; [FunctionSegment b a] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FunctionSegment b a -&gt; b
forall b a. FunctionSegment b a -&gt; b
</span><a href="Geom2D.CubicBezier.Approximate.html#fsCurve"><span class="hs-identifier hs-var hs-var">fsCurve</span></a></span><span> </span><span class="annot"><span class="annottext">([FunctionSegment b a] -&gt; [b]) -&gt; [FunctionSegment b a] -&gt; [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FunctionSegment b a -&gt; FunctionSegment b a -&gt; Ordering)
-&gt; [FunctionSegment b a] -&gt; [FunctionSegment b a]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering)
-&gt; (FunctionSegment b a -&gt; a)
-&gt; FunctionSegment b a
-&gt; FunctionSegment b a
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">FunctionSegment b a -&gt; a
forall b a. FunctionSegment b a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#fsTmin"><span class="hs-identifier hs-var hs-var">fsTmin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FunctionSegment b a] -&gt; [FunctionSegment b a])
-&gt; [FunctionSegment b a] -&gt; [FunctionSegment b a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">((a, FunctionSegment b a) -&gt; FunctionSegment b a)
-&gt; [(a, FunctionSegment b a)] -&gt; [FunctionSegment b a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, FunctionSegment b a) -&gt; FunctionSegment b a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(a, FunctionSegment b a)] -&gt; [FunctionSegment b a])
-&gt; [(a, FunctionSegment b a)] -&gt; [FunctionSegment b a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map a (FunctionSegment b a) -&gt; [(a, FunctionSegment b a)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map a (FunctionSegment b a)
</span><a href="#local-6989586621679239907"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, b, a, b))
-&gt; Map a (FunctionSegment b a)
-&gt; [b]
forall a b.
(Unbox a, Ord a, Floating a) =&gt;
(a -&gt; (Point a, Point a))
-&gt; a
-&gt; Int
-&gt; Bool
-&gt; (a
    -&gt; a
    -&gt; (a -&gt; (Point a, Point a))
    -&gt; a
    -&gt; a
    -&gt; Int
    -&gt; (a, a, b, a, b))
-&gt; Map a (FunctionSegment b a)
-&gt; [b]
</span><a href="Geom2D.CubicBezier.Approximate.html#approxMax"><span class="hs-identifier hs-var">approxMax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239912"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239911"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239910"><span class="hs-identifier hs-var">maxCurves</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239909"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, b, a, b)
</span><a href="#local-6989586621679239908"><span class="hs-identifier hs-var">splitBez</span></a></span><span> </span><span class="annot"><span class="annottext">(Map a (FunctionSegment b a) -&gt; [b])
-&gt; Map a (FunctionSegment b a) -&gt; [b]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-241"></span><span>                </span><span class="annot"><span class="annottext">a
-&gt; FunctionSegment b a
-&gt; Map a (FunctionSegment b a)
-&gt; Map a (FunctionSegment b a)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239900"><span class="hs-identifier hs-var">err_l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; b -&gt; FunctionSegment b a
forall b a. a -&gt; a -&gt; b -&gt; FunctionSegment b a
</span><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-var">FunctionSegment</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239899"><span class="hs-identifier hs-var">t_min</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239898"><span class="hs-identifier hs-var">t_mid</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239897"><span class="hs-identifier hs-var">curve_l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map a (FunctionSegment b a) -&gt; Map a (FunctionSegment b a))
-&gt; Map a (FunctionSegment b a) -&gt; Map a (FunctionSegment b a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-242"></span><span>                </span><span class="annot"><span class="annottext">a
-&gt; FunctionSegment b a
-&gt; Map a (FunctionSegment b a)
-&gt; Map a (FunctionSegment b a)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239896"><span class="hs-identifier hs-var">err_r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; b -&gt; FunctionSegment b a
forall b a. a -&gt; a -&gt; b -&gt; FunctionSegment b a
</span><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-var">FunctionSegment</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239898"><span class="hs-identifier hs-var">t_mid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239895"><span class="hs-identifier hs-var">t_max</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239894"><span class="hs-identifier hs-var">curve_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>                </span><span class="annot"><span class="annottext">Map a (FunctionSegment b a)
</span><a href="#local-6989586621679239893"><span class="hs-identifier hs-var">newSegments</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679239906"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239906"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#FunctionSegment"><span class="hs-identifier hs-type">FunctionSegment</span></a></span><span> </span><span id="local-6989586621679239899"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239899"><span class="hs-identifier hs-var">t_min</span></a></span></span><span> </span><span id="local-6989586621679239895"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239895"><span class="hs-identifier hs-var">t_max</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239893"><span class="annot"><span class="annottext">Map a (FunctionSegment b a)
</span><a href="#local-6989586621679239893"><span class="hs-identifier hs-var">newSegments</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><span class="annottext">Map a (FunctionSegment b a)
-&gt; ((a, FunctionSegment b a), Map a (FunctionSegment b a))
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><span class="hs-identifier hs-var">M.deleteFindMax</span></span><span> </span><span class="annot"><span class="annottext">Map a (FunctionSegment b a)
</span><a href="#local-6989586621679239907"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679239898"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239898"><span class="hs-identifier hs-var">t_mid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239900"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239900"><span class="hs-identifier hs-var">err_l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239897"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239897"><span class="hs-identifier hs-var">curve_l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239896"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239896"><span class="hs-identifier hs-var">err_r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239894"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239894"><span class="hs-identifier hs-var">curve_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, b, a, b)
</span><a href="#local-6989586621679239908"><span class="hs-identifier hs-var">splitBez</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.25</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239912"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239899"><span class="hs-identifier hs-var">t_min</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239895"><span class="hs-identifier hs-var">t_max</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679239909"><span class="hs-identifier hs-var">fast</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>      </span><span>
</span><span id="line-250"></span><span id="local-6989586621679240195"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#splitCubic"><span class="hs-identifier hs-type">splitCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-251"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240195"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-253"></span><span id="splitCubic"><span class="annot"><span class="annottext">splitCubic :: Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitCubic"><span class="hs-identifier hs-var hs-var">splitCubic</span></a></span></span><span> </span><span id="local-6989586621679239891"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239891"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679239890"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239890"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679239889"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239889"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span id="local-6989586621679239888"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239888"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239887"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239887"><span class="hs-identifier hs-var">tmin</span></a></span></span><span> </span><span id="local-6989586621679239886"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239886"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679239885"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239885"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239885"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239884"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239883"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239884"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239883"><span class="hs-identifier hs-var">err1</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239882"><span class="hs-identifier hs-var">tmid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239884"><span class="hs-identifier hs-var">err0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239881"><span class="hs-identifier hs-var">curve0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239883"><span class="hs-identifier hs-var">err1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239880"><span class="hs-identifier hs-var">curve1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><span class="annottext">Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
Int
-&gt; a
-&gt; a
-&gt; (a -&gt; (Point a, Point a))
-&gt; a
-&gt; a
-&gt; Int
-&gt; (a, a, CubicBezier a, a, CubicBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#splitCubic"><span class="hs-identifier hs-var">splitCubic</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239891"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239884"><span class="hs-identifier hs-var">err0</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239883"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239890"><span class="hs-identifier hs-var">node</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239889"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239890"><span class="hs-identifier hs-var">node</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239889"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239889"><span class="hs-identifier hs-var">offset</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239888"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239887"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239886"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239885"><span class="hs-identifier hs-var">maxiter</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679239882"><span class="annot"><span class="annottext">tmid :: a
</span><a href="#local-6989586621679239882"><span class="hs-identifier hs-var hs-var">tmid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-var">interpolate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239887"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239886"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239890"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679239881"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239881"><span class="hs-identifier hs-var">curve0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239884"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239884"><span class="hs-identifier hs-var">err0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1cubic"><span class="hs-identifier hs-var">approx1cubic</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239891"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239888"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239887"><span class="hs-identifier hs-var">tmin</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239882"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239885"><span class="hs-identifier hs-var">maxiter</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679239880"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239880"><span class="hs-identifier hs-var">curve1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239883"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239883"><span class="hs-identifier hs-var">err1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1cubic"><span class="hs-identifier hs-var">approx1cubic</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239891"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239888"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239882"><span class="hs-identifier hs-var">tmid</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239886"><span class="hs-identifier hs-var">tmax</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239885"><span class="hs-identifier hs-var">maxiter</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span>
</span><span id="line-264"></span><span id="local-6989586621679240245"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approx1cubic"><span class="hs-identifier hs-type">approx1cubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-265"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-267"></span><span id="approx1cubic"><span class="annot"><span class="annottext">approx1cubic :: Int
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; a -&gt; Int -&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approx1cubic"><span class="hs-identifier hs-var hs-var">approx1cubic</span></a></span></span><span> </span><span id="local-6989586621679239879"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239879"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679239878"><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239878"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679239877"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239877"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span id="local-6989586621679239876"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239876"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679239875"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239875"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">CubicBezier a
-&gt; Vector (Point a)
-&gt; Maybe (Vector a)
-&gt; Int
-&gt; (CubicBezier a, a)
forall a.
(Unbox a, Ord a, Floating a) =&gt;
CubicBezier a
-&gt; Vector (Point a)
-&gt; Maybe (Vector a)
-&gt; Int
-&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic"><span class="hs-identifier hs-var">approximateCubic</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239874"><span class="hs-identifier hs-var">curveCb</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239873"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector a -&gt; Maybe (Vector a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239872"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239875"><span class="hs-identifier hs-var">maxiter</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679239871"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239871"><span class="hs-identifier hs-var">p0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239870"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239870"><span class="hs-identifier hs-var">p0'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239878"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239877"><span class="hs-identifier hs-var">t0</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679239869"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239869"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239868"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239868"><span class="hs-identifier hs-var">p1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239878"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239876"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span id="local-6989586621679239872"><span class="annot"><span class="annottext">ts :: Vector a
</span><a href="#local-6989586621679239872"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a) -&gt; Vector Int -&gt; Vector a
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239867"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239867"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239867"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239879"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector Int
forall a. (Unbox a, Num a) =&gt; a -&gt; Int -&gt; Vector a
</span><span class="hs-identifier hs-var">V.enumFromN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239879"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>        </span><span id="local-6989586621679239873"><span class="annot"><span class="annottext">points :: Vector (Point a)
</span><a href="#local-6989586621679239873"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Point a) -&gt; Vector a -&gt; Vector (Point a)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point a, Point a) -&gt; Point a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Point a, Point a) -&gt; Point a)
-&gt; (a -&gt; (Point a, Point a)) -&gt; a -&gt; Point a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; (Point a, Point a)
</span><a href="#local-6989586621679239878"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; (a -&gt; a) -&gt; a -&gt; (Point a, Point a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="Geom2D.CubicBezier.Approximate.html#interpolate"><span class="hs-identifier hs-var">interpolate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239877"><span class="hs-identifier hs-var">t0</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239876"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239872"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span id="local-6989586621679239874"><span class="annot"><span class="annottext">curveCb :: CubicBezier a
</span><a href="#local-6989586621679239874"><span class="hs-identifier hs-var hs-var">curveCb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239871"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239871"><span class="hs-identifier hs-var">p0</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239870"><span class="hs-identifier hs-var">p0'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239869"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239868"><span class="hs-identifier hs-var">p1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239869"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-275"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approx1cubic"><span class="hs-pragma hs-type">approx1cubic</span></a></span><span> </span><span class="hs-pragma">::</span><span>  </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | @approximateCubic b pts maxiter@ finds the least squares fit of a bezier</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- curve to the points @pts@.  The resulting bezier has the same first</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- and last control point as the curve @b@, and have tangents colinear with @b@.</span><span>
</span><span id="line-280"></span><span id="local-6989586621679240174"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic"><span class="hs-identifier hs-type">approximateCubic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-281"></span><span>                    </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span>         </span><span class="hs-comment">-- ^ Curve</span><span>
</span><span id="line-282"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Points</span><span>
</span><span id="line-283"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Params.  Approximate if Nothing</span><span>
</span><span id="line-284"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                </span><span class="hs-comment">-- ^ Maximum iterations</span><span>
</span><span id="line-285"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240174"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ result curve and maximum error</span></span><span>
</span><span id="line-286"></span><span id="approximateCubic"><span class="annot"><span class="annottext">approximateCubic :: CubicBezier a
-&gt; Vector (Point a)
-&gt; Maybe (Vector a)
-&gt; Int
-&gt; (CubicBezier a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic"><span class="hs-identifier hs-var hs-var">approximateCubic</span></a></span></span><span> </span><span id="local-6989586621679239866"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239866"><span class="hs-identifier hs-var">curve</span></a></span></span><span> </span><span id="local-6989586621679239865"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239865"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679239864"><span class="annot"><span class="annottext">Maybe (Vector a)
</span><a href="#local-6989586621679239864"><span class="hs-identifier hs-var">mbTs</span></a></span></span><span> </span><span id="local-6989586621679239863"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239863"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679239862"><span class="annot"><span class="annottext">ts :: Vector a
</span><a href="#local-6989586621679239862"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Maybe (Vector a) -&gt; Vector a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Vector (Point a) -&gt; Vector a
forall a.
(Unbox a, Floating a) =&gt;
Point a -&gt; Point a -&gt; Vector (Point a) -&gt; Vector a
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateParams"><span class="hs-identifier hs-var">approximateParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC0"><span class="hs-identifier hs-var hs-var">cubicC0</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239866"><span class="hs-identifier hs-var">curve</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a -&gt; Point a
forall a. CubicBezier a -&gt; Point a
</span><a href="Geom2D.CubicBezier.Basic.html#cubicC3"><span class="hs-identifier hs-var hs-var">cubicC3</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239866"><span class="hs-identifier hs-var">curve</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239865"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Vector a)
</span><a href="#local-6989586621679239864"><span class="hs-identifier hs-var">mbTs</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span id="local-6989586621679239857"><span class="annot"><span class="annottext">curve2 :: CubicBezier a
</span><a href="#local-6989586621679239857"><span class="hs-identifier hs-var hs-var">curve2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CubicBezier a -&gt; Maybe (CubicBezier a) -&gt; CubicBezier a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239866"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (CubicBezier a) -&gt; CubicBezier a)
-&gt; Maybe (CubicBezier a) -&gt; CubicBezier a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
-&gt; Vector (Point a) -&gt; Vector a -&gt; Maybe (CubicBezier a)
forall a.
(Unbox a, Fractional a, Eq a) =&gt;
CubicBezier a
-&gt; Vector (Point a) -&gt; Vector a -&gt; Maybe (CubicBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#lsqDist"><span class="hs-identifier hs-var">lsqDist</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239866"><span class="hs-identifier hs-var">curve</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239865"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239862"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679239855"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239855"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239854"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239854"><span class="hs-identifier hs-var">bt'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Point a, Point a) -&gt; (Vector (Point a), Vector (Point a))
forall a b.
(Unbox a, Unbox b) =&gt;
Vector (a, b) -&gt; (Vector a, Vector b)
</span><span class="hs-identifier hs-var">V.unzip</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Point a, Point a) -&gt; (Vector (Point a), Vector (Point a)))
-&gt; Vector (Point a, Point a)
-&gt; (Vector (Point a), Vector (Point a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; Vector a -&gt; Vector (Point a, Point a)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a -&gt; a -&gt; (Point a, Point a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239857"><span class="hs-identifier hs-var">curve2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239862"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span id="local-6989586621679239852"><span class="annot"><span class="annottext">err :: a
</span><a href="#local-6989586621679239852"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Ord a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.maximum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; Vector a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Point a -&gt; a)
-&gt; Vector (Point a) -&gt; Vector (Point a) -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239865"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239855"><span class="hs-identifier hs-var">bt</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679239849"><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239849"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239848"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239848"><span class="hs-identifier hs-var">err2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">(CubicBezier a, Vector a, Vector a, a, Vector (Point a))
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
-&gt; (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239857"><span class="hs-identifier hs-var">curve2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239862"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239852"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
 -&gt; (CubicBezier a, Vector a, Vector a, a, Vector (Point a)))
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
-&gt; (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">CubicBezier a
-&gt; Vector (Point a)
-&gt; Vector a
-&gt; Int
-&gt; a
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
forall a.
(Unbox a, Ord a, Floating a) =&gt;
CubicBezier a
-&gt; Vector (Point a)
-&gt; Vector a
-&gt; Int
-&gt; a
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic%27"><span class="hs-identifier hs-var">approximateCubic'</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239857"><span class="hs-identifier hs-var">curve2</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239865"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239862"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239863"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239852"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239855"><span class="hs-identifier hs-var">bt</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239854"><span class="hs-identifier hs-var">bt'</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239849"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239848"><span class="hs-identifier hs-var">err2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic"><span class="hs-pragma hs-type">approximateCubic</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- find (a, b) which minimises &#8721;&#7522;(a*a&#7522; + b*b&#7522; + eps&#7522;)&#178;</span><span>
</span><span id="line-299"></span><span id="local-6989586621679240116"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#leastSquares"><span class="hs-identifier hs-type">leastSquares</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-300"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240116"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-301"></span><span id="leastSquares"><span class="annot"><span class="annottext">leastSquares :: Vector a -&gt; Vector a -&gt; Vector a -&gt; Maybe (a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#leastSquares"><span class="hs-identifier hs-var hs-var">leastSquares</span></a></span></span><span> </span><span id="local-6989586621679239844"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239844"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679239843"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239843"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679239842"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239842"><span class="hs-identifier hs-var">epses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Maybe (a, a)
forall a.
(Eq a, Fractional a) =&gt;
a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Maybe (a, a)
</span><a href="Geom2D.CubicBezier.Numeric.html#solveLinear2x2"><span class="hs-identifier hs-var">solveLinear2x2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239840"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239839"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239838"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239837"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239836"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239835"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679239834"><span class="annot"><span class="annottext">square :: a -&gt; a
</span><a href="#local-6989586621679239834"><span class="hs-identifier hs-var hs-var">square</span></a></span></span><span> </span><span id="local-6989586621679239833"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239833"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239833"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239833"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679239840"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679239840"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Num a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; Vector a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Vector a -&gt; Vector a
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><a href="#local-6989586621679239834"><span class="hs-identifier hs-var">square</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239844"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679239839"><span class="annot"><span class="annottext">b :: a
</span><a href="#local-6989586621679239839"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Num a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; Vector a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Vector a -&gt; Vector a -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239844"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239843"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679239838"><span class="annot"><span class="annottext">c :: a
</span><a href="#local-6989586621679239838"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Num a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; Vector a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Vector a -&gt; Vector a -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239844"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239842"><span class="hs-identifier hs-var">epses</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679239837"><span class="annot"><span class="annottext">d :: a
</span><a href="#local-6989586621679239837"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239839"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679239836"><span class="annot"><span class="annottext">e :: a
</span><a href="#local-6989586621679239836"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Num a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; Vector a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Vector a -&gt; Vector a
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><a href="#local-6989586621679239834"><span class="hs-identifier hs-var">square</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239843"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679239835"><span class="annot"><span class="annottext">f :: a
</span><a href="#local-6989586621679239835"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Num a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; a) -&gt; Vector a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Vector a -&gt; Vector a -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239843"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239842"><span class="hs-identifier hs-var">epses</span></a></span><span>
</span><span id="line-310"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#leastSquares"><span class="hs-pragma hs-type">leastSquares</span></a></span><span> </span><span class="hs-pragma">::</span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- find the least squares between the points p&#7522; and B(t&#7522;) for</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- bezier curve B, where pts contains the points p&#7522; and ts</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- the values of t&#7522; .</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- The tangent at the beginning and end is maintained.</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- Since the start and end point remains the same,</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- we need to find the new value of p2' = p1 + &#945;&#8321; * (p2 - p1)</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- and p&#8323;' = p4 + &#945;2 * (p3 - p4)</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- minimizing (&#8721;|B(t&#7522;) - p&#7522;|&#178;) gives a linear equation</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- with two unknown values (&#945;&#8321; and &#945;&#8322;)</span><span>
</span><span id="line-321"></span><span id="local-6989586621679240144"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#lsqDist"><span class="hs-identifier hs-type">lsqDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-322"></span><span>           </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-323"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-324"></span><span id="lsqDist"><span class="annot"><span class="annottext">lsqDist :: CubicBezier a
-&gt; Vector (Point a) -&gt; Vector a -&gt; Maybe (CubicBezier a)
</span><a href="Geom2D.CubicBezier.Approximate.html#lsqDist"><span class="hs-identifier hs-var hs-var">lsqDist</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239830"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239829"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239828"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239828"><span class="hs-identifier hs-var">p2x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239827"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239827"><span class="hs-identifier hs-var">p2y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239826"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239826"><span class="hs-identifier hs-var">p3x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239825"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239825"><span class="hs-identifier hs-var">p3y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239824"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239824"><span class="hs-identifier hs-var">p4x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679239823"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239823"><span class="hs-identifier hs-var">p4y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679239822"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239822"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679239821"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239821"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679239820"><span class="annot"><span class="annottext">calcParams :: a -&gt; Point a -&gt; (a, a, a, a, a, a)
</span><a href="#local-6989586621679239820"><span class="hs-identifier hs-var hs-var">calcParams</span></a></span></span><span> </span><span id="local-6989586621679239819"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239819"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span id="local-6989586621679239818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239818"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679239817"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239817"><span class="hs-identifier hs-var">py</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621679239816"><span class="annot"><span class="annottext">t2 :: a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239819"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239819"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">;</span><span> </span><span id="local-6989586621679239815"><span class="annot"><span class="annottext">t3 :: a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var hs-var">t3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239819"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621679239814"><span class="annot"><span class="annottext">ax :: a
</span><a href="#local-6989586621679239814"><span class="hs-identifier hs-var hs-var">ax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239828"><span class="hs-identifier hs-var">p2x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239819"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679239813"><span class="annot"><span class="annottext">ay :: a
</span><a href="#local-6989586621679239813"><span class="hs-identifier hs-var hs-var">ay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239827"><span class="hs-identifier hs-var">p2y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var">t3</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239819"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679239812"><span class="annot"><span class="annottext">bx :: a
</span><a href="#local-6989586621679239812"><span class="hs-identifier hs-var hs-var">bx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239826"><span class="hs-identifier hs-var">p3x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239824"><span class="hs-identifier hs-var">p4x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679239811"><span class="annot"><span class="annottext">by :: a
</span><a href="#local-6989586621679239811"><span class="hs-identifier hs-var hs-var">by</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239825"><span class="hs-identifier hs-var">p3y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239823"><span class="hs-identifier hs-var">p4y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679239810"><span class="annot"><span class="annottext">cx :: a
</span><a href="#local-6989586621679239810"><span class="hs-identifier hs-var hs-var">cx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239824"><span class="hs-identifier hs-var">p4x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239818"><span class="hs-identifier hs-var">px</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679239809"><span class="annot"><span class="annottext">cy :: a
</span><a href="#local-6989586621679239809"><span class="hs-identifier hs-var hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239823"><span class="hs-identifier hs-var">p4y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239816"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239815"><span class="hs-identifier hs-var">t3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239817"><span class="hs-identifier hs-var">py</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239814"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239814"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239813"><span class="hs-identifier hs-var">ay</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239813"><span class="hs-identifier hs-var">ay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239814"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239812"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239813"><span class="hs-identifier hs-var">ay</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239811"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-335"></span><span>        </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239814"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239810"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239813"><span class="hs-identifier hs-var">ay</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239809"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239812"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239814"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239811"><span class="hs-identifier hs-var">by</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239813"><span class="hs-identifier hs-var">ay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239812"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239812"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239811"><span class="hs-identifier hs-var">by</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239811"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239812"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239810"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239811"><span class="hs-identifier hs-var">by</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239809"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679239808"><span class="annot"><span class="annottext">add6 :: (a, b, c, d, e, f) -&gt; (a, b, c, d, e, f) -&gt; (a, b, c, d, e, f)
</span><a href="#local-6989586621679239808"><span class="hs-identifier hs-var hs-var">add6</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679239807"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239807"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239806"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239806"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239805"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679239805"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239804"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679239804"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239803"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679239803"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239802"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679239802"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span id="local-6989586621679239801"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239801"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239800"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239800"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239799"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679239799"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239798"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679239798"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239797"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679239797"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span class="hs-glyph">!</span><span id="local-6989586621679239796"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679239796"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239807"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239801"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239806"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679239800"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679239805"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679239799"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679239804"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679239798"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679239803"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">e -&gt; e -&gt; e
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679239797"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679239802"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679239796"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679239795"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239795"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239794"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239794"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239793"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239793"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239792"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239792"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239791"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239791"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239790"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239790"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, a, a, a, a, a) -&gt; (a, a, a, a, a, a) -&gt; (a, a, a, a, a, a))
-&gt; Vector (a, a, a, a, a, a) -&gt; (a, a, a, a, a, a)
forall a. Unbox a =&gt; (a -&gt; a -&gt; a) -&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.foldl1'</span></span><span> </span><span class="annot"><span class="annottext">(a, a, a, a, a, a) -&gt; (a, a, a, a, a, a) -&gt; (a, a, a, a, a, a)
forall a b c d e f.
(Num a, Num b, Num c, Num d, Num e, Num f) =&gt;
(a, b, c, d, e, f) -&gt; (a, b, c, d, e, f) -&gt; (a, b, c, d, e, f)
</span><a href="#local-6989586621679239808"><span class="hs-identifier hs-var">add6</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (a, a, a, a, a, a) -&gt; (a, a, a, a, a, a))
-&gt; Vector (a, a, a, a, a, a) -&gt; (a, a, a, a, a, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Point a -&gt; (a, a, a, a, a, a))
-&gt; Vector a -&gt; Vector (Point a) -&gt; Vector (a, a, a, a, a, a)
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Point a -&gt; (a, a, a, a, a, a)
</span><a href="#local-6989586621679239820"><span class="hs-identifier hs-var">calcParams</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239821"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239822"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679239788"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239788"><span class="hs-identifier hs-var">alpha1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679239787"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239787"><span class="hs-identifier hs-var">alpha2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Maybe (a, a)
forall a.
(Eq a, Fractional a) =&gt;
a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; a -&gt; Maybe (a, a)
</span><a href="Geom2D.CubicBezier.Numeric.html#solveLinear2x2"><span class="hs-identifier hs-var">solveLinear2x2</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239795"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239794"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239793"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239792"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239791"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239790"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679239786"><span class="annot"><span class="annottext">cp1 :: Point a
</span><a href="#local-6989586621679239786"><span class="hs-identifier hs-var hs-var">cp1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239788"><span class="hs-identifier hs-var">alpha1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239828"><span class="hs-identifier hs-var">p2x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239788"><span class="hs-identifier hs-var">alpha1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239827"><span class="hs-identifier hs-var">p2y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>            </span><span id="local-6989586621679239785"><span class="annot"><span class="annottext">cp2 :: Point a
</span><a href="#local-6989586621679239785"><span class="hs-identifier hs-var hs-var">cp2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239787"><span class="hs-identifier hs-var">alpha2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239826"><span class="hs-identifier hs-var">p3x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239824"><span class="hs-identifier hs-var">p4x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239824"><span class="hs-identifier hs-var">p4x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239787"><span class="hs-identifier hs-var">alpha2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239825"><span class="hs-identifier hs-var">p3y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239823"><span class="hs-identifier hs-var">p4y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239823"><span class="hs-identifier hs-var">p4y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">CubicBezier a -&gt; Maybe (CubicBezier a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CubicBezier a -&gt; Maybe (CubicBezier a))
-&gt; CubicBezier a -&gt; Maybe (CubicBezier a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239830"><span class="hs-identifier hs-var">p1x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239829"><span class="hs-identifier hs-var">p1y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239786"><span class="hs-identifier hs-var">cp1</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239785"><span class="hs-identifier hs-var">cp2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Point a
forall a. a -&gt; a -&gt; Point a
</span><a href="Geom2D.html#Point"><span class="hs-identifier hs-var">Point</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239824"><span class="hs-identifier hs-var">p4x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239823"><span class="hs-identifier hs-var">p4y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#lsqDist"><span class="hs-pragma hs-type">lsqDist</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span>
</span><span id="line-347"></span><span>           </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- calculate the least Squares bezier curve by choosing approximate values</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- of t, and iterating again with an improved estimate of t, by taking the</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- the values of t for which the points are closest to the curve</span><span>
</span><span id="line-352"></span><span id="local-6989586621679240134"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic%27"><span class="hs-identifier hs-type">approximateCubic'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-353"></span><span>                     </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-354"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-355"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240134"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-358"></span><span id="approximateCubic%27"><span class="annot"><span class="annottext">approximateCubic' :: CubicBezier a
-&gt; Vector (Point a)
-&gt; Vector a
-&gt; Int
-&gt; a
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic%27"><span class="hs-identifier hs-var hs-var">approximateCubic'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-type">CubicBezier</span></a></span><span> </span><span id="local-6989586621679239784"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239784"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679239783"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239783"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679239782"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239782"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679239781"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239781"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679239780"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239780"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679239779"><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239779"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679239778"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239778"><span class="hs-identifier hs-var">maxiter</span></a></span></span><span> </span><span id="local-6989586621679239777"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239777"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679239776"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239776"><span class="hs-identifier hs-var">bt</span></a></span></span><span> </span><span id="local-6989586621679239775"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239775"><span class="hs-identifier hs-var">bt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679239774"><span class="annot"><span class="annottext">dir1 :: Vector (Point a)
</span><a href="#local-6989586621679239774"><span class="hs-identifier hs-var hs-var">dir1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Point a) -&gt; Vector (Point a) -&gt; Vector (Point a)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239783"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239784"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Transform a -&gt; Point a)
-&gt; (Point a -&gt; Transform a) -&gt; Point a -&gt; Point a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Transform a
forall a. Floating a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateVec"><span class="hs-identifier hs-var">rotateVec</span></a></span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Transform a)
-&gt; (Point a -&gt; Point a) -&gt; Point a -&gt; Transform a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#flipVector"><span class="hs-identifier hs-var">flipVector</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239775"><span class="hs-identifier hs-var">bt'</span></a></span><span>
</span><span id="line-360"></span><span>      </span><span id="local-6989586621679239773"><span class="annot"><span class="annottext">dir2 :: Vector (Point a)
</span><a href="#local-6989586621679239773"><span class="hs-identifier hs-var hs-var">dir2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Point a) -&gt; Vector (Point a) -&gt; Vector (Point a)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239782"><span class="hs-identifier hs-var">p3</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239781"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Transform a -&gt; Point a)
-&gt; (Point a -&gt; Transform a) -&gt; Point a -&gt; Point a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Transform a
forall a. Floating a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateVec"><span class="hs-identifier hs-var">rotateVec</span></a></span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Transform a)
-&gt; (Point a -&gt; Point a) -&gt; Point a -&gt; Transform a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#flipVector"><span class="hs-identifier hs-var">flipVector</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239775"><span class="hs-identifier hs-var">bt'</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span id="local-6989586621679239772"><span class="annot"><span class="annottext">ps :: Vector (Point a)
</span><a href="#local-6989586621679239772"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Point a -&gt; Point a -&gt; Point a)
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Vector (Point a)
forall a b c d.
(Unbox a, Unbox b, Unbox c, Unbox d) =&gt;
(a -&gt; b -&gt; c -&gt; d) -&gt; Vector a -&gt; Vector b -&gt; Vector c -&gt; Vector d
</span><span class="hs-identifier hs-var">V.zipWith3</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239770"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239770"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679239769"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239769"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span id="local-6989586621679239768"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239768"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-362"></span><span>                        </span><span class="annot"><span class="annottext">Point a -&gt; Transform a
forall a. Floating a =&gt; Point a -&gt; Transform a
</span><a href="Geom2D.html#rotateVec"><span class="hs-identifier hs-var">rotateVec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; Point a
forall a. Num a =&gt; Point a -&gt; Point a
</span><a href="Geom2D.html#flipVector"><span class="hs-identifier hs-var">flipVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239769"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Transform a -&gt; Point a -&gt; Point a
forall a b. AffineTransform a b =&gt; Transform b -&gt; a -&gt; a
</span><a href="Geom2D.html#%24%2A"><span class="hs-operator hs-var">$*</span></a></span><span>
</span><span id="line-363"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239768"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239770"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239776"><span class="hs-identifier hs-var">bt</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239775"><span class="hs-identifier hs-var">bt'</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239780"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621679239767"><span class="annot"><span class="annottext">errs :: Vector a
</span><a href="#local-6989586621679239767"><span class="hs-identifier hs-var hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; a) -&gt; Vector (Point a) -&gt; Vector a
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (Point a -&gt; a) -&gt; Point a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239772"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span id="local-6989586621679239766"><span class="annot"><span class="annottext">as :: Vector a
</span><a href="#local-6989586621679239766"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; a -&gt; a) -&gt; Vector (Point a) -&gt; Vector a -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239765"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239765"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679239764"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239764"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239765"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239764"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239764"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239764"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>           </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239774"><span class="hs-identifier hs-var">dir1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239779"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-367"></span><span>      </span><span id="local-6989586621679239763"><span class="annot"><span class="annottext">bs :: Vector a
</span><a href="#local-6989586621679239763"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; a -&gt; a) -&gt; Vector (Point a) -&gt; Vector a -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239762"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239762"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679239761"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239761"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointY"><span class="hs-identifier hs-var hs-var">pointY</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239762"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239761"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239761"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239761"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>           </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239773"><span class="hs-identifier hs-var">dir2</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239779"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679239760"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239760"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679239759"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239759"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; Vector a -&gt; Vector a -&gt; Maybe (a, a)
forall a.
(Unbox a, Fractional a, Eq a) =&gt;
Vector a -&gt; Vector a -&gt; Vector a -&gt; Maybe (a, a)
</span><a href="Geom2D.CubicBezier.Approximate.html#leastSquares"><span class="hs-identifier hs-var">leastSquares</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239766"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239763"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239767"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679239758"><span class="annot"><span class="annottext">newTs :: Vector a
</span><a href="#local-6989586621679239758"><span class="hs-identifier hs-var hs-var">newTs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; a)
-&gt; Vector a
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Vector a
forall a b c d e f.
(Unbox a, Unbox b, Unbox c, Unbox d, Unbox e, Unbox f) =&gt;
(a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; f)
-&gt; Vector a
-&gt; Vector b
-&gt; Vector c
-&gt; Vector d
-&gt; Vector e
-&gt; Vector f
</span><span class="hs-identifier hs-var">V.zipWith5</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239756"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239756"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679239755"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239755"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679239754"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239754"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679239753"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239753"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span id="local-6989586621679239752"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239752"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>                           </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-372"></span><span>                           </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239756"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239755"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239756"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239756"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239760"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239754"><span class="hs-identifier hs-var">d1</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239756"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-373"></span><span>                                                      </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239759"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Point a -&gt; a
</span><a href="Geom2D.html#pointX"><span class="hs-identifier hs-var hs-var">pointX</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239753"><span class="hs-identifier hs-var">d2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239756"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span>
</span><span id="line-374"></span><span>                           </span><span class="annot"><span class="annottext">Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorMag"><span class="hs-identifier hs-var">vectorMag</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239752"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>              </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239779"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239772"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239774"><span class="hs-identifier hs-var">dir1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239773"><span class="hs-identifier hs-var">dir2</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239775"><span class="hs-identifier hs-var">bt'</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679239749"><span class="annot"><span class="annottext">newCurve :: CubicBezier a
</span><a href="#local-6989586621679239749"><span class="hs-identifier hs-var hs-var">newCurve</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
forall a. Point a -&gt; Point a -&gt; Point a -&gt; Point a -&gt; CubicBezier a
</span><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-identifier hs-var">CubicBezier</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239784"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239783"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679239760"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239783"><span class="hs-identifier hs-var">p2</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239784"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239782"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">a
Scalar (Point a)
</span><a href="#local-6989586621679239759"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Scalar (Point a) -&gt; Point a -&gt; Point a
forall v. VectorSpace v =&gt; Scalar v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">*^</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239782"><span class="hs-identifier hs-var">p3</span></a></span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; Point a
forall v. AdditiveGroup v =&gt; v -&gt; v -&gt; v
</span><span class="hs-operator hs-var">^-^</span></span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239781"><span class="hs-identifier hs-var">p4</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239781"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679239747"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239747"><span class="hs-identifier hs-var">bt2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679239746"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239746"><span class="hs-identifier hs-var">bt2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Point a, Point a) -&gt; (Vector (Point a), Vector (Point a))
forall a b.
(Unbox a, Unbox b) =&gt;
Vector (a, b) -&gt; (Vector a, Vector b)
</span><span class="hs-identifier hs-var">V.unzip</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Point a, Point a) -&gt; (Vector (Point a), Vector (Point a)))
-&gt; Vector (Point a, Point a)
-&gt; (Vector (Point a), Vector (Point a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (Point a, Point a)) -&gt; Vector a -&gt; Vector (Point a, Point a)
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a -&gt; a -&gt; (Point a, Point a)
forall a (b :: * -&gt; *).
(Unbox a, Fractional a, GenericBezier b) =&gt;
b a -&gt; a -&gt; (Point a, Point a)
</span><a href="Geom2D.CubicBezier.Basic.html#evalBezierDeriv"><span class="hs-identifier hs-var">evalBezierDeriv</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239749"><span class="hs-identifier hs-var">newCurve</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239758"><span class="hs-identifier hs-var">newTs</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span id="local-6989586621679239745"><span class="annot"><span class="annottext">err2 :: Vector a
</span><a href="#local-6989586621679239745"><span class="hs-identifier hs-var hs-var">err2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point a -&gt; Point a -&gt; a)
-&gt; Vector (Point a) -&gt; Vector (Point a) -&gt; Vector a
forall a b c.
(Unbox a, Unbox b, Unbox c) =&gt;
(a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239780"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239747"><span class="hs-identifier hs-var">bt2</span></a></span><span>
</span><span id="line-379"></span><span>      </span><span id="local-6989586621679239744"><span class="annot"><span class="annottext">maxErr :: a
</span><a href="#local-6989586621679239744"><span class="hs-identifier hs-var hs-var">maxErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Ord a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.maximum</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239745"><span class="hs-identifier hs-var">err2</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-comment">-- alternative method for finding the t values:</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-comment">-- newTs = V.zipWith (-) ts (V.zipWith (calcDeltaT newCurve) pts ts)</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239778"><span class="hs-identifier hs-var">maxiter</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239777"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239744"><span class="hs-identifier hs-var">maxErr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239777"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">8</span></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(CubicBezier a, Vector a, Vector a, a, Vector (Point a))
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239749"><span class="hs-identifier hs-var">newCurve</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239758"><span class="hs-identifier hs-var">newTs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239745"><span class="hs-identifier hs-var">err2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239744"><span class="hs-identifier hs-var">maxErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239747"><span class="hs-identifier hs-var">bt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CubicBezier a
-&gt; Vector (Point a)
-&gt; Vector a
-&gt; Int
-&gt; a
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
forall a.
(Unbox a, Ord a, Floating a) =&gt;
CubicBezier a
-&gt; Vector (Point a)
-&gt; Vector a
-&gt; Int
-&gt; a
-&gt; Vector (Point a)
-&gt; Vector (Point a)
-&gt; Maybe (CubicBezier a, Vector a, Vector a, a, Vector (Point a))
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic%27"><span class="hs-identifier hs-var">approximateCubic'</span></a></span><span> </span><span class="annot"><span class="annottext">CubicBezier a
</span><a href="#local-6989586621679239749"><span class="hs-identifier hs-var">newCurve</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239780"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239758"><span class="hs-identifier hs-var">newTs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239778"><span class="hs-identifier hs-var">maxiter</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239744"><span class="hs-identifier hs-var">maxErr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239747"><span class="hs-identifier hs-var">bt2</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239746"><span class="hs-identifier hs-var">bt2'</span></a></span><span>
</span><span id="line-385"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateCubic%27"><span class="hs-pragma hs-type">approximateCubic'</span></a></span><span> </span><span class="hs-pragma">::</span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Int</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.CubicBezier.Basic.html#CubicBezier"><span class="hs-pragma hs-type">CubicBezier</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">,</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- approximate t by calculating the distances between all points</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- and dividing by the total sum</span><span>
</span><span id="line-394"></span><span id="local-6989586621679240145"><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateParams"><span class="hs-identifier hs-type">approximateParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Unbox</span></span><span> </span><span class="annot"><a href="#local-6989586621679240145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="annot"><a href="#local-6989586621679240145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-395"></span><span>                     </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240145"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240145"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679240145"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679240145"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-396"></span><span id="approximateParams"><span class="annot"><span class="annottext">approximateParams :: Point a -&gt; Point a -&gt; Vector (Point a) -&gt; Vector a
</span><a href="Geom2D.CubicBezier.Approximate.html#approximateParams"><span class="hs-identifier hs-var hs-var">approximateParams</span></a></span></span><span> </span><span id="local-6989586621679239743"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239743"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679239742"><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239742"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span id="local-6989586621679239741"><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector (Point a) -&gt; Bool
forall a. Unbox a =&gt; Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.null</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a
forall a. Unbox a =&gt; Vector a
</span><span class="hs-identifier hs-var">V.empty</span></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679239738"><span class="annot"><span class="annottext">dists :: Vector a
</span><a href="#local-6989586621679239738"><span class="hs-identifier hs-var hs-var">dists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; a) -&gt; Vector a
forall a. Unbox a =&gt; Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Point a) -&gt; Int
forall a. Unbox a =&gt; Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>                  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679239735"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239735"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239735"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-401"></span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239743"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Point a) -&gt; Int -&gt; Point a
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Point a) -&gt; Int -&gt; Point a
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239735"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Point a) -&gt; Int -&gt; Point a
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">V.unsafeIndex</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679239735"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>          </span><span id="local-6989586621679239733"><span class="annot"><span class="annottext">total :: a
</span><a href="#local-6989586621679239733"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. (Unbox a, Num a) =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239738"><span class="hs-identifier hs-var">dists</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Point a -&gt; Point a -&gt; a
forall a. Floating a =&gt; Point a -&gt; Point a -&gt; a
</span><a href="Geom2D.html#vectorDistance"><span class="hs-identifier hs-var">vectorDistance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Point a) -&gt; Point a
forall a. Unbox a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.last</span></span><span> </span><span class="annot"><span class="annottext">Vector (Point a)
</span><a href="#local-6989586621679239741"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point a
</span><a href="#local-6989586621679239742"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; Vector a -&gt; Vector a
forall a b. (Unbox a, Unbox b) =&gt; (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679239733"><span class="hs-identifier hs-var">total</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector a -&gt; Vector a) -&gt; Vector a -&gt; Vector a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; Vector a -&gt; Vector a
forall a. Unbox a =&gt; (a -&gt; a -&gt; a) -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.scanl1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">Vector a
</span><a href="#local-6989586621679239738"><span class="hs-identifier hs-var">dists</span></a></span><span>
</span><span id="line-405"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Geom2D.CubicBezier.Approximate.html#approximateParams"><span class="hs-pragma hs-type">approximateParams</span></a></span><span> </span><span class="hs-pragma">::</span><span>
</span><span id="line-406"></span><span>   </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Geom2D.html#Point"><span class="hs-pragma hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- Alternative method for finding the next t values, using</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- Newton-Rafphson.  There is no noticable difference in speed or</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- efficiency.</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- calcDeltaT :: CubicBezier -&gt; Point -&gt; Double -&gt; Double</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- calcDeltaT curve (Point !ptx !pty) t = let</span><span>
</span><span id="line-414"></span><span class="hs-comment">--   (Point bezx bezy, Point dbezx dbezy, Point ddbezx ddbezy, _) = evalBezierDerivs curve t</span><span>
</span><span id="line-415"></span><span class="hs-comment">--   in ((bezx - ptx) * dbezx + (bezy - pty) * dbezy) /</span><span>
</span><span id="line-416"></span><span class="hs-comment">--      (dbezx * dbezx + dbezy * dbezy + (bezx - ptx) * ddbezx + (bezy - pty) * ddbezy)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span></pre></body></html>