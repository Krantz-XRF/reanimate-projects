<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, FlexibleContexts, TypeOperators
           , TypeFamilies, TypeSynonymInstances 
           , UndecidableInstances  #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Module      :  Data.Cross</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Copyright   :  (c) Conal Elliott 2008</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- </span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Maintainer  :  conal@conal.net</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- </span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Cross products and normals</span><span>
</span><span id="line-15"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Cross</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier">HasNormal</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#normal"><span class="hs-identifier">normal</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#One"><span class="hs-identifier">One</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier">Two</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#Three"><span class="hs-identifier">Three</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross2"><span class="hs-identifier">HasCross2</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross3"><span class="hs-identifier">HasCross3</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.VectorSpace.html"><span class="hs-identifier">Data.VectorSpace</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.MemoTrie</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Basis.html"><span class="hs-identifier">Data.Basis</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Derivative.html"><span class="hs-identifier">Data.Derivative</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Thing with a normal vector (not necessarily normalized).</span><span>
</span><span id="line-31"></span><span class="hs-keyword">class</span><span> </span><span id="HasNormal"><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-var">HasNormal</span></a></span></span><span> </span><span id="local-6989586621679060011"><span class="annot"><a href="#local-6989586621679060011"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="normalVec"><span class="annot"><a href="Data.Cross.html#normalVec"><span class="hs-identifier hs-type">normalVec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679060011"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060011"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Normalized normal vector.  See also 'cross'.</span><span>
</span><span id="line-34"></span><span id="local-6989586621679059957"><span class="annot"><a href="Data.Cross.html#normal"><span class="hs-identifier hs-type">normal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-type">HasNormal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059957"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#InnerSpace"><span class="hs-identifier hs-type">InnerSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059957"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059957"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059957"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059957"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-35"></span><span id="normal"><span class="annot"><span class="annottext">normal :: v -&gt; v
</span><a href="Data.Cross.html#normal"><span class="hs-identifier hs-var hs-var">normal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; v
forall v s. (InnerSpace v, s ~ Scalar v, Floating s) =&gt; v -&gt; v
</span><a href="Data.VectorSpace.html#normalized"><span class="hs-identifier hs-var">normalized</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; v) -&gt; (v -&gt; v) -&gt; v -&gt; v
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v
forall v. HasNormal v =&gt; v -&gt; v
</span><a href="Data.Cross.html#normalVec"><span class="hs-identifier hs-var">normalVec</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Singleton</span><span>
</span><span id="line-38"></span><span class="hs-keyword">type</span><span> </span><span id="One"><span class="annot"><a href="Data.Cross.html#One"><span class="hs-identifier hs-var">One</span></a></span></span><span>   </span><span id="local-6989586621679059954"><span class="annot"><a href="#local-6989586621679059954"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679059954"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Homogeneous pair</span><span>
</span><span id="line-41"></span><span class="hs-keyword">type</span><span> </span><span id="Two"><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier hs-var">Two</span></a></span></span><span>   </span><span id="local-6989586621679059953"><span class="annot"><a href="#local-6989586621679059953"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059953"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059953"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Homogeneous triple</span><span>
</span><span id="line-44"></span><span class="hs-keyword">type</span><span> </span><span id="Three"><span class="annot"><a href="Data.Cross.html#Three"><span class="hs-identifier hs-var">Three</span></a></span></span><span> </span><span id="local-6989586621679059952"><span class="annot"><a href="#local-6989586621679059952"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059952"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059952"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059952"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Cross product of various forms of 2D vectors</span><span>
</span><span id="line-47"></span><span class="hs-keyword">class</span><span> </span><span id="HasCross2"><span class="annot"><a href="Data.Cross.html#HasCross2"><span class="hs-identifier hs-var">HasCross2</span></a></span></span><span> </span><span id="local-6989586621679060006"><span class="annot"><a href="#local-6989586621679060006"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="cross2"><span class="annot"><a href="Data.Cross.html#cross2"><span class="hs-identifier hs-type">cross2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679060006"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679060006"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621679059950"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.AdditiveGroup.html#AdditiveGroup"><span class="hs-identifier hs-type">AdditiveGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059950"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross2"><span class="hs-identifier hs-type">HasCross2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059950"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059950"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621679059947"><span class="annot"><span class="annottext">cross2 :: (u, u) -&gt; (u, u)
</span><a href="#local-6989586621679059947"><span class="hs-identifier hs-var hs-var hs-var hs-var">cross2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059946"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679059946"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059945"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679059945"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">u -&gt; u
forall v. AdditiveGroup v =&gt; v -&gt; v
</span><a href="Data.AdditiveGroup.html#negateV"><span class="hs-identifier hs-var">negateV</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679059945"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679059946"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>  </span><span class="hs-comment">-- or @(y,-x)@?</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621679059942"><span id="local-6989586621679059943"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasTrie</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross2"><span class="hs-identifier hs-type">HasCross2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059942"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross2"><span class="hs-identifier hs-type">HasCross2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059943"><span class="hs-identifier hs-type">a</span></a></span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span class="annot"><a href="#local-6989586621679059942"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-comment">-- 2d cross-product is linear</span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679059940"><span class="annot"><span class="annottext">cross2 :: (a :&gt; v) -&gt; a :&gt; v
</span><a href="#local-6989586621679059940"><span class="hs-identifier hs-var hs-var hs-var hs-var">cross2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v) -&gt; (a :&gt; v) -&gt; a :&gt; v
forall a b c. HasTrie (Basis a) =&gt; (b -&gt; c) -&gt; (a :&gt; b) -&gt; a :&gt; c
</span><a href="Data.Maclaurin.html#fmapD"><span class="hs-identifier hs-var">fmapD</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v
forall v. HasCross2 v =&gt; v -&gt; v
</span><a href="Data.Cross.html#cross2"><span class="hs-identifier hs-var">cross2</span></a></span></span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span id="local-6989586621679059938"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasTrie</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-57"></span><span>         </span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-type">HasNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059938"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679059935"><span class="annot"><span class="annottext">normalVec :: (One s :&gt; Two (One s)) -&gt; One s :&gt; Two (One s)
</span><a href="#local-6989586621679059935"><span class="hs-identifier hs-var hs-var hs-var hs-var">normalVec</span></a></span></span><span> </span><span id="local-6989586621679059934"><span class="annot"><span class="annottext">One s :&gt; Two (One s)
</span><a href="#local-6989586621679059934"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(One s :&gt; Two (One s)) -&gt; One s :&gt; Two (One s)
forall v. HasCross2 v =&gt; v -&gt; v
</span><a href="Data.Cross.html#cross2"><span class="hs-identifier hs-var">cross2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">One s :&gt; Two (One s)
</span><a href="#local-6989586621679059934"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(One s :&gt; Two (One s)) -&gt; Basis (One s) -&gt; One s :&gt; Two (One s)
forall a b.
(HasTrie (Basis a), HasBasis a, AdditiveGroup b) =&gt;
(a :&gt; b) -&gt; Basis a -&gt; a :&gt; b
</span><a href="Data.Maclaurin.html#derivAtBasis"><span class="hs-operator hs-var">`derivAtBasis`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- When I use atBasis (from LinearMap) instead of the more liberally-typed</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- atB (below), I get a type error:</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- </span><span>
</span><span id="line-63"></span><span class="hs-comment">--     Couldn't match expected type `Basis a1' against inferred type `()'</span><span>
</span><span id="line-64"></span><span class="hs-comment">--       Expected type: a1 :-* (s :&gt; Two s)</span><span>
</span><span id="line-65"></span><span class="hs-comment">--       Inferred type: s  :-* (s :&gt; Two s)</span><span>
</span><span id="line-66"></span><span class="hs-comment">--     In the first argument of `atB', namely `derivative v'</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- </span><span>
</span><span id="line-68"></span><span class="hs-comment">-- I think this type error is a GHC bug, but I'm not sure.</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- atB :: (AdditiveGroup b, HasTrie a) =&gt; Maybe (a :-&gt;: b) -&gt; a -&gt; b</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- -- atB :: (AdditiveGroup b, HasBasis a, HasTrie (Basis a)) =&gt;</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- --        Maybe (Basis a :-&gt;: b) -&gt; Basis a -&gt; b</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- l `atB` b = maybe zeroV (`untrie` b) l</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span id="local-6989586621679059932"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059932"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059932"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasTrie</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059932"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059932"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-type">HasNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059932"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059932"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679059930"><span class="annot"><span class="annottext">normalVec :: Two (One s :&gt; One s) -&gt; Two (One s :&gt; One s)
</span><a href="#local-6989586621679059930"><span class="hs-identifier hs-var hs-var hs-var hs-var">normalVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(One s :&gt; (One s, One s)) -&gt; Two (One s :&gt; One s)
forall a b c.
HasTrie (Basis a) =&gt;
(a :&gt; (b, c)) -&gt; (a :&gt; b, a :&gt; c)
</span><a href="Data.Maclaurin.html#unpairD"><span class="hs-identifier hs-var">unpairD</span></a></span><span> </span><span class="annot"><span class="annottext">((One s :&gt; (One s, One s)) -&gt; Two (One s :&gt; One s))
-&gt; (Two (One s :&gt; One s) -&gt; One s :&gt; (One s, One s))
-&gt; Two (One s :&gt; One s)
-&gt; Two (One s :&gt; One s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(One s :&gt; (One s, One s)) -&gt; One s :&gt; (One s, One s)
forall v. HasNormal v =&gt; v -&gt; v
</span><a href="Data.Cross.html#normalVec"><span class="hs-identifier hs-var">normalVec</span></a></span><span> </span><span class="annot"><span class="annottext">((One s :&gt; (One s, One s)) -&gt; One s :&gt; (One s, One s))
-&gt; (Two (One s :&gt; One s) -&gt; One s :&gt; (One s, One s))
-&gt; Two (One s :&gt; One s)
-&gt; One s :&gt; (One s, One s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Two (One s :&gt; One s) -&gt; One s :&gt; (One s, One s)
forall a b c.
(HasBasis a, HasTrie (Basis a), VectorSpace b, VectorSpace c) =&gt;
(a :&gt; b, a :&gt; c) -&gt; a :&gt; (b, c)
</span><a href="Data.Maclaurin.html#pairD"><span class="hs-identifier hs-var">pairD</span></a></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- I don't know why I can't eliminate the @HasTrie (Basis s)@ constraints</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- above, considering @Basis s ~ ()@ and @HasTrie ()@.</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Cross product of various forms of 3D vectors</span><span>
</span><span id="line-84"></span><span class="hs-keyword">class</span><span> </span><span id="HasCross3"><span class="annot"><a href="Data.Cross.html#HasCross3"><span class="hs-identifier hs-var">HasCross3</span></a></span></span><span> </span><span id="local-6989586621679059980"><span class="annot"><a href="#local-6989586621679059980"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="cross3"><span class="annot"><a href="Data.Cross.html#cross3"><span class="hs-identifier hs-type">cross3</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679059980"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059980"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679059980"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679059926"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679059926"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross3"><span class="hs-identifier hs-type">HasCross3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059926"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059926"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679059926"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679059923"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">ax</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059922"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">ay</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059921"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059921"><span class="hs-identifier hs-var">az</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679059920"><span class="annot"><span class="annottext">cross3 :: (s, s, s) -&gt; (s, s, s) -&gt; (s, s, s)
</span><a href="#local-6989586621679059920"><span class="hs-operator hs-var hs-var hs-var hs-var">`cross3`</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679059919"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">bx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059918"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">by</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679059917"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var">bz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">ay</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var">bz</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059921"><span class="hs-identifier hs-var">az</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">by</span></a></span><span>
</span><span id="line-88"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059921"><span class="hs-identifier hs-var">az</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059917"><span class="hs-identifier hs-var">bz</span></a></span><span>
</span><span id="line-89"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059923"><span class="hs-identifier hs-var">ax</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059918"><span class="hs-identifier hs-var">by</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059922"><span class="hs-identifier hs-var">ay</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; s -&gt; s
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679059919"><span class="hs-identifier hs-var">bx</span></a></span><span> </span><span class="hs-special">)</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- TODO: Eliminate the 'Num' constraint by using 'VectorSpace' operations.</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679059914"><span id="local-6989586621679059915"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasTrie</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059915"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059914"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross3"><span class="hs-identifier hs-type">HasCross3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059914"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Cross.html#HasCross3"><span class="hs-identifier hs-type">HasCross3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059915"><span class="hs-identifier hs-type">a</span></a></span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span class="annot"><a href="#local-6989586621679059914"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-- 3D cross-product is bilinear (curried linear)</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679059912"><span class="annot"><span class="annottext">cross3 :: (a :&gt; v) -&gt; (a :&gt; v) -&gt; a :&gt; v
</span><a href="#local-6989586621679059912"><span class="hs-identifier hs-var hs-var hs-var hs-var">cross3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; (a :&gt; v) -&gt; (a :&gt; v) -&gt; a :&gt; v
forall a b c u.
(HasBasis a, HasTrie (Basis a), AdditiveGroup u) =&gt;
(b -&gt; c -&gt; u) -&gt; (a :&gt; b) -&gt; (a :&gt; c) -&gt; a :&gt; u
</span><a href="Data.Maclaurin.html#distrib"><span class="hs-identifier hs-var">distrib</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
forall v. HasCross3 v =&gt; v -&gt; v -&gt; v
</span><a href="Data.Cross.html#cross3"><span class="hs-identifier hs-var">cross3</span></a></span></span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span id="local-6989586621679059910"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasTrie</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-98"></span><span>         </span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-type">HasNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="Data.Cross.html#Three"><span class="hs-identifier hs-type">Three</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679059908"><span class="annot"><span class="annottext">normalVec :: (Two s :&gt; Three s) -&gt; Two s :&gt; Three s
</span><a href="#local-6989586621679059908"><span class="hs-identifier hs-var hs-var hs-var hs-var">normalVec</span></a></span></span><span> </span><span id="local-6989586621679059907"><span class="annot"><span class="annottext">Two s :&gt; Three s
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Basis (Two s) -&gt; Two s :&gt; Three s
</span><a href="#local-6989586621679059906"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Two s :&gt; Three s) -&gt; (Two s :&gt; Three s) -&gt; Two s :&gt; Three s
forall v. HasCross3 v =&gt; v -&gt; v -&gt; v
</span><a href="Data.Cross.html#cross3"><span class="hs-operator hs-var">`cross3`</span></a></span><span> </span><span class="annot"><span class="annottext">Basis (Two s) -&gt; Two s :&gt; Three s
</span><a href="#local-6989586621679059906"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>     </span><span id="local-6989586621679059906"><span class="annot"><span class="annottext">d :: Basis (Two s) -&gt; Two s :&gt; Three s
</span><a href="#local-6989586621679059906"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Two s :&gt; Three s) -&gt; Basis (Two s) -&gt; Two s :&gt; Three s
forall a b.
(HasTrie (Basis a), HasBasis a, AdditiveGroup b) =&gt;
(a :&gt; b) -&gt; Basis a -&gt; a :&gt; b
</span><a href="Data.Maclaurin.html#derivAtBasis"><span class="hs-identifier hs-var">derivAtBasis</span></a></span><span> </span><span class="annot"><span class="annottext">Two s :&gt; Three s
</span><a href="#local-6989586621679059907"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679059905"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.VectorSpace.html#VectorSpace"><span class="hs-identifier hs-type">VectorSpace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Basis.html#HasBasis"><span class="hs-identifier hs-type">HasBasis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasTrie</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Basis.html#Basis"><span class="hs-identifier hs-type">Basis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-type">HasNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="Data.Cross.html#Three"><span class="hs-identifier hs-type">Three</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Cross.html#HasNormal"><span class="hs-identifier hs-type">HasNormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#Three"><span class="hs-identifier hs-type">Three</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Cross.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Data.Maclaurin.html#%3A%3E"><span class="hs-operator hs-type">:&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059905"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679059903"><span class="annot"><span class="annottext">normalVec :: Three (Two s :&gt; s) -&gt; Three (Two s :&gt; s)
</span><a href="#local-6989586621679059903"><span class="hs-identifier hs-var hs-var hs-var hs-var">normalVec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Two s :&gt; Three s) -&gt; Three (Two s :&gt; s)
forall a b c d.
HasTrie (Basis a) =&gt;
(a :&gt; (b, c, d)) -&gt; (a :&gt; b, a :&gt; c, a :&gt; d)
</span><a href="Data.Maclaurin.html#untripleD"><span class="hs-identifier hs-var">untripleD</span></a></span><span> </span><span class="annot"><span class="annottext">((Two s :&gt; Three s) -&gt; Three (Two s :&gt; s))
-&gt; (Three (Two s :&gt; s) -&gt; Two s :&gt; Three s)
-&gt; Three (Two s :&gt; s)
-&gt; Three (Two s :&gt; s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Two s :&gt; Three s) -&gt; Two s :&gt; Three s
forall v. HasNormal v =&gt; v -&gt; v
</span><a href="Data.Cross.html#normalVec"><span class="hs-identifier hs-var">normalVec</span></a></span><span> </span><span class="annot"><span class="annottext">((Two s :&gt; Three s) -&gt; Two s :&gt; Three s)
-&gt; (Three (Two s :&gt; s) -&gt; Two s :&gt; Three s)
-&gt; Three (Two s :&gt; s)
-&gt; Two s :&gt; Three s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Three (Two s :&gt; s) -&gt; Two s :&gt; Three s
forall a b c d.
(HasBasis a, HasTrie (Basis a), VectorSpace b, VectorSpace c,
 VectorSpace d) =&gt;
(a :&gt; b, a :&gt; c, a :&gt; d) -&gt; a :&gt; (b, c, d)
</span><a href="Data.Maclaurin.html#tripleD"><span class="hs-identifier hs-var">tripleD</span></a></span></span><span>
</span><span id="line-107"></span></pre></body></html>