<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : TypeCheck
Description : Animations for type-checking.
Copyright   : (c) Xie Ruifeng, 2020
License     : AGPL-3
Maintainer  : krantz.xrf@outlook.com
Stability   : experimental
Portability : portable
-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE BlockArguments    #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes       #-}</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TypeCheck</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="TypeCheck.html#typeCheckAnim"><span class="hs-identifier">typeCheckAnim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.Animation.Effects</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">addWhiteBkg</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.HexColour</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromRGBA8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rgba</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.Linear</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Linear</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lerp</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.Object.Effect</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.Object.Transform</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.Object.Types</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Common.Prologue</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Picture.Types</span></span><span>  </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Traversal</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Product</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.SvgTree</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Reanimate</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Reanimate.Scene</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span id="local-6989586621679144862"><span class="annot"><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-type">yellow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="TypeCheck.html#red"><span class="hs-identifier hs-type">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="TypeCheck.html#blue"><span class="hs-identifier hs-type">blue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="TypeCheck.html#green"><span class="hs-identifier hs-type">green</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromRGBA8</span></span><span> </span><span class="annot"><a href="#local-6989586621679144862"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679144862"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-39"></span><span id="yellow"><span class="annot"><span class="annottext">yellow :: c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var hs-var">yellow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[rgba|C19C00|]</span></span><span>
</span><span id="line-40"></span><span id="red"><span class="annot"><span class="annottext">red :: c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[rgba|E74856|]</span></span><span>
</span><span id="line-41"></span><span id="blue"><span class="annot"><span class="annottext">blue :: c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[rgba|3A96DD|]</span></span><span>
</span><span id="line-42"></span><span id="green"><span class="annot"><span class="annottext">green :: c
</span><a href="TypeCheck.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[rgba|00c19c|]</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="local-6989586621679144804"><span class="annot"><a href="TypeCheck.html#showMathChunks"><span class="hs-identifier hs-type">showMathChunks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144804"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-45"></span><span id="showMathChunks"><span class="annot"><span class="annottext">showMathChunks :: [MathChunk] -&gt; Scene s [Object s SVG]
</span><a href="TypeCheck.html#showMathChunks"><span class="hs-identifier hs-var hs-var">showMathChunks</span></a></span></span><span> </span><span id="local-6989586621679144736"><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144736"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s [Object s SVG] -&gt; Scene s [Object s SVG]
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s [Object s SVG] -&gt; Scene s [Object s SVG])
-&gt; Scene s [Object s SVG] -&gt; Scene s [Object s SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroup</span></span><span> </span><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144736"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Scene s [Object s SVG]
-&gt; ([Object s SVG] -&gt; Scene s [Object s SVG])
-&gt; Scene s [Object s SVG]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s (Object s SVG))
-&gt; [Object s SVG] -&gt; Scene s [Object s SVG]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s (Object s SVG) -&gt; Scene s (Object s SVG)
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s (Object s SVG) -&gt; Scene s (Object s SVG))
-&gt; (Object s SVG -&gt; Scene s (Object s SVG))
-&gt; Object s SVG
-&gt; Scene s (Object s SVG)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679144730"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144730"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oShowWith</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144730"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeIn</span></span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Object s SVG -&gt; Scene s (Object s SVG)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144730"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><a href="TypeCheck.html#getFillColour"><span class="hs-identifier hs-type">getFillColour</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span>
</span><span id="line-48"></span><span id="getFillColour"><span class="annot"><span class="annottext">getFillColour :: SVG -&gt; PixelRGBA8
</span><a href="TypeCheck.html#getFillColour"><span class="hs-identifier hs-var hs-var">getFillColour</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
-&gt; (Texture -&gt; PixelRGBA8) -&gt; Maybe Texture -&gt; PixelRGBA8
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="">[rgba|000|]</span></span><span> </span><span class="annot"><span class="annottext">Texture -&gt; PixelRGBA8
</span><a href="#local-6989586621679144725"><span class="hs-identifier hs-var">fromColorRef</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Texture -&gt; PixelRGBA8)
-&gt; (SVG -&gt; Maybe Texture) -&gt; SVG -&gt; PixelRGBA8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe Texture) SVG (Maybe Texture) -&gt; SVG -&gt; Maybe Texture
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe Texture) SVG (Maybe Texture)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">fillColor</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679144725"><span class="annot"><span class="annottext">fromColorRef :: Texture -&gt; PixelRGBA8
</span><a href="#local-6989586621679144725"><span class="hs-identifier hs-var hs-var">fromColorRef</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ColorRef</span></span><span> </span><span id="local-6989586621679144721"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144721"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144721"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621679144788"><span id="local-6989586621679144789"><span class="annot"><a href="TypeCheck.html#moveVertical"><span class="hs-identifier hs-type">moveVertical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144789"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144789"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-52"></span><span id="moveVertical"><span class="annot"><span class="annottext">moveVertical :: Double -&gt; Object s a -&gt; Scene s ()
</span><a href="TypeCheck.html#moveVertical"><span class="hs-identifier hs-var hs-var">moveVertical</span></a></span></span><span> </span><span id="local-6989586621679144719"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144719"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679144718"><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679144718"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
forall s a.
Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oTween</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679144718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679144716"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144716"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData a -&gt; Identity (ObjectData a)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData a -&gt; Identity (ObjectData a))
-&gt; (Double -&gt; Double) -&gt; ObjectData a -&gt; ObjectData a
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144716"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144719"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679144787"><span class="annot"><a href="TypeCheck.html#showDotSig"><span class="hs-identifier hs-type">showDotSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-55"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144787"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144787"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144787"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144787"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-57"></span><span id="showDotSig"><span class="annot"><span class="annottext">showDotSig :: PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
</span><a href="TypeCheck.html#showDotSig"><span class="hs-identifier hs-var hs-var">showDotSig</span></a></span></span><span> </span><span id="local-6989586621679144710"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144710"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span id="local-6989586621679144709"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679144709"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621679144708"><span class="annot"><span class="annottext">[[Object s SVG] -&gt; Scene s ()]
</span><a href="#local-6989586621679144708"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679144707"><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144707"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144706"><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144706"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144705"><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144705"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; MathChunk) -&gt; String -&gt; [MathChunk]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; MathChunk
</span><span class="hs-identifier hs-var">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; MathChunk) -&gt; (Char -&gt; Text) -&gt; Char -&gt; MathChunk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679144709"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">~</span><span id="local-6989586621679144702"><span class="annot"><span class="annottext">sig :: [Object s SVG]
</span><a href="#local-6989586621679144702"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679144701"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144701"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Object s SVG]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; : &quot;</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144706"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144705"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144707"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144706"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144707"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><a href="#local-6989586621679144705"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><span class="annottext">(([Object s SVG] -&gt; Scene s ()) -&gt; Scene s ())
-&gt; [[Object s SVG] -&gt; Scene s ()] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Object s SVG] -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144702"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Object s SVG] -&gt; Scene s ()]
</span><a href="#local-6989586621679144708"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144701"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) (SVG -&gt; SVG)
</span><span class="hs-identifier hs-var">oContext</span></span><span> </span><span class="annot"><span class="annottext">(((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (SVG -&gt; SVG) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">mapTree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">withFillColorPixel</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144710"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Object s SVG -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oShowWith`</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeIn</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144702"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s [Object s SVG]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144702"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="EquationF"><span class="annot"><a href="TypeCheck.html#EquationF"><span class="hs-identifier hs-var">EquationF</span></a></span></span><span> </span><span id="local-6989586621679144877"><span class="annot"><a href="#local-6989586621679144877"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679144878"><span class="annot"><a href="#local-6989586621679144878"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Equation"><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-var">Equation</span></a></span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="equationLhs"><span class="annot"><span class="annottext">EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679144878"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="equalSign"><span class="annot"><span class="annottext">EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679144878"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="equationRhs"><span class="annot"><span class="annottext">EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679144878"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679144686"><span id="local-6989586621679144688"><span class="annot"><span class="annottext">a -&gt; EquationF s b -&gt; EquationF s a
(a -&gt; b) -&gt; EquationF s a -&gt; EquationF s b
(forall a b. (a -&gt; b) -&gt; EquationF s a -&gt; EquationF s b)
-&gt; (forall a b. a -&gt; EquationF s b -&gt; EquationF s a)
-&gt; Functor (EquationF s)
forall a b. a -&gt; EquationF s b -&gt; EquationF s a
forall a b. (a -&gt; b) -&gt; EquationF s a -&gt; EquationF s b
forall s a b. a -&gt; EquationF s b -&gt; EquationF s a
forall s a b. (a -&gt; b) -&gt; EquationF s a -&gt; EquationF s b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; EquationF s b -&gt; EquationF s a
$c&lt;$ :: forall s a b. a -&gt; EquationF s b -&gt; EquationF s a
fmap :: (a -&gt; b) -&gt; EquationF s a -&gt; EquationF s b
$cfmap :: forall s a b. (a -&gt; b) -&gt; EquationF s a -&gt; EquationF s b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144651"><span id="local-6989586621679144653"><span id="local-6989586621679144655"><span id="local-6989586621679144657"><span id="local-6989586621679144659"><span id="local-6989586621679144661"><span id="local-6989586621679144663"><span id="local-6989586621679144665"><span id="local-6989586621679144667"><span id="local-6989586621679144669"><span id="local-6989586621679144671"><span id="local-6989586621679144673"><span id="local-6989586621679144675"><span id="local-6989586621679144677"><span id="local-6989586621679144679"><span id="local-6989586621679144681"><span id="local-6989586621679144683"><span class="annot"><span class="annottext">EquationF s a -&gt; Bool
(a -&gt; m) -&gt; EquationF s a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
(forall m. Monoid m =&gt; EquationF s m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EquationF s a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EquationF s a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a)
-&gt; (forall a. EquationF s a -&gt; [a])
-&gt; (forall a. EquationF s a -&gt; Bool)
-&gt; (forall a. EquationF s a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; EquationF s a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; EquationF s a -&gt; a)
-&gt; (forall a. Ord a =&gt; EquationF s a -&gt; a)
-&gt; (forall a. Num a =&gt; EquationF s a -&gt; a)
-&gt; (forall a. Num a =&gt; EquationF s a -&gt; a)
-&gt; Foldable (EquationF s)
forall a. Eq a =&gt; a -&gt; EquationF s a -&gt; Bool
forall a. Num a =&gt; EquationF s a -&gt; a
forall a. Ord a =&gt; EquationF s a -&gt; a
forall m. Monoid m =&gt; EquationF s m -&gt; m
forall a. EquationF s a -&gt; Bool
forall a. EquationF s a -&gt; Int
forall a. EquationF s a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a
forall s a. Eq a =&gt; a -&gt; EquationF s a -&gt; Bool
forall s a. Num a =&gt; EquationF s a -&gt; a
forall s a. Ord a =&gt; EquationF s a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; EquationF s a -&gt; m
forall s m. Monoid m =&gt; EquationF s m -&gt; m
forall s a. EquationF s a -&gt; Bool
forall s a. EquationF s a -&gt; Int
forall s a. EquationF s a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
forall s a. (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a
forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; EquationF s a -&gt; m
forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: EquationF s a -&gt; a
$cproduct :: forall s a. Num a =&gt; EquationF s a -&gt; a
sum :: EquationF s a -&gt; a
$csum :: forall s a. Num a =&gt; EquationF s a -&gt; a
minimum :: EquationF s a -&gt; a
$cminimum :: forall s a. Ord a =&gt; EquationF s a -&gt; a
maximum :: EquationF s a -&gt; a
$cmaximum :: forall s a. Ord a =&gt; EquationF s a -&gt; a
elem :: a -&gt; EquationF s a -&gt; Bool
$celem :: forall s a. Eq a =&gt; a -&gt; EquationF s a -&gt; Bool
length :: EquationF s a -&gt; Int
$clength :: forall s a. EquationF s a -&gt; Int
null :: EquationF s a -&gt; Bool
$cnull :: forall s a. EquationF s a -&gt; Bool
toList :: EquationF s a -&gt; [a]
$ctoList :: forall s a. EquationF s a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a
$cfoldl1 :: forall s a. (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a
$cfoldr1 :: forall s a. (a -&gt; a -&gt; a) -&gt; EquationF s a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
$cfoldl' :: forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
$cfoldl :: forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
$cfoldr' :: forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
$cfoldr :: forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; EquationF s a -&gt; b
foldMap' :: (a -&gt; m) -&gt; EquationF s a -&gt; m
$cfoldMap' :: forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; EquationF s a -&gt; m
foldMap :: (a -&gt; m) -&gt; EquationF s a -&gt; m
$cfoldMap :: forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; EquationF s a -&gt; m
fold :: EquationF s m -&gt; m
$cfold :: forall s m. Monoid m =&gt; EquationF s m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144640"><span id="local-6989586621679144642"><span id="local-6989586621679144644"><span id="local-6989586621679144646"><span class="annot"><span class="annottext">Functor (EquationF s)
Foldable (EquationF s)
Functor (EquationF s)
-&gt; Foldable (EquationF s)
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; EquationF s a -&gt; f (EquationF s b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    EquationF s (f a) -&gt; f (EquationF s a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; EquationF s a -&gt; m (EquationF s b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    EquationF s (m a) -&gt; m (EquationF s a))
-&gt; Traversable (EquationF s)
(a -&gt; f b) -&gt; EquationF s a -&gt; f (EquationF s b)
forall s. Functor (EquationF s)
forall s. Foldable (EquationF s)
forall s (m :: * -&gt; *) a.
Monad m =&gt;
EquationF s (m a) -&gt; m (EquationF s a)
forall s (f :: * -&gt; *) a.
Applicative f =&gt;
EquationF s (f a) -&gt; f (EquationF s a)
forall s (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; EquationF s a -&gt; m (EquationF s b)
forall s (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; EquationF s a -&gt; f (EquationF s b)
forall (t :: * -&gt; *).
Functor t
-&gt; Foldable t
-&gt; (forall (f :: * -&gt; *) a b.
    Applicative f =&gt;
    (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
EquationF s (m a) -&gt; m (EquationF s a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
EquationF s (f a) -&gt; f (EquationF s a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; EquationF s a -&gt; m (EquationF s b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; EquationF s a -&gt; f (EquationF s b)
sequence :: EquationF s (m a) -&gt; m (EquationF s a)
$csequence :: forall s (m :: * -&gt; *) a.
Monad m =&gt;
EquationF s (m a) -&gt; m (EquationF s a)
mapM :: (a -&gt; m b) -&gt; EquationF s a -&gt; m (EquationF s b)
$cmapM :: forall s (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; EquationF s a -&gt; m (EquationF s b)
sequenceA :: EquationF s (f a) -&gt; f (EquationF s a)
$csequenceA :: forall s (f :: * -&gt; *) a.
Applicative f =&gt;
EquationF s (f a) -&gt; f (EquationF s a)
traverse :: (a -&gt; f b) -&gt; EquationF s a -&gt; f (EquationF s b)
$ctraverse :: forall s (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; EquationF s a -&gt; f (EquationF s b)
$cp2Traversable :: forall s. Foldable (EquationF s)
$cp1Traversable :: forall s. Functor (EquationF s)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">type</span><span> </span><span id="Equation"><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-var">Equation</span></a></span></span><span> </span><span id="local-6989586621679144638"><span class="annot"><a href="#local-6989586621679144638"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="TypeCheck.html#EquationF"><span class="hs-identifier hs-type">EquationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144638"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144638"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679144867"><span class="annot"><a href="TypeCheck.html#newEquation"><span class="hs-identifier hs-type">newEquation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144867"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-type">Equation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144867"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-78"></span><span id="newEquation"><span class="annot"><span class="annottext">newEquation :: [MathChunk] -&gt; [MathChunk] -&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#newEquation"><span class="hs-identifier hs-var hs-var">newEquation</span></a></span></span><span> </span><span id="local-6989586621679144636"><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144636"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679144635"><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144635"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679144634"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144634"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; EquationF s MathChunk -&gt; Scene s (Equation s)
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MathChunk] -&gt; MathChunk -&gt; [MathChunk] -&gt; EquationF s MathChunk
forall s a. [a] -&gt; a -&gt; [a] -&gt; EquationF s a
</span><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-var">Equation</span></a></span><span> </span><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144636"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144635"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; GroupAlignment [] (EquationF s) s Any SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
Double -&gt; GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">withMargin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144634"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">Equation s -&gt; Scene s (Equation s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144634"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621679144772"><span id="local-6989586621679144773"><span class="annot"><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-type">showEquation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Renderable</span></span><span> </span><span class="annot"><a href="#local-6989586621679144773"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-84"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144772"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144773"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144772"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144773"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-86"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-type">Equation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144772"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144772"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144772"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-type">Equation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144772"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-88"></span><span id="showEquation"><span class="annot"><span class="annottext">showEquation :: [MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var hs-var">showEquation</span></a></span></span><span> </span><span id="local-6989586621679144631"><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144631"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679144630"><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144630"><span class="hs-identifier hs-var">lhsOrig</span></a></span></span><span> </span><span id="local-6989586621679144629"><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144629"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679144628"><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144628"><span class="hs-identifier hs-var">rhsOrig</span></a></span></span><span> </span><span id="local-6989586621679144627"><span class="annot"><span class="annottext">[Equation s -&gt; Scene s ()]
</span><a href="#local-6989586621679144627"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679144626"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk] -&gt; [MathChunk] -&gt; Scene s (Equation s)
forall s. [MathChunk] -&gt; [MathChunk] -&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#newEquation"><span class="hs-identifier hs-var">newEquation</span></a></span><span> </span><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144631"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">[MathChunk]
</span><a href="#local-6989586621679144629"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="annottext">((Equation s -&gt; Scene s ()) -&gt; Scene s ())
-&gt; [Equation s -&gt; Scene s ()] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Equation s -&gt; Scene s ()) -&gt; Equation s -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Equation s -&gt; Scene s ()]
</span><a href="#local-6989586621679144627"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">Equation s -&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) (SVG -&gt; SVG)
</span><span class="hs-identifier hs-var">oContext</span></span><span> </span><span class="annot"><span class="annottext">(((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (SVG -&gt; SVG) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; PixelRGBA8 -&gt; SVG -&gt; SVG
</span><a href="TypeCheck.html#transColour"><span class="hs-identifier hs-var">transColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#green"><span class="hs-identifier hs-var">green</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">[(Object s a, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span> </span><span class="annot"><span class="annottext">([(Object s a, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; (Object s a, PixelRGBA8))
-&gt; [Object s a] -&gt; [(Object s a, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#green"><span class="hs-identifier hs-var">green</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144630"><span class="hs-identifier hs-var">lhsOrig</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; [Object s a] -&gt; [Object s a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144628"><span class="hs-identifier hs-var">rhsOrig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="annottext">[Trans (Object s a) [Object s SVG]] -&gt; Scene s ()
forall a s b.
Renderable a =&gt;
[Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><span class="hs-identifier hs-var">dupFromObject</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144630"><span class="hs-identifier hs-var">lhsOrig</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; [Object s SVG] -&gt; Trans (Object s a) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144628"><span class="hs-identifier hs-var">rhsOrig</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; [Object s SVG] -&gt; Trans (Object s a) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">Equation s -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oShowWith`</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeIn</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
forall s a.
(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-var">tweenColoursWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Object s a, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; (Object s a, PixelRGBA8))
-&gt; [Object s a] -&gt; [(Object s a, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#green"><span class="hs-identifier hs-var">green</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144630"><span class="hs-identifier hs-var">lhsOrig</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; [Object s a] -&gt; [Object s a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144628"><span class="hs-identifier hs-var">rhsOrig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a.
(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-var">tweenColoursWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Object s SVG, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; (Object s SVG, PixelRGBA8))
-&gt; [Object s SVG] -&gt; [(Object s SVG, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#green"><span class="hs-identifier hs-var">green</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">Equation s -&gt; Scene s (Equation s)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144626"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679144771"><span class="annot"><a href="TypeCheck.html#alignEquation"><span class="hs-identifier hs-type">alignEquation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-type">Equation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144771"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="TypeCheck.html#Equation"><span class="hs-identifier hs-type">Equation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144771"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144771"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-103"></span><span id="alignEquation"><span class="annot"><span class="annottext">alignEquation :: Equation s -&gt; Equation s -&gt; Scene s ()
</span><a href="TypeCheck.html#alignEquation"><span class="hs-identifier hs-var hs-var">alignEquation</span></a></span></span><span> </span><span id="local-6989586621679144617"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144617"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679144616"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144616"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679144615"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144615"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; Getting Double (ObjectData SVG) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-identifier hs-var">oRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144617"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData SVG) Double
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679144612"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144612"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; Getting Double (ObjectData SVG) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-identifier hs-var">oRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144616"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData SVG) Double
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679144611"><span class="annot"><span class="annottext">dx :: Double
</span><a href="#local-6989586621679144611"><span class="hs-identifier hs-var hs-var">dx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144615"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144612"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">Equation s -&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144616"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (Double -&gt; Double) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144611"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span id="local-6989586621679144780"><span id="local-6989586621679144781"><span class="annot"><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-type">oBoxNewOverArrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144781"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144781"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144781"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Box</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-110"></span><span id="oBoxNewOverArrow"><span class="annot"><span class="annottext">oBoxNewOverArrow :: [Object s a] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-var hs-var">oBoxNewOverArrow</span></a></span></span><span> </span><span id="local-6989586621679144609"><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144609"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679144608"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679144608"><span class="hs-identifier hs-var">arrIdx</span></a></span></span><span> </span><span id="local-6989586621679144607"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144607"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679144606"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144606"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><span class="hs-identifier hs-var">oBoxNewOverMany</span></span><span> </span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144609"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144607"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679144604"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144604"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object s a
-&gt; Getting Double (ObjectData a) Double -&gt; Scene s Double
forall s a b. Object s a -&gt; Getting b (ObjectData a) b -&gt; Scene s b
</span><span class="hs-identifier hs-var">oRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s a]
</span><a href="#local-6989586621679144609"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s a] -&gt; Int -&gt; Object s a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679144608"><span class="hs-identifier hs-var">arrIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Getting Double (ObjectData a) Double
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">Object s Box -&gt; (ObjectData Box -&gt; ObjectData Box) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144606"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData Box -&gt; Identity (ObjectData Box)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData Box -&gt; Identity (ObjectData Box))
-&gt; Double -&gt; ObjectData Box -&gt; ObjectData Box
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144604"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">Object s Box -&gt; Scene s (Object s Box)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144606"><span class="hs-identifier hs-var">box</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621679144775"><span id="local-6989586621679144776"><span class="annot"><a href="TypeCheck.html#oBoxGrowAll"><span class="hs-identifier hs-type">oBoxGrowAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679144776"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Duration</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679144776"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144775"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Box</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144775"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-117"></span><span id="oBoxGrowAll"><span class="annot"><span class="annottext">oBoxGrowAll :: Double -&gt; t (Object s Box) -&gt; Scene s ()
</span><a href="TypeCheck.html#oBoxGrowAll"><span class="hs-identifier hs-var hs-var">oBoxGrowAll</span></a></span></span><span> </span><span id="local-6989586621679144600"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144600"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (t (Object s Box) -&gt; Scene s ())
-&gt; t (Object s Box)
-&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Object s Box -&gt; Scene s ()) -&gt; t (Object s Box) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (Object s Box -&gt; Scene s ()) -&gt; Object s Box -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Object s Box -&gt; Scene s ()
forall s. Double -&gt; Object s Box -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oBoxGrow</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144600"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679144824"><span id="local-6989586621679144825"><span id="local-6989586621679144826"><span class="annot"><a href="TypeCheck.html#oFadeShowAll"><span class="hs-identifier hs-type">oFadeShowAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679144826"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679144826"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144825"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144824"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144825"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-120"></span><span id="oFadeShowAll"><span class="annot"><span class="annottext">oFadeShowAll :: t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeShowAll"><span class="hs-identifier hs-var hs-var">oFadeShowAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (t (Object s a) -&gt; Scene s ()) -&gt; t (Object s a) -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s ()) -&gt; t (Object s a) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (Object s a -&gt; Scene s ()) -&gt; Object s a -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oShowWith`</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeIn</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621679144595"><span id="local-6989586621679144596"><span id="local-6989586621679144597"><span class="annot"><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-type">oFadeHideAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679144597"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679144597"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144595"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144596"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-123"></span><span id="oFadeHideAll"><span class="annot"><span class="annottext">oFadeHideAll :: t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var hs-var">oFadeHideAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (t (Object s a) -&gt; Scene s ()) -&gt; t (Object s a) -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Object s a -&gt; Scene s ()) -&gt; t (Object s a) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (Object s a -&gt; Scene s ()) -&gt; Object s a -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oHideWith`</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oFadeOut</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679144796"><span id="local-6989586621679144797"><span id="local-6989586621679144798"><span class="annot"><a href="TypeCheck.html#oFadePopUp"><span class="hs-identifier hs-type">oFadePopUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679144798"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Duration</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679144798"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144796"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-126"></span><span id="oFadePopUp"><span class="annot"><span class="annottext">oFadePopUp :: Double -&gt; t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadePopUp"><span class="hs-identifier hs-var hs-var">oFadePopUp</span></a></span></span><span> </span><span id="local-6989586621679144590"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144590"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span id="local-6989586621679144589"><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679144589"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">t (Object s a) -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeShowAll"><span class="hs-identifier hs-var">oFadeShowAll</span></a></span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679144589"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144590"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">t (Object s a) -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="annot"><span class="annottext">t (Object s a)
</span><a href="#local-6989586621679144589"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="TypeCheck.html#transColour"><span class="hs-identifier hs-type">transColour</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span>
</span><span id="line-132"></span><span id="transColour"><span class="annot"><span class="annottext">transColour :: Double -&gt; PixelRGBA8 -&gt; SVG -&gt; SVG
</span><a href="TypeCheck.html#transColour"><span class="hs-identifier hs-var hs-var">transColour</span></a></span></span><span> </span><span id="local-6989586621679144586"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144586"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679144585"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144585"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679144584"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679144584"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">mapTree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">withFillColorPixel</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; PixelRGBA8 -&gt; PixelRGBA8 -&gt; PixelRGBA8
forall a. Linear a =&gt; Double -&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">lerp</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144586"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; PixelRGBA8
</span><a href="TypeCheck.html#getFillColour"><span class="hs-identifier hs-var">getFillColour</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679144584"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144585"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679144584"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679144815"><span id="local-6989586621679144816"><span class="annot"><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-type">tweenColour</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Duration</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signal</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144816"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144815"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144816"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-135"></span><span id="tweenColour"><span class="annot"><span class="annottext">tweenColour :: Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var hs-var">tweenColour</span></a></span></span><span> </span><span id="local-6989586621679144581"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144581"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span id="local-6989586621679144580"><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679144580"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679144579"><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679144579"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144578"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144578"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
forall s a.
Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oTween</span></span><span> </span><span class="annot"><span class="annottext">Object s a
</span><a href="#local-6989586621679144579"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144581"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679144577"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144577"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
-&gt; ObjectData a -&gt; Identity (ObjectData a)
forall a. Lens' (ObjectData a) (SVG -&gt; SVG)
</span><span class="hs-identifier hs-var">oContext</span></span><span> </span><span class="annot"><span class="annottext">(((SVG -&gt; SVG) -&gt; Identity (SVG -&gt; SVG))
 -&gt; ObjectData a -&gt; Identity (ObjectData a))
-&gt; (SVG -&gt; SVG) -&gt; ObjectData a -&gt; ObjectData a
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; PixelRGBA8 -&gt; SVG -&gt; SVG
</span><a href="TypeCheck.html#transColour"><span class="hs-identifier hs-var">transColour</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679144580"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144577"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144578"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679144774"><span class="annot"><a href="TypeCheck.html#blink"><span class="hs-identifier hs-type">blink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144774"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SVG</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144774"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span id="blink"><span class="annot"><span class="annottext">blink :: Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var hs-var">blink</span></a></span></span><span> </span><span id="local-6989586621679144575"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679144575"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679144574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679144574"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679144573"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144573"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679144572"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144572"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Scene s () -&gt; Scene s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679144575"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s SVG, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144572"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Scene s () -&gt; Scene s ()
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">replicateM_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679144574"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s SVG, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144572"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s SVG, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144572"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Scene s () -&gt; Scene s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679144575"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s SVG, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679144572"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679144860"><span id="local-6989586621679144861"><span class="annot"><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-type">tweenColours</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144861"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144860"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144861"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-146"></span><span id="tweenColours"><span class="annot"><span class="annottext">tweenColours :: [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var hs-var">tweenColours</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
forall s a.
(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-var">tweenColoursWith</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621679144850"><span id="local-6989586621679144851"><span class="annot"><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-type">tweenColoursWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Signal</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span class="annot"><a href="#local-6989586621679144851"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679144850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Scene</span></span><span> </span><span class="annot"><a href="#local-6989586621679144851"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-149"></span><span id="tweenColoursWith"><span class="annot"><span class="annottext">tweenColoursWith :: (Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-var hs-var">tweenColoursWith</span></a></span></span><span> </span><span id="local-6989586621679144567"><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679144567"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; ([(Object s a, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s a, PixelRGBA8)]
-&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Object s a, PixelRGBA8) -&gt; Scene s ())
-&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; ((Object s a, PixelRGBA8) -&gt; Scene s ())
-&gt; (Object s a, PixelRGBA8)
-&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679144567"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="TypeCheck.html#typeCheckAnim"><span class="hs-identifier hs-type">typeCheckAnim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Animation</span></span><span>
</span><span id="line-152"></span><span id="typeCheckAnim"><span class="annot"><span class="annottext">typeCheckAnim :: Animation
</span><a href="TypeCheck.html#typeCheckAnim"><span class="hs-identifier hs-var hs-var">typeCheckAnim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; Animation -&gt; Animation
</span><span class="hs-identifier hs-var">mapA</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><span class="hs-identifier hs-var">addWhiteBkg</span></span><span> </span><span class="annot"><span class="annottext">(Animation -&gt; Animation) -&gt; Animation -&gt; Animation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall s. Scene s ()) -&gt; Animation
forall a. (forall s. Scene s a) -&gt; Animation
</span><span class="hs-identifier hs-var">scene</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">Scene s ()
forall s. Scene s ()
</span><span class="hs-identifier hs-var">prologue</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- main composition illustration</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">~</span><span id="local-6989586621679144563"><span class="annot"><span class="annottext">tgt :: [Object s SVG]
</span><a href="#local-6989586621679144563"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679144562"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144562"><span class="hs-identifier hs-var">lp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144561"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144561"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144560"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144560"><span class="hs-identifier hs-var">d3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144559"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144559"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144558"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144558"><span class="hs-identifier hs-var">rp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk] -&gt; Scene s [Object s SVG]
forall s. [MathChunk] -&gt; Scene s [Object s SVG]
</span><a href="TypeCheck.html#showMathChunks"><span class="hs-identifier hs-var">showMathChunks</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; . &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">[(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144561"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144559"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144560"><span class="hs-identifier hs-var">d3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var">yellow</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">-- show description for '(.)'</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">~</span><span class="hs-special">[</span><span id="local-6989586621679144557"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144557"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.6</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(f . g)(x) = f(g(x))&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144563"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144557"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-glyph">~</span><span class="hs-special">[</span><span id="local-6989586621679144555"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144555"><span class="hs-identifier hs-var">arrowUp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.6</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;\\uparrow&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oModify</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144555"><span class="hs-identifier hs-var">arrowUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; Double -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; [Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
Double -&gt; t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadePopUp"><span class="hs-identifier hs-var">oFadePopUp</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144555"><span class="hs-identifier hs-var">arrowUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144557"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- infix style -&gt; function style</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">~</span><span id="local-6989586621679144554"><span class="annot"><span class="annottext">expr :: [Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679144553"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144553"><span class="hs-identifier hs-var">lp'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144552"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144552"><span class="hs-identifier hs-var">d3l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144551"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144551"><span class="hs-identifier hs-var">d3'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144550"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144550"><span class="hs-identifier hs-var">d3r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144549"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144549"><span class="hs-identifier hs-var">d1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144548"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144548"><span class="hs-identifier hs-var">d2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144547"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144547"><span class="hs-identifier hs-var">rp'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG]
-&gt; [Trans (Object s SVG) MathChunk] -&gt; Scene s [Object s SVG]
forall t s a.
GroupRender t =&gt;
[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG]
-&gt; [Trans (Object s a) t] -&gt; Scene s [Object s SVG]
</span><span class="hs-identifier hs-var">transformObject'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GroupAlignment
  (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GroupAlignment
  (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">xCentered</span></span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144562"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans (Object s SVG) MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144560"><span class="hs-identifier hs-var">d3</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trans (Object s SVG) MathChunk
</span><span class="hs-string">&quot;)~&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144561"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)~&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144559"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144558"><span class="hs-identifier hs-var">rp</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="annottext">[(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144552"><span class="hs-identifier hs-var">d3l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var">yellow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144550"><span class="hs-identifier hs-var">d3r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var">yellow</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">-- composition move up</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Object s SVG -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Object s SVG -&gt; Scene s ()
forall s a. Double -&gt; Object s a -&gt; Scene s ()
</span><a href="TypeCheck.html#moveVertical"><span class="hs-identifier hs-var">moveVertical</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- show signature yellow, red, blue.</span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621679144542"><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
forall s.
PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
</span><a href="TypeCheck.html#showDotSig"><span class="hs-identifier hs-var">showDotSig</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var">yellow</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xyz&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">xCentered</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679144541"><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
forall s.
PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
</span><a href="TypeCheck.html#showDotSig"><span class="hs-identifier hs-var">showDotSig</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;abc&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">leftAligned</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679144539"><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
forall s.
PixelRGBA8
-&gt; String
-&gt; [[Object s SVG] -&gt; Scene s ()]
-&gt; Scene s [Object s SVG]
</span><a href="TypeCheck.html#showDotSig"><span class="hs-identifier hs-var">showDotSig</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pqr&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">leftAligned</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- all move left, make room for type equations</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Compose [] [] (Object s SVG)
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Object s SVG]] -&gt; Compose [] [] (Object s SVG)
forall k k1 (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Object s SVG -&gt; Scene s ()) -&gt; Scene s ())
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679144537"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144537"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; Double
-&gt; (Double -&gt; ObjectData SVG -&gt; ObjectData SVG)
-&gt; Scene s ()
forall s a.
Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oTween</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679144536"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144536"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (Double -&gt; Double) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144536"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- box '(y -&gt; z)' and '(b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c' with red</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679144534"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144534"><span class="hs-identifier hs-var">byz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall s a.
[Object s a] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-var">oBoxNewOverArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679144530"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144530"><span class="hs-identifier hs-var">bsig2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall s a.
[Object s a] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-var">oBoxNewOverArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; [Object s Box] -&gt; Scene s ()
forall (t :: * -&gt; *) s.
Traversable t =&gt;
Double -&gt; t (Object s Box) -&gt; Scene s ()
</span><a href="TypeCheck.html#oBoxGrowAll"><span class="hs-identifier hs-var">oBoxGrowAll</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144534"><span class="hs-identifier hs-var">byz</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144530"><span class="hs-identifier hs-var">bsig2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">-- new equation 'y = b -&gt; c'</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679144529"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk]
-&gt; [Object s SVG]
-&gt; [MathChunk]
-&gt; [Object s SVG]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
forall a s.
Renderable a =&gt;
[MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var">showEquation</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;b&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;c&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GroupAlignment [] (EquationF s) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (Double -&gt; Double) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">-- new equation 'z = (a -&gt; b) -&gt; a -&gt; c'</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679144528"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk]
-&gt; [Object s SVG]
-&gt; [MathChunk]
-&gt; [Object s SVG]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
forall a s.
Renderable a =&gt;
[MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var">showEquation</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;z&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(a -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;b&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;) -&gt; a -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;c&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall s. Equation s -&gt; Equation s -&gt; Scene s ()
</span><a href="TypeCheck.html#alignEquation"><span class="hs-identifier hs-var">alignEquation</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">-- revert red color on arrows</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">-- box '(x -&gt; y)' and '(q -&gt; r) -&gt; (p -&gt; q) -&gt; p -&gt; r' with blue</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679144527"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144527"><span class="hs-identifier hs-var">bxy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall s a.
[Object s a] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-var">oBoxNewOverArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679144526"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144526"><span class="hs-identifier hs-var">bsig3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall s a.
[Object s a] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-var">oBoxNewOverArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; [Object s Box] -&gt; Scene s ()
forall (t :: * -&gt; *) s.
Traversable t =&gt;
Double -&gt; t (Object s Box) -&gt; Scene s ()
</span><a href="TypeCheck.html#oBoxGrowAll"><span class="hs-identifier hs-var">oBoxGrowAll</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144527"><span class="hs-identifier hs-var">bxy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144526"><span class="hs-identifier hs-var">bsig3</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">-- new equation 'x = q -&gt; r'</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679144525"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk]
-&gt; [Object s SVG]
-&gt; [MathChunk]
-&gt; [Object s SVG]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
forall a s.
Renderable a =&gt;
[MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var">showEquation</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;q -&gt; r&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall s. Equation s -&gt; Equation s -&gt; Scene s ()
</span><a href="TypeCheck.html#alignEquation"><span class="hs-identifier hs-var">alignEquation</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- new equation 'y = (p -&gt; q) -&gt; p -&gt; r'</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679144524"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk]
-&gt; [Object s SVG]
-&gt; [MathChunk]
-&gt; [Object s SVG]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
forall a s.
Renderable a =&gt;
[MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var">showEquation</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;p -&gt; q&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;p -&gt; r&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall s. Equation s -&gt; Equation s -&gt; Scene s ()
</span><a href="TypeCheck.html#alignEquation"><span class="hs-identifier hs-var">alignEquation</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- revert blue color on arrows</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- box 'x -&gt; z' with yellow, show ': x -&gt; z' for title</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679144523"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144523"><span class="hs-identifier hs-var">bxz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall s a.
[Object s a] -&gt; Int -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><a href="TypeCheck.html#oBoxNewOverArrow"><span class="hs-identifier hs-var">oBoxNewOverArrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">14</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var">yellow</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">~</span><span id="local-6989586621679144522"><span class="annot"><span class="annottext">title :: [Object s SVG]
</span><a href="#local-6989586621679144522"><span class="hs-identifier hs-var">title</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679144521"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144521"><span class="hs-identifier hs-var">exprNewPos</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679144520"><span class="annot"><span class="annottext">xz :: [Object s SVG]
</span><a href="#local-6989586621679144520"><span class="hs-identifier hs-var">xz</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">[</span><span id="local-6989586621679144519"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144519"><span class="hs-identifier hs-var">xz_colon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144518"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144518"><span class="hs-identifier hs-var">xz_x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144517"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144517"><span class="hs-identifier hs-var">xz_arr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144516"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144516"><span class="hs-identifier hs-var">xz_z</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;((.)~(.)~(.))&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;z&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="annottext">[GroupAlignment [] [] s SVG SVG] -&gt; GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
[GroupAlignment t t' s a b] -&gt; GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">applyAlignment</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144522"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Object s Box -&gt; Scene s ()
forall s. Double -&gt; Object s Box -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oBoxGrow</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144523"><span class="hs-identifier hs-var">bxz</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">[Trans (Object s SVG) [Object s SVG]] -&gt; Scene s ()
forall s a b. [Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><span class="hs-identifier hs-var">transformObject</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144521"><span class="hs-identifier hs-var">exprNewPos</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Scene s ()
forall s a. Object s a -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oShow</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Scene s ()
forall s a. Object s a -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oHide</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144521"><span class="hs-identifier hs-var">exprNewPos</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144520"><span class="hs-identifier hs-var">xz</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679144511"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144511"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s () -&gt; Scene s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
forall s a. Object s a -&gt; (SVG -&gt; Animation) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oShowWith</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144511"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; Animation
</span><span class="hs-identifier hs-var">oDraw</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">-- hide all boxes</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">[Object s Box] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144527"><span class="hs-identifier hs-var">bxy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144534"><span class="hs-identifier hs-var">byz</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144530"><span class="hs-identifier hs-var">bsig2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144526"><span class="hs-identifier hs-var">bsig3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144523"><span class="hs-identifier hs-var">bxz</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">-- move left, remove color in title, and hide dot-signatures</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a.
(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-var">tweenColoursWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Object s SVG, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; (Object s SVG, PixelRGBA8))
-&gt; [Object s SVG] -&gt; [(Object s SVG, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#yellow"><span class="hs-identifier hs-var">yellow</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; ([Object s SVG] -&gt; [Object s SVG]) -&gt; [Object s SVG]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s SVG, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; (Double -&gt; Double) -&gt; (Object s SVG, PixelRGBA8) -&gt; Scene s ()
forall s a.
Double
-&gt; (Double -&gt; Double) -&gt; (Object s a, PixelRGBA8) -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColour"><span class="hs-identifier hs-var">tweenColour</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Compose [] [] (Object s SVG) -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Object s SVG]] -&gt; Compose [] [] (Object s SVG)
forall k k1 (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">Product (Compose [] []) (Compose [] (EquationF s)) (Object s SVG)
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Object s SVG]] -&gt; Compose [] [] (Object s SVG)
forall k k1 (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144542"><span class="hs-identifier hs-var">sig1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144541"><span class="hs-identifier hs-var">sig2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144539"><span class="hs-identifier hs-var">sig3</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Compose [] [] (Object s SVG)
-&gt; Compose [] (EquationF s) (Object s SVG)
-&gt; Product
     (Compose [] []) (Compose [] (EquationF s)) (Object s SVG)
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-operator hs-var">`Pair`</span></span><span> </span><span class="annot"><span class="annottext">[Equation s] -&gt; Compose [] (EquationF s) (Object s SVG)
forall k k1 (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679144508"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144508"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; Double
-&gt; (Double -&gt; ObjectData SVG -&gt; ObjectData SVG)
-&gt; Scene s ()
forall s a.
Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oTween</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144508"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679144507"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144507"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (Double -&gt; Double) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144507"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">-- title back to infix notation</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">~</span><span class="hs-special">[</span><span id="local-6989586621679144506"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144506"><span class="hs-identifier hs-var">lp''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144505"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144505"><span class="hs-identifier hs-var">d1''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144504"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144504"><span class="hs-identifier hs-var">d3''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144503"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144503"><span class="hs-identifier hs-var">d2''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144502"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144502"><span class="hs-identifier hs-var">rp''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679144501"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144501"><span class="hs-identifier hs-var">xz'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(.)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;: x -&gt; z&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679144500"><span class="annot"><span class="annottext">expr' :: [Object s SVG]
</span><a href="#local-6989586621679144500"><span class="hs-identifier hs-var hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144506"><span class="hs-identifier hs-var">lp''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144505"><span class="hs-identifier hs-var">d1''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144504"><span class="hs-identifier hs-var">d3''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144503"><span class="hs-identifier hs-var">d2''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144502"><span class="hs-identifier hs-var">rp''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144554"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144501"><span class="hs-identifier hs-var">xz'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144500"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">[Trans (Object s SVG) [Object s SVG]] -&gt; Scene s ()
forall s a b. [Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><span class="hs-identifier hs-var">transformObject</span></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144553"><span class="hs-identifier hs-var">lp'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144506"><span class="hs-identifier hs-var">lp''</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; Trans a b
</span><span class="hs-identifier hs-var">Vanish</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144552"><span class="hs-identifier hs-var">d3l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144551"><span class="hs-identifier hs-var">d3'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144504"><span class="hs-identifier hs-var">d3''</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; Trans a b
</span><span class="hs-identifier hs-var">Vanish</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144550"><span class="hs-identifier hs-var">d3r</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144549"><span class="hs-identifier hs-var">d1'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144505"><span class="hs-identifier hs-var">d1''</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144548"><span class="hs-identifier hs-var">d2'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144503"><span class="hs-identifier hs-var">d2''</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144547"><span class="hs-identifier hs-var">rp'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144502"><span class="hs-identifier hs-var">rp''</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144520"><span class="hs-identifier hs-var">xz</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144501"><span class="hs-identifier hs-var">xz'</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Scene s ()
forall s a. Object s a -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oShow</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144520"><span class="hs-identifier hs-var">xz</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Scene s ()
forall s a. Object s a -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oHide</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144501"><span class="hs-identifier hs-var">xz'</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">-- wiggle 'y' in eq1 &amp; eq4</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oWiggle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oWiggle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-comment">-- box rhs of eq1 &amp; eq4</span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679144497"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144497"><span class="hs-identifier hs-var">beq1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><span class="hs-identifier hs-var">oBoxNewOverMany</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679144496"><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144496"><span class="hs-identifier hs-var">beq4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; PixelRGBA8 -&gt; Scene s (Object s Box)
</span><span class="hs-identifier hs-var">oBoxNewOverMany</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; [Object s Box] -&gt; Scene s ()
forall (t :: * -&gt; *) s.
Traversable t =&gt;
Double -&gt; t (Object s Box) -&gt; Scene s ()
</span><a href="TypeCheck.html#oBoxGrowAll"><span class="hs-identifier hs-var">oBoxGrowAll</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144497"><span class="hs-identifier hs-var">beq1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144496"><span class="hs-identifier hs-var">beq4</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- new equation 'b = p -&gt; q'</span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679144495"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk]
-&gt; [Object s SVG]
-&gt; [MathChunk]
-&gt; [Object s SVG]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
forall a s.
Renderable a =&gt;
[MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var">showEquation</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;b&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Object s SVG
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;p -&gt; q&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG -&gt; (ObjectData SVG -&gt; ObjectData SVG) -&gt; Scene s ()
forall s a.
Object s a -&gt; (ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-operator hs-var">`oModify`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateX</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (Double -&gt; Double) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-comment">-- new equation 'c = p -&gt; r'</span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679144493"><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144493"><span class="hs-identifier hs-var">eq6</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MathChunk]
-&gt; [Object s SVG]
-&gt; [MathChunk]
-&gt; [Object s SVG]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
forall a s.
Renderable a =&gt;
[MathChunk]
-&gt; [Object s a]
-&gt; [MathChunk]
-&gt; [Object s a]
-&gt; [Equation s -&gt; Scene s ()]
-&gt; Scene s (Equation s)
</span><a href="TypeCheck.html#showEquation"><span class="hs-identifier hs-var">showEquation</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;c&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;p -&gt; r&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall s. Equation s -&gt; Equation s -&gt; Scene s ()
</span><a href="TypeCheck.html#alignEquation"><span class="hs-identifier hs-var">alignEquation</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; Equation s -&gt; Scene s ()
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">placedBelow</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">-- revert color on arrows &amp; hide box</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s Box] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144497"><span class="hs-identifier hs-var">beq1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s Box
</span><a href="#local-6989586621679144496"><span class="hs-identifier hs-var">beq4</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- hide eq1 &amp; eq4 (no longer needed)</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">Product (EquationF s) (EquationF s) (Object s SVG) -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144529"><span class="hs-identifier hs-var">eq1</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
-&gt; Equation s -&gt; Product (EquationF s) (EquationF s) (Object s SVG)
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-operator hs-var">`Pair`</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144524"><span class="hs-identifier hs-var">eq4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Product (EquationF s) (EquationF s) (Object s SVG)
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
-&gt; Equation s -&gt; Product (EquationF s) (EquationF s) (Object s SVG)
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-operator hs-var">`Pair`</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679144492"><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144492"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; Double
-&gt; (Double -&gt; ObjectData SVG -&gt; ObjectData SVG)
-&gt; Scene s ()
forall s a.
Object s a
-&gt; Double -&gt; (Double -&gt; ObjectData a -&gt; ObjectData a) -&gt; Scene s ()
</span><span class="hs-identifier hs-var">oTween</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144492"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679144491"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144491"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Identity Double)
-&gt; ObjectData SVG -&gt; Identity (ObjectData SVG)
forall a. Lens' (ObjectData a) Double
</span><span class="hs-identifier hs-var">oTranslateY</span></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Identity Double)
 -&gt; ObjectData SVG -&gt; Identity (ObjectData SVG))
-&gt; (Double -&gt; Double) -&gt; ObjectData SVG -&gt; ObjectData SVG
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679144491"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- highlight rhs of eq5 &amp; eq6, highlight b &amp; c</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679144490"><span class="annot"><span class="annottext">eq2Rhs :: [Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var hs-var">eq2Rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span> </span><span class="annot"><span class="annottext">([(Object s SVG, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; (Object s SVG, PixelRGBA8))
-&gt; [Object s SVG] -&gt; [(Object s SVG, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var">eq2Rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span> </span><span class="annot"><span class="annottext">([(Object s SVG, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; (Object s SVG, PixelRGBA8))
-&gt; [Object s SVG] -&gt; [(Object s SVG, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var">eq2Rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144493"><span class="hs-identifier hs-var">eq6</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-comment">-- substitute b &amp; c into eq2</span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679144489"><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144489"><span class="hs-identifier hs-var">eq2Rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Scene s [Object s SVG] -&gt; Scene s [Object s SVG]
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="annot"><span class="annottext">([Object s SVG] -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">Equation s -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144493"><span class="hs-identifier hs-var">eq6</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144493"><span class="hs-identifier hs-var">eq6</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">Scene s [Object s SVG] -&gt; Scene s [Object s SVG]
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s [Object s SVG] -&gt; Scene s [Object s SVG])
-&gt; Scene s [Object s SVG] -&gt; Scene s [Object s SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG]
-&gt; [Trans (Object s SVG) MathChunk] -&gt; Scene s [Object s SVG]
forall t s a.
GroupRender t =&gt;
[GroupAlignment
   (Compose [] []) (Compose [] (Trans (Object s a))) s a SVG]
-&gt; [Trans (Object s a) t] -&gt; Scene s [Object s SVG]
</span><span class="hs-identifier hs-var">transformObject'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
-&gt; GroupAlignment
     (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
Double -&gt; GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">withMargin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
-&gt; GroupAlignment
     (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
Double -&gt; GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">scaled</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GroupAlignment
  (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">leftAligned</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Compose [] (Trans (Object s SVG)) (Object s SVG) -&gt; Scene s ())
-&gt; GroupAlignment
     (Compose [] []) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GroupAlignment
  (EquationF s) (Compose [] (Trans (Object s SVG))) s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Object s SVG
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var">eq2Rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(a -&gt; &quot;</span></span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;p -&gt; q&quot;</span></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var">eq2Rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;) -&gt; a -&gt; &quot;</span></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144493"><span class="hs-identifier hs-var">eq6</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; MathChunk -&gt; Trans (Object s SVG) MathChunk
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;p -&gt; r&quot;</span></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; Trans a b
</span><span class="hs-identifier hs-var">Vanish</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var">eq2Rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; Trans (Object s SVG) MathChunk
forall a b. a -&gt; Trans a b
</span><span class="hs-identifier hs-var">Vanish</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144490"><span class="hs-identifier hs-var">eq2Rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679144486"><span class="annot"><span class="annottext">eq2' :: EquationF s (Object s SVG)
</span><a href="#local-6989586621679144486"><span class="hs-identifier hs-var hs-var">eq2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144528"><span class="hs-identifier hs-var">eq2</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">equationRhs :: [Object s SVG]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var">equationRhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144489"><span class="hs-identifier hs-var">eq2Rhs'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="annottext">Product (EquationF s) (EquationF s) (Object s SVG) -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144495"><span class="hs-identifier hs-var">eq5</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
-&gt; Equation s -&gt; Product (EquationF s) (EquationF s) (Object s SVG)
forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-operator hs-var">`Pair`</span></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144493"><span class="hs-identifier hs-var">eq6</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-comment">-- revert color on 'p -&gt; q' &amp; 'p -&gt; r' back to black</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144489"><span class="hs-identifier hs-var">eq2Rhs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
forall s. Bool -&gt; Int -&gt; Object s SVG -&gt; PixelRGBA8 -&gt; Scene s ()
</span><a href="TypeCheck.html#blink"><span class="hs-identifier hs-var">blink</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144489"><span class="hs-identifier hs-var">eq2Rhs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-comment">-- highlight rhs of eq2 &amp; eq3, highlight z &amp; x in title</span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span> </span><span class="annot"><span class="annottext">([(Object s SVG, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; (Object s SVG, PixelRGBA8))
-&gt; [Object s SVG] -&gt; [(Object s SVG, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144516"><span class="hs-identifier hs-var">xz_z</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG) -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG)
forall s. EquationF s (Object s SVG)
</span><a href="#local-6989586621679144486"><span class="hs-identifier hs-var">eq2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a. [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColours"><span class="hs-identifier hs-var">tweenColours</span></a></span><span> </span><span class="annot"><span class="annottext">([(Object s SVG, PixelRGBA8)] -&gt; Scene s ())
-&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; (Object s SVG, PixelRGBA8))
-&gt; [Object s SVG] -&gt; [(Object s SVG, PixelRGBA8)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144518"><span class="hs-identifier hs-var">xz_x</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-comment">-- substitute z &amp; x into title</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679144485"><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; [MathChunk] -&gt; Scene s [Object s SVG]
forall a (t :: * -&gt; *) s.
(Traversable t, GroupRender a) =&gt;
Double -&gt; t a -&gt; Scene s (t (Object s SVG))
</span><span class="hs-identifier hs-var">oNewGroupScaled</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">MathChunk</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;((.) . (.))&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;q -&gt; r&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MathChunk
</span><span class="hs-string">&quot;(a -&gt; p -&gt; q) -&gt; a -&gt; p -&gt; r&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">GroupAlignment [] [] s SVG SVG
forall (t :: * -&gt; *) (t' :: * -&gt; *) s a b.
(Traversable t, Traversable t') =&gt;
GroupAlignment t t' s a b
</span><span class="hs-identifier hs-var">yCentered</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144522"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144518"><span class="hs-identifier hs-var">xz_x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144516"><span class="hs-identifier hs-var">xz_z</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="annot"><span class="annottext">([Object s SVG] -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG) -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG)
forall s. EquationF s (Object s SVG)
</span><a href="#local-6989586621679144486"><span class="hs-identifier hs-var">eq2'</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; Object s SVG
forall s a. EquationF s a -&gt; a
</span><a href="TypeCheck.html#equalSign"><span class="hs-identifier hs-var hs-var">equalSign</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG) -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG)
forall s. EquationF s (Object s SVG)
</span><a href="#local-6989586621679144486"><span class="hs-identifier hs-var">eq2'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; [Object s SVG] -&gt; [Object s SVG]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationLhs"><span class="hs-identifier hs-var hs-var">equationLhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Trans (Object s SVG) [Object s SVG]] -&gt; Scene s ()
forall s a b. [Trans (Object s a) [Object s b]] -&gt; Scene s ()
</span><span class="hs-identifier hs-var">transformObject</span></span><span>
</span><span id="line-325"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144500"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Object s SVG
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144519"><span class="hs-identifier hs-var">xz_colon</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Equation s -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Equation s
</span><a href="#local-6989586621679144525"><span class="hs-identifier hs-var">eq3</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object s SVG
</span><a href="#local-6989586621679144517"><span class="hs-identifier hs-var">xz_arr</span></a></span><span> </span><span class="annot"><span class="annottext">Object s SVG
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. a -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">:=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG) -&gt; [Object s SVG]
forall s a. EquationF s a -&gt; [a]
</span><a href="TypeCheck.html#equationRhs"><span class="hs-identifier hs-var hs-var">equationRhs</span></a></span><span> </span><span class="annot"><span class="annottext">EquationF Any (Object s SVG)
forall s. EquationF s (Object s SVG)
</span><a href="#local-6989586621679144486"><span class="hs-identifier hs-var">eq2'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
-&gt; [Object s SVG] -&gt; Trans (Object s SVG) [Object s SVG]
forall a b. [a] -&gt; b -&gt; Trans a b
</span><span class="hs-operator hs-var">::=&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeShowAll"><span class="hs-identifier hs-var">oFadeShowAll</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; [(Object s SVG, PixelRGBA8)] -&gt; Scene s ()
forall s a.
(Double -&gt; Double) -&gt; [(Object s a, PixelRGBA8)] -&gt; Scene s ()
</span><a href="TypeCheck.html#tweenColoursWith"><span class="hs-identifier hs-var">tweenColoursWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#red"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Int -&gt; Object s SVG
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
forall c. FromRGBA8 c =&gt; c
</span><a href="TypeCheck.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-comment">-- move title back down</span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">waitOn</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ()) -&gt; Scene s () -&gt; Scene s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Object s SVG -&gt; Scene s ()) -&gt; [Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Scene s () -&gt; Scene s ()
forall s a. Scene s a -&gt; Scene s a
</span><span class="hs-identifier hs-var">fork</span></span><span> </span><span class="annot"><span class="annottext">(Scene s () -&gt; Scene s ())
-&gt; (Object s SVG -&gt; Scene s ()) -&gt; Object s SVG -&gt; Scene s ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Object s SVG -&gt; Scene s ()
forall s a. Double -&gt; Object s a -&gt; Scene s ()
</span><a href="TypeCheck.html#moveVertical"><span class="hs-identifier hs-var">moveVertical</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-comment">-- hide everything</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><span class="annottext">[Object s SVG] -&gt; Scene s ()
forall (t :: * -&gt; *) s a.
Traversable t =&gt;
t (Object s a) -&gt; Scene s ()
</span><a href="TypeCheck.html#oFadeHideAll"><span class="hs-identifier hs-var">oFadeHideAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Object s SVG]
</span><a href="#local-6989586621679144485"><span class="hs-identifier hs-var">title'</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Scene s ()
forall s. Double -&gt; Scene s ()
</span><span class="hs-identifier hs-var">wait</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-340"></span></pre></body></html>