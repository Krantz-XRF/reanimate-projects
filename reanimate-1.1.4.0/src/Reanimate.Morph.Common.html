<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TupleSections   #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE UnicodeSyntax   #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">{-|
Copyright   : Written by David Himmelstrup
License     : Unlicense
Maintainer  : lemmih@gmail.com
Stability   : experimental
Portability : POSIX
-}</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reanimate.Morph.Common</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#PointCorrespondence"><span class="hs-identifier">PointCorrespondence</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#Trajectory"><span class="hs-identifier">Trajectory</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#ObjectCorrespondence"><span class="hs-identifier">ObjectCorrespondence</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#Morph"><span class="hs-identifier">Morph</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#morph"><span class="hs-identifier">morph</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#splitObjectCorrespondence"><span class="hs-identifier">splitObjectCorrespondence</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#dupObjectCorrespondence"><span class="hs-identifier">dupObjectCorrespondence</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#genesisObjectCorrespondence"><span class="hs-identifier">genesisObjectCorrespondence</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier">toShapes</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#normalizePolygons"><span class="hs-identifier">normalizePolygons</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#annotatePolygons"><span class="hs-identifier">annotatePolygons</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#unsafeSVGToPolygon"><span class="hs-identifier">unsafeSVGToPolygon</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Graphics.SvgTree</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DrawAttributes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Texture</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>                                            </span><span class="annot"><span class="hs-identifier">drawAttributes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fillColor</span></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                                            </span><span class="annot"><span class="hs-identifier">fillOpacity</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">groupOpacity</span></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>                                            </span><span class="annot"><span class="hs-identifier">strokeColor</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">strokeOpacity</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Linear.V2</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Animation.html"><span class="hs-identifier">Reanimate.Animation</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.ColorComponents.html"><span class="hs-identifier">Reanimate.ColorComponents</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Ease.html"><span class="hs-identifier">Reanimate.Ease</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Math.Polygon.html"><span class="hs-identifier">Reanimate.Math.Polygon</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier">APolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Epsilon</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier">Polygon</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>                                            </span><span class="annot"><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier">mkPolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPoints"><span class="hs-identifier">pAddPoints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCentroid"><span class="hs-identifier">pCentroid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>                                            </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCutEqual"><span class="hs-identifier">pCutEqual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier">pSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier">polygonPoints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.PolyShape.html"><span class="hs-identifier">Reanimate.PolyShape</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Svg.html"><span class="hs-identifier">Reanimate.Svg</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- import Debug.Trace</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- Correspondence</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- Trajectory</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- Color interpolation</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Polygon holes</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- Polygon splitting</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- Graphical polygon? FIXME: Come up with a better name.</span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="GPolygon"><span class="annot"><a href="Reanimate.Morph.Common.html#GPolygon"><span class="hs-identifier hs-var">GPolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DrawAttributes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Method determining how points in the source polygon align with</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   points in the target polygon.</span><span>
</span><span id="line-55"></span><span class="hs-keyword">type</span><span> </span><span id="PointCorrespondence"><span class="annot"><a href="Reanimate.Morph.Common.html#PointCorrespondence"><span class="hs-identifier hs-var">PointCorrespondence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Method for interpolating between two aligned polygons.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">type</span><span> </span><span id="Trajectory"><span class="annot"><a href="Reanimate.Morph.Common.html#Trajectory"><span class="hs-identifier hs-var">Trajectory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Method for pairing sets of polygons.</span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="ObjectCorrespondence"><span class="annot"><a href="Reanimate.Morph.Common.html#ObjectCorrespondence"><span class="hs-identifier hs-var">ObjectCorrespondence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Morph.Common.html#GPolygon"><span class="hs-identifier hs-type">GPolygon</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Morph.Common.html#GPolygon"><span class="hs-identifier hs-type">GPolygon</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&#8594;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Morph.Common.html#GPolygon"><span class="hs-identifier hs-type">GPolygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#GPolygon"><span class="hs-identifier hs-type">GPolygon</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Morphing strategy</span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="Morph"><span class="annot"><a href="Reanimate.Morph.Common.html#Morph"><span class="hs-identifier hs-var">Morph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Morph"><span class="annot"><a href="Reanimate.Morph.Common.html#Morph"><span class="hs-identifier hs-var">Morph</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="morphTolerance"><span class="annot"><span class="annottext">Morph -&gt; Double
</span><a href="Reanimate.Morph.Common.html#morphTolerance"><span class="hs-identifier hs-var hs-var">morphTolerance</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- ^ Morphing curves is not always possible and</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">--   sometimes shapes are reduced to polygons or meta-curves.</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">--   This parameter determined the accuracy of this transformation.</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="morphColorComponents"><span class="annot"><span class="annottext">Morph -&gt; ColorComponents
</span><a href="Reanimate.Morph.Common.html#morphColorComponents"><span class="hs-identifier hs-var hs-var">morphColorComponents</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.ColorComponents.html#ColorComponents"><span class="hs-identifier hs-type">ColorComponents</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- ^ Color components used for color interpolation. LAB is usually</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">--   the best option here.</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="morphPointCorrespondence"><span class="annot"><span class="annottext">Morph -&gt; PointCorrespondence
</span><a href="Reanimate.Morph.Common.html#morphPointCorrespondence"><span class="hs-identifier hs-var hs-var">morphPointCorrespondence</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#PointCorrespondence"><span class="hs-identifier hs-type">PointCorrespondence</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- ^ Desired point-correspondence algorithm.</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="morphTrajectory"><span class="annot"><span class="annottext">Morph -&gt; Trajectory
</span><a href="Reanimate.Morph.Common.html#morphTrajectory"><span class="hs-identifier hs-var hs-var">morphTrajectory</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#Trajectory"><span class="hs-identifier hs-type">Trajectory</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- ^ Desired interpolation algorithm.</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="morphObjectCorrespondence"><span class="annot"><span class="annottext">Morph -&gt; ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#morphObjectCorrespondence"><span class="hs-identifier hs-var hs-var">morphObjectCorrespondence</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#ObjectCorrespondence"><span class="hs-identifier hs-type">ObjectCorrespondence</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">-- ^ Desired object-correspondence algorithm.</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#morph"><span class="hs-pragma hs-type">morph</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Apply morphing strategy to interpolate between two SVG images.</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Reanimate.Morph.Common.html#morph"><span class="hs-identifier hs-type">morph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#Morph"><span class="hs-identifier hs-type">Morph</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-83"></span><span id="morph"><span class="annot"><span class="annottext">morph :: Morph -&gt; SVG -&gt; SVG -&gt; Double -&gt; SVG
</span><a href="Reanimate.Morph.Common.html#morph"><span class="hs-identifier hs-var hs-var">morph</span></a></span></span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#Morph"><span class="hs-identifier hs-type">Morph</span></a></span><span class="hs-special">{</span><span id="local-6989586621679545494"><span id="local-6989586621679545495"><span id="local-6989586621679545496"><span id="local-6989586621679545497"><span id="local-6989586621679545498"><span class="annot"><span class="annottext">Double
ColorComponents
ObjectCorrespondence
Trajectory
PointCorrespondence
morphObjectCorrespondence :: ObjectCorrespondence
morphTrajectory :: Trajectory
morphPointCorrespondence :: PointCorrespondence
morphColorComponents :: ColorComponents
morphTolerance :: Double
morphObjectCorrespondence :: Morph -&gt; ObjectCorrespondence
morphTrajectory :: Morph -&gt; Trajectory
morphPointCorrespondence :: Morph -&gt; PointCorrespondence
morphColorComponents :: Morph -&gt; ColorComponents
morphTolerance :: Morph -&gt; Double
</span><a href="#local-6989586621679545494"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679545493"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545493"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679545492"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545492"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679545491"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545491"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545491"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#lowerTransformations"><span class="hs-identifier hs-var">lowerTransformations</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545493"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#lowerTransformations"><span class="hs-identifier hs-var">lowerTransformations</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545492"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span>
</span><span id="line-88"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">APolygon Rational -&gt; SVG
forall a. Real a =&gt; APolygon a -&gt; SVG
</span><a href="#local-6989586621679545488"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; APolygon Rational
</span><a href="#local-6989586621679545487"><span class="hs-identifier hs-var">genPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545491"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>              </span><span class="annot"><span class="annottext">SVG -&gt; (SVG -&gt; SVG) -&gt; SVG
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes) -&gt; SVG -&gt; Identity SVG
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; SVG -&gt; Identity SVG)
-&gt; DrawAttributes -&gt; SVG -&gt; SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; DrawAttributes
</span><a href="#local-6989586621679545484"><span class="hs-identifier hs-var">genAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545491"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-90"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679545484"><span class="annot"><span class="annottext">Double -&gt; DrawAttributes
</span><a href="#local-6989586621679545484"><span class="hs-identifier hs-var">genAttrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545487"><span class="annot"><span class="annottext">Double -&gt; APolygon Rational
</span><a href="#local-6989586621679545487"><span class="hs-identifier hs-var">genPoints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double -&gt; DrawAttributes, Double -&gt; APolygon Rational)]
</span><a href="#local-6989586621679545483"><span class="hs-identifier hs-var">gens</span></a></span><span>
</span><span id="line-91"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679545488"><span class="annot"><span class="annottext">render :: APolygon a -&gt; SVG
</span><a href="#local-6989586621679545488"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679545482"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545482"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkLinePathClosed"><span class="hs-identifier hs-var">mkLinePathClosed</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545480"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545479"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679545480"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545480"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679545479"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545479"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(V2 a -&gt; V2 Double) -&gt; [V2 a] -&gt; [V2 Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Double) -&gt; V2 a -&gt; V2 Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; [V2 Double]) -&gt; [V2 a] -&gt; [V2 Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; [V2 a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; [V2 a]) -&gt; Vector (V2 a) -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545482"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679545476"><span class="annot"><span class="annottext">srcShapes :: [(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545476"><span class="hs-identifier hs-var hs-var">srcShapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SVG -&gt; [(DrawAttributes, APolygon Rational)]
</span><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier hs-var">toShapes</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545498"><span class="hs-identifier hs-var">morphTolerance</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545493"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621679545475"><span class="annot"><span class="annottext">dstShapes :: [(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545475"><span class="hs-identifier hs-var hs-var">dstShapes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SVG -&gt; [(DrawAttributes, APolygon Rational)]
</span><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier hs-var">toShapes</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545498"><span class="hs-identifier hs-var">morphTolerance</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545492"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679545474"><span class="annot"><span class="annottext">pairs :: [((DrawAttributes, APolygon Rational),
  (DrawAttributes, APolygon Rational))]
</span><a href="#local-6989586621679545474"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="#local-6989586621679545494"><span class="hs-identifier hs-var">morphObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545476"><span class="hs-identifier hs-var">srcShapes</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545475"><span class="hs-identifier hs-var">dstShapes</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679545483"><span class="annot"><span class="annottext">gens :: [(Double -&gt; DrawAttributes, Double -&gt; APolygon Rational)]
</span><a href="#local-6989586621679545483"><span class="hs-identifier hs-var hs-var">gens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColorComponents
-&gt; DrawAttributes -&gt; DrawAttributes -&gt; Double -&gt; DrawAttributes
</span><a href="Reanimate.Morph.Common.html#interpolateAttrs"><span class="hs-identifier hs-var">interpolateAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">ColorComponents
</span><a href="#local-6989586621679545497"><span class="hs-identifier hs-var">morphColorComponents</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545472"><span class="hs-identifier hs-var">srcAttr</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545471"><span class="hs-identifier hs-var">dstAttr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Trajectory
</span><a href="#local-6989586621679545495"><span class="hs-identifier hs-var">morphTrajectory</span></a></span><span> </span><span class="annot"><span class="annottext">(APolygon Rational, APolygon Rational)
</span><a href="#local-6989586621679545470"><span class="hs-identifier hs-var">arranged</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679545472"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545472"><span class="hs-identifier hs-var">srcAttr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545469"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545469"><span class="hs-identifier hs-var">srcPoly'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679545471"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545471"><span class="hs-identifier hs-var">dstAttr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545468"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545468"><span class="hs-identifier hs-var">dstPoly'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((DrawAttributes, APolygon Rational),
  (DrawAttributes, APolygon Rational))]
</span><a href="#local-6989586621679545474"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679545470"><span class="annot"><span class="annottext">arranged :: (APolygon Rational, APolygon Rational)
</span><a href="#local-6989586621679545470"><span class="hs-identifier hs-var hs-var">arranged</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PointCorrespondence
</span><a href="#local-6989586621679545496"><span class="hs-identifier hs-var">morphPointCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545469"><span class="hs-identifier hs-var">srcPoly'</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545468"><span class="hs-identifier hs-var">dstPoly'</span></a></span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Add points to each polygon such that they end up with same size.</span><span>
</span><span id="line-105"></span><span id="local-6989586621679545467"><span class="annot"><a href="Reanimate.Morph.Common.html#normalizePolygons"><span class="hs-identifier hs-type">normalizePolygons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Epsilon</span></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679545467"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-106"></span><span id="normalizePolygons"><span class="annot"><span class="annottext">normalizePolygons :: APolygon a -&gt; APolygon a -&gt; (APolygon a, APolygon a)
</span><a href="Reanimate.Morph.Common.html#normalizePolygons"><span class="hs-identifier hs-var hs-var">normalizePolygons</span></a></span></span><span> </span><span id="local-6989586621679545466"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545466"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679545465"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545465"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; APolygon a -&gt; APolygon a
forall a. PolyCtx a =&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPoints"><span class="hs-identifier hs-var">pAddPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545463"><span class="hs-identifier hs-var">dstN</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545462"><span class="hs-identifier hs-var">srcN</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545466"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; APolygon a -&gt; APolygon a
forall a. PolyCtx a =&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPoints"><span class="hs-identifier hs-var">pAddPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545462"><span class="hs-identifier hs-var">srcN</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545463"><span class="hs-identifier hs-var">dstN</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545465"><span class="hs-identifier hs-var">dst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679545462"><span class="annot"><span class="annottext">srcN :: Int
</span><a href="#local-6989586621679545462"><span class="hs-identifier hs-var hs-var">srcN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545466"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679545463"><span class="annot"><span class="annottext">dstN :: Int
</span><a href="#local-6989586621679545463"><span class="hs-identifier hs-var hs-var">dstN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545465"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Reanimate.Morph.Common.html#interpolateAttrs"><span class="hs-identifier hs-type">interpolateAttrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.ColorComponents.html#ColorComponents"><span class="hs-identifier hs-type">ColorComponents</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DrawAttributes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DrawAttributes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DrawAttributes</span></span><span>
</span><span id="line-114"></span><span id="interpolateAttrs"><span class="annot"><span class="annottext">interpolateAttrs :: ColorComponents
-&gt; DrawAttributes -&gt; DrawAttributes -&gt; Double -&gt; DrawAttributes
</span><a href="Reanimate.Morph.Common.html#interpolateAttrs"><span class="hs-identifier hs-var hs-var">interpolateAttrs</span></a></span></span><span> </span><span id="local-6989586621679545461"><span class="annot"><span class="annottext">ColorComponents
</span><a href="#local-6989586621679545461"><span class="hs-identifier hs-var">colorComps</span></a></span></span><span> </span><span id="local-6989586621679545460"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679545459"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545459"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span id="local-6989586621679545458"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545458"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
-&gt; (DrawAttributes -&gt; DrawAttributes) -&gt; DrawAttributes
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Texture -&gt; Identity (Maybe Texture))
-&gt; DrawAttributes -&gt; Identity DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">fillColor</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Texture -&gt; Identity (Maybe Texture))
 -&gt; DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Maybe Texture -&gt; DrawAttributes -&gt; DrawAttributes
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Texture -&gt; Texture -&gt; Texture
</span><a href="#local-6989586621679545457"><span class="hs-identifier hs-var">interpColor</span></a></span><span> </span><span class="annot"><span class="annottext">(Texture -&gt; Texture -&gt; Texture)
-&gt; Maybe Texture -&gt; Maybe (Texture -&gt; Texture)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Texture) DrawAttributes (Maybe Texture)
-&gt; Maybe Texture
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Texture) DrawAttributes (Maybe Texture)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">fillColor</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Texture -&gt; Texture) -&gt; Maybe Texture -&gt; Maybe Texture
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545459"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Texture) DrawAttributes (Maybe Texture)
-&gt; Maybe Texture
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Texture) DrawAttributes (Maybe Texture)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">fillColor</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><span class="annottext">DrawAttributes
-&gt; (DrawAttributes -&gt; DrawAttributes) -&gt; DrawAttributes
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Texture -&gt; Identity (Maybe Texture))
-&gt; DrawAttributes -&gt; Identity DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">strokeColor</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Texture -&gt; Identity (Maybe Texture))
 -&gt; DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Maybe Texture -&gt; DrawAttributes -&gt; DrawAttributes
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Texture -&gt; Texture -&gt; Texture
</span><a href="#local-6989586621679545457"><span class="hs-identifier hs-var">interpColor</span></a></span><span> </span><span class="annot"><span class="annottext">(Texture -&gt; Texture -&gt; Texture)
-&gt; Maybe Texture -&gt; Maybe (Texture -&gt; Texture)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Texture) DrawAttributes (Maybe Texture)
-&gt; Maybe Texture
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Texture) DrawAttributes (Maybe Texture)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">strokeColor</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Texture -&gt; Texture) -&gt; Maybe Texture -&gt; Maybe Texture
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545459"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Texture) DrawAttributes (Maybe Texture)
-&gt; Maybe Texture
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Texture) DrawAttributes (Maybe Texture)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Texture)
</span><span class="hs-identifier hs-var">strokeColor</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="annottext">DrawAttributes
-&gt; (DrawAttributes -&gt; DrawAttributes) -&gt; DrawAttributes
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Float -&gt; Identity (Maybe Float))
-&gt; DrawAttributes -&gt; Identity DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">fillOpacity</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Float -&gt; Identity (Maybe Float))
 -&gt; DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Maybe Float -&gt; DrawAttributes -&gt; DrawAttributes
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall b a a. (Fractional b, Real a, Real a) =&gt; a -&gt; a -&gt; b
</span><a href="#local-6989586621679545454"><span class="hs-identifier hs-var">interpOpacity</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float -&gt; Float) -&gt; Maybe Float -&gt; Maybe (Float -&gt; Float)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Float) DrawAttributes (Maybe Float)
-&gt; Maybe Float
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Float) DrawAttributes (Maybe Float)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">fillOpacity</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Float -&gt; Float) -&gt; Maybe Float -&gt; Maybe Float
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545459"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Float) DrawAttributes (Maybe Float)
-&gt; Maybe Float
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Float) DrawAttributes (Maybe Float)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">fillOpacity</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><span class="annottext">DrawAttributes
-&gt; (DrawAttributes -&gt; DrawAttributes) -&gt; DrawAttributes
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Float -&gt; Identity (Maybe Float))
-&gt; DrawAttributes -&gt; Identity DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">groupOpacity</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Float -&gt; Identity (Maybe Float))
 -&gt; DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Maybe Float -&gt; DrawAttributes -&gt; DrawAttributes
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall b a a. (Fractional b, Real a, Real a) =&gt; a -&gt; a -&gt; b
</span><a href="#local-6989586621679545454"><span class="hs-identifier hs-var">interpOpacity</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float -&gt; Float) -&gt; Maybe Float -&gt; Maybe (Float -&gt; Float)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Float) DrawAttributes (Maybe Float)
-&gt; Maybe Float
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Float) DrawAttributes (Maybe Float)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">groupOpacity</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Float -&gt; Float) -&gt; Maybe Float -&gt; Maybe Float
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545459"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Float) DrawAttributes (Maybe Float)
-&gt; Maybe Float
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Float) DrawAttributes (Maybe Float)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">groupOpacity</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="annottext">DrawAttributes
-&gt; (DrawAttributes -&gt; DrawAttributes) -&gt; DrawAttributes
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Float -&gt; Identity (Maybe Float))
-&gt; DrawAttributes -&gt; Identity DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">strokeOpacity</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Float -&gt; Identity (Maybe Float))
 -&gt; DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Maybe Float -&gt; DrawAttributes -&gt; DrawAttributes
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall b a a. (Fractional b, Real a, Real a) =&gt; a -&gt; a -&gt; b
</span><a href="#local-6989586621679545454"><span class="hs-identifier hs-var">interpOpacity</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float -&gt; Float) -&gt; Maybe Float -&gt; Maybe (Float -&gt; Float)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545460"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Float) DrawAttributes (Maybe Float)
-&gt; Maybe Float
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Float) DrawAttributes (Maybe Float)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">strokeOpacity</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Float -&gt; Float) -&gt; Maybe Float -&gt; Maybe Float
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545459"><span class="hs-identifier hs-var">dst</span></a></span><span class="annot"><span class="annottext">DrawAttributes
-&gt; Getting (Maybe Float) DrawAttributes (Maybe Float)
-&gt; Maybe Float
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe Float) DrawAttributes (Maybe Float)
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Float)
</span><span class="hs-identifier hs-var">strokeOpacity</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679545457"><span class="annot"><span class="annottext">interpColor :: Texture -&gt; Texture -&gt; Texture
</span><a href="#local-6989586621679545457"><span class="hs-identifier hs-var hs-var">interpColor</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ColorRef</span></span><span> </span><span id="local-6989586621679545452"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679545452"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ColorRef</span></span><span> </span><span id="local-6989586621679545451"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679545451"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; Texture
</span><span class="hs-identifier hs-var">ColorRef</span></span><span> </span><span class="annot"><span class="annottext">(PixelRGBA8 -&gt; Texture) -&gt; PixelRGBA8 -&gt; Texture
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColorComponents -&gt; PixelRGBA8 -&gt; PixelRGBA8 -&gt; Double -&gt; PixelRGBA8
</span><a href="Reanimate.ColorComponents.html#interpolateRGBA8"><span class="hs-identifier hs-var">interpolateRGBA8</span></a></span><span> </span><span class="annot"><span class="annottext">ColorComponents
</span><a href="#local-6989586621679545461"><span class="hs-identifier hs-var">colorComps</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679545452"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679545451"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545458"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- interpolateColor (ColorRef a) FillNone = ColorRef a</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="#local-6989586621679545457"><span class="hs-identifier hs-var">interpColor</span></a></span><span> </span><span id="local-6989586621679545449"><span class="annot"><span class="annottext">Texture
</span><a href="#local-6989586621679545449"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Texture
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Texture
</span><a href="#local-6989586621679545449"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679545454"><span class="annot"><span class="annottext">interpOpacity :: a -&gt; a -&gt; b
</span><a href="#local-6989586621679545454"><span class="hs-identifier hs-var hs-var">interpOpacity</span></a></span></span><span> </span><span id="local-6989586621679545448"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679545448"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679545447"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679545447"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; b
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Signal
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679545448"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679545447"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545458"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Object-correspondence algorithm that spawn objects as necessary.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Reanimate.Morph.Common.html#genesisObjectCorrespondence"><span class="hs-identifier hs-type">genesisObjectCorrespondence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#ObjectCorrespondence"><span class="hs-identifier hs-type">ObjectCorrespondence</span></a></span><span>
</span><span id="line-129"></span><span id="genesisObjectCorrespondence"><span class="annot"><span class="annottext">genesisObjectCorrespondence :: ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#genesisObjectCorrespondence"><span class="hs-identifier hs-var hs-var">genesisObjectCorrespondence</span></a></span></span><span> </span><span id="local-6989586621679545445"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545445"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679545444"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545444"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545445"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545444"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679545443"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545443"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545442"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545442"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545441"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545441"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545443"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545442"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545443"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon Rational -&gt; APolygon Rational -&gt; APolygon Rational
forall a a.
(Real a, Fractional a, Epsilon a) =&gt;
APolygon a -&gt; APolygon a -&gt; APolygon a
</span><a href="#local-6989586621679545440"><span class="hs-identifier hs-var">emptyFrom</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545442"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545442"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DrawAttributes, APolygon Rational),
 (DrawAttributes, APolygon Rational))
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#genesisObjectCorrespondence"><span class="hs-identifier hs-var">genesisObjectCorrespondence</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545441"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679545439"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545439"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545438"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545438"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545437"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545437"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545439"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545438"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545439"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon Rational -&gt; APolygon Rational -&gt; APolygon Rational
forall a a.
(Real a, Fractional a, Epsilon a) =&gt;
APolygon a -&gt; APolygon a -&gt; APolygon a
</span><a href="#local-6989586621679545440"><span class="hs-identifier hs-var">emptyFrom</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545438"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545438"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DrawAttributes, APolygon Rational),
 (DrawAttributes, APolygon Rational))
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#genesisObjectCorrespondence"><span class="hs-identifier hs-var">genesisObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545437"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679545436"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545436"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545435"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545435"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545434"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545434"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545433"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545433"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545436"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545434"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DrawAttributes, APolygon Rational),
 (DrawAttributes, APolygon Rational))
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#genesisObjectCorrespondence"><span class="hs-identifier hs-var">genesisObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545435"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545433"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679545440"><span class="annot"><span class="annottext">emptyFrom :: APolygon a -&gt; APolygon a -&gt; APolygon a
</span><a href="#local-6989586621679545440"><span class="hs-identifier hs-var hs-var">emptyFrom</span></a></span></span><span> </span><span id="local-6989586621679545432"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545432"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679545431"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545431"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(V2 a -&gt; V2 a) -&gt; Vector (V2 a) -&gt; Vector (V2 a)
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; V2 a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(V2 a -&gt; V2 a -&gt; V2 a) -&gt; V2 a -&gt; V2 a -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; V2 a
forall a. Fractional a =&gt; APolygon a -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pCentroid"><span class="hs-identifier hs-var">pCentroid</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545432"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679545431"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Object-correspondence algorithm that duplicate objects as necessary.</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Reanimate.Morph.Common.html#dupObjectCorrespondence"><span class="hs-identifier hs-type">dupObjectCorrespondence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#ObjectCorrespondence"><span class="hs-identifier hs-type">ObjectCorrespondence</span></a></span><span>
</span><span id="line-143"></span><span id="dupObjectCorrespondence"><span class="annot"><span class="annottext">dupObjectCorrespondence :: ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#dupObjectCorrespondence"><span class="hs-identifier hs-var hs-var">dupObjectCorrespondence</span></a></span></span><span> </span><span id="local-6989586621679545428"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545428"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679545427"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545427"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545428"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545427"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621679545426"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545426"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679545425"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545425"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545426"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545425"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679545424"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545424"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545423"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545423"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545422"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545422"><span class="hs-identifier hs-var">yShapes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679545421"><span class="annot"><span class="annottext">x2s :: [APolygon Rational]
</span><a href="#local-6989586621679545421"><span class="hs-identifier hs-var hs-var">x2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; APolygon Rational -&gt; [APolygon Rational]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545422"><span class="hs-identifier hs-var">yShapes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545423"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#dupObjectCorrespondence"><span class="hs-identifier hs-var">dupObjectCorrespondence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(APolygon Rational -&gt; (DrawAttributes, APolygon Rational))
-&gt; [APolygon Rational] -&gt; [(DrawAttributes, APolygon Rational)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545424"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[APolygon Rational]
</span><a href="#local-6989586621679545421"><span class="hs-identifier hs-var">x2s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545422"><span class="hs-identifier hs-var">yShapes</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679545418"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545418"><span class="hs-identifier hs-var">xShapes</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679545417"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545417"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545416"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545416"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679545415"><span class="annot"><span class="annottext">y2s :: [APolygon Rational]
</span><a href="#local-6989586621679545415"><span class="hs-identifier hs-var hs-var">y2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; APolygon Rational -&gt; [APolygon Rational]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545418"><span class="hs-identifier hs-var">xShapes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545416"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#dupObjectCorrespondence"><span class="hs-identifier hs-var">dupObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545418"><span class="hs-identifier hs-var">xShapes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(APolygon Rational -&gt; (DrawAttributes, APolygon Rational))
-&gt; [APolygon Rational] -&gt; [(DrawAttributes, APolygon Rational)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545417"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[APolygon Rational]
</span><a href="#local-6989586621679545415"><span class="hs-identifier hs-var">y2s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679545414"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545414"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545413"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545413"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545412"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545412"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545411"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545411"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545414"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545412"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DrawAttributes, APolygon Rational),
 (DrawAttributes, APolygon Rational))
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#dupObjectCorrespondence"><span class="hs-identifier hs-var">dupObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545413"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545411"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Object-correspondence algorithm that splits objects in smaller pieces</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   as necessary.</span><span>
</span><span id="line-160"></span><span class="annot"><a href="Reanimate.Morph.Common.html#splitObjectCorrespondence"><span class="hs-identifier hs-type">splitObjectCorrespondence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Morph.Common.html#ObjectCorrespondence"><span class="hs-identifier hs-type">ObjectCorrespondence</span></a></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- splitObjectCorrespondence = dupObjectCorrespondence</span><span>
</span><span id="line-162"></span><span id="splitObjectCorrespondence"><span class="annot"><span class="annottext">splitObjectCorrespondence :: ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#splitObjectCorrespondence"><span class="hs-identifier hs-var hs-var">splitObjectCorrespondence</span></a></span></span><span> </span><span id="local-6989586621679545410"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545410"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679545409"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545409"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545410"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545409"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621679545408"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545408"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679545407"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545407"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545408"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545407"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679545406"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545406"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545405"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545405"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545404"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545404"><span class="hs-identifier hs-var">yShapes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679545403"><span class="annot"><span class="annottext">x2s :: [APolygon Rational]
</span><a href="#local-6989586621679545403"><span class="hs-identifier hs-var hs-var">x2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; APolygon Rational -&gt; [APolygon Rational]
</span><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-var">splitPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545404"><span class="hs-identifier hs-var">yShapes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545405"><span class="hs-identifier hs-var">x2</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#splitObjectCorrespondence"><span class="hs-identifier hs-var">splitObjectCorrespondence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(APolygon Rational -&gt; (DrawAttributes, APolygon Rational))
-&gt; [APolygon Rational] -&gt; [(DrawAttributes, APolygon Rational)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545406"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[APolygon Rational]
</span><a href="#local-6989586621679545403"><span class="hs-identifier hs-var">x2s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545404"><span class="hs-identifier hs-var">yShapes</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679545401"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545401"><span class="hs-identifier hs-var">xShapes</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679545400"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545400"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545399"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545399"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679545398"><span class="annot"><span class="annottext">y2s :: [APolygon Rational]
</span><a href="#local-6989586621679545398"><span class="hs-identifier hs-var hs-var">y2s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; APolygon Rational -&gt; [APolygon Rational]
</span><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-var">splitPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545401"><span class="hs-identifier hs-var">xShapes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545399"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#splitObjectCorrespondence"><span class="hs-identifier hs-var">splitObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545401"><span class="hs-identifier hs-var">xShapes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(APolygon Rational -&gt; (DrawAttributes, APolygon Rational))
-&gt; [APolygon Rational] -&gt; [(DrawAttributes, APolygon Rational)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545400"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[APolygon Rational]
</span><a href="#local-6989586621679545398"><span class="hs-identifier hs-var">y2s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679545397"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545397"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545396"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545396"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545395"><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545395"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679545394"><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545394"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545397"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational)
</span><a href="#local-6989586621679545395"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DrawAttributes, APolygon Rational),
 (DrawAttributes, APolygon Rational))
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
-&gt; [((DrawAttributes, APolygon Rational),
     (DrawAttributes, APolygon Rational))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ObjectCorrespondence
</span><a href="Reanimate.Morph.Common.html#splitObjectCorrespondence"><span class="hs-identifier hs-var">splitObjectCorrespondence</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545396"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
</span><a href="#local-6989586621679545394"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-type">splitPolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span id="splitPolygon"><span class="annot"><span class="annottext">splitPolygon :: Int -&gt; APolygon Rational -&gt; [APolygon Rational]
</span><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-var hs-var">splitPolygon</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span id="local-6989586621679545393"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545393"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545393"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span class="annot"><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-var">splitPolygon</span></a></span><span> </span><span id="local-6989586621679545392"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545392"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679545391"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545391"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679545390"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545390"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679545389"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545389"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon Rational -&gt; (APolygon Rational, APolygon Rational)
forall a. PolyCtx a =&gt; APolygon a -&gt; (APolygon a, APolygon a)
</span><a href="Reanimate.Math.Polygon.html#pCutEqual"><span class="hs-identifier hs-var">pCutEqual</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545391"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; APolygon Rational -&gt; [APolygon Rational]
</span><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-var">splitPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545392"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545390"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[APolygon Rational] -&gt; [APolygon Rational] -&gt; [APolygon Rational]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; APolygon Rational -&gt; [APolygon Rational]
</span><a href="Reanimate.Morph.Common.html#splitPolygon"><span class="hs-identifier hs-var">splitPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679545392"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545389"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- joinPairs :: Correspondence -&gt; [(DrawAttributes, PolyShape)] -&gt; [(DrawAttributes, PolyShape)]</span><span>
</span><span id="line-184"></span><span class="hs-comment">--           -&gt; [(DrawAttributes, DrawAttributes, [(RPoint, RPoint)])]</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- joinPairs _ _ [] = []</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- joinPairs _ [] _ = []</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- joinPairs corr [(x1,x2)] [(y1,y2)] =</span><span>
</span><span id="line-188"></span><span class="hs-comment">--   [(x1,y1, corr x2 y2)]</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- joinPairs corr [(x1,x2)] yShapes =</span><span>
</span><span id="line-190"></span><span class="hs-comment">--   let x2s = splitPolyShape 0.001 (length yShapes) x2</span><span>
</span><span id="line-191"></span><span class="hs-comment">--   in joinPairs corr (map (x1,) x2s) yShapes</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- joinPairs corr xShapes [(y1,y2)] =</span><span>
</span><span id="line-193"></span><span class="hs-comment">--   let y2s = reverse $ splitPolyShape 0.001 (length xShapes) y2</span><span>
</span><span id="line-194"></span><span class="hs-comment">--   in joinPairs corr xShapes (map (y1,) y2s)</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- joinPairs corr ((x1,x2):xs) ((y1,y2):ys) =</span><span>
</span><span id="line-196"></span><span class="hs-comment">--   (x1,y1, corr x2 y2) : joinPairs corr xs ys</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- joinPairs _ _ _ = []</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- FIXME: sort by size, smallest to largest</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Extract shapes and their graphical attributes from an SVG node.</span><span>
</span><span id="line-201"></span><span class="annot"><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier hs-type">toShapes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DrawAttributes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span id="toShapes"><span class="annot"><span class="annottext">toShapes :: Double -&gt; SVG -&gt; [(DrawAttributes, APolygon Rational)]
</span><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier hs-var hs-var">toShapes</span></a></span></span><span> </span><span id="local-6989586621679545386"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545386"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679545385"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545385"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545384"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; PolyShape -&gt; APolygon Rational
</span><a href="Reanimate.PolyShape.html#plToPolygon"><span class="hs-identifier hs-var">plToPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545386"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">PolyShape
</span><a href="#local-6989586621679545382"><span class="hs-identifier hs-var">shape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545384"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545384"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545381"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545381"><span class="hs-identifier hs-var">glyph</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [(SVG -&gt; SVG, DrawAttributes, SVG)]
</span><a href="Reanimate.Svg.html#svgGlyphs"><span class="hs-identifier hs-var">svgGlyphs</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [(SVG -&gt; SVG, DrawAttributes, SVG)])
-&gt; SVG -&gt; [(SVG -&gt; SVG, DrawAttributes, SVG)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#lowerTransformations"><span class="hs-identifier hs-var">lowerTransformations</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#pathify"><span class="hs-identifier hs-var">pathify</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545385"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545382"><span class="annot"><span class="annottext">PolyShape
</span><a href="#local-6989586621679545382"><span class="hs-identifier hs-var">shape</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PolyShapeWithHoles -&gt; PolyShape)
-&gt; [PolyShapeWithHoles] -&gt; [PolyShape]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PolyShapeWithHoles -&gt; PolyShape
</span><a href="Reanimate.PolyShape.html#mergePolyShapeHoles"><span class="hs-identifier hs-var">mergePolyShapeHoles</span></a></span><span> </span><span class="annot"><span class="annottext">([PolyShapeWithHoles] -&gt; [PolyShape])
-&gt; [PolyShapeWithHoles] -&gt; [PolyShape]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PolyShape] -&gt; [PolyShapeWithHoles]
</span><a href="Reanimate.PolyShape.html#plGroupShapes"><span class="hs-identifier hs-var">plGroupShapes</span></a></span><span> </span><span class="annot"><span class="annottext">([PolyShape] -&gt; [PolyShapeWithHoles])
-&gt; [PolyShape] -&gt; [PolyShapeWithHoles]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [PolyShape]
</span><a href="Reanimate.PolyShape.html#svgToPolyShapes"><span class="hs-identifier hs-var">svgToPolyShapes</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545381"><span class="hs-identifier hs-var">glyph</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Extract the first polygon in an SVG node. Will fail if there</span><span>
</span><span id="line-209"></span><span class="hs-comment">--   are no acceptable shapes.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Reanimate.Morph.Common.html#unsafeSVGToPolygon"><span class="hs-identifier hs-type">unsafeSVGToPolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-211"></span><span id="unsafeSVGToPolygon"><span class="annot"><span class="annottext">unsafeSVGToPolygon :: Double -&gt; SVG -&gt; APolygon Rational
</span><a href="Reanimate.Morph.Common.html#unsafeSVGToPolygon"><span class="hs-identifier hs-var hs-var">unsafeSVGToPolygon</span></a></span></span><span> </span><span id="local-6989586621679545375"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545375"><span class="hs-identifier hs-var">tol</span></a></span></span><span> </span><span id="local-6989586621679545374"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545374"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DrawAttributes, APolygon Rational) -&gt; APolygon Rational
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes, APolygon Rational) -&gt; APolygon Rational)
-&gt; (DrawAttributes, APolygon Rational) -&gt; APolygon Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(DrawAttributes, APolygon Rational)]
-&gt; (DrawAttributes, APolygon Rational)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(DrawAttributes, APolygon Rational)]
 -&gt; (DrawAttributes, APolygon Rational))
-&gt; [(DrawAttributes, APolygon Rational)]
-&gt; (DrawAttributes, APolygon Rational)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; SVG -&gt; [(DrawAttributes, APolygon Rational)]
</span><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier hs-var">toShapes</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679545375"><span class="hs-identifier hs-var">tol</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545374"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Map over each polygon in an SVG node.</span><span>
</span><span id="line-214"></span><span class="annot"><a href="Reanimate.Morph.Common.html#annotatePolygons"><span class="hs-identifier hs-type">annotatePolygons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-215"></span><span id="annotatePolygons"><span class="annot"><span class="annottext">annotatePolygons :: (APolygon Rational -&gt; SVG) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Morph.Common.html#annotatePolygons"><span class="hs-identifier hs-var hs-var">annotatePolygons</span></a></span></span><span> </span><span id="local-6989586621679545372"><span class="annot"><span class="annottext">APolygon Rational -&gt; SVG
</span><a href="#local-6989586621679545372"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679545371"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545371"><span class="hs-identifier hs-var">svg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">APolygon Rational -&gt; SVG
</span><a href="#local-6989586621679545372"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545370"><span class="hs-identifier hs-var">poly</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; (SVG -&gt; SVG) -&gt; SVG
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes) -&gt; SVG -&gt; Identity SVG
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; SVG -&gt; Identity SVG)
-&gt; DrawAttributes -&gt; SVG -&gt; SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545369"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679545369"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679545369"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679545370"><span class="annot"><span class="annottext">APolygon Rational
</span><a href="#local-6989586621679545370"><span class="hs-identifier hs-var">poly</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; SVG -&gt; [(DrawAttributes, APolygon Rational)]
</span><a href="Reanimate.Morph.Common.html#toShapes"><span class="hs-identifier hs-var">toShapes</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.001</span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679545371"><span class="hs-identifier hs-var">svg</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-219"></span></pre></body></html>