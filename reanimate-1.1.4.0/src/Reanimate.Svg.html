<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">{-|
Copyright   : Written by David Himmelstrup
License     : Unlicense
Maintainer  : lemmih@gmail.com
Stability   : experimental
Portability : POSIX
-}</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reanimate.Svg</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Reanimate.Svg.html"><span class="hs-identifier">Reanimate.Svg</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Reanimate.Svg.Constructors.html"><span class="hs-identifier">Reanimate.Svg.Constructors</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Reanimate.Svg.LineCommand.html"><span class="hs-identifier">Reanimate.Svg.LineCommand</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Reanimate.Svg.BoundingBox.html"><span class="hs-identifier">Reanimate.Svg.BoundingBox</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Reanimate.Svg.Unuse.html"><span class="hs-identifier">Reanimate.Svg.Unuse</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(%~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(?~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Graphics.SvgTree</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Linear.V2</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">V2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Animation.html"><span class="hs-identifier">Reanimate.Animation</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier">SVG</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Constants.html"><span class="hs-identifier">Reanimate.Constants</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Constants.html#defaultDPI"><span class="hs-identifier">defaultDPI</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Svg.BoundingBox.html"><span class="hs-identifier">Reanimate.Svg.BoundingBox</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.BoundingBox.html#boundingBox"><span class="hs-identifier">boundingBox</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Svg.BoundingBox.html#svgHeight"><span class="hs-identifier">svgHeight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Svg.BoundingBox.html#svgWidth"><span class="hs-identifier">svgWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Svg.Constructors.html"><span class="hs-identifier">Reanimate.Svg.Constructors</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Svg.LineCommand.html"><span class="hs-identifier">Reanimate.Svg.LineCommand</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Svg.Unuse.html"><span class="hs-identifier">Reanimate.Svg.Unuse</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.Unuse.html#embedDocument"><span class="hs-identifier">embedDocument</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Svg.Unuse.html#replaceUses"><span class="hs-identifier">replaceUses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Svg.Unuse.html#unbox"><span class="hs-identifier">unbox</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Svg.Unuse.html#unboxFit"><span class="hs-identifier">unboxFit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Reanimate.Transform.html"><span class="hs-identifier">Reanimate.Transform</span></a></span><span>        </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Transform</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- | Remove transformations (such as translations, rotations, scaling)</span><span>
</span><span id="line-30"></span><span class="hs-comment">--   and apply them directly to the SVG nodes. Note, this function</span><span>
</span><span id="line-31"></span><span class="hs-comment">--   may convert nodes (such as Circle or Rect) to paths. Also note</span><span>
</span><span id="line-32"></span><span class="hs-comment">--   that /does/ change how the SVG is rendered. Particularly, stroke</span><span>
</span><span id="line-33"></span><span class="hs-comment">--   width is affected by directly applying scaling.</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">--   @lowerTransformations (scale 2 (mkCircle 1)) = mkCircle 2@</span><span>
</span><span id="line-36"></span><span class="annot"><a href="Reanimate.Svg.html#lowerTransformations"><span class="hs-identifier hs-type">lowerTransformations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-37"></span><span id="lowerTransformations"><span class="annot"><span class="annottext">lowerTransformations :: SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#lowerTransformations"><span class="hs-identifier hs-var hs-var">lowerTransformations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Matrix Coord -&gt; SVG -&gt; SVG
</span><a href="#local-6989586621679544741"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="Reanimate.Transform.html#identity"><span class="hs-identifier hs-var">Transform.identity</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679544739"><span class="annot"><span class="annottext">updLineCmd :: Matrix Coord -&gt; LineCommand -&gt; LineCommand
</span><a href="#local-6989586621679544739"><span class="hs-identifier hs-var hs-var">updLineCmd</span></a></span></span><span> </span><span id="local-6989586621679544738"><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544738"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679544737"><span class="annot"><span class="annottext">LineCommand
</span><a href="#local-6989586621679544737"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-40"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LineCommand
</span><a href="#local-6989586621679544737"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-type">LineMove</span></a></span><span> </span><span id="local-6989586621679544735"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544735"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-var">LineMove</span></a></span><span> </span><span class="annot"><span class="annottext">(RPoint -&gt; LineCommand) -&gt; RPoint -&gt; LineCommand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; RPoint -&gt; RPoint
</span><a href="Reanimate.Transform.html#transformPoint"><span class="hs-identifier hs-var">Transform.transformPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544738"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544735"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-42"></span><span>        </span><span class="hs-comment">-- LineDraw p -&gt; LineDraw $ Transform.transformPoint m p</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-type">LineBezier</span></a></span><span> </span><span id="local-6989586621679544732"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544732"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-var">LineBezier</span></a></span><span> </span><span class="annot"><span class="annottext">([RPoint] -&gt; LineCommand) -&gt; [RPoint] -&gt; LineCommand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RPoint -&gt; RPoint) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Coord -&gt; RPoint -&gt; RPoint
</span><a href="Reanimate.Transform.html#transformPoint"><span class="hs-identifier hs-var">Transform.transformPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544738"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544732"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineEnd"><span class="hs-identifier hs-type">LineEnd</span></a></span><span> </span><span id="local-6989586621679544730"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544730"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineEnd"><span class="hs-identifier hs-var">LineEnd</span></a></span><span> </span><span class="annot"><span class="annottext">(RPoint -&gt; LineCommand) -&gt; RPoint -&gt; LineCommand
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; RPoint -&gt; RPoint
</span><a href="Reanimate.Transform.html#transformPoint"><span class="hs-identifier hs-var">Transform.transformPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544738"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544730"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span id="local-6989586621679544729"><span class="annot"><span class="annottext">updPath :: Matrix Coord -&gt; [PathCommand] -&gt; [PathCommand]
</span><a href="#local-6989586621679544729"><span class="hs-identifier hs-var hs-var">updPath</span></a></span></span><span> </span><span id="local-6989586621679544728"><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544728"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LineCommand] -&gt; [PathCommand]
</span><a href="Reanimate.Svg.LineCommand.html#lineToPath"><span class="hs-identifier hs-var">lineToPath</span></a></span><span> </span><span class="annot"><span class="annottext">([LineCommand] -&gt; [PathCommand])
-&gt; ([PathCommand] -&gt; [LineCommand])
-&gt; [PathCommand]
-&gt; [PathCommand]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LineCommand -&gt; LineCommand) -&gt; [LineCommand] -&gt; [LineCommand]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Coord -&gt; LineCommand -&gt; LineCommand
</span><a href="#local-6989586621679544739"><span class="hs-identifier hs-var">updLineCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544728"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([LineCommand] -&gt; [LineCommand])
-&gt; ([PathCommand] -&gt; [LineCommand])
-&gt; [PathCommand]
-&gt; [LineCommand]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[PathCommand] -&gt; [LineCommand]
</span><a href="Reanimate.Svg.LineCommand.html#toLineCommands"><span class="hs-identifier hs-var">toLineCommands</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679544724"><span class="annot"><span class="annottext">updPoint :: Matrix Coord -&gt; (Number, Number) -&gt; (Number, Number)
</span><a href="#local-6989586621679544724"><span class="hs-identifier hs-var hs-var">updPoint</span></a></span></span><span> </span><span id="local-6989586621679544723"><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544723"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span id="local-6989586621679544721"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544721"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span id="local-6989586621679544720"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544720"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-47"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; RPoint -&gt; RPoint
</span><a href="Reanimate.Transform.html#transformPoint"><span class="hs-identifier hs-var">Transform.transformPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544723"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544721"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544720"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679544719"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544719"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679544718"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544718"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord -&gt; Number
</span><span class="hs-identifier hs-var">Num</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544719"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord -&gt; Number
</span><span class="hs-identifier hs-var">Num</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544718"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="#local-6989586621679544724"><span class="hs-identifier hs-var">updPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679544717"><span class="annot"><span class="annottext">(Number, Number)
</span><a href="#local-6989586621679544717"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Number, Number)
</span><a href="#local-6989586621679544717"><span class="hs-identifier hs-var">other</span></a></span><span> </span><span class="hs-comment">-- XXX: Can we do better here?</span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679544741"><span class="annot"><span class="annottext">worker :: Bool -&gt; Matrix Coord -&gt; SVG -&gt; SVG
</span><a href="#local-6989586621679544741"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544716"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679544716"><span class="hs-identifier hs-var">hasPathified</span></a></span></span><span> </span><span id="local-6989586621679544715"><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544715"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679544714"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-51"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679544713"><span class="annot"><span class="annottext">m' :: Matrix Coord
</span><a href="#local-6989586621679544713"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544715"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; Matrix Coord -&gt; Matrix Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Transformation] -&gt; Matrix Coord
</span><a href="Reanimate.Transform.html#mkMatrix"><span class="hs-identifier hs-var">Transform.mkMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">SVG
-&gt; Getting (Maybe [Transformation]) SVG (Maybe [Transformation])
-&gt; Maybe [Transformation]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Maybe [Transformation]) SVG (Maybe [Transformation])
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe [Transformation])
</span><span class="hs-identifier hs-var">transform</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-52"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PathTree</span></span><span> </span><span id="local-6989586621679544708"><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679544708"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-54"></span><span>          </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679544708"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; ([PathCommand] -&gt; [PathCommand]) -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; [PathCommand] -&gt; [PathCommand]
</span><a href="#local-6989586621679544729"><span class="hs-identifier hs-var">updPath</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544713"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-55"></span><span>               </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe [Transformation] -&gt; Identity (Maybe [Transformation]))
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe [Transformation])
</span><span class="hs-identifier hs-var">transform</span></span><span> </span><span class="annot"><span class="annottext">((Maybe [Transformation] -&gt; Identity (Maybe [Transformation]))
 -&gt; Path -&gt; Identity Path)
-&gt; Maybe [Transformation] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Transformation]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-56"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544705"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544705"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">GroupTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-57"></span><span>          </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544705"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; ([SVG] -&gt; [SVG]) -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; [SVG] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Matrix Coord -&gt; SVG -&gt; SVG
</span><a href="#local-6989586621679544741"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679544716"><span class="hs-identifier hs-var">hasPathified</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544713"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>            </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe [Transformation] -&gt; Identity (Maybe [Transformation]))
-&gt; Group -&gt; Identity Group
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe [Transformation])
</span><span class="hs-identifier hs-var">transform</span></span><span> </span><span class="annot"><span class="annottext">((Maybe [Transformation] -&gt; Identity (Maybe [Transformation]))
 -&gt; Group -&gt; Identity Group)
-&gt; Maybe [Transformation] -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Transformation]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LineTree</span></span><span> </span><span id="local-6989586621679544702"><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544702"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-60"></span><span>          </span><span class="annot"><span class="annottext">Line -&gt; SVG
</span><span class="hs-identifier hs-var">LineTree</span></span><span> </span><span class="annot"><span class="annottext">(Line -&gt; SVG) -&gt; Line -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-61"></span><span>            </span><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544702"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Line -&gt; (Line -&gt; Line) -&gt; Line
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Number, Number) -&gt; Identity (Number, Number))
-&gt; Line -&gt; Identity Line
Lens' Line (Number, Number)
</span><span class="hs-identifier hs-var">linePoint1</span></span><span> </span><span class="annot"><span class="annottext">(((Number, Number) -&gt; Identity (Number, Number))
 -&gt; Line -&gt; Identity Line)
-&gt; ((Number, Number) -&gt; (Number, Number)) -&gt; Line -&gt; Line
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; (Number, Number) -&gt; (Number, Number)
</span><a href="#local-6989586621679544724"><span class="hs-identifier hs-var">updPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544715"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-62"></span><span>                 </span><span class="annot"><span class="annottext">Line -&gt; (Line -&gt; Line) -&gt; Line
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Number, Number) -&gt; Identity (Number, Number))
-&gt; Line -&gt; Identity Line
Lens' Line (Number, Number)
</span><span class="hs-identifier hs-var">linePoint2</span></span><span> </span><span class="annot"><span class="annottext">(((Number, Number) -&gt; Identity (Number, Number))
 -&gt; Line -&gt; Identity Line)
-&gt; ((Number, Number) -&gt; (Number, Number)) -&gt; Line -&gt; Line
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; (Number, Number) -&gt; (Number, Number)
</span><a href="#local-6989586621679544724"><span class="hs-identifier hs-var">updPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544715"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ClipPathTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">DefinitionTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-comment">-- If we encounter an unknown node and we've already tried to convert</span><span>
</span><span id="line-66"></span><span>        </span><span class="hs-comment">-- to paths, give up and insert an explicit transformation.</span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679544716"><span class="hs-identifier hs-var">hasPathified</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-68"></span><span>          </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; (SVG -&gt; SVG) -&gt; SVG
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe [Transformation] -&gt; Identity (Maybe [Transformation]))
-&gt; SVG -&gt; Identity SVG
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe [Transformation])
</span><span class="hs-identifier hs-var">transform</span></span><span> </span><span class="annot"><span class="annottext">((Maybe [Transformation] -&gt; Identity (Maybe [Transformation]))
 -&gt; SVG -&gt; Identity SVG)
-&gt; [Transformation] -&gt; SVG -&gt; SVG
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">?~</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Matrix Coord -&gt; Transformation
</span><a href="Reanimate.Transform.html#toTransformation"><span class="hs-identifier hs-var">Transform.toTransformation</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544715"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-comment">-- If we haven't tried to pathify, run pathify only once.</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Matrix Coord -&gt; SVG -&gt; SVG
</span><a href="#local-6989586621679544741"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Matrix Coord
</span><a href="#local-6989586621679544715"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#pathify"><span class="hs-identifier hs-var">pathify</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544714"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Remove all @id@ attributes.</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Reanimate.Svg.html#lowerIds"><span class="hs-identifier hs-type">lowerIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-74"></span><span id="lowerIds"><span class="annot"><span class="annottext">lowerIds :: SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#lowerIds"><span class="hs-identifier hs-var hs-var">lowerIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">mapTree</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544692"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679544692"><span class="annot"><span class="annottext">worker :: SVG -&gt; SVG
</span><a href="#local-6989586621679544692"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544691"><span class="annot"><span class="annottext">t :: SVG
</span><a href="#local-6989586621679544691"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544691"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; (SVG -&gt; SVG) -&gt; SVG
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Identity (Maybe String)) -&gt; SVG -&gt; Identity SVG
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe String)
</span><span class="hs-identifier hs-var">attrId</span></span><span> </span><span class="annot"><span class="annottext">((Maybe String -&gt; Identity (Maybe String)) -&gt; SVG -&gt; Identity SVG)
-&gt; Maybe String -&gt; SVG -&gt; SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="#local-6989586621679544692"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679544689"><span class="annot"><span class="annottext">t :: SVG
</span><a href="#local-6989586621679544689"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">PathTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544689"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; (SVG -&gt; SVG) -&gt; SVG
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Identity (Maybe String)) -&gt; SVG -&gt; Identity SVG
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe String)
</span><span class="hs-identifier hs-var">attrId</span></span><span> </span><span class="annot"><span class="annottext">((Maybe String -&gt; Identity (Maybe String)) -&gt; SVG -&gt; Identity SVG)
-&gt; Maybe String -&gt; SVG -&gt; SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="#local-6989586621679544692"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679544688"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544688"><span class="hs-identifier hs-var">t</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544688"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Remove all draw attributes such as 'stroke', 'fill' and 'fill-opacity'.</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Reanimate.Svg.html#clearDrawAttributes"><span class="hs-identifier hs-type">clearDrawAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-82"></span><span id="clearDrawAttributes"><span class="annot"><span class="annottext">clearDrawAttributes :: SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#clearDrawAttributes"><span class="hs-identifier hs-var hs-var">clearDrawAttributes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">mapTree</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
forall b. HasDrawAttributes b =&gt; b -&gt; b
</span><a href="#local-6989586621679544686"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679544686"><span class="annot"><span class="annottext">worker :: b -&gt; b
</span><a href="#local-6989586621679544686"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544685"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679544685"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679544685"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; (b -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes) -&gt; b -&gt; Identity b
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes) -&gt; b -&gt; Identity b)
-&gt; DrawAttributes -&gt; b -&gt; b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Optimize SVG tree without affecting how it is rendered.</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Reanimate.Svg.html#simplify"><span class="hs-identifier hs-type">simplify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-88"></span><span id="simplify"><span class="annot"><span class="annottext">simplify :: SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#simplify"><span class="hs-identifier hs-var hs-var">simplify</span></a></span></span><span> </span><span id="local-6989586621679544681"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544681"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544681"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679544678"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544678"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544678"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679544677"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544677"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544677"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679544680"><span class="annot"><span class="annottext">worker :: SVG -&gt; [SVG]
</span><a href="#local-6989586621679544680"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefinitionTree</span></span><span> </span><span id="local-6989586621679544676"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544676"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">DefinitionTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544676"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; ([SVG] -&gt; [SVG]) -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544673"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544673"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544673"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group
-&gt; Getting DrawAttributes Group DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting DrawAttributes Group DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes -&gt; DrawAttributes -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544673"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; SVG -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">GroupTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544673"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; ([SVG] -&gt; [SVG]) -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="#local-6989586621679544680"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679544672"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544672"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544672"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679544674"><span class="annot"><span class="annottext">dropNulls :: SVG -&gt; [SVG]
</span><a href="#local-6989586621679544674"><span class="hs-identifier hs-var hs-var">dropNulls</span></a></span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefinitionTree</span></span><span> </span><span id="local-6989586621679544671"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544671"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544671"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544669"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544669"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544669"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="#local-6989586621679544674"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span id="local-6989586621679544668"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544668"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544668"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Separate grouped items. This is required by clip nodes.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- @removeGroups (withFillColor &quot;blue&quot; $ mkGroup [mkCircle 1, mkRect 1 1])</span><span>
</span><span id="line-117"></span><span class="hs-comment">--    = [ withFillColor &quot;blue&quot; $ mkCircle 1</span><span>
</span><span id="line-118"></span><span class="hs-comment">--      , withFillColor &quot;blue&quot; $ mkRect 1 1 ]@</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Reanimate.Svg.html#removeGroups"><span class="hs-identifier hs-type">removeGroups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span id="removeGroups"><span class="annot"><span class="annottext">removeGroups :: SVG -&gt; [SVG]
</span><a href="Reanimate.Svg.html#removeGroups"><span class="hs-identifier hs-var hs-var">removeGroups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrawAttributes -&gt; SVG -&gt; [SVG]
</span><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679544666"><span class="annot"><span class="annottext">worker :: DrawAttributes -&gt; SVG -&gt; [SVG]
</span><a href="#local-6989586621679544666"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544665"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544665"><span class="hs-identifier hs-var">_attr</span></a></span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679544664"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544664"><span class="hs-identifier hs-var">_attr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefinitionTree</span></span><span> </span><span id="local-6989586621679544663"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544663"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544662"><span class="hs-identifier hs-var">dropNulls</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">DefinitionTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544663"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; ([SVG] -&gt; [SVG]) -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes -&gt; SVG -&gt; [SVG]
</span><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679544661"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544661"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544660"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544660"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544660"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group
-&gt; Getting DrawAttributes Group DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting DrawAttributes Group DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes -&gt; DrawAttributes -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544662"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes -&gt; SVG -&gt; [SVG]
</span><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544661"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544660"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">(SVG -&gt; [SVG]) -&gt; [SVG] -&gt; [SVG]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes -&gt; SVG -&gt; [SVG]
</span><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544661"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes -&gt; DrawAttributes -&gt; DrawAttributes
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544660"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group
-&gt; Getting DrawAttributes Group DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting DrawAttributes Group DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544660"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679544666"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679544659"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544659"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679544658"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544658"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [SVG]
</span><a href="#local-6989586621679544662"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544658"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; (SVG -&gt; SVG) -&gt; SVG
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes) -&gt; SVG -&gt; Identity SVG
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; SVG -&gt; Identity SVG)
-&gt; DrawAttributes -&gt; SVG -&gt; SVG
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544659"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679544662"><span class="annot"><span class="annottext">dropNulls :: SVG -&gt; [SVG]
</span><a href="#local-6989586621679544662"><span class="hs-identifier hs-var hs-var">dropNulls</span></a></span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="#local-6989586621679544662"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefinitionTree</span></span><span> </span><span id="local-6989586621679544657"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544657"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544657"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="#local-6989586621679544662"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544656"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544656"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544656"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621679544662"><span class="hs-identifier hs-var">dropNulls</span></a></span><span> </span><span id="local-6989586621679544655"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544655"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544655"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Extract all path commands from a node (and its children) and concatenate them.</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Reanimate.Svg.html#extractPath"><span class="hs-identifier hs-type">extractPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PathCommand</span></span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span id="extractPath"><span class="annot"><span class="annottext">extractPath :: SVG -&gt; [PathCommand]
</span><a href="Reanimate.Svg.html#extractPath"><span class="hs-identifier hs-var hs-var">extractPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [PathCommand]
</span><a href="#local-6989586621679544653"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [PathCommand]) -&gt; (SVG -&gt; SVG) -&gt; SVG -&gt; [PathCommand]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; (SVG -&gt; SVG) -&gt; SVG -&gt; SVG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#lowerTransformations"><span class="hs-identifier hs-var">lowerTransformations</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; (SVG -&gt; SVG) -&gt; SVG -&gt; SVG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#pathify"><span class="hs-identifier hs-var">pathify</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679544653"><span class="annot"><span class="annottext">worker :: SVG -&gt; [PathCommand]
</span><a href="#local-6989586621679544653"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544652"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544652"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [PathCommand]) -&gt; [SVG] -&gt; [PathCommand]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; [PathCommand]
</span><a href="#local-6989586621679544653"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544652"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="#local-6989586621679544653"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PathTree</span></span><span> </span><span id="local-6989586621679544651"><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679544651"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679544651"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Path -&gt; Getting [PathCommand] Path [PathCommand] -&gt; [PathCommand]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting [PathCommand] Path [PathCommand]
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679544653"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Map over indexed symbols.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">--   @withSubglyphs [0,2] (scale 2) (mkGroup [mkCircle 1, mkRect 2, mkEllipse 1 2])</span><span>
</span><span id="line-152"></span><span class="hs-comment">--      = mkGroup [scale 2 (mkCircle 1), mkRect 2, scale 2 (mkEllipse 1 2)]@</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Reanimate.Svg.html#withSubglyphs"><span class="hs-identifier hs-type">withSubglyphs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-154"></span><span id="withSubglyphs"><span class="annot"><span class="annottext">withSubglyphs :: [Int] -&gt; (SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#withSubglyphs"><span class="hs-identifier hs-var hs-var">withSubglyphs</span></a></span></span><span> </span><span id="local-6989586621679544649"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679544649"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679544648"><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544648"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679544647"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544647"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State Int SVG -&gt; Int -&gt; SVG
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544645"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544647"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="#local-6989586621679544645"><span class="hs-identifier hs-type">worker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679544645"><span class="annot"><span class="annottext">worker :: SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544645"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544643"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544642"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544642"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>          </span><span id="local-6989586621679544641"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544641"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State Int SVG) -&gt; [SVG] -&gt; StateT Int Identity [SVG]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544645"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544642"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>          </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State Int SVG) -&gt; SVG -&gt; State Int SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">GroupTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544642"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; [SVG] -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544641"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PathTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CircleTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PolyLineTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PolygonTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EllipseTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LineTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RectangleTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544643"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="#local-6989586621679544639"><span class="hs-identifier hs-type">handleGlyph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679544639"><span class="annot"><span class="annottext">handleGlyph :: SVG -&gt; State Int SVG
</span><a href="#local-6989586621679544639"><span class="hs-identifier hs-var hs-var">handleGlyph</span></a></span></span><span> </span><span id="local-6989586621679544633"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544633"><span class="hs-identifier hs-var">svg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>      </span><span id="local-6989586621679544632"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544632"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">StateT Int Identity Int
-&gt; StateT Int Identity () -&gt; StateT Int Identity Int
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; StateT Int Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544632"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679544649"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State Int SVG) -&gt; SVG -&gt; State Int SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544648"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544633"><span class="hs-identifier hs-var">svg</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State Int SVG
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544633"><span class="hs-identifier hs-var">svg</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Split symbols.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   @splitGlyphs [0,2] (mkGroup [mkCircle 1, mkRect 2, mkEllipse 1 2])</span><span>
</span><span id="line-180"></span><span class="hs-comment">--      = ([mkRect 2], [mkCircle 1, mkEllipse 1 2])@</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Reanimate.Svg.html#splitGlyphs"><span class="hs-identifier hs-type">splitGlyphs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span id="splitGlyphs"><span class="annot"><span class="annottext">splitGlyphs :: [Int] -&gt; SVG -&gt; (SVG, SVG)
</span><a href="Reanimate.Svg.html#splitGlyphs"><span class="hs-identifier hs-var hs-var">splitGlyphs</span></a></span></span><span> </span><span id="local-6989586621679544625"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679544625"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679544624"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544624"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544623"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544623"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544622"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544622"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Int, [SVG], [SVG]) ()
-&gt; (Int, [SVG], [SVG]) -&gt; (Int, [SVG], [SVG])
forall s a. State s a -&gt; s -&gt; s
</span><span class="hs-identifier hs-var">execState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544620"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544624"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544623"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544622"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621679544618"><span class="hs-identifier hs-type">handleGlyph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679544618"><span class="annot"><span class="annottext">handleGlyph :: SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var hs-var">handleGlyph</span></a></span></span><span> </span><span id="local-6989586621679544617"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544617"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679544616"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544616"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544615"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544615"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544614"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544614"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Int, [SVG], [SVG]) Identity (Int, [SVG], [SVG])
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544616"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679544625"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Int, [SVG], [SVG]) -&gt; State (Int, [SVG], [SVG]) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544616"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544615"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544617"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">SVG -&gt; [SVG] -&gt; [SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544614"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Int, [SVG], [SVG]) -&gt; State (Int, [SVG], [SVG]) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544616"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544617"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">SVG -&gt; [SVG] -&gt; [SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544615"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544614"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621679544620"><span class="hs-identifier hs-type">worker</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679544620"><span class="annot"><span class="annottext">worker :: (SVG -&gt; SVG) -&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544620"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544612"><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679544611"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544610"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544610"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679544609"><span class="annot"><span class="annottext">acc' :: SVG -&gt; SVG
</span><a href="#local-6989586621679544609"><span class="hs-identifier hs-var hs-var">acc'</span></a></span></span><span> </span><span id="local-6989586621679544608"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544608"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">GroupTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544610"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; [SVG] -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544608"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; [SVG] -&gt; State (Int, [SVG], [SVG]) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544620"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544609"><span class="hs-identifier hs-var">acc'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544610"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PathTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CircleTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PolyLineTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PolygonTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EllipseTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LineTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RectangleTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; State (Int, [SVG], [SVG]) ()
</span><a href="#local-6989586621679544618"><span class="hs-identifier hs-var">handleGlyph</span></a></span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; State (Int, [SVG], [SVG]) ())
-&gt; SVG -&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">DefinitionTree</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; State (Int, [SVG], [SVG]) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>          </span><span class="annot"><span class="annottext">((Int, [SVG], [SVG]) -&gt; (Int, [SVG], [SVG]))
-&gt; State (Int, [SVG], [SVG]) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(((Int, [SVG], [SVG]) -&gt; (Int, [SVG], [SVG]))
 -&gt; State (Int, [SVG], [SVG]) ())
-&gt; ((Int, [SVG], [SVG]) -&gt; (Int, [SVG], [SVG]))
-&gt; State (Int, [SVG], [SVG]) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679544606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544606"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544605"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544605"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544604"><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544604"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679544606"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544612"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544611"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">SVG -&gt; [SVG] -&gt; [SVG]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544605"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SVG]
</span><a href="#local-6989586621679544604"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span class="hs-comment">{-
&lt;g transform=&quot;translate(10,10)&quot;&gt;
  &lt;g transform=&quot;scale(2)&quot;&gt;
    &lt;circle/&gt;
  &lt;/g&gt;
  &lt;g transform=&quot;scale(0.5)&quot;&gt;
    &lt;rect/&gt;
  &lt;/g&gt;
&lt;/g&gt;

[ (\svg -&gt; &lt;g transform=&quot;translate(10,10)&quot;&gt;&lt;g transform=&quot;scale(2)&quot;&gt;svg&lt;/g&gt;&lt;/g&gt;, &lt;circle/&gt;)
, (\svg -&gt; &lt;g transform=&quot;translate(10,10)&quot;&gt;&lt;g transform=&quot;scale(0.5)&quot;&gt;svg&lt;/g&gt;&lt;/g&gt;, &lt;rect/&gt;)]
-}</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Split symbols and include their context and drawing attributes.</span><span>
</span><span id="line-222"></span><span class="annot"><a href="Reanimate.Svg.html#svgGlyphs"><span class="hs-identifier hs-type">svgGlyphs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DrawAttributes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span id="svgGlyphs"><span class="annot"><span class="annottext">svgGlyphs :: SVG -&gt; [(SVG -&gt; SVG, DrawAttributes, SVG)]
</span><a href="Reanimate.Svg.html#svgGlyphs"><span class="hs-identifier hs-var hs-var">svgGlyphs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG)
-&gt; DrawAttributes -&gt; SVG -&gt; [(SVG -&gt; SVG, DrawAttributes, SVG)]
forall t.
(SVG -&gt; t)
-&gt; DrawAttributes -&gt; SVG -&gt; [(SVG -&gt; t, DrawAttributes, SVG)]
</span><a href="#local-6989586621679544602"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>    </span><span id="local-6989586621679544602"><span class="annot"><span class="annottext">worker :: (SVG -&gt; t)
-&gt; DrawAttributes -&gt; SVG -&gt; [(SVG -&gt; t, DrawAttributes, SVG)]
</span><a href="#local-6989586621679544602"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679544601"><span class="annot"><span class="annottext">SVG -&gt; t
</span><a href="#local-6989586621679544601"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679544600"><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544600"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">GroupTree</span></span><span> </span><span id="local-6989586621679544599"><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544599"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679544598"><span class="annot"><span class="annottext">acc' :: SVG -&gt; t
</span><a href="#local-6989586621679544598"><span class="hs-identifier hs-var hs-var">acc'</span></a></span></span><span> </span><span id="local-6989586621679544597"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544597"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SVG -&gt; t
</span><a href="#local-6989586621679544601"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group -&gt; SVG
</span><span class="hs-identifier hs-var">GroupTree</span></span><span> </span><span class="annot"><span class="annottext">(Group -&gt; SVG) -&gt; Group -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544599"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; (Group -&gt; Group) -&gt; Group
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span> </span><span class="annot"><span class="annottext">(([SVG] -&gt; Identity [SVG]) -&gt; Group -&gt; Identity Group)
-&gt; [SVG] -&gt; Group -&gt; Group
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544597"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>              </span><span id="local-6989586621679544596"><span class="annot"><span class="annottext">attr' :: DrawAttributes
</span><a href="#local-6989586621679544596"><span class="hs-identifier hs-var hs-var">attr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544599"><span class="hs-identifier hs-var">g</span></a></span><span class="annot"><span class="annottext">Group
-&gt; Getting DrawAttributes Group DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting DrawAttributes Group DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DrawAttributes -&gt; DrawAttributes -&gt; DrawAttributes
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544600"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; [(SVG -&gt; t, DrawAttributes, SVG)])
-&gt; [SVG] -&gt; [(SVG -&gt; t, DrawAttributes, SVG)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SVG -&gt; t)
-&gt; DrawAttributes -&gt; SVG -&gt; [(SVG -&gt; t, DrawAttributes, SVG)]
</span><a href="#local-6989586621679544602"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; t
</span><a href="#local-6989586621679544598"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544596"><span class="hs-identifier hs-var">attr'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Group
</span><a href="#local-6989586621679544599"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Group -&gt; Getting [SVG] Group [SVG] -&gt; [SVG]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [SVG] Group [SVG]
Lens' Group [SVG]
</span><span class="hs-identifier hs-var">groupChildren</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span id="local-6989586621679544595"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544595"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG -&gt; t
</span><a href="#local-6989586621679544601"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544595"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">SVG -&gt; Getting DrawAttributes SVG DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting DrawAttributes SVG DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DrawAttributes -&gt; DrawAttributes -&gt; DrawAttributes
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DrawAttributes
</span><a href="#local-6989586621679544600"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544595"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">{-| Convert primitive SVG shapes (like those created by 'mkCircle', 'mkRect', 'mkLine' or
    'mkEllipse') into SVG path. This can be useful for creating animations of these shapes being
    drawn progressively with 'partialSvg'.

    Example:

    &gt; pathifyExample :: Animation
    &gt; pathifyExample = animate $ \t -&gt; gridLayout
    &gt;     [ [ partialSvg t $ pathify $ mkCircle 1
    &gt;       , partialSvg t $ pathify $ mkRect 2 2
    &gt;       ]
    &gt;     , [ partialSvg t $ pathify $ mkEllipse 1 0.5
    &gt;       , partialSvg t $ pathify $ mkLine (-1, -1) (1, 1)
    &gt;       ]
    &gt;     ]

    &lt;&lt;docs/gifs/doc_pathify.gif&gt;&gt;
 -}</span><span>
</span><span id="line-252"></span><span class="annot"><a href="Reanimate.Svg.html#pathify"><span class="hs-identifier hs-type">pathify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-253"></span><span id="pathify"><span class="annot"><span class="annottext">pathify :: SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#pathify"><span class="hs-identifier hs-var hs-var">pathify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">mapTree</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544594"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679544594"><span class="annot"><span class="annottext">worker :: SVG -&gt; SVG
</span><a href="#local-6989586621679544594"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RectangleTree</span></span><span> </span><span id="local-6989586621679544593"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544593"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544592"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544592"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544591"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544591"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544590"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544590"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544589"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544589"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Maybe (Coord, Coord, Coord, Coord)
</span><a href="#local-6989586621679544588"><span class="hs-identifier hs-var">unpackRect</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544593"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>          </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-259"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; Path -&gt; Identity Path)
-&gt; DrawAttributes -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544593"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
-&gt; Getting DrawAttributes Rectangle DrawAttributes
-&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DrawAttributes Rectangle DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span>
</span><span id="line-260"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Cap -&gt; Identity (Maybe Cap)) -&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c (Maybe Cap)
</span><span class="hs-identifier hs-var">strokeLineCap</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Cap -&gt; Identity (Maybe Cap)) -&gt; Path -&gt; Identity Path)
-&gt; Maybe Cap -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Cap -&gt; Maybe Cap
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Cap
</span><span class="hs-identifier hs-var">CapSquare</span></span><span>
</span><span id="line-261"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; [PathCommand] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span>
</span><span id="line-262"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">MoveTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544592"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544591"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Origin -&gt; [Coord] -&gt; PathCommand
</span><span class="hs-identifier hs-var">HorizontalTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginRelative</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544590"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-264"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Origin -&gt; [Coord] -&gt; PathCommand
</span><span class="hs-identifier hs-var">VerticalTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginRelative</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544589"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Origin -&gt; [Coord] -&gt; PathCommand
</span><span class="hs-identifier hs-var">HorizontalTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginRelative</span></span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544590"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">PathCommand
</span><span class="hs-identifier hs-var">EndPath</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LineTree</span></span><span> </span><span id="local-6989586621679544579"><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544579"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544578"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544578"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544577"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544577"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544576"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544576"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544575"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544575"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Line -&gt; Maybe (Coord, Coord, Coord, Coord)
</span><a href="#local-6989586621679544574"><span class="hs-identifier hs-var">unpackLine</span></a></span><span> </span><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544579"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-269"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; Path -&gt; Identity Path)
-&gt; DrawAttributes -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544579"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Line
-&gt; Getting DrawAttributes Line DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DrawAttributes Line DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span>
</span><span id="line-270"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; [PathCommand] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span>
</span><span id="line-271"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">MoveTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544578"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544577"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">LineTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544576"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544575"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CircleTree</span></span><span> </span><span id="local-6989586621679544572"><span class="annot"><span class="annottext">Circle
</span><a href="#local-6989586621679544572"><span class="hs-identifier hs-var">circ</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544571"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544571"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544570"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544570"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544569"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Circle -&gt; Maybe (Coord, Coord, Coord)
</span><a href="#local-6989586621679544568"><span class="hs-identifier hs-var">unpackCircle</span></a></span><span> </span><span class="annot"><span class="annottext">Circle
</span><a href="#local-6989586621679544572"><span class="hs-identifier hs-var">circ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; Path -&gt; Identity Path)
-&gt; DrawAttributes -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Circle
</span><a href="#local-6989586621679544572"><span class="hs-identifier hs-var">circ</span></a></span><span> </span><span class="annot"><span class="annottext">Circle
-&gt; Getting DrawAttributes Circle DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DrawAttributes Circle DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; [PathCommand] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span>
</span><span id="line-277"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">MoveTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544571"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544570"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Origin
-&gt; [(Coord, Coord, Coord, Bool, Bool, RPoint)] -&gt; PathCommand
</span><span class="hs-identifier hs-var">EllipticalArc</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginRelative</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>                                            </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544569"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PolyLineTree</span></span><span> </span><span id="local-6989586621679544566"><span class="annot"><span class="annottext">PolyLine
</span><a href="#local-6989586621679544566"><span class="hs-identifier hs-var">pl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679544565"><span class="annot"><span class="annottext">points :: [RPoint]
</span><a href="#local-6989586621679544565"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PolyLine
</span><a href="#local-6989586621679544566"><span class="hs-identifier hs-var">pl</span></a></span><span> </span><span class="annot"><span class="annottext">PolyLine -&gt; Getting [RPoint] PolyLine [RPoint] -&gt; [RPoint]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [RPoint] PolyLine [RPoint]
Lens' PolyLine [RPoint]
</span><span class="hs-identifier hs-var">polyLinePoints</span></span><span>
</span><span id="line-282"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-283"></span><span>               </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; Path -&gt; Identity Path)
-&gt; DrawAttributes -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">PolyLine
</span><a href="#local-6989586621679544566"><span class="hs-identifier hs-var">pl</span></a></span><span> </span><span class="annot"><span class="annottext">PolyLine
-&gt; Getting DrawAttributes PolyLine DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DrawAttributes PolyLine DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span>
</span><span id="line-284"></span><span>               </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; [PathCommand] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; [PathCommand]
</span><a href="#local-6989586621679544563"><span class="hs-identifier hs-var">pointsToPathCommands</span></a></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544565"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PolygonTree</span></span><span> </span><span id="local-6989586621679544562"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679544562"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679544561"><span class="annot"><span class="annottext">points :: [RPoint]
</span><a href="#local-6989586621679544561"><span class="hs-identifier hs-var hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679544562"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Getting [RPoint] Polygon [RPoint] -&gt; [RPoint]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [RPoint] Polygon [RPoint]
Lens' Polygon [RPoint]
</span><span class="hs-identifier hs-var">polygonPoints</span></span><span>
</span><span id="line-287"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-288"></span><span>               </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; Path -&gt; Identity Path)
-&gt; DrawAttributes -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679544562"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
-&gt; Getting DrawAttributes Polygon DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DrawAttributes Polygon DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span>
</span><span id="line-289"></span><span>               </span><span class="hs-comment">-- Polygon automatically connects the last point to the first. For path we must do</span><span>
</span><span id="line-290"></span><span>               </span><span class="hs-comment">-- it explicitly</span><span>
</span><span id="line-291"></span><span>               </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; [PathCommand] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RPoint] -&gt; [PathCommand]
</span><a href="#local-6989586621679544563"><span class="hs-identifier hs-var">pointsToPathCommands</span></a></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544561"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="annot"><span class="annottext">[PathCommand] -&gt; [PathCommand] -&gt; [PathCommand]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PathCommand
</span><span class="hs-identifier hs-var">EndPath</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EllipseTree</span></span><span> </span><span id="local-6989586621679544559"><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544559"><span class="hs-identifier hs-var">elip</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544558"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544558"><span class="hs-identifier hs-var">cx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544557"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544557"><span class="hs-identifier hs-var">cy</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544556"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544556"><span class="hs-identifier hs-var">rx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544555"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544555"><span class="hs-identifier hs-var">ry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ellipse -&gt; Maybe (Coord, Coord, Coord, Coord)
</span><a href="#local-6989586621679544554"><span class="hs-identifier hs-var">unpackEllipse</span></a></span><span> </span><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544559"><span class="hs-identifier hs-var">elip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-293"></span><span>          </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path
forall a. WithDefaultSvg a =&gt; a
</span><span class="hs-identifier hs-var">defaultSvg</span></span><span>
</span><span id="line-294"></span><span>             </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(DrawAttributes -&gt; Identity DrawAttributes)
-&gt; Path -&gt; Identity Path
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span> </span><span class="annot"><span class="annottext">((DrawAttributes -&gt; Identity DrawAttributes)
 -&gt; Path -&gt; Identity Path)
-&gt; DrawAttributes -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544559"><span class="hs-identifier hs-var">elip</span></a></span><span> </span><span class="annot"><span class="annottext">Ellipse
-&gt; Getting DrawAttributes Ellipse DrawAttributes -&gt; DrawAttributes
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting DrawAttributes Ellipse DrawAttributes
forall c. HasDrawAttributes c =&gt; Lens' c DrawAttributes
</span><span class="hs-identifier hs-var">drawAttributes</span></span><span>
</span><span id="line-295"></span><span>             </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; [PathCommand] -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span>
</span><span id="line-296"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">MoveTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544558"><span class="hs-identifier hs-var">cx</span></a></span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544556"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544557"><span class="hs-identifier hs-var">cy</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Origin
-&gt; [(Coord, Coord, Coord, Bool, Bool, RPoint)] -&gt; PathCommand
</span><span class="hs-identifier hs-var">EllipticalArc</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginRelative</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544556"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544555"><span class="hs-identifier hs-var">ry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544556"><span class="hs-identifier hs-var">rx</span></a></span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                                              </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544556"><span class="hs-identifier hs-var">rx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544555"><span class="hs-identifier hs-var">ry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544556"><span class="hs-identifier hs-var">rx</span></a></span><span class="annot"><span class="annottext">Coord -&gt; Coord -&gt; Coord
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Coord
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>        </span><span id="local-6989586621679544553"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544553"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544553"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679544568"><span class="annot"><span class="annottext">unpackCircle :: Circle -&gt; Maybe (Coord, Coord, Coord)
</span><a href="#local-6989586621679544568"><span class="hs-identifier hs-var hs-var">unpackCircle</span></a></span></span><span> </span><span id="local-6989586621679544552"><span class="annot"><span class="annottext">Circle
</span><a href="#local-6989586621679544552"><span class="hs-identifier hs-var">circ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544551"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544551"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544550"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544550"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Circle
</span><a href="#local-6989586621679544552"><span class="hs-identifier hs-var">circ</span></a></span><span> </span><span class="annot"><span class="annottext">Circle
-&gt; Getting (Number, Number) Circle (Number, Number)
-&gt; (Number, Number)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Number, Number) Circle (Number, Number)
Lens' Circle (Number, Number)
</span><span class="hs-identifier hs-var">circleCenter</span></span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">(Coord -&gt; Coord -&gt; Coord -&gt; (Coord, Coord, Coord))
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe (Coord, Coord, Coord)
forall (m :: * -&gt; *) a1 a2 a3 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; a3 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m a3 -&gt; m r
</span><span class="hs-identifier hs-var">liftM3</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544551"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544550"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Number -&gt; Maybe Coord) -&gt; Number -&gt; Maybe Coord
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Circle
</span><a href="#local-6989586621679544552"><span class="hs-identifier hs-var">circ</span></a></span><span> </span><span class="annot"><span class="annottext">Circle -&gt; Getting Number Circle Number -&gt; Number
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Number Circle Number
Lens' Circle Number
</span><span class="hs-identifier hs-var">circleRadius</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679544554"><span class="annot"><span class="annottext">unpackEllipse :: Ellipse -&gt; Maybe (Coord, Coord, Coord, Coord)
</span><a href="#local-6989586621679544554"><span class="hs-identifier hs-var hs-var">unpackEllipse</span></a></span></span><span> </span><span id="local-6989586621679544545"><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544545"><span class="hs-identifier hs-var">elip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544544"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544544"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544543"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544543"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544545"><span class="hs-identifier hs-var">elip</span></a></span><span> </span><span class="annot"><span class="annottext">Ellipse
-&gt; Getting (Number, Number) Ellipse (Number, Number)
-&gt; (Number, Number)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Number, Number) Ellipse (Number, Number)
Lens' Ellipse (Number, Number)
</span><span class="hs-identifier hs-var">ellipseCenter</span></span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><span class="annottext">(Coord -&gt; Coord -&gt; Coord -&gt; Coord -&gt; (Coord, Coord, Coord, Coord))
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe (Coord, Coord, Coord, Coord)
forall (m :: * -&gt; *) a1 a2 a3 a4 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; a3 -&gt; a4 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m a3 -&gt; m a4 -&gt; m r
</span><span class="hs-identifier hs-var">liftM4</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544544"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544543"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Number -&gt; Maybe Coord) -&gt; Number -&gt; Maybe Coord
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544545"><span class="hs-identifier hs-var">elip</span></a></span><span> </span><span class="annot"><span class="annottext">Ellipse -&gt; Getting Number Ellipse Number -&gt; Number
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Number Ellipse Number
Lens' Ellipse Number
</span><span class="hs-identifier hs-var">ellipseXRadius</span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Number -&gt; Maybe Coord) -&gt; Number -&gt; Maybe Coord
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ellipse
</span><a href="#local-6989586621679544545"><span class="hs-identifier hs-var">elip</span></a></span><span> </span><span class="annot"><span class="annottext">Ellipse -&gt; Getting Number Ellipse Number -&gt; Number
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Number Ellipse Number
Lens' Ellipse Number
</span><span class="hs-identifier hs-var">ellipseYRadius</span></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679544574"><span class="annot"><span class="annottext">unpackLine :: Line -&gt; Maybe (Coord, Coord, Coord, Coord)
</span><a href="#local-6989586621679544574"><span class="hs-identifier hs-var hs-var">unpackLine</span></a></span></span><span> </span><span id="local-6989586621679544538"><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544538"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544537"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544537"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544536"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544536"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544538"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Line
-&gt; Getting (Number, Number) Line (Number, Number)
-&gt; (Number, Number)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Number, Number) Line (Number, Number)
Lens' Line (Number, Number)
</span><span class="hs-identifier hs-var">linePoint1</span></span><span>
</span><span id="line-309"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679544535"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544535"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679544534"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544534"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Line
</span><a href="#local-6989586621679544538"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Line
-&gt; Getting (Number, Number) Line (Number, Number)
-&gt; (Number, Number)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Number, Number) Line (Number, Number)
Lens' Line (Number, Number)
</span><span class="hs-identifier hs-var">linePoint2</span></span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><span class="annottext">(Coord -&gt; Coord -&gt; Coord -&gt; Coord -&gt; (Coord, Coord, Coord, Coord))
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe Coord
-&gt; Maybe (Coord, Coord, Coord, Coord)
forall (m :: * -&gt; *) a1 a2 a3 a4 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; a3 -&gt; a4 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m a3 -&gt; m a4 -&gt; m r
</span><span class="hs-identifier hs-var">liftM4</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544537"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544536"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544535"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544534"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679544588"><span class="annot"><span class="annottext">unpackRect :: Rectangle -&gt; Maybe (Coord, Coord, Coord, Coord)
</span><a href="#local-6989586621679544588"><span class="hs-identifier hs-var hs-var">unpackRect</span></a></span></span><span> </span><span id="local-6989586621679544533"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544533"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679544532"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544532"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679544531"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544531"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544533"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
-&gt; Getting (Number, Number) Rectangle (Number, Number)
-&gt; (Number, Number)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Number, Number) Rectangle (Number, Number)
Lens' Rectangle (Number, Number)
</span><span class="hs-identifier hs-var">rectUpperLeftCorner</span></span><span>
</span><span id="line-313"></span><span>      </span><span id="local-6989586621679544529"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544529"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544532"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679544528"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544528"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544531"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679544527"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544527"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Number -&gt; Maybe Coord) -&gt; Maybe Number -&gt; Maybe Coord
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544533"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
-&gt; Getting (Maybe Number) Rectangle (Maybe Number) -&gt; Maybe Number
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe Number) Rectangle (Maybe Number)
Lens' Rectangle (Maybe Number)
</span><span class="hs-identifier hs-var">rectWidth</span></span><span>
</span><span id="line-316"></span><span>      </span><span id="local-6989586621679544524"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544524"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var">unpackNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Number -&gt; Maybe Coord) -&gt; Maybe Number -&gt; Maybe Coord
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679544533"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
-&gt; Getting (Maybe Number) Rectangle (Maybe Number) -&gt; Maybe Number
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe Number) Rectangle (Maybe Number)
Lens' Rectangle (Maybe Number)
</span><span class="hs-identifier hs-var">rectHeight</span></span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">(Coord, Coord, Coord, Coord) -&gt; Maybe (Coord, Coord, Coord, Coord)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544529"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544528"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544527"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544524"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679544563"><span class="annot"><span class="annottext">pointsToPathCommands :: [RPoint] -&gt; [PathCommand]
</span><a href="#local-6989586621679544563"><span class="hs-identifier hs-var hs-var">pointsToPathCommands</span></a></span></span><span> </span><span id="local-6989586621679544522"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544522"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544522"><span class="hs-identifier hs-var">points</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679544521"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544521"><span class="hs-identifier hs-var">p</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679544520"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544520"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">MoveTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544521"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Origin -&gt; [RPoint] -&gt; PathCommand
</span><span class="hs-identifier hs-var">LineTo</span></span><span> </span><span class="annot"><span class="annottext">Origin
</span><span class="hs-identifier hs-var">OriginAbsolute</span></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544520"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679544547"><span class="annot"><span class="annottext">unpackNumber :: Number -&gt; Maybe Coord
</span><a href="#local-6989586621679544547"><span class="hs-identifier hs-var hs-var">unpackNumber</span></a></span></span><span> </span><span id="local-6989586621679544519"><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544519"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Number -&gt; Number
</span><span class="hs-identifier hs-var">toUserUnit</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Reanimate.Constants.html#defaultDPI"><span class="hs-identifier hs-var">defaultDPI</span></a></span><span> </span><span class="annot"><span class="annottext">Number
</span><a href="#local-6989586621679544519"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span id="local-6989586621679544517"><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544517"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Coord -&gt; Maybe Coord
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Coord
</span><a href="#local-6989586621679544517"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><span class="annottext">Number
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Coord
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | Map over all recursively-found path commands.</span><span>
</span><span id="line-328"></span><span class="annot"><a href="Reanimate.Svg.html#mapSvgPaths"><span class="hs-identifier hs-type">mapSvgPaths</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PathCommand</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PathCommand</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-329"></span><span id="mapSvgPaths"><span class="annot"><span class="annottext">mapSvgPaths :: ([PathCommand] -&gt; [PathCommand]) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgPaths"><span class="hs-identifier hs-var hs-var">mapSvgPaths</span></a></span></span><span> </span><span id="local-6989586621679544515"><span class="annot"><span class="annottext">[PathCommand] -&gt; [PathCommand]
</span><a href="#local-6989586621679544515"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
</span><span class="hs-identifier hs-var">mapTree</span></span><span> </span><span class="annot"><span class="annottext">SVG -&gt; SVG
</span><a href="#local-6989586621679544514"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679544514"><span class="annot"><span class="annottext">worker :: SVG -&gt; SVG
</span><a href="#local-6989586621679544514"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>      </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PathTree</span></span><span> </span><span id="local-6989586621679544513"><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679544513"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Path -&gt; SVG
</span><span class="hs-identifier hs-var">PathTree</span></span><span> </span><span class="annot"><span class="annottext">(Path -&gt; SVG) -&gt; Path -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-334"></span><span>          </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679544513"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Path -&gt; (Path -&gt; Path) -&gt; Path
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; Identity [PathCommand]) -&gt; Path -&gt; Identity Path
Lens' Path [PathCommand]
</span><span class="hs-identifier hs-var">pathDefinition</span></span><span> </span><span class="annot"><span class="annottext">(([PathCommand] -&gt; Identity [PathCommand])
 -&gt; Path -&gt; Identity Path)
-&gt; ([PathCommand] -&gt; [PathCommand]) -&gt; Path -&gt; Path
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">[PathCommand] -&gt; [PathCommand]
</span><a href="#local-6989586621679544515"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span id="local-6989586621679544512"><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544512"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><a href="#local-6989586621679544512"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Map over all recursively-found line commands.</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Reanimate.Svg.html#mapSvgLines"><span class="hs-identifier hs-type">mapSvgLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineCommand"><span class="hs-identifier hs-type">LineCommand</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineCommand"><span class="hs-identifier hs-type">LineCommand</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-339"></span><span id="mapSvgLines"><span class="annot"><span class="annottext">mapSvgLines :: ([LineCommand] -&gt; [LineCommand]) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgLines"><span class="hs-identifier hs-var hs-var">mapSvgLines</span></a></span></span><span> </span><span id="local-6989586621679544510"><span class="annot"><span class="annottext">[LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679544510"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([PathCommand] -&gt; [PathCommand]) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgPaths"><span class="hs-identifier hs-var">mapSvgPaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LineCommand] -&gt; [PathCommand]
</span><a href="Reanimate.Svg.LineCommand.html#lineToPath"><span class="hs-identifier hs-var">lineToPath</span></a></span><span> </span><span class="annot"><span class="annottext">([LineCommand] -&gt; [PathCommand])
-&gt; ([PathCommand] -&gt; [LineCommand])
-&gt; [PathCommand]
-&gt; [PathCommand]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679544510"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">([LineCommand] -&gt; [LineCommand])
-&gt; ([PathCommand] -&gt; [LineCommand])
-&gt; [PathCommand]
-&gt; [LineCommand]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[PathCommand] -&gt; [LineCommand]
</span><a href="Reanimate.Svg.LineCommand.html#toLineCommands"><span class="hs-identifier hs-var">toLineCommands</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- Only maps points in paths</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Map over all line command control points.</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Reanimate.Svg.html#mapSvgPoints"><span class="hs-identifier hs-type">mapSvgPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RPoint</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-344"></span><span id="mapSvgPoints"><span class="annot"><span class="annottext">mapSvgPoints :: (RPoint -&gt; RPoint) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgPoints"><span class="hs-identifier hs-var hs-var">mapSvgPoints</span></a></span></span><span> </span><span id="local-6989586621679544508"><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679544508"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LineCommand] -&gt; [LineCommand]) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgLines"><span class="hs-identifier hs-var">mapSvgLines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LineCommand -&gt; LineCommand) -&gt; [LineCommand] -&gt; [LineCommand]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LineCommand -&gt; LineCommand
</span><a href="#local-6989586621679544507"><span class="hs-identifier hs-var">worker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679544507"><span class="annot"><span class="annottext">worker :: LineCommand -&gt; LineCommand
</span><a href="#local-6989586621679544507"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-type">LineMove</span></a></span><span> </span><span id="local-6989586621679544506"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544506"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-var">LineMove</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679544508"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544506"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="#local-6989586621679544507"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-type">LineBezier</span></a></span><span> </span><span id="local-6989586621679544505"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544505"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-var">LineBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RPoint -&gt; RPoint) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679544508"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679544505"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="#local-6989586621679544507"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineEnd"><span class="hs-identifier hs-type">LineEnd</span></a></span><span> </span><span id="local-6989586621679544504"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544504"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineEnd"><span class="hs-identifier hs-var">LineEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679544508"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679544504"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | Convert coordinate system from degrees to radians.</span><span>
</span><span id="line-351"></span><span class="annot"><a href="Reanimate.Svg.html#svgPointsToRadians"><span class="hs-identifier hs-type">svgPointsToRadians</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-352"></span><span id="svgPointsToRadians"><span class="annot"><span class="annottext">svgPointsToRadians :: SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#svgPointsToRadians"><span class="hs-identifier hs-var hs-var">svgPointsToRadians</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RPoint -&gt; RPoint) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgPoints"><span class="hs-identifier hs-var">mapSvgPoints</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
forall a. Floating a =&gt; V2 a -&gt; V2 a
</span><a href="#local-6989586621679544502"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679544502"><span class="annot"><span class="annottext">worker :: V2 a -&gt; V2 a
</span><a href="#local-6989586621679544502"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679544501"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679544501"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679544500"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679544500"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; V2 a
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679544501"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">180</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679544500"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">180</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span></pre></body></html>