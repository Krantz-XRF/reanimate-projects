<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK hide #-}</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reanimate.Math.Polygon</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier">APolygon</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier">Polygon</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#FPolygon"><span class="hs-identifier">FPolygon</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#P"><span class="hs-identifier">P</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier">mkPolygon</span></a></span><span>     </span><span class="hs-comment">-- :: (Fractional a, Ord a) =&gt; V.Vector (V2 a) -&gt; APolygon a</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#mkPolygonFromRing"><span class="hs-identifier">mkPolygonFromRing</span></a></span><span> </span><span class="hs-comment">-- :: (Fractional a, Ord a) =&gt; Ring a -&gt; APolygon a</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#castPolygon"><span class="hs-identifier">castPolygon</span></a></span><span>   </span><span class="hs-comment">-- :: (Real a, Fractional b, Ord a) =&gt; APolygon a -&gt; APolygon b</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pParent"><span class="hs-identifier">pParent</span></a></span><span>       </span><span class="hs-comment">-- :: Polygon -&gt; Int -&gt; Int -&gt; Int</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pSetOffset"><span class="hs-identifier">pSetOffset</span></a></span><span>    </span><span class="hs-comment">-- :: APolygon a -&gt; Int -&gt; APolygon a</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAdjustOffset"><span class="hs-identifier">pAdjustOffset</span></a></span><span> </span><span class="hs-comment">-- :: APolygon a -&gt; Int -&gt; APolygon a</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier">pSize</span></a></span><span>         </span><span class="hs-comment">-- :: APolygon a -&gt; Int</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pNull"><span class="hs-identifier">pNull</span></a></span><span>         </span><span class="hs-comment">-- :: APolygon a -&gt; Bool</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pNext"><span class="hs-identifier">pNext</span></a></span><span>         </span><span class="hs-comment">-- :: APolygon a -&gt; Int -&gt; Int</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pPrev"><span class="hs-identifier">pPrev</span></a></span><span>         </span><span class="hs-comment">-- :: APolygon a -&gt; Int -&gt; Int</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsSimple"><span class="hs-identifier">pIsSimple</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; Bool</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsConvex"><span class="hs-identifier">pIsConvex</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; Bool</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsCCW"><span class="hs-identifier">pIsCCW</span></a></span><span>        </span><span class="hs-comment">-- :: Polygon -&gt; Bool</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier">pScale</span></a></span><span>        </span><span class="hs-comment">-- :: Rational -&gt; Polygon -&gt; Polygon</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAtCentroid"><span class="hs-identifier">pAtCentroid</span></a></span><span>   </span><span class="hs-comment">-- :: Polygon -&gt; Polygon</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAtCenter"><span class="hs-identifier">pAtCenter</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; Polygon</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pTranslate"><span class="hs-identifier">pTranslate</span></a></span><span>    </span><span class="hs-comment">-- :: V2 Rational -&gt; Polygon -&gt; Polygon</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCenter"><span class="hs-identifier">pCenter</span></a></span><span>       </span><span class="hs-comment">-- :: Polygon -&gt; V2 Rational</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pBoundingBox"><span class="hs-identifier">pBoundingBox</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon -&gt; (Rational, Rational, Rational, Rational)</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsInside"><span class="hs-identifier">pIsInside</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; V2 Rational -&gt; Bool</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier">pAccess</span></a></span><span>       </span><span class="hs-comment">-- :: APolygon a -&gt; Int -&gt; V2 a</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pMkWinding"><span class="hs-identifier">pMkWinding</span></a></span><span>    </span><span class="hs-comment">-- :: Int -&gt; Polygon</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pDeoverlap"><span class="hs-identifier">pDeoverlap</span></a></span><span>    </span><span class="hs-comment">-- :: Polygon -&gt; Polygon</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCycles"><span class="hs-identifier">pCycles</span></a></span><span>       </span><span class="hs-comment">-- :: Polygon -&gt; [Polygon]</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCycle"><span class="hs-identifier">pCycle</span></a></span><span>        </span><span class="hs-comment">-- :: (Real a, Fractional a, Ord a) =&gt; APolygon a -&gt; Double -&gt; APolygon a</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCentroid"><span class="hs-identifier">pCentroid</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; V2 Rational</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-identifier">pMapEdges</span></a></span><span>     </span><span class="hs-comment">-- :: (V2 Rational -&gt; V2 Rational -&gt; a) -&gt; Polygon -&gt; V.Vector a</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-identifier">pArea</span></a></span><span>         </span><span class="hs-comment">-- :: Polygon -&gt; Rational</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCircumference"><span class="hs-identifier">pCircumference</span></a></span><span>   </span><span class="hs-comment">-- :: (Real a, Fractional a) =&gt; APolygon a -&gt; a</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCircumference%27"><span class="hs-identifier">pCircumference'</span></a></span><span>  </span><span class="hs-comment">-- :: (Real a, Fractional a) =&gt; APolygon a -&gt; Double</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPoints"><span class="hs-identifier">pAddPoints</span></a></span><span>       </span><span class="hs-comment">-- :: Int -&gt; Polygon -&gt; Polygon</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPointsRestricted"><span class="hs-identifier">pAddPointsRestricted</span></a></span><span> </span><span class="hs-comment">-- :: [Int] -&gt; Int -&gt; Polygon -&gt; Polygon</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPointsBetween"><span class="hs-identifier">pAddPointsBetween</span></a></span><span> </span><span class="hs-comment">-- :: (Fractional a, Ord a, Real a) =&gt; (Int, Int) -&gt; Int -&gt; APolygon a -&gt; APolygon a</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier">pRayIntersect</span></a></span><span>    </span><span class="hs-comment">-- :: Polygon -&gt; (Int, Int) -&gt; (Int,Int) -&gt; Maybe (V2 Rational)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pOverlap"><span class="hs-identifier">pOverlap</span></a></span><span>         </span><span class="hs-comment">-- :: Polygon -&gt; Polygon -&gt; Polygon</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCuts"><span class="hs-identifier">pCuts</span></a></span><span>         </span><span class="hs-comment">-- :: Polygon -&gt; [(Polygon,Polygon)]</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCutEqual"><span class="hs-identifier">pCutEqual</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; (Polygon, Polygon)</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Triangulation</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#isValidTriangulation"><span class="hs-identifier">isValidTriangulation</span></a></span><span>     </span><span class="hs-comment">-- :: Polygon -&gt; Triangulation -&gt; Bool</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#triangulationsToPolygons"><span class="hs-identifier">triangulationsToPolygons</span></a></span><span> </span><span class="hs-comment">-- :: Polygon -&gt; Triangulation -&gt; [Polygon]</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Single-Source-Shortest-Path</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#ssspVisibility"><span class="hs-identifier">ssspVisibility</span></a></span><span> </span><span class="hs-comment">-- :: Polygon -&gt; Polygon</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#ssspWindows"><span class="hs-identifier">ssspWindows</span></a></span><span> </span><span class="hs-comment">-- :: Polygon -&gt; [(V2 Rational, V2 Rational)]</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Built-in shapes for testing</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#triangle"><span class="hs-identifier">triangle</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#triangle%27"><span class="hs-identifier">triangle'</span></a></span><span> </span><span class="hs-comment">-- :: [P]</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape1"><span class="hs-identifier">shape1</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape2"><span class="hs-identifier">shape2</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape3"><span class="hs-identifier">shape3</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape4"><span class="hs-identifier">shape4</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape5"><span class="hs-identifier">shape5</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape6"><span class="hs-identifier">shape6</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape7"><span class="hs-identifier">shape7</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape8"><span class="hs-identifier">shape8</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape9"><span class="hs-identifier">shape9</span></a></span><span>  </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape10"><span class="hs-identifier">shape10</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape11"><span class="hs-identifier">shape11</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape12"><span class="hs-identifier">shape12</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape13"><span class="hs-identifier">shape13</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape14"><span class="hs-identifier">shape14</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape15"><span class="hs-identifier">shape15</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape16"><span class="hs-identifier">shape16</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape17"><span class="hs-identifier">shape17</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape18"><span class="hs-identifier">shape18</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape19"><span class="hs-identifier">shape19</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape20"><span class="hs-identifier">shape20</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape21"><span class="hs-identifier">shape21</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape22"><span class="hs-identifier">shape22</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape23"><span class="hs-identifier">shape23</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#concave"><span class="hs-identifier">concave</span></a></span><span> </span><span class="hs-comment">-- :: Polygon</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Internals</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pRing"><span class="hs-identifier">pRing</span></a></span><span>       </span><span class="hs-comment">-- :: APolygon a -&gt; Ring a</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pUnsafeMap"><span class="hs-identifier">pUnsafeMap</span></a></span><span>  </span><span class="hs-comment">-- :: (Ring a -&gt; Ring a) -&gt; APolygon a -&gt; APolygon a</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCopy"><span class="hs-identifier">pCopy</span></a></span><span>       </span><span class="hs-comment">-- :: Polygon -&gt; Polygon</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier">pGenerate</span></a></span><span>   </span><span class="hs-comment">-- :: [(Double, Double)] -&gt; Polygon</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pUnGenerate"><span class="hs-identifier">pUnGenerate</span></a></span><span> </span><span class="hs-comment">-- :: Polygon -&gt; [(Double, Double)]</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Epsilon</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- import           Control.Exception</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersect</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maximumBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>                                             </span><span class="annot"><span class="hs-identifier">tails</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Serialize</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Vector</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Linear.V2</span></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Linear.Vector</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Math.Common.html"><span class="hs-identifier">Reanimate.Math.Common</span></a></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- import           Reanimate.Math.EarClip</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Math.SSSP.html"><span class="hs-identifier">Reanimate.Math.SSSP</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.Math.Triangulate.html"><span class="hs-identifier">Reanimate.Math.Triangulate</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- import Debug.Trace</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Generate random polygons, options:</span><span>
</span><span id="line-107"></span><span class="hs-comment">--   1. put corners around a circle. Vary the radius.</span><span>
</span><span id="line-108"></span><span class="hs-comment">--   2. close a hilbert curve</span><span>
</span><span id="line-109"></span><span class="hs-keyword">type</span><span> </span><span id="FPolygon"><span class="annot"><a href="Reanimate.Math.Polygon.html#FPolygon"><span class="hs-identifier hs-var">FPolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- Optimize representation?</span><span>
</span><span id="line-111"></span><span class="hs-comment">--   Polygon = (Vector XNumerator, Vector XDenominator</span><span>
</span><span id="line-112"></span><span class="hs-comment">--             ,Vector YNumerator, Vector YDenominator)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="APolygon"><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-var">APolygon</span></a></span></span><span> </span><span id="local-6989586621679540536"><span class="annot"><a href="#local-6989586621679540536"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Polygon"><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="polygonPoints"><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540536"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="polygonOffset"><span class="annot"><span class="annottext">APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="polygonTriangulation"><span class="annot"><span class="annottext">APolygon a -&gt; Triangulation
</span><a href="Reanimate.Math.Polygon.html#polygonTriangulation"><span class="hs-identifier hs-var hs-var">polygonTriangulation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Triangulate.html#Triangulation"><span class="hs-identifier hs-type">Triangulation</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="polygonSSSP"><span class="annot"><span class="annottext">APolygon a -&gt; Vector SSSP
</span><a href="Reanimate.Math.Polygon.html#polygonSSSP"><span class="hs-identifier hs-var hs-var">polygonSSSP</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="Reanimate.Math.SSSP.html#SSSP"><span class="hs-identifier hs-type">SSSP</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-119"></span><span class="hs-keyword">type</span><span> </span><span id="Polygon"><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-var">Polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-120"></span><span class="hs-keyword">type</span><span> </span><span id="P"><span class="annot"><a href="Reanimate.Math.Polygon.html#P"><span class="hs-identifier hs-var">P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621679540286"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679540281"><span id="local-6989586621679540284"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679540286"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540286"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679540279"><span class="annot"><span class="annottext">show :: APolygon a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; String)
-&gt; (APolygon a -&gt; [V2 a]) -&gt; APolygon a -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; [V2 a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; [V2 a])
-&gt; (APolygon a -&gt; Vector (V2 a)) -&gt; APolygon a -&gt; [V2 a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679540275"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679540272"><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679540275"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540275"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679540270"><span class="annot"><span class="annottext">hashWithSalt :: Int -&gt; APolygon a -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hashWithSalt</span></span></span><span> </span><span id="local-6989586621679540268"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679540267"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540267"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a -&gt; Int) -&gt; Int -&gt; Vector (V2 a) -&gt; Int
forall a b. (a -&gt; b -&gt; a) -&gt; a -&gt; Vector b -&gt; a
</span><span class="hs-identifier hs-var">V.foldl'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; V2 a -&gt; Int
forall a. Hashable a =&gt; Int -&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">hashWithSalt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540268"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540267"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621679540265"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialize</span></span><span> </span><span class="annot"><a href="#local-6989586621679540265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540265"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679540261"><span class="annot"><span class="annottext">put :: Putter (APolygon a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Putter [V2 a]
forall t. Serialize t =&gt; Putter t
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Putter [V2 a] -&gt; (APolygon a -&gt; [V2 a]) -&gt; Putter (APolygon a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; [V2 a]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; [V2 a])
-&gt; (APolygon a -&gt; Vector (V2 a)) -&gt; APolygon a -&gt; [V2 a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679540259"><span class="annot"><span class="annottext">get :: Get (APolygon a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a)
-&gt; ([V2 a] -&gt; Vector (V2 a)) -&gt; [V2 a] -&gt; APolygon a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; APolygon a) -&gt; Get [V2 a] -&gt; Get (APolygon a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get [V2 a]
forall t. Serialize t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679540493"><span class="annot"><a href="Reanimate.Math.Polygon.html#pRing"><span class="hs-identifier hs-type">pRing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Common.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540493"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-133"></span><span id="pRing"><span class="annot"><span class="annottext">pRing :: APolygon a -&gt; Ring a
</span><a href="Reanimate.Math.Polygon.html#pRing"><span class="hs-identifier hs-var hs-var">pRing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Ring a
forall a. Vector (V2 a) -&gt; Ring a
</span><a href="Reanimate.Math.Common.html#ringPack"><span class="hs-identifier hs-var">ringPack</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; Ring a)
-&gt; (APolygon a -&gt; Vector (V2 a)) -&gt; APolygon a -&gt; Ring a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">type</span><span> </span><span id="PolyCtx"><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-var">PolyCtx</span></a></span></span><span> </span><span id="local-6989586621679540254"><span class="annot"><a href="#local-6989586621679540254"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679540254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679540254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Epsilon</span></span><span> </span><span class="annot"><a href="#local-6989586621679540254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679540524"><span class="annot"><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-type">mkPolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540524"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540524"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-138"></span><span id="mkPolygon"><span class="annot"><span class="annottext">mkPolygon :: Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var hs-var">mkPolygon</span></a></span></span><span> </span><span id="local-6989586621679540253"><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540253"><span class="hs-identifier hs-var">points</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon :: forall a.
Vector (V2 a) -&gt; Int -&gt; Triangulation -&gt; Vector SSSP -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">polygonPoints :: Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var">polygonPoints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540253"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">polygonOffset :: Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var">polygonOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">polygonTriangulation :: Triangulation
</span><a href="Reanimate.Math.Polygon.html#polygonTriangulation"><span class="hs-identifier hs-var">polygonTriangulation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540252"><span class="hs-identifier hs-var">trig</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">polygonSSSP :: Vector SSSP
</span><a href="Reanimate.Math.Polygon.html#polygonSSSP"><span class="hs-identifier hs-var">polygonSSSP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; SSSP) -&gt; Vector SSSP
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540250"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; SSSP) -&gt; Vector SSSP) -&gt; (Int -&gt; SSSP) -&gt; Vector SSSP
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679540249"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540249"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ring a -&gt; Dual -&gt; SSSP
forall a.
(Fractional a, Ord a, Epsilon a) =&gt;
Ring a -&gt; Dual -&gt; SSSP
</span><a href="Reanimate.Math.SSSP.html#sssp"><span class="hs-identifier hs-var">sssp</span></a></span><span> </span><span class="annot"><span class="annottext">Ring a
</span><a href="#local-6989586621679540247"><span class="hs-identifier hs-var">ring</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Triangulation -&gt; Dual
</span><a href="Reanimate.Math.SSSP.html#dual"><span class="hs-identifier hs-var">dual</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540249"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540252"><span class="hs-identifier hs-var">trig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679540250"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679540250"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540253"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679540247"><span class="annot"><span class="annottext">ring :: Ring a
</span><a href="#local-6989586621679540247"><span class="hs-identifier hs-var hs-var">ring</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Ring a
forall a. Vector (V2 a) -&gt; Ring a
</span><a href="Reanimate.Math.Common.html#ringPack"><span class="hs-identifier hs-var">ringPack</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540253"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679540252"><span class="annot"><span class="annottext">trig :: Triangulation
</span><a href="#local-6989586621679540252"><span class="hs-identifier hs-var hs-var">trig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ring a -&gt; Triangulation
forall a. (Fractional a, Ord a) =&gt; Ring a -&gt; Triangulation
</span><a href="Reanimate.Math.Triangulate.html#triangulate"><span class="hs-identifier hs-var">triangulate</span></a></span><span> </span><span class="annot"><span class="annottext">Ring a
</span><a href="#local-6989586621679540247"><span class="hs-identifier hs-var">ring</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-comment">-- earClip ring</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="local-6989586621679540242"><span id="local-6989586621679540243"><span class="annot"><a href="Reanimate.Math.Polygon.html#castPolygon"><span class="hs-identifier hs-type">castPolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540243"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540242"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540242"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-151"></span><span id="castPolygon"><span class="annot"><span class="annottext">castPolygon :: APolygon a -&gt; APolygon b
</span><a href="Reanimate.Math.Polygon.html#castPolygon"><span class="hs-identifier hs-var hs-var">castPolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 b) -&gt; APolygon b
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 b) -&gt; APolygon b)
-&gt; (APolygon a -&gt; Vector (V2 b)) -&gt; APolygon a -&gt; APolygon b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(V2 a -&gt; V2 b) -&gt; Vector (V2 a) -&gt; Vector (V2 b)
forall a b. (a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><span class="hs-identifier hs-var">V.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; V2 a -&gt; V2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; Vector (V2 b))
-&gt; (APolygon a -&gt; Vector (V2 a)) -&gt; APolygon a -&gt; Vector (V2 b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621679540240"><span class="annot"><a href="Reanimate.Math.Polygon.html#mkPolygonFromRing"><span class="hs-identifier hs-type">mkPolygonFromRing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Common.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540240"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540240"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-154"></span><span id="mkPolygonFromRing"><span class="annot"><span class="annottext">mkPolygonFromRing :: Ring a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygonFromRing"><span class="hs-identifier hs-var hs-var">mkPolygonFromRing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a)
-&gt; (Ring a -&gt; Vector (V2 a)) -&gt; Ring a -&gt; APolygon a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ring a -&gt; Vector (V2 a)
forall a. Ring a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Common.html#ringUnpack"><span class="hs-identifier hs-var">ringUnpack</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621679540473"><span class="annot"><a href="Reanimate.Math.Polygon.html#pUnsafeMap"><span class="hs-identifier hs-type">pUnsafeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Common.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540473"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Common.html#Ring"><span class="hs-identifier hs-type">Ring</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540473"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540473"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-157"></span><span id="pUnsafeMap"><span class="annot"><span class="annottext">pUnsafeMap :: (Ring a -&gt; Ring a) -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pUnsafeMap"><span class="hs-identifier hs-var hs-var">pUnsafeMap</span></a></span></span><span> </span><span id="local-6989586621679540238"><span class="annot"><span class="annottext">Ring a -&gt; Ring a
</span><a href="#local-6989586621679540238"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679540237"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540237"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540237"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">polygonPoints :: Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var">polygonPoints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ring a -&gt; Vector (V2 a)
forall a. Ring a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Common.html#ringUnpack"><span class="hs-identifier hs-var">ringUnpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ring a -&gt; Ring a
</span><a href="#local-6989586621679540238"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Ring a
forall a. APolygon a -&gt; Ring a
</span><a href="Reanimate.Math.Polygon.html#pRing"><span class="hs-identifier hs-var">pRing</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540237"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- pParent p i j = shortest-path parent from j to i</span><span>
</span><span id="line-160"></span><span id="local-6989586621679540386"><span class="annot"><a href="Reanimate.Math.Polygon.html#pParent"><span class="hs-identifier hs-type">pParent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540386"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-161"></span><span id="pParent"><span class="annot"><span class="annottext">pParent :: APolygon a -&gt; Int -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pParent"><span class="hs-identifier hs-var hs-var">pParent</span></a></span></span><span> </span><span id="local-6989586621679540236"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540236"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540235"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540235"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679540234"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540234"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SSSP
</span><a href="#local-6989586621679540233"><span class="hs-identifier hs-var">sTree</span></a></span><span> </span><span class="annot"><span class="annottext">SSSP -&gt; Int -&gt; Int
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540234"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540236"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540229"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540236"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540229"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679540233"><span class="annot"><span class="annottext">sTree :: SSSP
</span><a href="#local-6989586621679540233"><span class="hs-identifier hs-var hs-var">sTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector SSSP
forall a. APolygon a -&gt; Vector SSSP
</span><a href="Reanimate.Math.Polygon.html#polygonSSSP"><span class="hs-identifier hs-var hs-var">polygonSSSP</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540236"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector SSSP -&gt; Int -&gt; SSSP
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540235"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540236"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540229"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621679540229"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679540229"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540236"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCopy"><span class="hs-identifier hs-type">pCopy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-168"></span><span id="pCopy"><span class="annot"><span class="annottext">pCopy :: Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pCopy"><span class="hs-identifier hs-var hs-var">pCopy</span></a></span></span><span> </span><span id="local-6989586621679540228"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540228"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; V2 Rational) -&gt; Vector (V2 Rational)
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540228"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; V2 Rational) -&gt; Vector (V2 Rational))
-&gt; (Int -&gt; V2 Rational) -&gt; Vector (V2 Rational)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540228"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span id="local-6989586621679540227"><span class="annot"><a href="Reanimate.Math.Polygon.html#pSetOffset"><span class="hs-identifier hs-type">pSetOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540227"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-171"></span><span id="pSetOffset"><span class="annot"><span class="annottext">pSetOffset :: APolygon a -&gt; Int -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pSetOffset"><span class="hs-identifier hs-var hs-var">pSetOffset</span></a></span></span><span> </span><span id="local-6989586621679540226"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540226"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540225"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540225"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540226"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">polygonOffset :: Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var">polygonOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540225"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540226"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679540427"><span class="annot"><a href="Reanimate.Math.Polygon.html#pAdjustOffset"><span class="hs-identifier hs-type">pAdjustOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540427"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-175"></span><span id="pAdjustOffset"><span class="annot"><span class="annottext">pAdjustOffset :: APolygon a -&gt; Int -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAdjustOffset"><span class="hs-identifier hs-var hs-var">pAdjustOffset</span></a></span></span><span> </span><span id="local-6989586621679540224"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540224"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540223"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540223"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540224"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">polygonOffset :: Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var">polygonOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540224"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540223"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540224"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-pragma hs-type">pSize</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-179"></span><span id="local-6989586621679540222"><span class="annot"><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-type">pSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-180"></span><span id="pSize"><span class="annot"><span class="annottext">pSize :: APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var hs-var">pSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; Int)
-&gt; (APolygon a -&gt; Vector (V2 a)) -&gt; APolygon a -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679540392"><span class="annot"><a href="Reanimate.Math.Polygon.html#pNull"><span class="hs-identifier hs-type">pNull</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540392"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-183"></span><span id="pNull"><span class="annot"><span class="annottext">pNull :: APolygon a -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pNull"><span class="hs-identifier hs-var hs-var">pNull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Bool
forall a. Vector a -&gt; Bool
</span><span class="hs-identifier hs-var">V.null</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; Bool)
-&gt; (APolygon a -&gt; Vector (V2 a)) -&gt; APolygon a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span id="local-6989586621679540451"><span class="annot"><a href="Reanimate.Math.Polygon.html#pNext"><span class="hs-identifier hs-type">pNext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-186"></span><span id="pNext"><span class="annot"><span class="annottext">pNext :: APolygon a -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pNext"><span class="hs-identifier hs-var hs-var">pNext</span></a></span></span><span> </span><span id="local-6989586621679540220"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540220"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540219"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540219"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540219"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540220"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621679540218"><span class="annot"><a href="Reanimate.Math.Polygon.html#pPrev"><span class="hs-identifier hs-type">pPrev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-189"></span><span id="pPrev"><span class="annot"><span class="annottext">pPrev :: APolygon a -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pPrev"><span class="hs-identifier hs-var hs-var">pPrev</span></a></span></span><span> </span><span id="local-6989586621679540217"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540217"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540216"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540216"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540216"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540217"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- When is a polygon valid/simple?</span><span>
</span><span id="line-192"></span><span class="hs-comment">--   It is counter-clockwise.</span><span>
</span><span id="line-193"></span><span class="hs-comment">--   No edges intersect.</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- O(n^2)</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- 'checkEdge' takes 90% of the time.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsSimple"><span class="hs-identifier hs-type">pIsSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-197"></span><span id="pIsSimple"><span class="annot"><span class="annottext">pIsSimple :: Polygon -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pIsSimple"><span class="hs-identifier hs-var hs-var">pIsSimple</span></a></span></span><span> </span><span id="local-6989586621679540215"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540215"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540215"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsSimple"><span class="hs-identifier hs-var">pIsSimple</span></a></span><span> </span><span id="local-6989586621679540213"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pIsCCW"><span class="hs-identifier hs-var">pIsCCW</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679540211"><span class="hs-identifier hs-var">noDups</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679540210"><span class="hs-identifier hs-var">checkEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679540211"><span class="annot"><span class="annottext">noDups :: Bool
</span><a href="#local-6989586621679540211"><span class="hs-identifier hs-var hs-var">noDups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; Bool
</span><a href="#local-6989586621679540209"><span class="hs-identifier hs-var">checkForDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[V2 Rational] -&gt; [V2 Rational]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; [V2 Rational]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Vector (V2 Rational)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679540209"><span class="annot"><span class="annottext">checkForDups :: [a] -&gt; Bool
</span><a href="#local-6989586621679540209"><span class="hs-identifier hs-var hs-var">checkForDups</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540208"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540208"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679540207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540207"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679540206"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679540206"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540208"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540207"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
</span><a href="#local-6989586621679540209"><span class="hs-identifier hs-var">checkForDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540207"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679540206"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="#local-6989586621679540209"><span class="hs-identifier hs-var">checkForDups</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679540204"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679540204"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- check i,i+1 against j,j+1</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- j &gt; i+1</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679540210"><span class="annot"><span class="annottext">checkEdge :: Int -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679540210"><span class="hs-identifier hs-var hs-var">checkEdge</span></a></span></span><span> </span><span id="local-6989586621679540203"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679540202"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540202"><span class="hs-identifier hs-var">j</span></a></span></span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540202"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540204"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540204"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679540210"><span class="hs-identifier hs-var">checkEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(V2 Rational, V2 Rational)
-&gt; (V2 Rational, V2 Rational) -&gt; Maybe (V2 Rational)
forall a.
(Ord a, Fractional a) =&gt;
(V2 a, V2 a) -&gt; (V2 a, V2 a) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Common.html#lineIntersect"><span class="hs-identifier hs-var">lineIntersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 Rational) -&gt; Int -&gt; V2 Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540202"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 Rational) -&gt; Int -&gt; V2 Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540202"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679540198"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540198"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540198"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540213"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-213"></span><span>          </span><span id="local-6989586621679540197"><span class="annot"><span class="annottext">Maybe (V2 Rational)
</span><a href="#local-6989586621679540197"><span class="hs-identifier hs-var">_nothing</span></a></span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
</span><a href="#local-6989586621679540210"><span class="hs-identifier hs-var">checkEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540203"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540202"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier hs-type">pScale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-216"></span><span id="pScale"><span class="annot"><span class="annottext">pScale :: Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier hs-var hs-var">pScale</span></a></span></span><span> </span><span id="local-6989586621679540196"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540196"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ring Rational -&gt; Ring Rational) -&gt; Polygon -&gt; Polygon
forall a. (Ring a -&gt; Ring a) -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pUnsafeMap"><span class="hs-identifier hs-var">pUnsafeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 Rational -&gt; V2 Rational) -&gt; Ring Rational -&gt; Ring Rational
forall a b. (V2 a -&gt; V2 b) -&gt; Ring a -&gt; Ring b
</span><a href="Reanimate.Math.Common.html#ringMap"><span class="hs-identifier hs-var">ringMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; Rational -&gt; V2 Rational
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; f a -&gt; a -&gt; f a
</span><span class="hs-operator hs-var">^*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540196"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAtCentroid"><span class="hs-identifier hs-type">pAtCentroid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-219"></span><span id="pAtCentroid"><span class="annot"><span class="annottext">pAtCentroid :: Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pAtCentroid"><span class="hs-identifier hs-var hs-var">pAtCentroid</span></a></span></span><span> </span><span id="local-6989586621679540193"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540193"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pTranslate"><span class="hs-identifier hs-var">pTranslate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540192"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540193"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679540192"><span class="annot"><span class="annottext">c :: V2 Rational
</span><a href="#local-6989586621679540192"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; V2 Rational
forall a. Fractional a =&gt; APolygon a -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pCentroid"><span class="hs-identifier hs-var">pCentroid</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Rational -&gt; V2 Rational
forall (f :: * -&gt; *) a.
(Functor f, Fractional a) =&gt;
f a -&gt; a -&gt; f a
</span><span class="hs-operator hs-var">^/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAtCenter"><span class="hs-identifier hs-type">pAtCenter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-223"></span><span id="pAtCenter"><span class="annot"><span class="annottext">pAtCenter :: Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pAtCenter"><span class="hs-identifier hs-var hs-var">pAtCenter</span></a></span></span><span> </span><span id="local-6989586621679540190"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540190"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pTranslate"><span class="hs-identifier hs-var">pTranslate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">(V2 Rational -&gt; V2 Rational) -&gt; V2 Rational -&gt; V2 Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; V2 Rational
</span><a href="Reanimate.Math.Polygon.html#pCenter"><span class="hs-identifier hs-var">pCenter</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540190"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540190"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pTranslate"><span class="hs-identifier hs-type">pTranslate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-226"></span><span id="pTranslate"><span class="annot"><span class="annottext">pTranslate :: V2 Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pTranslate"><span class="hs-identifier hs-var hs-var">pTranslate</span></a></span></span><span> </span><span id="local-6989586621679540189"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540189"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ring Rational -&gt; Ring Rational) -&gt; Polygon -&gt; Polygon
forall a. (Ring a -&gt; Ring a) -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pUnsafeMap"><span class="hs-identifier hs-var">pUnsafeMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 Rational -&gt; V2 Rational) -&gt; Ring Rational -&gt; Ring Rational
forall a b. (V2 a -&gt; V2 b) -&gt; Ring a -&gt; Ring b
</span><a href="Reanimate.Math.Common.html#ringMap"><span class="hs-identifier hs-var">ringMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; V2 Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540189"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCenter"><span class="hs-identifier hs-type">pCenter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-229"></span><span id="pCenter"><span class="annot"><span class="annottext">pCenter :: Polygon -&gt; V2 Rational
</span><a href="Reanimate.Math.Polygon.html#pCenter"><span class="hs-identifier hs-var hs-var">pCenter</span></a></span></span><span> </span><span id="local-6989586621679540188"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540188"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540186"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540185"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540183"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540182"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679540186"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540186"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540183"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540183"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540185"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540185"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540182"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540182"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; (Rational, Rational, Rational, Rational)
</span><a href="Reanimate.Math.Polygon.html#pBoundingBox"><span class="hs-identifier hs-var">pBoundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540188"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- Returns (min-x, min-y, width, height)</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pBoundingBox"><span class="hs-identifier hs-type">pBoundingBox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="pBoundingBox"><span class="annot"><span class="annottext">pBoundingBox :: Polygon -&gt; (Rational, Rational, Rational, Rational)
</span><a href="Reanimate.Math.Polygon.html#pBoundingBox"><span class="hs-identifier hs-var hs-var">pBoundingBox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679540181"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540181"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540180"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540180"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679540179"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540179"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540181"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Rational, Rational, Rational, Rational)
 -&gt; V2 Rational -&gt; (Rational, Rational, Rational, Rational))
-&gt; (Rational, Rational, Rational, Rational)
-&gt; Vector (V2 Rational)
-&gt; (Rational, Rational, Rational, Rational)
forall a b. (a -&gt; b -&gt; a) -&gt; a -&gt; Vector b -&gt; a
</span><span class="hs-identifier hs-var">V.foldl'</span></span><span> </span><span class="annot"><span class="annottext">(Rational, Rational, Rational, Rational)
-&gt; V2 Rational -&gt; (Rational, Rational, Rational, Rational)
forall d. Ord d =&gt; (d, d, d, d) -&gt; V2 d -&gt; (d, d, d, d)
</span><a href="#local-6989586621679540178"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540180"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540179"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Vector (V2 Rational)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540181"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679540177"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540177"><span class="hs-identifier hs-var">xMin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540176"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540176"><span class="hs-identifier hs-var">yMin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540175"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540175"><span class="hs-identifier hs-var">xMax</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540174"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540174"><span class="hs-identifier hs-var">yMax</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540177"><span class="hs-identifier hs-var">xMin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540176"><span class="hs-identifier hs-var">yMin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540175"><span class="hs-identifier hs-var">xMax</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540177"><span class="hs-identifier hs-var">xMin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540174"><span class="hs-identifier hs-var">yMax</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679540176"><span class="hs-identifier hs-var">yMin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679540178"><span class="annot"><span class="annottext">worker :: (d, d, d, d) -&gt; V2 d -&gt; (d, d, d, d)
</span><a href="#local-6989586621679540178"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540173"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540173"><span class="hs-identifier hs-var">xMin</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540172"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540172"><span class="hs-identifier hs-var">yMin</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540171"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540171"><span class="hs-identifier hs-var">xMax</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540170"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540170"><span class="hs-identifier hs-var">yMax</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540169"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540169"><span class="hs-identifier hs-var">thisX</span></a></span></span><span> </span><span id="local-6989586621679540168"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540168"><span class="hs-identifier hs-var">thisY</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540173"><span class="hs-identifier hs-var">xMin</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540169"><span class="hs-identifier hs-var">thisX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540172"><span class="hs-identifier hs-var">yMin</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540168"><span class="hs-identifier hs-var">thisY</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="hs-special">,</span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540171"><span class="hs-identifier hs-var">xMax</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540169"><span class="hs-identifier hs-var">thisX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d -&gt; d -&gt; d
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540170"><span class="hs-identifier hs-var">yMax</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679540168"><span class="hs-identifier hs-var">thisY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- Place n points on a circle, use one parameter to slide the points back and forth.</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- Use second parameter to move points closer to center circle.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier hs-type">pGenerate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-248"></span><span id="pGenerate"><span class="annot"><span class="annottext">pGenerate :: [(Double, Double)] -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier hs-var hs-var">pGenerate</span></a></span></span><span> </span><span id="local-6989586621679540165"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679540165"><span class="hs-identifier hs-var">points</span></a></span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540164"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Polygon
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pGenerate: require at least four points&quot;</span></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Rational) -&gt; Double -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540161"><span class="hs-identifier hs-var">ang</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540159"><span class="hs-identifier hs-var">rMod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Rational) -&gt; Double -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540161"><span class="hs-identifier hs-var">ang</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540159"><span class="hs-identifier hs-var">rMod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540157"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540157"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679540156"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540156"><span class="hs-identifier hs-var">angMod</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540159"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540159"><span class="hs-identifier hs-var">rMod</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [(Double, Double)] -&gt; [(Double, (Double, Double))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679540165"><span class="hs-identifier hs-var">points</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540155"><span class="annot"><span class="annottext">minAngle :: Double
</span><a href="#local-6989586621679540155"><span class="hs-identifier hs-var hs-var">minAngle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540154"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540164"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540157"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-255"></span><span>        </span><span id="local-6989586621679540152"><span class="annot"><span class="annottext">maxAngle :: Double
</span><a href="#local-6989586621679540152"><span class="hs-identifier hs-var hs-var">maxAngle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540154"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540164"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540157"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679540161"><span class="annot"><span class="annottext">ang :: Double
</span><a href="#local-6989586621679540161"><span class="hs-identifier hs-var hs-var">ang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540155"><span class="hs-identifier hs-var">minAngle</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540152"><span class="hs-identifier hs-var">maxAngle</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540155"><span class="hs-identifier hs-var">minAngle</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540156"><span class="hs-identifier hs-var">angMod</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679540154"><span class="annot"><span class="annottext">tau :: Double
</span><a href="#local-6989586621679540154"><span class="hs-identifier hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679540164"><span class="annot"><span class="annottext">len :: Double
</span><a href="#local-6989586621679540164"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679540165"><span class="hs-identifier hs-var">points</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pUnGenerate"><span class="hs-identifier hs-type">pUnGenerate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span id="pUnGenerate"><span class="annot"><span class="annottext">pUnGenerate :: Polygon -&gt; [(Double, Double)]
</span><a href="Reanimate.Math.Polygon.html#pUnGenerate"><span class="hs-identifier hs-var hs-var">pUnGenerate</span></a></span></span><span> </span><span id="local-6989586621679540151"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540151"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Double -&gt; V2 Double -&gt; (Double, Double)
</span><a href="#local-6989586621679540150"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540149"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Double) -&gt; V2 Rational -&gt; V2 Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540148"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540149"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540149"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540148"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540148"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [V2 Rational] -&gt; [(Double, V2 Rational)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; [V2 Rational]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; [V2 Rational])
-&gt; Vector (V2 Rational) -&gt; [V2 Rational]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Vector (V2 Rational)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540151"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679540147"><span class="annot"><span class="annottext">len :: Double
</span><a href="#local-6989586621679540147"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540151"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679540150"><span class="annot"><span class="annottext">worker :: Double -&gt; V2 Double -&gt; (Double, Double)
</span><a href="#local-6989586621679540150"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679540146"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540146"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540145"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540145"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679540144"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540144"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540143"><span class="annot"><span class="annottext">ang :: Double
</span><a href="#local-6989586621679540143"><span class="hs-identifier hs-var hs-var">ang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540144"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540145"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-270"></span><span>          </span><span id="local-6989586621679540141"><span class="annot"><span class="annottext">minAngle :: Double
</span><a href="#local-6989586621679540141"><span class="hs-identifier hs-var hs-var">minAngle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540140"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540147"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540146"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-271"></span><span>          </span><span id="local-6989586621679540139"><span class="annot"><span class="annottext">maxAngle :: Double
</span><a href="#local-6989586621679540139"><span class="hs-identifier hs-var hs-var">maxAngle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540140"><span class="hs-identifier hs-var">tau</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540147"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540146"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540143"><span class="hs-identifier hs-var">ang</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540141"><span class="hs-identifier hs-var">minAngle</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540139"><span class="hs-identifier hs-var">maxAngle</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540141"><span class="hs-identifier hs-var">minAngle</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540145"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540145"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540144"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540144"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679540140"><span class="annot"><span class="annottext">tau :: Double
</span><a href="#local-6989586621679540140"><span class="hs-identifier hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- When is a triangulation valid?</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   Intersection: No internal edges intersect.</span><span>
</span><span id="line-277"></span><span class="hs-comment">--   Completeness: All edge neighbours share a single internal edge.</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#isValidTriangulation"><span class="hs-identifier hs-type">isValidTriangulation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Triangulate.html#Triangulation"><span class="hs-identifier hs-type">Triangulation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-279"></span><span id="isValidTriangulation"><span class="annot"><span class="annottext">isValidTriangulation :: Polygon -&gt; Triangulation -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#isValidTriangulation"><span class="hs-identifier hs-var hs-var">isValidTriangulation</span></a></span></span><span> </span><span id="local-6989586621679540137"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540136"><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540136"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679540135"><span class="hs-identifier hs-var">isComplete</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679540134"><span class="hs-identifier hs-var">intersectionFree</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679540133"><span class="annot"><span class="annottext">o :: Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679540135"><span class="annot"><span class="annottext">isComplete :: Bool
</span><a href="#local-6989586621679540135"><span class="hs-identifier hs-var hs-var">isComplete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679540131"><span class="hs-identifier hs-var">isProper</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679540131"><span class="annot"><span class="annottext">isProper :: Int -&gt; Bool
</span><a href="#local-6989586621679540131"><span class="hs-identifier hs-var hs-var">isProper</span></a></span></span><span> </span><span id="local-6989586621679540130"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540130"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540129"><span class="annot"><span class="annottext">j :: Int
</span><a href="#local-6989586621679540129"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; Int
forall a. APolygon a -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pNext"><span class="hs-identifier hs-var">pNext</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540130"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; Int
forall a. APolygon a -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pPrev"><span class="hs-identifier hs-var">pPrev</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540130"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540136"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Triangulation -&gt; Int -&gt; [Int]
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540130"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [Int]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; Int
forall a. APolygon a -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pNext"><span class="hs-identifier hs-var">pNext</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540129"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540136"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Triangulation -&gt; Int -&gt; [Int]
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540129"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679540134"><span class="annot"><span class="annottext">intersectionFree :: Bool
</span><a href="#local-6989586621679540134"><span class="hs-identifier hs-var hs-var">intersectionFree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span>
</span><span id="line-287"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(V2 Rational, V2 Rational)
-&gt; (V2 Rational, V2 Rational) -&gt; Maybe (V2 Rational)
forall a.
(Ord a, Fractional a) =&gt;
(V2 a, V2 a) -&gt; (V2 a, V2 a) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Common.html#lineIntersect"><span class="hs-identifier hs-var">lineIntersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540127"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540126"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540125"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540124"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-288"></span><span>          </span><span class="annot"><span class="annottext">Maybe (V2 Rational)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-289"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679540123"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540123"><span class="hs-identifier hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540123"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540127"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540123"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540126"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-290"></span><span>                     </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540123"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540125"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540123"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540124"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540133"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679540127"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540127"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540126"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540126"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679540125"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540125"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679540124"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540124"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((Int, Int), (Int, Int))]
</span><a href="#local-6989586621679540122"><span class="hs-identifier hs-var">edgePairs</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679540122"><span class="annot"><span class="annottext">edgePairs :: [((Int, Int), (Int, Int))]
</span><a href="#local-6989586621679540122"><span class="hs-identifier hs-var hs-var">edgePairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679540121"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679540120"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540121"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679540121"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540119"><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679540119"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; [[(Int, Int)]] -&gt; [((Int, Int), [(Int, Int)])]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679540118"><span class="hs-identifier hs-var">edges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [[(Int, Int)]] -&gt; [[(Int, Int)]]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([[(Int, Int)]] -&gt; [[(Int, Int)]])
-&gt; [[(Int, Int)]] -&gt; [[(Int, Int)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; [[(Int, Int)]]
forall a. [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">tails</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679540118"><span class="hs-identifier hs-var">edges</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540120"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679540120"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Int, Int)]
</span><a href="#local-6989586621679540119"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679540118"><span class="annot"><span class="annottext">edges :: [(Int, Int)]
</span><a href="#local-6989586621679540118"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540116"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540115"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540116"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540116"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540114"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679540114"><span class="hs-identifier hs-var">lst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [[Int]] -&gt; [(Int, [Int])]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triangulation -&gt; [[Int]]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span> </span><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540136"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540115"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540115"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679540114"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540116"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540115"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#triangulationsToPolygons"><span class="hs-identifier hs-type">triangulationsToPolygons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Triangulate.html#Triangulation"><span class="hs-identifier hs-type">Triangulation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span id="triangulationsToPolygons"><span class="annot"><span class="annottext">triangulationsToPolygons :: Polygon -&gt; Triangulation -&gt; [Polygon]
</span><a href="Reanimate.Math.Polygon.html#triangulationsToPolygons"><span class="hs-identifier hs-var hs-var">triangulationsToPolygons</span></a></span></span><span> </span><span id="local-6989586621679540113"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540113"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540112"><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540112"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540113"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540111"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540113"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540110"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540113"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540109"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679540110"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540110"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540113"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540108"><span class="annot"><span class="annottext">js :: [Int]
</span><a href="#local-6989586621679540108"><span class="hs-identifier hs-var hs-var">js</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Int]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540110"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Triangulation
</span><a href="#local-6989586621679540112"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Triangulation -&gt; Int -&gt; [Int]
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540110"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540111"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540111"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540109"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540109"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [(Int, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540110"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679540108"><span class="hs-identifier hs-var">js</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679540108"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsInside"><span class="hs-identifier hs-type">pIsInside</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-310"></span><span id="pIsInside"><span class="annot"><span class="annottext">pIsInside :: Polygon -&gt; V2 Rational -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pIsInside"><span class="hs-identifier hs-var hs-var">pIsInside</span></a></span></span><span> </span><span id="local-6989586621679540107"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540107"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540106"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540106"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; V2 Rational -&gt; V2 Rational -&gt; Bool
forall a.
(Fractional a, Ord a) =&gt;
V2 a -&gt; V2 a -&gt; V2 a -&gt; V2 a -&gt; Bool
</span><a href="Reanimate.Math.Common.html#isInside"><span class="hs-identifier hs-var">isInside</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; V2 Rational
</span><a href="#local-6989586621679540103"><span class="hs-identifier hs-var">rawAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540102"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; V2 Rational
</span><a href="#local-6989586621679540103"><span class="hs-identifier hs-var">rawAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540101"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; V2 Rational
</span><a href="#local-6989586621679540103"><span class="hs-identifier hs-var">rawAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540100"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540106"><span class="hs-identifier hs-var">point</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679540101"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540101"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540107"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540099"><span class="annot"><span class="annottext">js :: [Int]
</span><a href="#local-6989586621679540099"><span class="hs-identifier hs-var hs-var">js</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Int]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540101"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Triangulation
forall a. APolygon a -&gt; Triangulation
</span><a href="Reanimate.Math.Polygon.html#polygonTriangulation"><span class="hs-identifier hs-var hs-var">polygonTriangulation</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540107"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Triangulation -&gt; Int -&gt; [Int]
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540101"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679540102"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540102"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679540100"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540100"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [(Int, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540101"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679540099"><span class="hs-identifier hs-var">js</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679540099"><span class="hs-identifier hs-var">js</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679540103"><span class="annot"><span class="annottext">rawAccess :: Int -&gt; V2 Rational
</span><a href="#local-6989586621679540103"><span class="hs-identifier hs-var hs-var">rawAccess</span></a></span></span><span> </span><span id="local-6989586621679540098"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540098"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Vector (V2 Rational)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540107"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Int -&gt; V2 Rational
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540098"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- reducePolygons :: Int -&gt; [Polygon] -&gt; [Polygon]</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- reducePolygons n ps</span><span>
</span><span id="line-321"></span><span class="hs-comment">--   | length ps &lt;= n = ps</span><span>
</span><span id="line-322"></span><span class="hs-comment">--   | otherwise =</span><span>
</span><span id="line-323"></span><span class="hs-comment">--     let p = findSmallest ps</span><span>
</span><span id="line-324"></span><span class="hs-comment">--         es = edges p</span><span>
</span><span id="line-325"></span><span class="hs-comment">--         e = findSmallest es</span><span>
</span><span id="line-326"></span><span class="hs-comment">--     in reducePolygons n (merge p e : delete p (delete e ps))</span><span>
</span><span id="line-327"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-328"></span><span class="hs-comment">--     findSmallest = minimumBy (comparing area2X)</span><span>
</span><span id="line-329"></span><span class="hs-comment">--     shareEdge p1 p2 =</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-pragma hs-type">pAccess</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-332"></span><span id="local-6989586621679540487"><span class="annot"><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-type">pAccess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540487"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540487"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-333"></span><span id="pAccess"><span class="annot"><span class="annottext">pAccess :: APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var hs-var">pAccess</span></a></span></span><span> </span><span id="local-6989586621679540097"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540097"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540096"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540096"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- polygonPoints p V.! ((polygonOffset p + i) `mod` pSize p)</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#polygonOffset"><span class="hs-identifier hs-var hs-var">polygonOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540096"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540097"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#triangle"><span class="hs-identifier hs-type">triangle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-337"></span><span id="triangle"><span class="annot"><span class="annottext">triangle :: Polygon
</span><a href="Reanimate.Math.Polygon.html#triangle"><span class="hs-identifier hs-var hs-var">triangle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#triangle%27"><span class="hs-identifier hs-type">triangle'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Math.Polygon.html#P"><span class="hs-identifier hs-type">P</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-340"></span><span id="triangle%27"><span class="annot"><span class="annottext">triangle' :: [V2 Double]
</span><a href="Reanimate.Math.Polygon.html#triangle%27"><span class="hs-identifier hs-var hs-var">triangle'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[V2 Double] -&gt; [V2 Double]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; V2 Double
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; V2 Double
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; V2 Double
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape1"><span class="hs-identifier hs-type">shape1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-343"></span><span id="shape1"><span class="annot"><span class="annottext">shape1 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape1"><span class="hs-identifier hs-var hs-var">shape1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">6</span></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape2"><span class="hs-identifier hs-type">shape2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-349"></span><span id="shape2"><span class="annot"><span class="annottext">shape2 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape2"><span class="hs-identifier hs-var hs-var">shape2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape3"><span class="hs-identifier hs-type">shape3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-354"></span><span id="shape3"><span class="annot"><span class="annottext">shape3 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape3"><span class="hs-identifier hs-var hs-var">shape3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape4"><span class="hs-identifier hs-type">shape4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-358"></span><span id="shape4"><span class="annot"><span class="annottext">shape4 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape4"><span class="hs-identifier hs-var hs-var">shape4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape5"><span class="hs-identifier hs-type">shape5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-362"></span><span id="shape5"><span class="annot"><span class="annottext">shape5 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape5"><span class="hs-identifier hs-var hs-var">shape5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; [Polygon]
forall a. APolygon a -&gt; [APolygon a]
</span><a href="Reanimate.Math.Polygon.html#pCycles"><span class="hs-identifier hs-var">pCycles</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="Reanimate.Math.Polygon.html#shape4"><span class="hs-identifier hs-var">shape4</span></a></span><span> </span><span class="annot"><span class="annottext">[Polygon] -&gt; Int -&gt; Polygon
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- square</span><span>
</span><span id="line-365"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape6"><span class="hs-identifier hs-type">shape6</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-366"></span><span id="shape6"><span class="annot"><span class="annottext">shape6 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape6"><span class="hs-identifier hs-var hs-var">shape6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape7"><span class="hs-identifier hs-type">shape7</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-369"></span><span id="shape7"><span class="annot"><span class="annottext">shape7 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape7"><span class="hs-identifier hs-var hs-var">shape7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier hs-var">pScale</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">6</span></span><span> </span><span class="annot"><span class="annottext">(Polygon -&gt; Polygon) -&gt; Polygon -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-370"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1567171105775771</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">144115188075855872</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7758063241391039</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1152921504606846976</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2711114907999263</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">18014398509481984</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3561889280168807</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">18014398509481984</span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">6897139157863177</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">72057594037927936</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1632144794297397</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4503599627370496</span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">5592137945106423</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">36028797018963968</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">71351641856107</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">281474976710656</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2568147525079071</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4503599627370496</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4312925637247687</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">18014398509481984</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1291079014395023</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2251799813685248</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">321513444515769</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2251799813685248</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2071709221627247</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4503599627370496</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4019115966736491</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9007199254740992</span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1589087869859839</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">144115188075855872</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4904023654354179</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">9007199254740992</span></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2328090886101149</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">36028797018963968</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2587887893460759</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">36028797018963968</span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7990199074159871</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">18014398509481984</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1301850651537745</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Rational
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">4503599627370496</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape8"><span class="hs-identifier hs-type">shape8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-382"></span><span id="shape8"><span class="annot"><span class="annottext">shape8 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape8"><span class="hs-identifier hs-var hs-var">shape8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier hs-var">pScale</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(Polygon -&gt; Polygon) -&gt; Polygon -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier hs-var">pGenerate</span></a></span><span>
</span><span id="line-383"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.36</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.8e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape9"><span class="hs-identifier hs-type">shape9</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-386"></span><span id="shape9"><span class="annot"><span class="annottext">shape9 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape9"><span class="hs-identifier hs-var hs-var">shape9</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier hs-var">pScale</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(Polygon -&gt; Polygon) -&gt; Polygon -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier hs-var">pGenerate</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.6</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape10"><span class="hs-identifier hs-type">shape10</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-390"></span><span id="shape10"><span class="annot"><span class="annottext">shape10 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape10"><span class="hs-identifier hs-var hs-var">shape10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier hs-var">pGenerate</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.9</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5.0e-2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.9</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.6</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape11"><span class="hs-identifier hs-type">shape11</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-394"></span><span id="shape11"><span class="annot"><span class="annottext">shape11 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape11"><span class="hs-identifier hs-var hs-var">shape11</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pGenerate"><span class="hs-identifier hs-var">pGenerate</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.6</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.4</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.9</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">6.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0e-2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4.0e-2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.8</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape12"><span class="hs-identifier hs-type">shape12</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-398"></span><span id="shape12"><span class="annot"><span class="annottext">shape12 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape12"><span class="hs-identifier hs-var hs-var">shape12</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.5</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- F shape</span><span>
</span><span id="line-402"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape13"><span class="hs-identifier hs-type">shape13</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-403"></span><span id="shape13"><span class="annot"><span class="annottext">shape13 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape13"><span class="hs-identifier hs-var hs-var">shape13</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; [Polygon]
forall a. APolygon a -&gt; [APolygon a]
</span><a href="Reanimate.Math.Polygon.html#pCycles"><span class="hs-identifier hs-var">pCycles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Vector (V2 Rational)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.7</span></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Polygon] -&gt; Int -&gt; Polygon
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- E shape</span><span>
</span><span id="line-410"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape14"><span class="hs-identifier hs-type">shape14</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-411"></span><span id="shape14"><span class="annot"><span class="annottext">shape14 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape14"><span class="hs-identifier hs-var hs-var">shape14</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; [Polygon]
forall a. APolygon a -&gt; [APolygon a]
</span><a href="Reanimate.Math.Polygon.html#pCycles"><span class="hs-identifier hs-var">pCycles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Vector (V2 Rational)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Vector (V2 Rational))
-&gt; Vector (V2 Rational) -&gt; Vector (V2 Rational)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="hs-comment">-- up</span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="hs-comment">-- first prong</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span> </span><span class="hs-comment">-- second prong</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- last prong</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Polygon] -&gt; Int -&gt; Polygon
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">--</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape15"><span class="hs-identifier hs-type">shape15</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-420"></span><span id="shape15"><span class="annot"><span class="annottext">shape15 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape15"><span class="hs-identifier hs-var hs-var">shape15</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape16"><span class="hs-identifier hs-type">shape16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-426"></span><span id="shape16"><span class="annot"><span class="annottext">shape16 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape16"><span class="hs-identifier hs-var hs-var">shape16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape17"><span class="hs-identifier hs-type">shape17</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-432"></span><span id="shape17"><span class="annot"><span class="annottext">shape17 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape17"><span class="hs-identifier hs-var hs-var">shape17</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape18"><span class="hs-identifier hs-type">shape18</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-438"></span><span id="shape18"><span class="annot"><span class="annottext">shape18 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape18"><span class="hs-identifier hs-var hs-var">shape18</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape19"><span class="hs-identifier hs-type">shape19</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-444"></span><span id="shape19"><span class="annot"><span class="annottext">shape19 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape19"><span class="hs-identifier hs-var hs-var">shape19</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape20"><span class="hs-identifier hs-type">shape20</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-451"></span><span id="shape20"><span class="annot"><span class="annottext">shape20 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape20"><span class="hs-identifier hs-var hs-var">shape20</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.5</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape21"><span class="hs-identifier hs-type">shape21</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-464"></span><span id="shape21"><span class="annot"><span class="annottext">shape21 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape21"><span class="hs-identifier hs-var hs-var">shape21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3.0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.0</span></span><span class="hs-special">]</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape22"><span class="hs-identifier hs-type">shape22</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-469"></span><span id="shape22"><span class="annot"><span class="annottext">shape22 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape22"><span class="hs-identifier hs-var hs-var">shape22</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pScale"><span class="hs-identifier hs-var">pScale</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Polygon -&gt; Polygon) -&gt; Polygon -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.17</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.08</span></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.34</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.21</span></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.60</span></span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.14</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.19</span></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.05</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.03</span></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#shape23"><span class="hs-identifier hs-type">shape23</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-479"></span><span id="shape23"><span class="annot"><span class="annottext">shape23 :: Polygon
</span><a href="Reanimate.Math.Polygon.html#shape23"><span class="hs-identifier hs-var hs-var">shape23</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#concave"><span class="hs-identifier hs-type">concave</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-488"></span><span id="concave"><span class="annot"><span class="annottext">concave :: Polygon
</span><a href="Reanimate.Math.Polygon.html#concave"><span class="hs-identifier hs-var hs-var">concave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pMkWinding"><span class="hs-identifier hs-type">pMkWinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-492"></span><span id="pMkWinding"><span class="annot"><span class="annottext">pMkWinding :: Int -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pMkWinding"><span class="hs-identifier hs-var hs-var">pMkWinding</span></a></span></span><span> </span><span id="local-6989586621679540090"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540090"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540090"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Polygon
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Polygon must have at least one winding.&quot;</span></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pMkWinding"><span class="hs-identifier hs-var">pMkWinding</span></a></span><span> </span><span id="local-6989586621679540089"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540089"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 Rational) -&gt; Polygon)
-&gt; Vector (V2 Rational) -&gt; Polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; Vector (V2 Rational)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([V2 Rational] -&gt; Vector (V2 Rational))
-&gt; [V2 Rational] -&gt; Vector (V2 Rational)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540088"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [V2 Rational] -&gt; [V2 Rational]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540087"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [V2 Rational] -&gt; [V2 Rational]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Int -&gt; Int -&gt; V2 Rational -&gt; [V2 Rational]
forall t.
Real t =&gt;
V2 Rational -&gt; t -&gt; t -&gt; V2 Rational -&gt; [V2 Rational]
</span><a href="#local-6989586621679540086"><span class="hs-identifier hs-var">walkTo</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540087"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540089"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; [V2 Rational] -&gt; [V2 Rational]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[V2 Rational] -&gt; [V2 Rational]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; Int -&gt; Int -&gt; V2 Rational -&gt; [V2 Rational]
forall t.
Real t =&gt;
V2 Rational -&gt; t -&gt; t -&gt; V2 Rational -&gt; [V2 Rational]
</span><a href="#local-6989586621679540086"><span class="hs-identifier hs-var">walkTo</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540088"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540089"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621679540088"><span class="annot"><span class="annottext">p0 :: V2 Rational
</span><a href="#local-6989586621679540088"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621679540087"><span class="annot"><span class="annottext">p1 :: V2 Rational
</span><a href="#local-6989586621679540087"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; V2 Rational
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-498"></span><span>    </span><span id="local-6989586621679540086"><span class="annot"><span class="annottext">walkTo :: V2 Rational -&gt; t -&gt; t -&gt; V2 Rational -&gt; [V2 Rational]
</span><a href="#local-6989586621679540086"><span class="hs-identifier hs-var hs-var">walkTo</span></a></span></span><span> </span><span id="local-6989586621679540085"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540085"><span class="hs-identifier hs-var">at</span></a></span></span><span> </span><span id="local-6989586621679540084"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540084"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679540083"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540083"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679540082"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540082"><span class="hs-identifier hs-var">dir</span></a></span></span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540084"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540083"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-501"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540081"><span class="annot"><span class="annottext">newAt :: V2 Rational
</span><a href="#local-6989586621679540081"><span class="hs-identifier hs-var hs-var">newAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540085"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; V2 Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540082"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Rational -&gt; V2 Rational
forall (f :: * -&gt; *) a. (Functor f, Num a) =&gt; f a -&gt; a -&gt; f a
</span><span class="hs-operator hs-var">^*</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540084"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540081"><span class="hs-identifier hs-var">newAt</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [V2 Rational] -&gt; [V2 Rational]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; t -&gt; t -&gt; V2 Rational -&gt; [V2 Rational]
</span><a href="#local-6989586621679540086"><span class="hs-identifier hs-var">walkTo</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540081"><span class="hs-identifier hs-var">newAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540084"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679540083"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational
forall a. Num a =&gt; V2 a -&gt; V2 a
</span><a href="#local-6989586621679540080"><span class="hs-identifier hs-var">rot</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540082"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621679540080"><span class="annot"><span class="annottext">rot :: V2 a -&gt; V2 a
</span><a href="#local-6989586621679540080"><span class="hs-identifier hs-var hs-var">rot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540079"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540079"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679540078"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540078"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; a -&gt; V2 a
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540078"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540079"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pDeoverlap"><span class="hs-identifier hs-type">pDeoverlap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span>
</span><span id="line-507"></span><span id="pDeoverlap"><span class="annot"><span class="annottext">pDeoverlap :: Polygon -&gt; Polygon
</span><a href="Reanimate.Math.Polygon.html#pDeoverlap"><span class="hs-identifier hs-var hs-var">pDeoverlap</span></a></span></span><span> </span><span id="local-6989586621679540077"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Polygon
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational)
</span><a href="#local-6989586621679540076"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>    </span><span id="local-6989586621679540076"><span class="annot"><span class="annottext">arr :: Vector (V2 Rational)
</span><a href="#local-6989586621679540076"><span class="hs-identifier hs-var hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; V2 Rational) -&gt; Vector (V2 Rational)
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; V2 Rational
</span><a href="#local-6989586621679540075"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span id="local-6989586621679540075"><span class="annot"><span class="annottext">worker :: Int -&gt; V2 Rational
</span><a href="#local-6989586621679540075"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><a href="#local-6989586621679540075"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679540074"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540074"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SSSP -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; Vector (V2 Rational) -&gt; SSSP
forall a. Eq a =&gt; a -&gt; Vector a -&gt; SSSP
</span><span class="hs-identifier hs-var">V.elemIndices</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540074"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Vector (V2 Rational)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-513"></span><span>        </span><span class="hs-keyword">then</span><span>
</span><span id="line-514"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679540072"><span class="annot"><span class="annottext">prev :: V2 Rational
</span><a href="#local-6989586621679540072"><span class="hs-identifier hs-var hs-var">prev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational)
</span><a href="#local-6989586621679540076"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 Rational) -&gt; Int -&gt; V2 Rational
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540074"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>              </span><span id="local-6989586621679540071"><span class="annot"><span class="annottext">this :: V2 Rational
</span><a href="#local-6989586621679540071"><span class="hs-identifier hs-var hs-var">this</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540074"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-516"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; V2 Rational -&gt; V2 Rational -&gt; V2 Rational
forall (f :: * -&gt; *) a.
(Additive f, Num a) =&gt;
a -&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-identifier hs-var">lerp</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.99999</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540071"><span class="hs-identifier hs-var">this</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679540072"><span class="hs-identifier hs-var">prev</span></a></span><span>
</span><span id="line-517"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679540077"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540074"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span id="local-6989586621679540442"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCycles"><span class="hs-identifier hs-type">pCycles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540442"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-520"></span><span id="pCycles"><span class="annot"><span class="annottext">pCycles :: APolygon a -&gt; [APolygon a]
</span><a href="Reanimate.Math.Polygon.html#pCycles"><span class="hs-identifier hs-var hs-var">pCycles</span></a></span></span><span> </span><span id="local-6989586621679540069"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540069"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; APolygon a) -&gt; [Int] -&gt; [APolygon a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; APolygon a
forall a. APolygon a -&gt; Int -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAdjustOffset"><span class="hs-identifier hs-var">pAdjustOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540069"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540069"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span id="local-6989586621679540068"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCycle"><span class="hs-identifier hs-type">pCycle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540068"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-523"></span><span id="pCycle"><span class="annot"><span class="annottext">pCycle :: APolygon a -&gt; Double -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pCycle"><span class="hs-identifier hs-var hs-var">pCycle</span></a></span></span><span> </span><span id="local-6989586621679540067"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540067"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540067"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-524"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pCycle"><span class="hs-identifier hs-var">pCycle</span></a></span><span> </span><span id="local-6989586621679540066"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679540065"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540065"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int -&gt; Vector (V2 a)
</span><a href="#local-6989586621679540064"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-526"></span><span>    </span><span id="local-6989586621679540064"><span class="annot"><span class="annottext">worker :: Double -&gt; Int -&gt; Vector (V2 a)
</span><a href="#local-6989586621679540064"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679540063"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540063"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679540062"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540061"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540063"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540060"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-528"></span><span>        </span><span class="annot"><span class="annottext">V2 a -&gt; Vector (V2 a)
forall a. a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; V2 a -&gt; V2 a -&gt; V2 a
forall (f :: * -&gt; *) a.
(Additive f, Num a) =&gt;
a -&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-identifier hs-var">lerp</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; a
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; a) -&gt; Double -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540061"><span class="hs-identifier hs-var">segment</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540063"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540060"><span class="hs-identifier hs-var">limit</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540061"><span class="hs-identifier hs-var">segment</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679540058"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679540057"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Vector (V2 a) -&gt; Vector (V2 a)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-529"></span><span>        </span><span class="hs-comment">-- V.drop (i+1) (polygonPoints p) &lt;&gt;</span><span>
</span><span id="line-530"></span><span>        </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; [Int] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Vector (V2 a) -&gt; Vector (V2 a)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; [Int] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>        </span><span class="hs-comment">-- V.take (i+1) (polygonPoints p)</span><span>
</span><span id="line-533"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; [Int] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int -&gt; Vector (V2 a)
</span><a href="#local-6989586621679540064"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540063"><span class="hs-identifier hs-var">acc</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540061"><span class="hs-identifier hs-var">segment</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-536"></span><span>          </span><span id="local-6989586621679540058"><span class="annot"><span class="annottext">x :: V2 a
</span><a href="#local-6989586621679540058"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-537"></span><span>          </span><span id="local-6989586621679540057"><span class="annot"><span class="annottext">y :: V2 a
</span><a href="#local-6989586621679540057"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540062"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-538"></span><span>          </span><span id="local-6989586621679540061"><span class="annot"><span class="annottext">segment :: Double
</span><a href="#local-6989586621679540061"><span class="hs-identifier hs-var hs-var">segment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; Double
forall a. (Real a, Fractional a) =&gt; V2 a -&gt; V2 a -&gt; Double
</span><a href="Reanimate.Math.Common.html#distance%27"><span class="hs-identifier hs-var">distance'</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679540058"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679540057"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span id="local-6989586621679540055"><span class="annot"><span class="annottext">len :: Double
</span><a href="#local-6989586621679540055"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Double
forall a. (Real a, Fractional a) =&gt; APolygon a -&gt; Double
</span><a href="Reanimate.Math.Polygon.html#pCircumference%27"><span class="hs-identifier hs-var">pCircumference'</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540066"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span id="local-6989586621679540060"><span class="annot"><span class="annottext">limit :: Double
</span><a href="#local-6989586621679540060"><span class="hs-identifier hs-var hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540065"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679540055"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span id="local-6989586621679540468"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCentroid"><span class="hs-identifier hs-type">pCentroid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679540468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540468"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-543"></span><span id="pCentroid"><span class="annot"><span class="annottext">pCentroid :: APolygon a -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pCentroid"><span class="hs-identifier hs-var hs-var">pCentroid</span></a></span></span><span> </span><span id="local-6989586621679540054"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540054"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; V2 a
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540053"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540052"><span class="hs-identifier hs-var">cy</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span id="local-6989586621679540051"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679540051"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; a
forall a. Fractional a =&gt; APolygon a -&gt; a
</span><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-identifier hs-var">pArea</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540054"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-546"></span><span>    </span><span id="local-6989586621679540053"><span class="annot"><span class="annottext">cx :: a
</span><a href="#local-6989586621679540053"><span class="hs-identifier hs-var hs-var">cx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">6</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540051"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 a -&gt; V2 a -&gt; a) -&gt; APolygon a -&gt; Vector a
forall a b. (V2 a -&gt; V2 a -&gt; b) -&gt; APolygon a -&gt; Vector b
</span><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-identifier hs-var">pMapEdges</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540048"><span class="hs-identifier hs-var">fnX</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540054"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>    </span><span id="local-6989586621679540052"><span class="annot"><span class="annottext">cy :: a
</span><a href="#local-6989586621679540052"><span class="hs-identifier hs-var hs-var">cy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">6</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540051"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Vector a -&gt; a
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 a -&gt; V2 a -&gt; a) -&gt; APolygon a -&gt; Vector a
forall a b. (V2 a -&gt; V2 a -&gt; b) -&gt; APolygon a -&gt; Vector b
</span><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-identifier hs-var">pMapEdges</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540047"><span class="hs-identifier hs-var">fnY</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540054"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621679540048"><span class="annot"><span class="annottext">fnX :: V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540048"><span class="hs-identifier hs-var hs-var">fnX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540046"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540046"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679540045"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540045"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540044"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540044"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679540043"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540043"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540046"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540044"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540046"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540043"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540044"><span class="hs-identifier hs-var">x'</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540045"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621679540047"><span class="annot"><span class="annottext">fnY :: V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540047"><span class="hs-identifier hs-var hs-var">fnY</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540042"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540042"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679540041"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540041"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540040"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540040"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679540039"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540039"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540041"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540039"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540042"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540039"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540040"><span class="hs-identifier hs-var">x'</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540041"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-pragma hs-type">pMapEdges</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-552"></span><span id="local-6989586621679540417"><span id="local-6989586621679540418"><span class="annot"><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-identifier hs-type">pMapEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540418"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540418"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679540417"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540418"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679540417"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-553"></span><span id="pMapEdges"><span class="annot"><span class="annottext">pMapEdges :: (V2 a -&gt; V2 a -&gt; b) -&gt; APolygon a -&gt; Vector b
</span><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-identifier hs-var hs-var">pMapEdges</span></a></span></span><span> </span><span id="local-6989586621679540038"><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; b
</span><a href="#local-6989586621679540038"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679540037"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540037"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; b) -&gt; Vector b
forall a. Int -&gt; (Int -&gt; a) -&gt; Vector a
</span><span class="hs-identifier hs-var">V.generate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540036"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; b) -&gt; Vector b) -&gt; (Int -&gt; b) -&gt; Vector b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679540035"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540035"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540035"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540036"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; b
</span><a href="#local-6989586621679540038"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540034"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540035"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540034"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; b
</span><a href="#local-6989586621679540038"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540034"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540035"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540034"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540035"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679540036"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679540036"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540037"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span id="local-6989586621679540034"><span class="annot"><span class="annottext">arr :: Vector (V2 a)
</span><a href="#local-6989586621679540034"><span class="hs-identifier hs-var hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540037"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-pragma hs-type">pArea</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-pragma hs-type">APolygon</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Double</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-562"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-pragma hs-type">pArea</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-pragma hs-type">APolygon</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><span class="hs-pragma hs-type">Rational</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-563"></span><span id="local-6989586621679540420"><span class="annot"><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-identifier hs-type">pArea</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679540420"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540420"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679540420"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-564"></span><span id="pArea"><span class="annot"><span class="annottext">pArea :: APolygon a -&gt; a
</span><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-identifier hs-var hs-var">pArea</span></a></span></span><span> </span><span id="local-6989586621679540033"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540033"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-comment">-- 0.5 * V.sum (pMapEdges (\(V2 x y) (V2 x' y') -&gt; x*y' - x'*y) p)</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
</span><a href="#local-6989586621679540032"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-568"></span><span>    </span><span id="local-6989586621679540031"><span class="annot"><span class="annottext">fn :: V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540031"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540030"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540030"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679540029"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540029"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679540028"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540028"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679540027"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540027"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540030"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540027"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540028"><span class="hs-identifier hs-var">x'</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540029"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-569"></span><span>    </span><span id="local-6989586621679540026"><span class="annot"><span class="annottext">arr :: Vector (V2 a)
</span><a href="#local-6989586621679540026"><span class="hs-identifier hs-var hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Vector (V2 a)
forall a. APolygon a -&gt; Vector (V2 a)
</span><a href="Reanimate.Math.Polygon.html#polygonPoints"><span class="hs-identifier hs-var hs-var">polygonPoints</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540033"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621679540032"><span class="annot"><span class="annottext">worker :: a -&gt; Int -&gt; a
</span><a href="#local-6989586621679540032"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679540025"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540025"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679540024"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540024"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540024"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540033"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540025"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540031"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540026"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540024"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540026"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
</span><a href="#local-6989586621679540032"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679540025"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679540031"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540026"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540024"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a)
</span><a href="#local-6989586621679540026"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; Int -&gt; V2 a
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`V.unsafeIndex`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540024"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540024"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span id="local-6989586621679540023"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCircumference"><span class="hs-identifier hs-type">pCircumference</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679540023"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679540023"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540023"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679540023"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-576"></span><span id="pCircumference"><span class="annot"><span class="annottext">pCircumference :: APolygon a -&gt; a
</span><a href="Reanimate.Math.Polygon.html#pCircumference"><span class="hs-identifier hs-var hs-var">pCircumference</span></a></span></span><span> </span><span id="local-6989586621679540022"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540022"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. (Real a, Fractional a) =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#approxDist"><span class="hs-identifier hs-var">approxDist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540022"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540019"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540022"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540019"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679540019"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540019"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540022"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span id="local-6989586621679540422"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCircumference%27"><span class="hs-identifier hs-type">pCircumference'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679540422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679540422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span></span><span>
</span><span id="line-581"></span><span id="pCircumference%27"><span class="annot"><span class="annottext">pCircumference' :: APolygon a -&gt; Double
</span><a href="Reanimate.Math.Polygon.html#pCircumference%27"><span class="hs-identifier hs-var hs-var">pCircumference'</span></a></span></span><span> </span><span id="local-6989586621679540018"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540018"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; Double
forall a. (Real a, Fractional a) =&gt; V2 a -&gt; V2 a -&gt; Double
</span><a href="Reanimate.Math.Common.html#distance%27"><span class="hs-identifier hs-var">distance'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540018"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540017"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540018"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540017"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679540017"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540017"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540018"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- Add points by splitting the longest lines in half repeatedly.</span><span>
</span><span id="line-587"></span><span id="local-6989586621679540016"><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPoints"><span class="hs-identifier hs-type">pAddPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540016"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540016"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-588"></span><span id="pAddPoints"><span class="annot"><span class="annottext">pAddPoints :: Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPoints"><span class="hs-identifier hs-var hs-var">pAddPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(V2 a, V2 a)] -&gt; Int -&gt; APolygon a -&gt; APolygon a
forall a.
PolyCtx a =&gt;
[(V2 a, V2 a)] -&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPointsRestricted"><span class="hs-identifier hs-var">pAddPointsRestricted</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span id="local-6989586621679540405"><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPointsRestricted"><span class="hs-identifier hs-type">pAddPointsRestricted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540405"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540405"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540405"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-591"></span><span id="pAddPointsRestricted"><span class="annot"><span class="annottext">pAddPointsRestricted :: [(V2 a, V2 a)] -&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPointsRestricted"><span class="hs-identifier hs-var hs-var">pAddPointsRestricted</span></a></span></span><span> </span><span id="local-6989586621679540015"><span class="annot"><span class="annottext">[(V2 a, V2 a)]
</span><a href="#local-6989586621679540015"><span class="hs-identifier hs-var">_immutableEdges</span></a></span></span><span> </span><span id="local-6989586621679540014"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540014"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679540013"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540013"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540014"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540013"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-592"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPointsRestricted"><span class="hs-identifier hs-var">pAddPointsRestricted</span></a></span><span> </span><span id="local-6989586621679540011"><span class="annot"><span class="annottext">[(V2 a, V2 a)]
</span><a href="#local-6989586621679540011"><span class="hs-identifier hs-var">immutableEdges</span></a></span></span><span> </span><span id="local-6989586621679540010"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540010"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679540009"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(V2 a, V2 a)] -&gt; Int -&gt; APolygon a -&gt; APolygon a
forall a.
PolyCtx a =&gt;
[(V2 a, V2 a)] -&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPointsRestricted"><span class="hs-identifier hs-var">pAddPointsRestricted</span></a></span><span> </span><span class="annot"><span class="annottext">[(V2 a, V2 a)]
</span><a href="#local-6989586621679540011"><span class="hs-identifier hs-var">immutableEdges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540010"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(APolygon a -&gt; APolygon a) -&gt; APolygon a -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; Vector (V2 a)) -&gt; [V2 a] -&gt; Vector (V2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [V2 a]) -&gt; [Int] -&gt; [V2 a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [V2 a]
</span><a href="#local-6989586621679540007"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-595"></span><span>    </span><span id="local-6989586621679540006"><span class="annot"><span class="annottext">isImmutable :: Int -&gt; Bool
</span><a href="#local-6989586621679540006"><span class="hs-identifier hs-var hs-var">isImmutable</span></a></span></span><span> </span><span id="local-6989586621679540005"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540005"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-596"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540005"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540005"><span class="hs-identifier hs-var">idx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(V2 a, V2 a) -&gt; [(V2 a, V2 a)] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[(V2 a, V2 a)]
</span><a href="#local-6989586621679540011"><span class="hs-identifier hs-var">immutableEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540005"><span class="hs-identifier hs-var">idx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540005"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(V2 a, V2 a) -&gt; [(V2 a, V2 a)] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[(V2 a, V2 a)]
</span><a href="#local-6989586621679540011"><span class="hs-identifier hs-var">immutableEdges</span></a></span><span>
</span><span id="line-598"></span><span>    </span><span id="local-6989586621679540007"><span class="annot"><span class="annottext">worker :: Int -&gt; [V2 a]
</span><a href="#local-6989586621679540007"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679540003"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540003"><span class="hs-identifier hs-var">idx</span></a></span></span><span>
</span><span id="line-599"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540003"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540002"><span class="hs-identifier hs-var">longestEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679540006"><span class="hs-identifier hs-var">isImmutable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540003"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-600"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540003"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. PolyCtx a =&gt; APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pMiddlePoint"><span class="hs-identifier hs-var">pMiddlePoint</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540003"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-601"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679540003"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621679540002"><span class="annot"><span class="annottext">longestEdge :: Int
</span><a href="#local-6989586621679540002"><span class="hs-identifier hs-var hs-var">longestEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Ordering) -&gt; [Int] -&gt; Int
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
</span><a href="#local-6989586621679539999"><span class="hs-identifier hs-var">cmpLength</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679539999"><span class="annot"><span class="annottext">cmpLength :: Int -&gt; Int -&gt; Ordering
</span><a href="#local-6989586621679539999"><span class="hs-identifier hs-var hs-var">cmpLength</span></a></span></span><span> </span><span id="local-6989586621679539998"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539998"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679540006"><span class="hs-identifier hs-var">isImmutable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539998"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><a href="#local-6989586621679539999"><span class="hs-identifier hs-var">cmpLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679539997"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539997"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679540006"><span class="hs-identifier hs-var">isImmutable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539997"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-605"></span><span>    </span><span class="annot"><a href="#local-6989586621679539999"><span class="hs-identifier hs-var">cmpLength</span></a></span><span> </span><span id="local-6989586621679539996"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539996"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679539995"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539995"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#distSquared"><span class="hs-identifier hs-var">distSquared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539996"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539996"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#distSquared"><span class="hs-identifier hs-var">distSquared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539995"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679540009"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539995"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span id="local-6989586621679540399"><span class="annot"><a href="Reanimate.Math.Polygon.html#pMiddlePoint"><span class="hs-identifier hs-type">pMiddlePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540399"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-610"></span><span id="pMiddlePoint"><span class="annot"><span class="annottext">pMiddlePoint :: APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pMiddlePoint"><span class="hs-identifier hs-var hs-var">pMiddlePoint</span></a></span></span><span> </span><span id="local-6989586621679539992"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539992"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679539991"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539991"><span class="hs-identifier hs-var">idx</span></a></span></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; V2 a -&gt; V2 a -&gt; V2 a
forall (f :: * -&gt; *) a.
(Additive f, Num a) =&gt;
a -&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-identifier hs-var">lerp</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.5</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539992"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539991"><span class="hs-identifier hs-var">idx</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539992"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539991"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span id="local-6989586621679540394"><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPointsBetween"><span class="hs-identifier hs-type">pAddPointsBetween</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540394"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-614"></span><span id="pAddPointsBetween"><span class="annot"><span class="annottext">pAddPointsBetween :: (Int, Int) -&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPointsBetween"><span class="hs-identifier hs-var hs-var">pAddPointsBetween</span></a></span></span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679539990"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539990"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679539989"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539989"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539990"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539989"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-615"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pAddPointsBetween"><span class="hs-identifier hs-var">pAddPointsBetween</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539988"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539988"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679539987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539987"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679539986"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539986"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679539985"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int -&gt; APolygon a -&gt; APolygon a
forall a.
PolyCtx a =&gt;
(Int, Int) -&gt; Int -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAddPointsBetween"><span class="hs-identifier hs-var">pAddPointsBetween</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539988"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539987"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539986"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(APolygon a -&gt; APolygon a) -&gt; APolygon a -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; Vector (V2 a)) -&gt; [V2 a] -&gt; Vector (V2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [V2 a]) -&gt; [Int] -&gt; [V2 a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [V2 a]
</span><a href="#local-6989586621679539984"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-618"></span><span>    </span><span id="local-6989586621679539984"><span class="annot"><span class="annottext">worker :: Int -&gt; [V2 a]
</span><a href="#local-6989586621679539984"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679539983"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539983"><span class="hs-identifier hs-var">idx</span></a></span></span><span>
</span><span id="line-619"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539983"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539982"><span class="hs-identifier hs-var">longestEdge</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-620"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539983"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. PolyCtx a =&gt; APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pMiddlePoint"><span class="hs-identifier hs-var">pMiddlePoint</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539983"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-621"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539983"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-622"></span><span>    </span><span id="local-6989586621679539982"><span class="annot"><span class="annottext">longestEdge :: Int
</span><a href="#local-6989586621679539982"><span class="hs-identifier hs-var hs-var">longestEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Ordering) -&gt; [Int] -&gt; Int
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
</span><a href="#local-6989586621679539981"><span class="hs-identifier hs-var">cmpLength</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539988"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539988"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539987"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-623"></span><span>    </span><span id="local-6989586621679539981"><span class="annot"><span class="annottext">cmpLength :: Int -&gt; Int -&gt; Ordering
</span><a href="#local-6989586621679539981"><span class="hs-identifier hs-var hs-var">cmpLength</span></a></span></span><span> </span><span id="local-6989586621679539980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539980"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679539979"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539979"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-624"></span><span>      </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#distSquared"><span class="hs-identifier hs-var">distSquared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539980"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539980"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span>
</span><span id="line-625"></span><span>      </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#distSquared"><span class="hs-identifier hs-var">distSquared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539979"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539985"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; Int -&gt; V2 a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539979"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- addPoints :: Int -&gt; Polygon -&gt; Polygon</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- addPoints n p = mkPolygon $ V.fromList $ worker n 0 (map (pAccess p) [0..s])</span><span>
</span><span id="line-629"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-630"></span><span class="hs-comment">--     worker 0 _ rest = init rest</span><span>
</span><span id="line-631"></span><span class="hs-comment">--     worker i acc (x:y:xs) =</span><span>
</span><span id="line-632"></span><span class="hs-comment">--       let xy = approxDist x y in</span><span>
</span><span id="line-633"></span><span class="hs-comment">--       if acc + xy &gt; limit</span><span>
</span><span id="line-634"></span><span class="hs-comment">--         then x : worker (i-1) 0 (lerp ((limit-acc)/xy) y x : y:xs)</span><span>
</span><span id="line-635"></span><span class="hs-comment">--         else x : worker i (acc+xy) (y:xs)</span><span>
</span><span id="line-636"></span><span class="hs-comment">--     worker _ _ [_] = []</span><span>
</span><span id="line-637"></span><span class="hs-comment">--     worker _ _ _ = error &quot;addPoints: invalid polygon&quot;</span><span>
</span><span id="line-638"></span><span class="hs-comment">--     s = pSize p</span><span>
</span><span id="line-639"></span><span class="hs-comment">--     len = polygonLength p</span><span>
</span><span id="line-640"></span><span class="hs-comment">--     limit = len / fromIntegral (n+1)</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsConvex"><span class="hs-identifier hs-type">pIsConvex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-643"></span><span id="pIsConvex"><span class="annot"><span class="annottext">pIsConvex :: Polygon -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pIsConvex"><span class="hs-identifier hs-var hs-var">pIsConvex</span></a></span></span><span> </span><span id="local-6989586621679539978"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539978"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; V2 Rational -&gt; Rational
forall a. Fractional a =&gt; V2 a -&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#area2X"><span class="hs-identifier hs-var">area2X</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539978"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539976"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539978"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539975"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539978"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539974"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679539976"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539976"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539973"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679539975"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539975"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539976"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539973"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679539974"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539974"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539975"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539973"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679539973"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679539973"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539978"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsCCW"><span class="hs-identifier hs-type">pIsCCW</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-652"></span><span id="pIsCCW"><span class="annot"><span class="annottext">pIsCCW :: Polygon -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pIsCCW"><span class="hs-identifier hs-var hs-var">pIsCCW</span></a></span></span><span> </span><span id="local-6989586621679539972"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539972"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Bool
forall a. APolygon a -&gt; Bool
</span><a href="Reanimate.Math.Polygon.html#pNull"><span class="hs-identifier hs-var">pNull</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539972"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-653"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#pIsCCW"><span class="hs-identifier hs-var">pIsCCW</span></a></span><span> </span><span id="local-6989586621679539971"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539971"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Rational -&gt; Rational
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(V2 Rational -&gt; V2 Rational -&gt; Rational)
-&gt; Polygon -&gt; Vector Rational
forall a b. (V2 a -&gt; V2 a -&gt; b) -&gt; APolygon a -&gt; Vector b
</span><a href="Reanimate.Math.Polygon.html#pMapEdges"><span class="hs-identifier hs-var">pMapEdges</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Rational
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679539970"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539971"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621679539970"><span class="annot"><span class="annottext">fn :: V2 a -&gt; V2 a -&gt; a
</span><a href="#local-6989586621679539970"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679539969"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539969"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679539968"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539968"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679539967"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539967"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679539966"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539966"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539967"><span class="hs-identifier hs-var">x2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539969"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539966"><span class="hs-identifier hs-var">y2</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539968"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-pragma hs-type">pRayIntersect</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-658"></span><span id="local-6989586621679540372"><span class="annot"><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-type">pRayIntersect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><a href="#local-6989586621679540372"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-659"></span><span id="pRayIntersect"><span class="annot"><span class="annottext">pRayIntersect :: APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var hs-var">pRayIntersect</span></a></span></span><span> </span><span id="local-6989586621679539965"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539965"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539964"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539964"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679539963"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539963"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539962"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539962"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679539961"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539961"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-660"></span><span>  </span><span class="annot"><span class="annottext">(V2 a, V2 a) -&gt; (V2 a, V2 a) -&gt; Maybe (V2 a)
forall a.
(Fractional a, Ord a) =&gt;
(V2 a, V2 a) -&gt; (V2 a, V2 a) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Common.html#rayIntersect"><span class="hs-identifier hs-var">rayIntersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539965"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539964"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539965"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539963"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539965"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539962"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539965"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539961"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span id="local-6989586621679540379"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCuts"><span class="hs-identifier hs-type">pCuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Real</span></span><span> </span><span class="annot"><a href="#local-6989586621679540379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679540379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Epsilon</span></span><span> </span><span class="annot"><a href="#local-6989586621679540379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540379"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-663"></span><span id="pCuts"><span class="annot"><span class="annottext">pCuts :: APolygon a -&gt; [(APolygon a, APolygon a)]
</span><a href="Reanimate.Math.Polygon.html#pCuts"><span class="hs-identifier hs-var hs-var">pCuts</span></a></span></span><span> </span><span id="local-6989586621679539959"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539959"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; (APolygon a, APolygon a)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; Int -&gt; (APolygon a, APolygon a)
</span><a href="Reanimate.Math.Polygon.html#pCutAt"><span class="hs-identifier hs-var">pCutAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; APolygon a
forall a. APolygon a -&gt; Int -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pAdjustOffset"><span class="hs-identifier hs-var">pAdjustOffset</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539959"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539956"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679539957"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539959"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679539956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539956"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539959"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539956"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539959"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; Int -&gt; Int
forall a. APolygon a -&gt; Int -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pParent"><span class="hs-identifier hs-var">pParent</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539959"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539956"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539957"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span id="local-6989586621679539955"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCutEqual"><span class="hs-identifier hs-type">pCutEqual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-671"></span><span id="pCutEqual"><span class="annot"><span class="annottext">pCutEqual :: APolygon a -&gt; (APolygon a, APolygon a)
</span><a href="Reanimate.Math.Polygon.html#pCutEqual"><span class="hs-identifier hs-var hs-var">pCutEqual</span></a></span></span><span> </span><span id="local-6989586621679539954"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539954"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><span class="annottext">(APolygon a, APolygon a)
-&gt; Maybe (APolygon a, APolygon a) -&gt; (APolygon a, APolygon a)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539954"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539954"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (APolygon a, APolygon a) -&gt; (APolygon a, APolygon a))
-&gt; Maybe (APolygon a, APolygon a) -&gt; (APolygon a, APolygon a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(APolygon a, APolygon a)] -&gt; Maybe (APolygon a, APolygon a)
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([(APolygon a, APolygon a)] -&gt; Maybe (APolygon a, APolygon a))
-&gt; [(APolygon a, APolygon a)] -&gt; Maybe (APolygon a, APolygon a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((APolygon a, APolygon a) -&gt; a)
-&gt; [(APolygon a, APolygon a)] -&gt; [(APolygon a, APolygon a)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">(APolygon a, APolygon a) -&gt; a
forall a. Fractional a =&gt; (APolygon a, APolygon a) -&gt; a
</span><a href="#local-6989586621679539951"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([(APolygon a, APolygon a)] -&gt; [(APolygon a, APolygon a)])
-&gt; [(APolygon a, APolygon a)] -&gt; [(APolygon a, APolygon a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; [(APolygon a, APolygon a)]
forall a.
(Real a, Fractional a, Epsilon a) =&gt;
APolygon a -&gt; [(APolygon a, APolygon a)]
</span><a href="Reanimate.Math.Polygon.html#pCuts"><span class="hs-identifier hs-var">pCuts</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539954"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679539951"><span class="annot"><span class="annottext">f :: (APolygon a, APolygon a) -&gt; a
</span><a href="#local-6989586621679539951"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539950"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539950"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679539949"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539949"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; a
forall a. Fractional a =&gt; APolygon a -&gt; a
</span><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-identifier hs-var">pArea</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539950"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; a
forall a. Fractional a =&gt; APolygon a -&gt; a
</span><a href="Reanimate.Math.Polygon.html#pArea"><span class="hs-identifier hs-var">pArea</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539949"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- FIXME: This should be more efficient</span><span>
</span><span id="line-677"></span><span id="local-6989586621679540387"><span class="annot"><a href="Reanimate.Math.Polygon.html#pCutAt"><span class="hs-identifier hs-type">pCutAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679540387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-678"></span><span id="pCutAt"><span class="annot"><span class="annottext">pCutAt :: APolygon a -&gt; Int -&gt; (APolygon a, APolygon a)
</span><a href="Reanimate.Math.Polygon.html#pCutAt"><span class="hs-identifier hs-var hs-var">pCutAt</span></a></span></span><span> </span><span id="local-6989586621679539947"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539947"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679539946"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539946"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[V2 a]
</span><a href="#local-6989586621679539945"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[V2 a]
</span><a href="#local-6989586621679539944"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-680"></span><span>    </span><span id="local-6989586621679539943"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679539943"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539947"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span id="local-6989586621679539945"><span class="annot"><span class="annottext">left :: [V2 a]
</span><a href="#local-6989586621679539945"><span class="hs-identifier hs-var hs-var">left</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; [Int] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539947"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539946"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621679539944"><span class="annot"><span class="annottext">right :: [V2 a]
</span><a href="#local-6989586621679539944"><span class="hs-identifier hs-var hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; V2 a) -&gt; [Int] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539947"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539946"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539943"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span id="local-6989586621679539942"><span class="annot"><a href="Reanimate.Math.Polygon.html#pOverlap"><span class="hs-identifier hs-type">pOverlap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539942"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-685"></span><span id="pOverlap"><span class="annot"><span class="annottext">pOverlap :: APolygon a -&gt; APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#pOverlap"><span class="hs-identifier hs-var hs-var">pOverlap</span></a></span></span><span> </span><span id="local-6989586621679539941"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539941"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679539940"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539940"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; Vector (V2 a)) -&gt; [V2 a] -&gt; Vector (V2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; [V2 a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679539939"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; [V2 a]) -&gt; [V2 a] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [V2 a]) -&gt; [Int] -&gt; [V2 a]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [V2 a]
</span><a href="#local-6989586621679539938"><span class="hs-identifier hs-var">edgeIntersect</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539941"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>    </span><span id="local-6989586621679539939"><span class="annot"><span class="annottext">clearDups :: [a] -&gt; [a]
</span><a href="#local-6989586621679539939"><span class="hs-identifier hs-var hs-var">clearDups</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539937"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539937"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539936"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539935"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539935"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539937"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539936"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679539939"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539936"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539935"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539937"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679539939"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539936"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539935"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><a href="#local-6989586621679539939"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span id="local-6989586621679539934"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539934"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539934"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span id="local-6989586621679539938"><span class="annot"><span class="annottext">edgeIntersect :: Int -&gt; [V2 a]
</span><a href="#local-6989586621679539938"><span class="hs-identifier hs-var hs-var">edgeIntersect</span></a></span></span><span> </span><span id="local-6989586621679539933"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539933"><span class="hs-identifier hs-var">edge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-692"></span><span>      </span><span class="annot"><span class="annottext">(V2 a -&gt; a) -&gt; [V2 a] -&gt; [V2 a]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; a
forall a. Num a =&gt; V2 a -&gt; V2 a -&gt; a
</span><a href="Reanimate.Math.Common.html#distSquared"><span class="hs-identifier hs-var">distSquared</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539941"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539933"><span class="hs-identifier hs-var">edge</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; [V2 a]) -&gt; [V2 a] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (V2 a)] -&gt; [V2 a]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(V2 a, V2 a) -&gt; (V2 a, V2 a) -&gt; Maybe (V2 a)
forall a.
(Ord a, Fractional a) =&gt;
(V2 a, V2 a) -&gt; (V2 a, V2 a) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Common.html#lineIntersect"><span class="hs-identifier hs-var">lineIntersect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539931"><span class="hs-identifier hs-var">aP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539930"><span class="hs-identifier hs-var">aP'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539929"><span class="hs-identifier hs-var">bP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539928"><span class="hs-identifier hs-var">bP'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679539927"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539927"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539940"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679539931"><span class="annot"><span class="annottext">aP :: V2 a
</span><a href="#local-6989586621679539931"><span class="hs-identifier hs-var hs-var">aP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539941"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539933"><span class="hs-identifier hs-var">edge</span></a></span><span>
</span><span id="line-696"></span><span>            </span><span id="local-6989586621679539930"><span class="annot"><span class="annottext">aP' :: V2 a
</span><a href="#local-6989586621679539930"><span class="hs-identifier hs-var hs-var">aP'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539941"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539933"><span class="hs-identifier hs-var">edge</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>            </span><span id="local-6989586621679539929"><span class="annot"><span class="annottext">bP :: V2 a
</span><a href="#local-6989586621679539929"><span class="hs-identifier hs-var hs-var">bP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539940"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539927"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-698"></span><span>            </span><span id="local-6989586621679539928"><span class="annot"><span class="annottext">bP' :: V2 a
</span><a href="#local-6989586621679539928"><span class="hs-identifier hs-var hs-var">bP'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539940"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539927"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-comment">---------------------------------------------------------</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- SSSP visibility and SSSP windows</span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span id="local-6989586621679539926"><span class="annot"><a href="Reanimate.Math.Polygon.html#ssspVisibility"><span class="hs-identifier hs-type">ssspVisibility</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#PolyCtx"><span class="hs-identifier hs-type">PolyCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539926"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539926"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#APolygon"><span class="hs-identifier hs-type">APolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679539926"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-705"></span><span id="ssspVisibility"><span class="annot"><span class="annottext">ssspVisibility :: APolygon a -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#ssspVisibility"><span class="hs-identifier hs-var hs-var">ssspVisibility</span></a></span></span><span> </span><span id="local-6989586621679539925"><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (V2 a) -&gt; APolygon a
forall a. PolyCtx a =&gt; Vector (V2 a) -&gt; APolygon a
</span><a href="Reanimate.Math.Polygon.html#mkPolygon"><span class="hs-identifier hs-var">mkPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (V2 a) -&gt; APolygon a) -&gt; Vector (V2 a) -&gt; APolygon a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><span class="annottext">[V2 a] -&gt; Vector (V2 a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; Vector (V2 a)) -&gt; [V2 a] -&gt; Vector (V2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[V2 a] -&gt; [V2 a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679539924"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="annot"><span class="annottext">([V2 a] -&gt; [V2 a]) -&gt; [V2 a] -&gt; [V2 a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ([root..pSize p-1]  ++ [0 .. root-1])</span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679539924"><span class="annot"><span class="annottext">clearDups :: [a] -&gt; [a]
</span><a href="#local-6989586621679539924"><span class="hs-identifier hs-var hs-var">clearDups</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539922"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539922"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539921"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539921"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539920"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539920"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539922"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539921"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679539924"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539921"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539920"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539922"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679539924"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539921"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539920"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><a href="#local-6989586621679539924"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span id="local-6989586621679539919"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539919"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539919"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-712"></span><span>    </span><span id="local-6989586621679539918"><span class="annot"><span class="annottext">obstructedBy :: Int -&gt; Int
</span><a href="#local-6989586621679539918"><span class="hs-identifier hs-var hs-var">obstructedBy</span></a></span></span><span> </span><span id="local-6989586621679539917"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539917"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-713"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; Int -&gt; Int
forall a. APolygon a -&gt; Int -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pParent"><span class="hs-identifier hs-var">pParent</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539917"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-714"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539917"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-715"></span><span>        </span><span id="local-6989586621679539916"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539916"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679539918"><span class="hs-identifier hs-var">obstructedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539916"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679539923"><span class="annot"><span class="annottext">go :: [Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679539915"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539915"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539915"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-718"></span><span>    </span><span class="annot"><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539914"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539913"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539912"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-719"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679539911"><span class="annot"><span class="annottext">xO :: Int
</span><a href="#local-6989586621679539911"><span class="hs-identifier hs-var hs-var">xO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679539918"><span class="hs-identifier hs-var">obstructedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-720"></span><span>          </span><span id="local-6989586621679539910"><span class="annot"><span class="annottext">yO :: Int
</span><a href="#local-6989586621679539910"><span class="hs-identifier hs-var hs-var">yO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679539918"><span class="hs-identifier hs-var">obstructedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-721"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-722"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>            </span><span class="hs-comment">-- Both ends are visible.</span><span>
</span><span id="line-724"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539911"><span class="hs-identifier hs-var">xO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539910"><span class="hs-identifier hs-var">yO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>            </span><span class="hs-comment">-- X is visible, x to intersect (0,yO) (x,y)</span><span>
</span><span id="line-726"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539911"><span class="hs-identifier hs-var">xO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-727"></span><span>              </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; Maybe (V2 a) -&gt; V2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539910"><span class="hs-identifier hs-var">yO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>            </span><span class="hs-comment">-- Y is visible</span><span>
</span><span id="line-729"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539910"><span class="hs-identifier hs-var">yO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; Maybe (V2 a) -&gt; V2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539911"><span class="hs-identifier hs-var">xO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">APolygon a -&gt; Int -&gt; V2 a
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>            </span><span class="hs-comment">-- Neither is visible and they've obstructed by the same point</span><span>
</span><span id="line-731"></span><span>            </span><span class="hs-comment">-- so the entire edge is hidden.</span><span>
</span><span id="line-732"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539911"><span class="hs-identifier hs-var">xO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539910"><span class="hs-identifier hs-var">yO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>            </span><span class="hs-comment">-- Neither is visible. Cast shadow from obstruction points to</span><span>
</span><span id="line-734"></span><span>            </span><span class="hs-comment">-- find if a subsection of the edge is visible.</span><span>
</span><span id="line-735"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-736"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679539909"><span class="annot"><span class="annottext">a :: V2 a
</span><a href="#local-6989586621679539909"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; Maybe (V2 a) -&gt; V2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; V2 a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539911"><span class="hs-identifier hs-var">xO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>                  </span><span id="local-6989586621679539908"><span class="annot"><span class="annottext">b :: V2 a
</span><a href="#local-6989586621679539908"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; Maybe (V2 a) -&gt; V2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; V2 a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;b&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">APolygon a
</span><a href="#local-6989586621679539925"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539910"><span class="hs-identifier hs-var">yO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539914"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539909"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; V2 a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539908"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-739"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539909"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">V2 a
</span><a href="#local-6989586621679539908"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">V2 a -&gt; [V2 a] -&gt; [V2 a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [V2 a]
</span><a href="#local-6989586621679539923"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539913"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539912"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="annot"><a href="Reanimate.Math.Polygon.html#ssspWindows"><span class="hs-identifier hs-type">ssspWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.Math.Polygon.html#Polygon"><span class="hs-identifier hs-type">Polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-743"></span><span id="ssspWindows"><span class="annot"><span class="annottext">ssspWindows :: Polygon -&gt; [(V2 Rational, V2 Rational)]
</span><a href="Reanimate.Math.Polygon.html#ssspWindows"><span class="hs-identifier hs-var hs-var">ssspWindows</span></a></span></span><span> </span><span id="local-6989586621679539907"><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(V2 Rational, V2 Rational)] -&gt; [(V2 Rational, V2 Rational)]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679539906"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="annot"><span class="annottext">([(V2 Rational, V2 Rational)] -&gt; [(V2 Rational, V2 Rational)])
-&gt; [(V2 Rational, V2 Rational)] -&gt; [(V2 Rational, V2 Rational)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Polygon -&gt; Int
forall a. APolygon a -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pSize"><span class="hs-identifier hs-var">pSize</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-744"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-745"></span><span>    </span><span id="local-6989586621679539906"><span class="annot"><span class="annottext">clearDups :: [a] -&gt; [a]
</span><a href="#local-6989586621679539906"><span class="hs-identifier hs-var hs-var">clearDups</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539904"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539904"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539903"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539902"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539902"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539904"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539903"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679539906"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539903"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539902"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539904"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679539906"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679539903"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539902"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><a href="#local-6989586621679539906"><span class="hs-identifier hs-var">clearDups</span></a></span><span> </span><span id="local-6989586621679539901"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539901"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679539901"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-749"></span><span>    </span><span id="local-6989586621679539900"><span class="annot"><span class="annottext">obstructedBy :: Int -&gt; Int
</span><a href="#local-6989586621679539900"><span class="hs-identifier hs-var hs-var">obstructedBy</span></a></span></span><span> </span><span id="local-6989586621679539899"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539899"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-750"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; Int -&gt; Int
forall a. APolygon a -&gt; Int -&gt; Int -&gt; Int
</span><a href="Reanimate.Math.Polygon.html#pParent"><span class="hs-identifier hs-var">pParent</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539899"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-751"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539899"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-752"></span><span>        </span><span id="local-6989586621679539898"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539898"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679539900"><span class="hs-identifier hs-var">obstructedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539898"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-753"></span><span>    </span><span id="local-6989586621679539905"><span class="annot"><span class="annottext">go :: V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679539897"><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539897"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679539896"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539895"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679539894"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-756"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679539893"><span class="annot"><span class="annottext">xO :: Int
</span><a href="#local-6989586621679539893"><span class="hs-identifier hs-var hs-var">xO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679539900"><span class="hs-identifier hs-var">obstructedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-757"></span><span>          </span><span id="local-6989586621679539892"><span class="annot"><span class="annottext">yO :: Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var hs-var">yO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679539900"><span class="hs-identifier hs-var">obstructedBy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-758"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-759"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>            </span><span class="hs-comment">-- Both ends are visible.</span><span>
</span><span id="line-761"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539893"><span class="hs-identifier hs-var">xO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>            </span><span class="hs-comment">-- X is visible, x to intersect (0,yO) (x,y)</span><span>
</span><span id="line-763"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539893"><span class="hs-identifier hs-var">xO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-764"></span><span>              </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational -&gt; Maybe (V2 Rational) -&gt; V2 Rational
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 Rational)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>            </span><span class="hs-comment">-- Y is visible</span><span>
</span><span id="line-766"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-767"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679539891"><span class="annot"><span class="annottext">newL :: V2 Rational
</span><a href="#local-6989586621679539891"><span class="hs-identifier hs-var hs-var">newL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Maybe (V2 Rational) -&gt; V2 Rational
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 Rational)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539893"><span class="hs-identifier hs-var">xO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-768"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539897"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539891"><span class="hs-identifier hs-var">newL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(V2 Rational, V2 Rational)
-&gt; [(V2 Rational, V2 Rational)] -&gt; [(V2 Rational, V2 Rational)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-769"></span><span>              </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539891"><span class="hs-identifier hs-var">newL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>            </span><span class="hs-comment">-- Neither is visible and they've obstructed by the same point</span><span>
</span><span id="line-771"></span><span>            </span><span class="hs-comment">-- so the entire edge is hidden.</span><span>
</span><span id="line-772"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539893"><span class="hs-identifier hs-var">xO</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539897"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>            </span><span class="hs-comment">-- Neither is visible. Cast shadow from obstruction points to</span><span>
</span><span id="line-774"></span><span>            </span><span class="hs-comment">-- find if a subsection of the edge is visible.</span><span>
</span><span id="line-775"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-776"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679539890"><span class="annot"><span class="annottext">a :: V2 Rational
</span><a href="#local-6989586621679539890"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Maybe (V2 Rational) -&gt; V2 Rational
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; V2 Rational
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 Rational)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539893"><span class="hs-identifier hs-var">xO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>                  </span><span id="local-6989586621679539889"><span class="annot"><span class="annottext">b :: V2 Rational
</span><a href="#local-6989586621679539889"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; Maybe (V2 Rational) -&gt; V2 Rational
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; V2 Rational
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;b&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 Rational)
forall a.
PolyCtx a =&gt;
APolygon a -&gt; (Int, Int) -&gt; (Int, Int) -&gt; Maybe (V2 a)
</span><a href="Reanimate.Math.Polygon.html#pRayIntersect"><span class="hs-identifier hs-var">pRayIntersect</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539896"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539890"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; V2 Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539889"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-779"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539897"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539890"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(V2 Rational, V2 Rational)
-&gt; [(V2 Rational, V2 Rational)] -&gt; [(V2 Rational, V2 Rational)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539889"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(V2 Rational, V2 Rational)
-&gt; [(V2 Rational, V2 Rational)] -&gt; [(V2 Rational, V2 Rational)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polygon -&gt; Int -&gt; V2 Rational
forall a. APolygon a -&gt; Int -&gt; V2 a
</span><a href="Reanimate.Math.Polygon.html#pAccess"><span class="hs-identifier hs-var">pAccess</span></a></span><span> </span><span class="annot"><span class="annottext">Polygon
</span><a href="#local-6989586621679539907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539892"><span class="hs-identifier hs-var">yO</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">V2 Rational -&gt; [Int] -&gt; [(V2 Rational, V2 Rational)]
</span><a href="#local-6989586621679539905"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">V2 Rational
</span><a href="#local-6989586621679539897"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679539895"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679539894"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span></pre></body></html>