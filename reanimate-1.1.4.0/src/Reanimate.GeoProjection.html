<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MagicHash    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms   #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">{-|
Module      : Reanimate.GeoProjection
Copyright   : Written by David Himmelstrup
License     : Unlicense
Maintainer  : lemmih@gmail.com
Stability   : experimental
Portability : POSIX

This module provides functions for mapping the surface of
a sphere on to a 2D plane. It also has convenience functions
for loading GeoJSON data.

-}</span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reanimate.GeoProjection</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier">Projection</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier">XYCoord</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier">LonLat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#project"><span class="hs-identifier">project</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#interpP"><span class="hs-identifier">interpP</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#interpBBP"><span class="hs-identifier">interpBBP</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#mergeP"><span class="hs-identifier">mergeP</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#isValidP"><span class="hs-identifier">isValidP</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#scaleP"><span class="hs-identifier">scaleP</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#flipYAxisP"><span class="hs-identifier">flipYAxisP</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#moveBottomP"><span class="hs-identifier">moveBottomP</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#moveTopP"><span class="hs-identifier">moveTopP</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Projections</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#equirectangularP"><span class="hs-identifier">equirectangularP</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#mercatorP"><span class="hs-identifier">mercatorP</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#mollweideP"><span class="hs-identifier">mollweideP</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#hammerP"><span class="hs-identifier">hammerP</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#cylindricalEqualAreaP"><span class="hs-identifier">cylindricalEqualAreaP</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#lambertP"><span class="hs-identifier">lambertP</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#bottomleyP"><span class="hs-identifier">bottomleyP</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#sinusoidalP"><span class="hs-identifier">sinusoidalP</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#wernerP"><span class="hs-identifier">wernerP</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#bonneP"><span class="hs-identifier">bonneP</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#orthoP"><span class="hs-identifier">orthoP</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#cassiniP"><span class="hs-identifier">cassiniP</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#augustP"><span class="hs-identifier">augustP</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#collignonP"><span class="hs-identifier">collignonP</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#eckert1P"><span class="hs-identifier">eckert1P</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#eckert3P"><span class="hs-identifier">eckert3P</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#eckert5P"><span class="hs-identifier">eckert5P</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#faheyP"><span class="hs-identifier">faheyP</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#foucautP"><span class="hs-identifier">foucautP</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#lagrangeP"><span class="hs-identifier">lagrangeP</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="hs-comment">-- * GeoJSON helpers</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#drawFeatureCollection"><span class="hs-identifier">drawFeatureCollection</span></a></span><span> </span><span class="hs-comment">-- :: GeoFeatureCollection a -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#loadFeatureCollection"><span class="hs-identifier">loadFeatureCollection</span></a></span><span> </span><span class="hs-comment">-- :: FromJSON a =&gt; FilePath -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#applyProjection"><span class="hs-identifier">applyProjection</span></a></span><span> </span><span class="hs-comment">-- :: Projection -&gt; SVG -&gt; SVG</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#applyProjection%27"><span class="hs-identifier">applyProjection'</span></a></span><span> </span><span class="hs-comment">-- :: Double -&gt; Projection -&gt; SVG -&gt; SVG</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#renderGeometry"><span class="hs-identifier">renderGeometry</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Picture</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Picture.Types</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.ST.Unsafe</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Geospatial</span></span><span>         </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LonLat</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.LinearRing</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.LineString</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Line</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vector.Storable</span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector.Unboxed</span></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Foreign</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Double</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cosDouble#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sinDouble#</span></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>                                          </span><span class="annot"><span class="hs-operator">(*##)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(+##)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(-##)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(/##)</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Graphics.SvgTree</span></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-identifier">None</span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Linear</span></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">distance</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lerp</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Linear.V2</span></span><span>               </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">angle</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Reanimate.html"><span class="hs-identifier">Reanimate</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-pragma hs-type">halfPi</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-84"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-pragma hs-type">sqrtPi</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-85"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-pragma hs-type">sqrt2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-86"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-pragma hs-type">epsilon</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-87"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#tau"><span class="hs-pragma hs-type">tau</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- Constants</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-type">halfPi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-type">sqrtPi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-type">sqrt2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-identifier hs-type">epsilon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-type">tau</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-90"></span><span id="halfPi"><span class="annot"><span class="annottext">halfPi :: Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var hs-var">halfPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-91"></span><span id="sqrtPi"><span class="annot"><span class="annottext">sqrtPi :: Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var hs-var">sqrtPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-92"></span><span id="sqrt2"><span class="annot"><span class="annottext">sqrt2 :: Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var hs-var">sqrt2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-93"></span><span id="epsilon"><span class="annot"><span class="annottext">epsilon :: Double
</span><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-identifier hs-var hs-var">epsilon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0e-12</span></span><span>
</span><span id="line-94"></span><span id="tau"><span class="annot"><span class="annottext">tau :: Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var hs-var">tau</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Reanimate.GeoProjection.html#toRads"><span class="hs-identifier hs-type">toRads</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#cot"><span class="hs-identifier hs-type">cot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-97"></span><span id="toRads"><span class="annot"><span class="annottext">toRads :: Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#toRads"><span class="hs-identifier hs-var hs-var">toRads</span></a></span></span><span> </span><span id="local-6989586621679549154"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549154"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549154"><span class="hs-identifier hs-var">dec</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">180</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-98"></span><span id="cot"><span class="annot"><span class="annottext">cot :: Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#cot"><span class="hs-identifier hs-var hs-var">cot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Double -&gt; Double) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679549275"><span class="annot"><a href="Reanimate.GeoProjection.html#srcPixel"><span class="hs-identifier hs-type">srcPixel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="annot"><a href="#local-6989586621679549275"><span class="hs-identifier hs-type">pixel</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><a href="#local-6989586621679549275"><span class="hs-identifier hs-type">pixel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679549275"><span class="hs-identifier hs-type">pixel</span></a></span></span><span>
</span><span id="line-102"></span><span id="srcPixel"><span class="annot"><span class="annottext">srcPixel :: Image pixel -&gt; LonLat -&gt; pixel
</span><a href="Reanimate.GeoProjection.html#srcPixel"><span class="hs-identifier hs-var hs-var">srcPixel</span></a></span></span><span> </span><span id="local-6989586621679549149"><span class="annot"><span class="annottext">Image pixel
</span><a href="#local-6989586621679549149"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679549147"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549147"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679549146"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549146"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- pixelAt src xPx yPx</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">Vector (PixelBaseComponent pixel) -&gt; Int -&gt; pixel
forall a. Pixel a =&gt; Vector (PixelBaseComponent a) -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">unsafePixelAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Image pixel -&gt; Vector (PixelBaseComponent pixel)
forall a. Image a -&gt; Vector (PixelBaseComponent a)
</span><span class="hs-identifier hs-var hs-var">imageData</span></span><span> </span><span class="annot"><span class="annottext">Image pixel
</span><a href="#local-6989586621679549149"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Image pixel -&gt; Int -&gt; Int -&gt; Int
forall a. Pixel a =&gt; Image a -&gt; Int -&gt; Int -&gt; Int
</span><span class="hs-identifier hs-var">pixelBaseIndex</span></span><span> </span><span class="annot"><span class="annottext">Image pixel
</span><a href="#local-6989586621679549149"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549142"><span class="hs-identifier hs-var">xPx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549141"><span class="hs-identifier hs-var">yPx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549142"><span class="annot"><span class="annottext">xPx :: Int
</span><a href="#local-6989586621679549142"><span class="hs-identifier hs-var hs-var">xPx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549147"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Image pixel -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageWidth</span></span><span> </span><span class="annot"><span class="annottext">Image pixel
</span><a href="#local-6989586621679549149"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549141"><span class="annot"><span class="annottext">yPx :: Int
</span><a href="#local-6989586621679549141"><span class="hs-identifier hs-var hs-var">yPx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549146"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Image pixel -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageHeight</span></span><span> </span><span class="annot"><span class="annottext">Image pixel
</span><a href="#local-6989586621679549149"><span class="hs-identifier hs-var">src</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679549297"><span class="annot"><a href="Reanimate.GeoProjection.html#srcPixelFast"><span class="hs-identifier hs-type">srcPixelFast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679549297"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span></span><span>
</span><span id="line-111"></span><span id="srcPixelFast"><span class="annot"><span class="annottext">srcPixelFast :: Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#srcPixelFast"><span class="hs-identifier hs-var hs-var">srcPixelFast</span></a></span></span><span> </span><span id="local-6989586621679549135"><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549135"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679549134"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549134"><span class="hs-identifier hs-var">wMax</span></a></span></span><span> </span><span id="local-6989586621679549133"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549133"><span class="hs-identifier hs-var">hMax</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679549132"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549132"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679549131"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549131"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO PixelRGBA8 -&gt; ST s PixelRGBA8
forall a s. IO a -&gt; ST s a
</span><span class="hs-identifier hs-var">unsafeIOToST</span></span><span> </span><span class="annot"><span class="annottext">(IO PixelRGBA8 -&gt; ST s PixelRGBA8)
-&gt; IO PixelRGBA8 -&gt; ST s PixelRGBA8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Vector Word8 -&gt; (Ptr Word8 -&gt; IO PixelRGBA8) -&gt; IO PixelRGBA8
forall a b. Storable a =&gt; Vector a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Vector (PixelBaseComponent PixelRGBA8)
forall a. Image a -&gt; Vector (PixelBaseComponent a)
</span><span class="hs-identifier hs-var hs-var">imageData</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549135"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO PixelRGBA8) -&gt; IO PixelRGBA8)
-&gt; (Ptr Word8 -&gt; IO PixelRGBA8) -&gt; IO PixelRGBA8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549129"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679549129"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679549128"><span class="annot"><span class="annottext">ptr' :: Ptr b
</span><a href="#local-6989586621679549128"><span class="hs-identifier hs-var hs-var">ptr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679549129"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549126"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-114"></span><span>      </span><span id="local-6989586621679549125"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549125"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
forall b. Ptr b
</span><a href="#local-6989586621679549128"><span class="hs-identifier hs-var">ptr'</span></a></span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621679549123"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549123"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO Word8) -&gt; Ptr Word8 -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr Any
forall b. Ptr b
</span><a href="#local-6989586621679549128"><span class="hs-identifier hs-var">ptr'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-116"></span><span>      </span><span id="local-6989586621679549122"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549122"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO Word8) -&gt; Ptr Word8 -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr Any
forall b. Ptr b
</span><a href="#local-6989586621679549128"><span class="hs-identifier hs-var">ptr'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679549121"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549121"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO Word8) -&gt; Ptr Word8 -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ptr Any -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr Any
forall b. Ptr b
</span><a href="#local-6989586621679549128"><span class="hs-identifier hs-var">ptr'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; IO PixelRGBA8
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PixelRGBA8 -&gt; IO PixelRGBA8) -&gt; PixelRGBA8 -&gt; IO PixelRGBA8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8 -&gt; Word8 -&gt; PixelRGBA8
</span><span class="hs-identifier hs-var">PixelRGBA8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549125"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549123"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549122"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679549121"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549126"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679549126"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int -&gt; Int -&gt; Int
forall a. Pixel a =&gt; Image a -&gt; Int -&gt; Int -&gt; Int
</span><span class="hs-identifier hs-var">pixelBaseIndex</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549135"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549119"><span class="hs-identifier hs-var">xPx</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549118"><span class="hs-identifier hs-var">yPx</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549119"><span class="annot"><span class="annottext">xPx :: Int
</span><a href="#local-6989586621679549119"><span class="hs-identifier hs-var hs-var">xPx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549132"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549134"><span class="hs-identifier hs-var">wMax</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549118"><span class="annot"><span class="annottext">yPx :: Int
</span><a href="#local-6989586621679549118"><span class="hs-identifier hs-var hs-var">yPx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549131"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549133"><span class="hs-identifier hs-var">hMax</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Interpolate between two projections and apply the result to an image in</span><span>
</span><span id="line-125"></span><span class="hs-comment">--   equirectangular format. The source image must have an aspect ratio of 2:1.</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Reanimate.GeoProjection.html#interpP"><span class="hs-identifier hs-type">interpP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span>
</span><span id="line-127"></span><span id="interpP"><span class="annot"><span class="annottext">interpP :: Image PixelRGBA8
-&gt; Projection -&gt; Projection -&gt; Double -&gt; Image PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#interpP"><span class="hs-identifier hs-var hs-var">interpP</span></a></span></span><span> </span><span id="local-6989586621679549117"><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549117"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679549116"><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679549116"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Projection
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Projection -&gt; Image PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#project"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549117"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679549116"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Reanimate.GeoProjection.html#interpP"><span class="hs-identifier hs-var">interpP</span></a></span><span> </span><span id="local-6989586621679549115"><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549115"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="annot"><span class="annottext">Projection
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679549114"><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679549114"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Projection -&gt; Image PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#project"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549115"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679549114"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Reanimate.GeoProjection.html#interpP"><span class="hs-identifier hs-var">interpP</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549113"><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549113"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679549111"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679549111"><span class="hs-identifier hs-var">_label1</span></a></span></span><span> </span><span id="local-6989586621679549110"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549110"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679549109"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549109"><span class="hs-identifier hs-var">p1_inv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679549108"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679549108"><span class="hs-identifier hs-var">_label2</span></a></span></span><span> </span><span id="local-6989586621679549107"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549107"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679549106"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549106"><span class="hs-identifier hs-var">p2_inv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549105"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549105"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (Image PixelRGBA8)) -&gt; Image PixelRGBA8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (Image PixelRGBA8)) -&gt; Image PixelRGBA8)
-&gt; (forall s. ST s (Image PixelRGBA8)) -&gt; Image PixelRGBA8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549103"><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
</span><a href="#local-6989586621679549103"><span class="hs-identifier hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s (MutableImage (PrimState (ST s)) PixelRGBA8)
forall px (m :: * -&gt; *).
(Pixel px, PrimMonad m) =&gt;
Int -&gt; Int -&gt; m (MutableImage (PrimState m) px)
</span><span class="hs-identifier hs-var">newMutableImage</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679549099"><span class="annot"><span class="annottext">factor :: Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var hs-var">factor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679549098"><span class="annot"><span class="annottext">l1 :: ST s ()
</span><a href="#local-6989586621679549098"><span class="hs-identifier hs-var hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549097"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549096"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549096"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549097"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549095"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549095"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549094"><span class="annot"><span class="annottext">x1' :: Double
</span><a href="#local-6989586621679549094"><span class="hs-identifier hs-var hs-var">x1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549096"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var">wMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                  </span><span class="hs-glyph">!</span><span id="local-6989586621679549092"><span class="annot"><span class="annottext">y1' :: Double
</span><a href="#local-6989586621679549092"><span class="hs-identifier hs-var hs-var">y1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549095"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var">hMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                  </span><span class="hs-glyph">!</span><span id="local-6989586621679549090"><span class="annot"><span class="annottext">lonlat :: LonLat
</span><a href="#local-6989586621679549090"><span class="hs-identifier hs-var hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549109"><span class="hs-identifier hs-var">p1_inv</span></a></span><span> </span><span class="annot"><span class="annottext">(XYCoord -&gt; LonLat) -&gt; XYCoord -&gt; LonLat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549094"><span class="hs-identifier hs-var">x1'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549092"><span class="hs-identifier hs-var">y1'</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var">validLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549090"><span class="hs-identifier hs-var">lonlat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>                </span><span id="local-6989586621679549085"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549085"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
forall s.
Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#srcPixelFast"><span class="hs-identifier hs-var">srcPixelFast</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549113"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var">wMax</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var">hMax</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549090"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-142"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; PixelBaseComponent PixelRGBA8
forall a. Pixel a =&gt; a -&gt; PixelBaseComponent a
</span><span class="hs-identifier hs-var">pixelOpacity</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549085"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549082"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549082"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679549081"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549081"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549110"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549090"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-144"></span><span>                      </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549080"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549080"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679549079"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549079"><span class="hs-identifier hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549107"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549090"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-145"></span><span>                      </span><span class="hs-glyph">!</span><span id="local-6989586621679549078"><span class="annot"><span class="annottext">x3 :: Int
</span><a href="#local-6989586621679549078"><span class="hs-identifier hs-var hs-var">x3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549082"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549080"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549105"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var">wMax</span></a></span><span>
</span><span id="line-146"></span><span>                      </span><span class="hs-glyph">!</span><span id="local-6989586621679549076"><span class="annot"><span class="annottext">y3 :: Int
</span><a href="#local-6989586621679549076"><span class="hs-identifier hs-var hs-var">y3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549081"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549079"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549105"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var">hMax</span></a></span><span>
</span><span id="line-147"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549078"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549078"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549076"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549076"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-148"></span><span>                    </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) PixelRGBA8
-&gt; Int -&gt; Int -&gt; PixelRGBA8 -&gt; ST s ()
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writePixel</span></span><span> </span><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
MutableImage (PrimState (ST s)) PixelRGBA8
</span><a href="#local-6989586621679549103"><span class="hs-identifier hs-var">img</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549078"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549076"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549085"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621679549072"><span class="annot"><span class="annottext">l2 :: ST s ()
</span><a href="#local-6989586621679549072"><span class="hs-identifier hs-var hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549097"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549071"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549071"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549097"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549070"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549070"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549069"><span class="annot"><span class="annottext">x2' :: Double
</span><a href="#local-6989586621679549069"><span class="hs-identifier hs-var hs-var">x2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549071"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var">wMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                  </span><span class="hs-glyph">!</span><span id="local-6989586621679549068"><span class="annot"><span class="annottext">y2' :: Double
</span><a href="#local-6989586621679549068"><span class="hs-identifier hs-var hs-var">y2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549070"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var">hMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549099"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>                  </span><span class="hs-glyph">!</span><span id="local-6989586621679549067"><span class="annot"><span class="annottext">lonlat :: LonLat
</span><a href="#local-6989586621679549067"><span class="hs-identifier hs-var hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549106"><span class="hs-identifier hs-var">p2_inv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549069"><span class="hs-identifier hs-var">x2'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549068"><span class="hs-identifier hs-var">y2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var">validLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549067"><span class="hs-identifier hs-var">lonlat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>                </span><span id="local-6989586621679549066"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549066"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
forall s.
Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#srcPixelFast"><span class="hs-identifier hs-var">srcPixelFast</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549113"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var">wMax</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var">hMax</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549067"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-157"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; PixelBaseComponent PixelRGBA8
forall a. Pixel a =&gt; a -&gt; PixelBaseComponent a
</span><span class="hs-identifier hs-var">pixelOpacity</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549066"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549065"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549065"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679549064"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549064"><span class="hs-identifier hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549107"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549067"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-159"></span><span>                      </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549063"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549063"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679549062"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549062"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549110"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549067"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-160"></span><span>                      </span><span class="hs-glyph">!</span><span id="local-6989586621679549061"><span class="annot"><span class="annottext">x3 :: Int
</span><a href="#local-6989586621679549061"><span class="hs-identifier hs-var hs-var">x3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549063"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549065"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549105"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var">wMax</span></a></span><span>
</span><span id="line-161"></span><span>                      </span><span class="hs-glyph">!</span><span id="local-6989586621679549060"><span class="annot"><span class="annottext">y3 :: Int
</span><a href="#local-6989586621679549060"><span class="hs-identifier hs-var hs-var">y3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549062"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549064"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549105"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var">hMax</span></a></span><span>
</span><span id="line-162"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549061"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549061"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549060"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549060"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-163"></span><span>                    </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) PixelRGBA8
-&gt; Int -&gt; Int -&gt; PixelRGBA8 -&gt; ST s ()
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writePixel</span></span><span> </span><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
MutableImage (PrimState (ST s)) PixelRGBA8
</span><a href="#local-6989586621679549103"><span class="hs-identifier hs-var">img</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549061"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549060"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549066"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549105"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549098"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; ST s () -&gt; ST s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549072"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549072"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; ST s () -&gt; ST s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549098"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) PixelRGBA8
-&gt; ST s (Image PixelRGBA8)
forall a (m :: * -&gt; *).
(Storable (PixelBaseComponent a), PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; m (Image a)
</span><span class="hs-identifier hs-var">unsafeFreezeImage</span></span><span> </span><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
MutableImage (PrimState (ST s)) PixelRGBA8
</span><a href="#local-6989586621679549103"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679549097"><span class="annot"><span class="annottext">loopTo :: t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549097"><span class="hs-identifier hs-var hs-var">loopTo</span></a></span></span><span> </span><span id="local-6989586621679549058"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549058"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679549057"><span class="annot"><span class="annottext">t -&gt; m a
</span><a href="#local-6989586621679549057"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; m ()
</span><a href="#local-6989586621679549056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549058"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679549056"><span class="annot"><span class="annottext">go :: t -&gt; m ()
</span><a href="#local-6989586621679549056"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><a href="#local-6989586621679549056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679549055"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549055"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; m a
</span><a href="#local-6989586621679549057"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549055"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a -&gt; m () -&gt; m ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; m ()
</span><a href="#local-6989586621679549056"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549055"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549101"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageWidth</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549113"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549100"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageHeight</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549113"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549093"><span class="annot"><span class="annottext">wMax :: Double
</span><a href="#local-6989586621679549093"><span class="hs-identifier hs-var hs-var">wMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549101"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549091"><span class="annot"><span class="annottext">hMax :: Double
</span><a href="#local-6989586621679549091"><span class="hs-identifier hs-var hs-var">hMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549100"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Interpolate between two projections and apply the result to an image in</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   equirectangular format. The source image must have an aspect ratio of 2:1.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   Only the areas inside of the two bounding boxes (applying to the source and</span><span>
</span><span id="line-180"></span><span class="hs-comment">--   target projection, respectively) are mapped. Pixels outside of these bounding-boxes</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   are undefined.</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Reanimate.GeoProjection.html#interpBBP"><span class="hs-identifier hs-type">interpBBP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span>
</span><span id="line-184"></span><span id="interpBBP"><span class="annot"><span class="annottext">interpBBP :: Image PixelRGBA8
-&gt; Projection
-&gt; Projection
-&gt; (Double, Double, Double, Double)
-&gt; (Double, Double, Double, Double)
-&gt; Double
-&gt; Image PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#interpBBP"><span class="hs-identifier hs-var hs-var">interpBBP</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549054"><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549054"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679549053"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549053"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679549052"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549052"><span class="hs-identifier hs-var">p1_inv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679549051"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549051"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679549050"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549050"><span class="hs-identifier hs-var">p2_inv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549049"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549049"><span class="hs-identifier hs-var">fx</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679549048"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549048"><span class="hs-identifier hs-var">fy</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679549047"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549047"><span class="hs-identifier hs-var">fw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679549046"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549046"><span class="hs-identifier hs-var">fh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549045"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549045"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679549044"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549044"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679549043"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549043"><span class="hs-identifier hs-var">tw</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679549042"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549042"><span class="hs-identifier hs-var">th</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549041"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549041"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (Image PixelRGBA8)) -&gt; Image PixelRGBA8
forall a. (forall s. ST s a) -&gt; a
</span><span class="hs-identifier hs-var">runST</span></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (Image PixelRGBA8)) -&gt; Image PixelRGBA8)
-&gt; (forall s. ST s (Image PixelRGBA8)) -&gt; Image PixelRGBA8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549040"><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
</span><a href="#local-6989586621679549040"><span class="hs-identifier hs-var">img</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s (MutableImage (PrimState (ST s)) PixelRGBA8)
forall px (m :: * -&gt; *).
(Pixel px, PrimMonad m) =&gt;
Int -&gt; Int -&gt; m (MutableImage (PrimState m) px)
</span><span class="hs-identifier hs-var">newMutableImage</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679549037"><span class="annot"><span class="annottext">factor :: Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var hs-var">factor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679549036"><span class="annot"><span class="annottext">l1 :: ST s ()
</span><a href="#local-6989586621679549036"><span class="hs-identifier hs-var hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549035"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549034"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549034"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549035"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549033"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549033"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549032"><span class="annot"><span class="annottext">x1' :: Double
</span><a href="#local-6989586621679549032"><span class="hs-identifier hs-var hs-var">x1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549034"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var">wMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                  </span><span class="hs-glyph">!</span><span id="local-6989586621679549030"><span class="annot"><span class="annottext">y1' :: Double
</span><a href="#local-6989586621679549030"><span class="hs-identifier hs-var hs-var">y1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549033"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var">hMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549032"><span class="hs-identifier hs-var">x1'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549049"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549032"><span class="hs-identifier hs-var">x1'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549049"><span class="hs-identifier hs-var">fx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549047"><span class="hs-identifier hs-var">fw</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549030"><span class="hs-identifier hs-var">y1'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549048"><span class="hs-identifier hs-var">fy</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549030"><span class="hs-identifier hs-var">y1'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549048"><span class="hs-identifier hs-var">fy</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549046"><span class="hs-identifier hs-var">fh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549027"><span class="annot"><span class="annottext">lonlat :: LonLat
</span><a href="#local-6989586621679549027"><span class="hs-identifier hs-var hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549052"><span class="hs-identifier hs-var">p1_inv</span></a></span><span> </span><span class="annot"><span class="annottext">(XYCoord -&gt; LonLat) -&gt; XYCoord -&gt; LonLat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549032"><span class="hs-identifier hs-var">x1'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549030"><span class="hs-identifier hs-var">y1'</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var">validLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549027"><span class="hs-identifier hs-var">lonlat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>                    </span><span id="local-6989586621679549026"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549026"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
forall s.
Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#srcPixelFast"><span class="hs-identifier hs-var">srcPixelFast</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549054"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var">wMax</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var">hMax</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549027"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-197"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; PixelBaseComponent PixelRGBA8
forall a. Pixel a =&gt; a -&gt; PixelBaseComponent a
</span><span class="hs-identifier hs-var">pixelOpacity</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549026"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549025"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549025"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679549024"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549024"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549053"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549027"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-199"></span><span>                          </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549023"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549023"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679549022"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549022"><span class="hs-identifier hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549051"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549027"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-200"></span><span>                          </span><span class="hs-glyph">!</span><span id="local-6989586621679549021"><span class="annot"><span class="annottext">x3 :: Int
</span><a href="#local-6989586621679549021"><span class="hs-identifier hs-var hs-var">x3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549025"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549023"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549041"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var">wMax</span></a></span><span>
</span><span id="line-201"></span><span>                          </span><span class="hs-glyph">!</span><span id="local-6989586621679549020"><span class="annot"><span class="annottext">y3 :: Int
</span><a href="#local-6989586621679549020"><span class="hs-identifier hs-var hs-var">y3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549024"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549022"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549041"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var">hMax</span></a></span><span>
</span><span id="line-202"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549021"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549021"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549020"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549020"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-203"></span><span>                        </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) PixelRGBA8
-&gt; Int -&gt; Int -&gt; PixelRGBA8 -&gt; ST s ()
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writePixel</span></span><span> </span><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
MutableImage (PrimState (ST s)) PixelRGBA8
</span><a href="#local-6989586621679549040"><span class="hs-identifier hs-var">img</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549021"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549020"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549026"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span id="local-6989586621679549019"><span class="annot"><span class="annottext">l2 :: ST s ()
</span><a href="#local-6989586621679549019"><span class="hs-identifier hs-var hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549035"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549018"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549018"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall t (m :: * -&gt; *) a.
(Eq t, Num t, Monad m) =&gt;
t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549035"><span class="hs-identifier hs-var">loopTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s ()) -&gt; ST s ()) -&gt; (Int -&gt; ST s ()) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679549017"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549017"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549016"><span class="annot"><span class="annottext">x2' :: Double
</span><a href="#local-6989586621679549016"><span class="hs-identifier hs-var hs-var">x2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549018"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var">wMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                  </span><span class="hs-glyph">!</span><span id="local-6989586621679549015"><span class="annot"><span class="annottext">y2' :: Double
</span><a href="#local-6989586621679549015"><span class="hs-identifier hs-var hs-var">y2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549017"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var">hMax</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549037"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549016"><span class="hs-identifier hs-var">x2'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549045"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549016"><span class="hs-identifier hs-var">x2'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549045"><span class="hs-identifier hs-var">tx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549043"><span class="hs-identifier hs-var">tw</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549015"><span class="hs-identifier hs-var">y2'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549044"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549015"><span class="hs-identifier hs-var">y2'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549044"><span class="hs-identifier hs-var">ty</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549042"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679549014"><span class="annot"><span class="annottext">lonlat :: LonLat
</span><a href="#local-6989586621679549014"><span class="hs-identifier hs-var hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679549050"><span class="hs-identifier hs-var">p2_inv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549016"><span class="hs-identifier hs-var">x2'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549015"><span class="hs-identifier hs-var">y2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var">validLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549014"><span class="hs-identifier hs-var">lonlat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>                  </span><span id="local-6989586621679549013"><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549013"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
forall s.
Image PixelRGBA8 -&gt; Double -&gt; Double -&gt; LonLat -&gt; ST s PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#srcPixelFast"><span class="hs-identifier hs-var">srcPixelFast</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549054"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var">wMax</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var">hMax</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549014"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-213"></span><span>                  </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PixelRGBA8 -&gt; PixelBaseComponent PixelRGBA8
forall a. Pixel a =&gt; a -&gt; PixelBaseComponent a
</span><span class="hs-identifier hs-var">pixelOpacity</span></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549013"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549012"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549012"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679549011"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549011"><span class="hs-identifier hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549051"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549014"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-215"></span><span>                        </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679549010"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549010"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679549009"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549009"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679549053"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679549014"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-216"></span><span>                        </span><span class="hs-glyph">!</span><span id="local-6989586621679549008"><span class="annot"><span class="annottext">x3 :: Int
</span><a href="#local-6989586621679549008"><span class="hs-identifier hs-var hs-var">x3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549010"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549012"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549041"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var">wMax</span></a></span><span>
</span><span id="line-217"></span><span>                        </span><span class="hs-glyph">!</span><span id="local-6989586621679549007"><span class="annot"><span class="annottext">y3 :: Int
</span><a href="#local-6989586621679549007"><span class="hs-identifier hs-var hs-var">y3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549009"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549011"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549041"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var">hMax</span></a></span><span>
</span><span id="line-218"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; ST s () -&gt; ST s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549008"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549008"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549007"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549007"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ST s () -&gt; ST s ()) -&gt; ST s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-219"></span><span>                      </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) PixelRGBA8
-&gt; Int -&gt; Int -&gt; PixelRGBA8 -&gt; ST s ()
forall a (m :: * -&gt; *).
(Pixel a, PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; Int -&gt; Int -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">writePixel</span></span><span> </span><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
MutableImage (PrimState (ST s)) PixelRGBA8
</span><a href="#local-6989586621679549040"><span class="hs-identifier hs-var">img</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549008"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549007"><span class="hs-identifier hs-var">y3</span></a></span><span> </span><span class="annot"><span class="annottext">PixelRGBA8
</span><a href="#local-6989586621679549013"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549041"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549036"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; ST s () -&gt; ST s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549019"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549019"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">ST s () -&gt; ST s () -&gt; ST s ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ST s ()
</span><a href="#local-6989586621679549036"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">MutableImage (PrimState (ST s)) PixelRGBA8
-&gt; ST s (Image PixelRGBA8)
forall a (m :: * -&gt; *).
(Storable (PixelBaseComponent a), PrimMonad m) =&gt;
MutableImage (PrimState m) a -&gt; m (Image a)
</span><span class="hs-identifier hs-var">unsafeFreezeImage</span></span><span> </span><span class="annot"><span class="annottext">MutableImage s PixelRGBA8
MutableImage (PrimState (ST s)) PixelRGBA8
</span><a href="#local-6989586621679549040"><span class="hs-identifier hs-var">img</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679549035"><span class="annot"><span class="annottext">loopTo :: t -&gt; (t -&gt; m a) -&gt; m ()
</span><a href="#local-6989586621679549035"><span class="hs-identifier hs-var hs-var">loopTo</span></a></span></span><span> </span><span id="local-6989586621679549006"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549006"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679549005"><span class="annot"><span class="annottext">t -&gt; m a
</span><a href="#local-6989586621679549005"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; m ()
</span><a href="#local-6989586621679549004"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549006"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679549004"><span class="annot"><span class="annottext">go :: t -&gt; m ()
</span><a href="#local-6989586621679549004"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><a href="#local-6989586621679549004"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679549003"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549003"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; m a
</span><a href="#local-6989586621679549005"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549003"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a -&gt; m () -&gt; m ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; m ()
</span><a href="#local-6989586621679549004"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679549003"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549039"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageWidth</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549054"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549038"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageHeight</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679549054"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549031"><span class="annot"><span class="annottext">wMax :: Double
</span><a href="#local-6989586621679549031"><span class="hs-identifier hs-var hs-var">wMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549039"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679549029"><span class="annot"><span class="annottext">hMax :: Double
</span><a href="#local-6989586621679549029"><span class="hs-identifier hs-var hs-var">hMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679549038"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Reanimate.GeoProjection.html#eqLonLat"><span class="hs-identifier hs-type">eqLonLat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-236"></span><span id="eqLonLat"><span class="annot"><span class="annottext">eqLonLat :: LonLat -&gt; LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#eqLonLat"><span class="hs-identifier hs-var hs-var">eqLonLat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679549001"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549001"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679549000"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549000"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548999"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548999"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679548998"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548998"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#eqDouble"><span class="hs-identifier hs-var">eqDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549001"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548999"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#eqDouble"><span class="hs-identifier hs-var">eqDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679549000"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548998"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-238"></span><span class="hs-comment">{-
eqCoords :: XYCoord -&gt; XYCoord -&gt; Bool
eqCoords (XYCoord x1 y1) (XYCoord x2 y2)
  = eqDouble x1 x2 &amp;&amp; eqDouble y1 y2
-}</span><span>
</span><span id="line-243"></span><span class="annot"><a href="Reanimate.GeoProjection.html#eqDouble"><span class="hs-identifier hs-type">eqDouble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-244"></span><span id="eqDouble"><span class="annot"><span class="annottext">eqDouble :: Double -&gt; Double -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#eqDouble"><span class="hs-identifier hs-var hs-var">eqDouble</span></a></span></span><span> </span><span id="local-6989586621679548996"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548996"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679548995"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548995"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548996"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548995"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-identifier hs-var">epsilon</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | XY coordinates on a 2D plane. Valid ranges go from 0 to 1, inclusive.</span><span>
</span><span id="line-247"></span><span class="hs-keyword">data</span><span> </span><span id="XYCoord"><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XYCoord"><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-comment">-- 0 to 1</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679548986"><span id="local-6989586621679548988"><span id="local-6989586621679548990"><span id="local-6989586621679548992"><span class="annot"><span class="annottext">ReadPrec [XYCoord]
ReadPrec XYCoord
Int -&gt; ReadS XYCoord
ReadS [XYCoord]
(Int -&gt; ReadS XYCoord)
-&gt; ReadS [XYCoord]
-&gt; ReadPrec XYCoord
-&gt; ReadPrec [XYCoord]
-&gt; Read XYCoord
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [XYCoord]
$creadListPrec :: ReadPrec [XYCoord]
readPrec :: ReadPrec XYCoord
$creadPrec :: ReadPrec XYCoord
readList :: ReadS [XYCoord]
$creadList :: ReadS [XYCoord]
readsPrec :: Int -&gt; ReadS XYCoord
$creadsPrec :: Int -&gt; ReadS XYCoord
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679548979"><span id="local-6989586621679548981"><span id="local-6989586621679548983"><span class="annot"><span class="annottext">Int -&gt; XYCoord -&gt; ShowS
[XYCoord] -&gt; ShowS
XYCoord -&gt; String
(Int -&gt; XYCoord -&gt; ShowS)
-&gt; (XYCoord -&gt; String) -&gt; ([XYCoord] -&gt; ShowS) -&gt; Show XYCoord
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [XYCoord] -&gt; ShowS
$cshowList :: [XYCoord] -&gt; ShowS
show :: XYCoord -&gt; String
$cshow :: XYCoord -&gt; String
showsPrec :: Int -&gt; XYCoord -&gt; ShowS
$cshowsPrec :: Int -&gt; XYCoord -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679548974"><span id="local-6989586621679548976"><span class="annot"><span class="annottext">XYCoord -&gt; XYCoord -&gt; Bool
(XYCoord -&gt; XYCoord -&gt; Bool)
-&gt; (XYCoord -&gt; XYCoord -&gt; Bool) -&gt; Eq XYCoord
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: XYCoord -&gt; XYCoord -&gt; Bool
$c/= :: XYCoord -&gt; XYCoord -&gt; Bool
== :: XYCoord -&gt; XYCoord -&gt; Bool
$c== :: XYCoord -&gt; XYCoord -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679548958"><span id="local-6989586621679548960"><span id="local-6989586621679548962"><span id="local-6989586621679548964"><span id="local-6989586621679548966"><span id="local-6989586621679548968"><span id="local-6989586621679548970"><span class="annot"><span class="annottext">Eq XYCoord
Eq XYCoord
-&gt; (XYCoord -&gt; XYCoord -&gt; Ordering)
-&gt; (XYCoord -&gt; XYCoord -&gt; Bool)
-&gt; (XYCoord -&gt; XYCoord -&gt; Bool)
-&gt; (XYCoord -&gt; XYCoord -&gt; Bool)
-&gt; (XYCoord -&gt; XYCoord -&gt; Bool)
-&gt; (XYCoord -&gt; XYCoord -&gt; XYCoord)
-&gt; (XYCoord -&gt; XYCoord -&gt; XYCoord)
-&gt; Ord XYCoord
XYCoord -&gt; XYCoord -&gt; Bool
XYCoord -&gt; XYCoord -&gt; Ordering
XYCoord -&gt; XYCoord -&gt; XYCoord
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: XYCoord -&gt; XYCoord -&gt; XYCoord
$cmin :: XYCoord -&gt; XYCoord -&gt; XYCoord
max :: XYCoord -&gt; XYCoord -&gt; XYCoord
$cmax :: XYCoord -&gt; XYCoord -&gt; XYCoord
&gt;= :: XYCoord -&gt; XYCoord -&gt; Bool
$c&gt;= :: XYCoord -&gt; XYCoord -&gt; Bool
&gt; :: XYCoord -&gt; XYCoord -&gt; Bool
$c&gt; :: XYCoord -&gt; XYCoord -&gt; Bool
&lt;= :: XYCoord -&gt; XYCoord -&gt; Bool
$c&lt;= :: XYCoord -&gt; XYCoord -&gt; Bool
&lt; :: XYCoord -&gt; XYCoord -&gt; Bool
$c&lt; :: XYCoord -&gt; XYCoord -&gt; Bool
compare :: XYCoord -&gt; XYCoord -&gt; Ordering
$ccompare :: XYCoord -&gt; XYCoord -&gt; Ordering
$cp1Ord :: Eq XYCoord
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Longitude and latitude. Valid range for longitude is -pi to +pi.</span><span>
</span><span id="line-251"></span><span class="hs-comment">--   Valid range for latitude is -pi/2 to +pi/2.</span><span>
</span><span id="line-252"></span><span class="hs-keyword">data</span><span> </span><span id="LonLat"><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LonLat"><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-comment">-- -pi to +pi, -halfPi to +halfPi</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679548949"><span id="local-6989586621679548951"><span id="local-6989586621679548953"><span id="local-6989586621679548955"><span class="annot"><span class="annottext">ReadPrec [LonLat]
ReadPrec LonLat
Int -&gt; ReadS LonLat
ReadS [LonLat]
(Int -&gt; ReadS LonLat)
-&gt; ReadS [LonLat]
-&gt; ReadPrec LonLat
-&gt; ReadPrec [LonLat]
-&gt; Read LonLat
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [LonLat]
$creadListPrec :: ReadPrec [LonLat]
readPrec :: ReadPrec LonLat
$creadPrec :: ReadPrec LonLat
readList :: ReadS [LonLat]
$creadList :: ReadS [LonLat]
readsPrec :: Int -&gt; ReadS LonLat
$creadsPrec :: Int -&gt; ReadS LonLat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679548943"><span id="local-6989586621679548945"><span id="local-6989586621679548947"><span class="annot"><span class="annottext">Int -&gt; LonLat -&gt; ShowS
[LonLat] -&gt; ShowS
LonLat -&gt; String
(Int -&gt; LonLat -&gt; ShowS)
-&gt; (LonLat -&gt; String) -&gt; ([LonLat] -&gt; ShowS) -&gt; Show LonLat
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LonLat] -&gt; ShowS
$cshowList :: [LonLat] -&gt; ShowS
show :: LonLat -&gt; String
$cshow :: LonLat -&gt; String
showsPrec :: Int -&gt; LonLat -&gt; ShowS
$cshowsPrec :: Int -&gt; LonLat -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679548939"><span id="local-6989586621679548941"><span class="annot"><span class="annottext">LonLat -&gt; LonLat -&gt; Bool
(LonLat -&gt; LonLat -&gt; Bool)
-&gt; (LonLat -&gt; LonLat -&gt; Bool) -&gt; Eq LonLat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LonLat -&gt; LonLat -&gt; Bool
$c/= :: LonLat -&gt; LonLat -&gt; Bool
== :: LonLat -&gt; LonLat -&gt; Bool
$c== :: LonLat -&gt; LonLat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679548924"><span id="local-6989586621679548926"><span id="local-6989586621679548928"><span id="local-6989586621679548930"><span id="local-6989586621679548932"><span id="local-6989586621679548934"><span id="local-6989586621679548936"><span class="annot"><span class="annottext">Eq LonLat
Eq LonLat
-&gt; (LonLat -&gt; LonLat -&gt; Ordering)
-&gt; (LonLat -&gt; LonLat -&gt; Bool)
-&gt; (LonLat -&gt; LonLat -&gt; Bool)
-&gt; (LonLat -&gt; LonLat -&gt; Bool)
-&gt; (LonLat -&gt; LonLat -&gt; Bool)
-&gt; (LonLat -&gt; LonLat -&gt; LonLat)
-&gt; (LonLat -&gt; LonLat -&gt; LonLat)
-&gt; Ord LonLat
LonLat -&gt; LonLat -&gt; Bool
LonLat -&gt; LonLat -&gt; Ordering
LonLat -&gt; LonLat -&gt; LonLat
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: LonLat -&gt; LonLat -&gt; LonLat
$cmin :: LonLat -&gt; LonLat -&gt; LonLat
max :: LonLat -&gt; LonLat -&gt; LonLat
$cmax :: LonLat -&gt; LonLat -&gt; LonLat
&gt;= :: LonLat -&gt; LonLat -&gt; Bool
$c&gt;= :: LonLat -&gt; LonLat -&gt; Bool
&gt; :: LonLat -&gt; LonLat -&gt; Bool
$c&gt; :: LonLat -&gt; LonLat -&gt; Bool
&lt;= :: LonLat -&gt; LonLat -&gt; Bool
$c&lt;= :: LonLat -&gt; LonLat -&gt; Bool
&lt; :: LonLat -&gt; LonLat -&gt; Bool
$c&lt; :: LonLat -&gt; LonLat -&gt; Bool
compare :: LonLat -&gt; LonLat -&gt; Ordering
$ccompare :: LonLat -&gt; LonLat -&gt; Ordering
$cp1Ord :: Eq LonLat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679548921"><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679548919"><span class="annot"><span class="annottext">hashWithSalt :: Int -&gt; LonLat -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">hashWithSalt</span></span></span><span> </span><span id="local-6989586621679548917"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548917"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548916"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548916"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679548915"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548915"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Double, Double) -&gt; Int
forall a. Hashable a =&gt; Int -&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">hashWithSalt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548917"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548916"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548915"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Projections are named bi-directional mappings between a sphere</span><span>
</span><span id="line-258"></span><span class="hs-comment">--   and a 2D plane.</span><span>
</span><span id="line-259"></span><span class="hs-keyword">data</span><span> </span><span id="Projection"><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Projection"><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="projectionLabel"><span class="annot"><span class="annottext">Projection -&gt; String
</span><a href="Reanimate.GeoProjection.html#projectionLabel"><span class="hs-identifier hs-var hs-var">projectionLabel</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ Name of the projection.</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="projectionForward"><span class="annot"><span class="annottext">Projection -&gt; LonLat -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#projectionForward"><span class="hs-identifier hs-var hs-var">projectionForward</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- ^ Mapping from longitude and latitude on a sphere to</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">--   XY coordinates on a 2D plane.</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="projectionInverse"><span class="annot"><span class="annottext">Projection -&gt; XYCoord -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#projectionInverse"><span class="hs-identifier hs-var hs-var">projectionInverse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-comment">-- ^ Mapping from XY coordinates on a 2D plane to longitude</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-comment">--   and latitude on a sphere.</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- FIXME: Verify that 'src' has an aspect ratio of 2:1.</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Apply on an image in equirectangular format. The source image</span><span>
</span><span id="line-271"></span><span class="hs-comment">--   therfore must have an aspect ratio of 2:1.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Reanimate.GeoProjection.html#project"><span class="hs-identifier hs-type">project</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Image</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PixelRGBA8</span></span><span>
</span><span id="line-273"></span><span id="project"><span class="annot"><span class="annottext">project :: Image PixelRGBA8 -&gt; Projection -&gt; Image PixelRGBA8
</span><a href="Reanimate.GeoProjection.html#project"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span id="local-6989586621679548911"><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679548911"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679548910"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548910"><span class="hs-identifier hs-var">_label</span></a></span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679548909"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548909"><span class="hs-identifier hs-var">pInv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; PixelRGBA8) -&gt; Int -&gt; Int -&gt; Image PixelRGBA8
forall px. Pixel px =&gt; (Int -&gt; Int -&gt; px) -&gt; Int -&gt; Int -&gt; Image px
</span><span class="hs-identifier hs-var">generateImage</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; PixelRGBA8
forall a a. (Integral a, Integral a) =&gt; a -&gt; a -&gt; PixelRGBA8
</span><a href="#local-6989586621679548907"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548906"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548905"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621679548906"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679548906"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageWidth</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679548911"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679548905"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679548905"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; Int
forall a. Image a -&gt; Int
</span><span class="hs-identifier hs-var hs-var">imageHeight</span></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679548911"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679548907"><span class="annot"><span class="annottext">fn :: a -&gt; a -&gt; PixelRGBA8
</span><a href="#local-6989586621679548907"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679548904"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548904"><span class="hs-identifier hs-var">xPx</span></a></span></span><span> </span><span id="local-6989586621679548903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548903"><span class="hs-identifier hs-var">yPx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679548902"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548902"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548904"><span class="hs-identifier hs-var">xPx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548906"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>          </span><span id="local-6989586621679548901"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548901"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548903"><span class="hs-identifier hs-var">yPx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548905"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>          </span><span id="local-6989586621679548900"><span class="annot"><span class="annottext">lonlat :: LonLat
</span><a href="#local-6989586621679548900"><span class="hs-identifier hs-var hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548909"><span class="hs-identifier hs-var">pInv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548902"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548901"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var">validLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548900"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8 -&gt; LonLat -&gt; PixelRGBA8
forall pixel. Pixel pixel =&gt; Image pixel -&gt; LonLat -&gt; pixel
</span><a href="Reanimate.GeoProjection.html#srcPixel"><span class="hs-identifier hs-var">srcPixel</span></a></span><span> </span><span class="annot"><span class="annottext">Image PixelRGBA8
</span><a href="#local-6989586621679548911"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548900"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8 -&gt; Word8 -&gt; PixelRGBA8
</span><span class="hs-identifier hs-var">PixelRGBA8</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-type">validLonLat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-287"></span><span id="validLonLat"><span class="annot"><span class="annottext">validLonLat :: LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var hs-var">validLonLat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548899"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548899"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548898"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548898"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548899"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548899"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548898"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548898"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Reanimate.GeoProjection.html#_validXYCoord"><span class="hs-identifier hs-type">_validXYCoord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-291"></span><span id="_validXYCoord"><span class="annot"><span class="annottext">_validXYCoord :: XYCoord -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#_validXYCoord"><span class="hs-identifier hs-var hs-var">_validXYCoord</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548896"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548896"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548895"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548895"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548896"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548896"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548895"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548895"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Returns @True@ iff a projection is consistent and complete.</span><span>
</span><span id="line-294"></span><span class="annot"><a href="Reanimate.GeoProjection.html#isValidP"><span class="hs-identifier hs-type">isValidP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-295"></span><span id="isValidP"><span class="annot"><span class="annottext">isValidP :: Projection -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#isValidP"><span class="hs-identifier hs-var hs-var">isValidP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679548894"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548894"><span class="hs-identifier hs-var">_label</span></a></span></span><span> </span><span id="local-6989586621679548893"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548893"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679548892"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548892"><span class="hs-identifier hs-var">pInv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a a. (Integral a, Integral a) =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679548890"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548889"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548888"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679548889"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548889"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548887"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679548888"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548888"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548886"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679548887"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679548887"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679548886"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679548886"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679548890"><span class="annot"><span class="annottext">check :: a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679548890"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679548885"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548885"><span class="hs-identifier hs-var">xPx</span></a></span></span><span> </span><span id="local-6989586621679548884"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548884"><span class="hs-identifier hs-var">yPx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679548883"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548883"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548885"><span class="hs-identifier hs-var">xPx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548887"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>          </span><span id="local-6989586621679548882"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548882"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548884"><span class="hs-identifier hs-var">yPx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548886"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>          </span><span id="local-6989586621679548881"><span class="annot"><span class="annottext">lonlat :: LonLat
</span><a href="#local-6989586621679548881"><span class="hs-identifier hs-var hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548892"><span class="hs-identifier hs-var">pInv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548883"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548882"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>          </span><span id="local-6989586621679548880"><span class="annot"><span class="annottext">lonlat2 :: LonLat
</span><a href="#local-6989586621679548880"><span class="hs-identifier hs-var hs-var">lonlat2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548892"><span class="hs-identifier hs-var">pInv</span></a></span><span> </span><span class="annot"><span class="annottext">(XYCoord -&gt; LonLat) -&gt; XYCoord -&gt; LonLat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548893"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548881"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#validLonLat"><span class="hs-identifier hs-var">validLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548881"><span class="hs-identifier hs-var">lonlat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; LonLat -&gt; Bool
</span><a href="Reanimate.GeoProjection.html#eqLonLat"><span class="hs-identifier hs-var">eqLonLat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548881"><span class="hs-identifier hs-var">lonlat</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548880"><span class="hs-identifier hs-var">lonlat2</span></a></span><span>
</span><span id="line-308"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Bool
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LonLat, LonLat) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548881"><span class="hs-identifier hs-var">lonlat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548880"><span class="hs-identifier hs-var">lonlat2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- | Translate the lower-most point of a projection by an offset.</span><span>
</span><span id="line-311"></span><span class="annot"><a href="Reanimate.GeoProjection.html#moveBottomP"><span class="hs-identifier hs-type">moveBottomP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-312"></span><span id="moveBottomP"><span class="annot"><span class="annottext">moveBottomP :: Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#moveBottomP"><span class="hs-identifier hs-var hs-var">moveBottomP</span></a></span></span><span> </span><span id="local-6989586621679548876"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548876"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679548875"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548875"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679548874"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548874"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679548873"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548873"><span class="hs-identifier hs-var">pInv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548875"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548872"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548871"><span class="hs-identifier hs-var">pInv'</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679548872"><span class="annot"><span class="annottext">p' :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548872"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548870"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548870"><span class="hs-identifier hs-var">lon</span></a></span></span><span> </span><span id="local-6989586621679548869"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548869"><span class="hs-identifier hs-var">lat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548874"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548870"><span class="hs-identifier hs-var">lon</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548869"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>        </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548868"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548868"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548867"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548867"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548868"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548876"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548867"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679548871"><span class="annot"><span class="annottext">pInv' :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548871"><span class="hs-identifier hs-var hs-var">pInv'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548866"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548866"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548865"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548865"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548873"><span class="hs-identifier hs-var">pInv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548866"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548865"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548876"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548876"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Translate the top-most point of a projection by an offset.</span><span>
</span><span id="line-320"></span><span class="annot"><a href="Reanimate.GeoProjection.html#moveTopP"><span class="hs-identifier hs-type">moveTopP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-321"></span><span id="moveTopP"><span class="annot"><span class="annottext">moveTopP :: Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#moveTopP"><span class="hs-identifier hs-var hs-var">moveTopP</span></a></span></span><span> </span><span id="local-6989586621679548864"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548864"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#flipYAxisP"><span class="hs-identifier hs-var">flipYAxisP</span></a></span><span> </span><span class="annot"><span class="annottext">(Projection -&gt; Projection)
-&gt; (Projection -&gt; Projection) -&gt; Projection -&gt; Projection
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#moveBottomP"><span class="hs-identifier hs-var">moveBottomP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548864"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">(Projection -&gt; Projection)
-&gt; (Projection -&gt; Projection) -&gt; Projection -&gt; Projection
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#flipYAxisP"><span class="hs-identifier hs-var">flipYAxisP</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- | Invert the Y axis of projection.</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Reanimate.GeoProjection.html#flipYAxisP"><span class="hs-identifier hs-type">flipYAxisP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-325"></span><span id="flipYAxisP"><span class="annot"><span class="annottext">flipYAxisP :: Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#flipYAxisP"><span class="hs-identifier hs-var hs-var">flipYAxisP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679548863"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548863"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679548862"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548862"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679548861"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548861"><span class="hs-identifier hs-var">pInv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548863"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548860"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548859"><span class="hs-identifier hs-var">pInv'</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621679548860"><span class="annot"><span class="annottext">p' :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548860"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548858"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548858"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548857"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548857"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548856"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548856"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548855"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548855"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548862"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548858"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548857"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548856"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548855"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679548859"><span class="annot"><span class="annottext">pInv' :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548859"><span class="hs-identifier hs-var hs-var">pInv'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548854"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548854"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548853"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548853"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548852"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548852"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548851"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548851"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548861"><span class="hs-identifier hs-var">pInv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548854"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548853"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548852"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548851"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- | Scale X and Y axis of projection.</span><span>
</span><span id="line-335"></span><span class="annot"><a href="Reanimate.GeoProjection.html#scaleP"><span class="hs-identifier hs-type">scaleP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-336"></span><span id="scaleP"><span class="annot"><span class="annottext">scaleP :: Double -&gt; Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#scaleP"><span class="hs-identifier hs-var hs-var">scaleP</span></a></span></span><span> </span><span id="local-6989586621679548850"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548850"><span class="hs-identifier hs-var">xScale</span></a></span></span><span> </span><span id="local-6989586621679548849"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548849"><span class="hs-identifier hs-var">yScale</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span id="local-6989586621679548848"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548848"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679548847"><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548847"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679548846"><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548846"><span class="hs-identifier hs-var">pInv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548848"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548845"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548844"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679548845"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548845"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679548843"><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548843"><span class="hs-identifier hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548847"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548843"><span class="hs-identifier hs-var">lonlat</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548842"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548842"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548841"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548841"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548842"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548850"><span class="hs-identifier hs-var">xScale</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548841"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548849"><span class="hs-identifier hs-var">yScale</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679548844"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548844"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548840"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548840"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548839"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548839"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548846"><span class="hs-identifier hs-var">pInv</span></a></span><span> </span><span class="annot"><span class="annottext">(XYCoord -&gt; LonLat) -&gt; XYCoord -&gt; LonLat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548840"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548850"><span class="hs-identifier hs-var">xScale</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548839"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548849"><span class="hs-identifier hs-var">yScale</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-comment">-- | Attempt to smoothly interpolate two projections. The result may not be continuous</span><span>
</span><span id="line-345"></span><span class="hs-comment">--   and 'interpP' may give prettier results.</span><span>
</span><span id="line-346"></span><span class="annot"><a href="Reanimate.GeoProjection.html#mergeP"><span class="hs-identifier hs-type">mergeP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-347"></span><span id="mergeP"><span class="annot"><span class="annottext">mergeP :: Projection -&gt; Projection -&gt; Double -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#mergeP"><span class="hs-identifier hs-var hs-var">mergeP</span></a></span></span><span> </span><span id="local-6989586621679548838"><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548838"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679548837"><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548837"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679548836"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548836"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Projection -&gt; String
</span><a href="Reanimate.GeoProjection.html#projectionLabel"><span class="hs-identifier hs-var hs-var">projectionLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548838"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Projection -&gt; String
</span><a href="Reanimate.GeoProjection.html#projectionLabel"><span class="hs-identifier hs-var hs-var">projectionLabel</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548837"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548835"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548834"><span class="hs-identifier hs-var">pInv</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621679548835"><span class="annot"><span class="annottext">p :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548835"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679548833"><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548833"><span class="hs-identifier hs-var">lonlat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548832"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548832"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679548831"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548831"><span class="hs-identifier hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Projection -&gt; LonLat -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#projectionForward"><span class="hs-identifier hs-var hs-var">projectionForward</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548838"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548833"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-351"></span><span>          </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548830"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548830"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679548829"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548829"><span class="hs-identifier hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Projection -&gt; LonLat -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#projectionForward"><span class="hs-identifier hs-var hs-var">projectionForward</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548837"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">LonLat
</span><a href="#local-6989586621679548833"><span class="hs-identifier hs-var">lonlat</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548832"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548830"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548836"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548831"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548829"><span class="hs-identifier hs-var">y2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548836"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621679548834"><span class="annot"><span class="annottext">pInv :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548834"><span class="hs-identifier hs-var hs-var">pInv</span></a></span></span><span> </span><span id="local-6989586621679548828"><span class="annot"><span class="annottext">XYCoord
</span><a href="#local-6989586621679548828"><span class="hs-identifier hs-var">coord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548827"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548827"><span class="hs-identifier hs-var">lon1</span></a></span></span><span> </span><span id="local-6989586621679548826"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548826"><span class="hs-identifier hs-var">lat1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Projection -&gt; XYCoord -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#projectionInverse"><span class="hs-identifier hs-var hs-var">projectionInverse</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548838"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord
</span><a href="#local-6989586621679548828"><span class="hs-identifier hs-var">coord</span></a></span><span>
</span><span id="line-355"></span><span>          </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548825"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548825"><span class="hs-identifier hs-var">lon2</span></a></span></span><span> </span><span id="local-6989586621679548824"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548824"><span class="hs-identifier hs-var">lat2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Projection -&gt; XYCoord -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#projectionInverse"><span class="hs-identifier hs-var hs-var">projectionInverse</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548837"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord
</span><a href="#local-6989586621679548828"><span class="hs-identifier hs-var">coord</span></a></span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a a.
(Ord a, Ord a, Floating a, Floating a) =&gt;
a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679548823"><span class="hs-identifier hs-var">oob</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548827"><span class="hs-identifier hs-var">lon1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548826"><span class="hs-identifier hs-var">lat1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a a.
(Ord a, Ord a, Floating a, Floating a) =&gt;
a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679548823"><span class="hs-identifier hs-var">oob</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548825"><span class="hs-identifier hs-var">lon2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548824"><span class="hs-identifier hs-var">lat2</span></a></span><span>
</span><span id="line-358"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548827"><span class="hs-identifier hs-var">lon1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548825"><span class="hs-identifier hs-var">lon2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548836"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548826"><span class="hs-identifier hs-var">lat1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548824"><span class="hs-identifier hs-var">lat2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548836"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679548823"><span class="annot"><span class="annottext">oob :: a -&gt; a -&gt; Bool
</span><a href="#local-6989586621679548823"><span class="hs-identifier hs-var hs-var">oob</span></a></span></span><span> </span><span id="local-6989586621679548822"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548822"><span class="hs-identifier hs-var">lon</span></a></span></span><span> </span><span id="local-6989586621679548821"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548821"><span class="hs-identifier hs-var">lat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548822"><span class="hs-identifier hs-var">lon</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548822"><span class="hs-identifier hs-var">lon</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548821"><span class="hs-identifier hs-var">lat</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548821"><span class="hs-identifier hs-var">lat</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">2</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_equirectangularP.gif&gt;&gt;</span><span>
</span><span id="line-363"></span><span class="annot"><a href="Reanimate.GeoProjection.html#equirectangularP"><span class="hs-identifier hs-type">equirectangularP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-364"></span><span id="equirectangularP"><span class="annot"><span class="annottext">equirectangularP :: Projection
</span><a href="Reanimate.GeoProjection.html#equirectangularP"><span class="hs-identifier hs-var hs-var">equirectangularP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;equirectangular&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548819"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548818"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621679548819"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548819"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548817"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548817"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548816"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548816"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548817"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548816"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679548818"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548818"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548815"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548815"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548814"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548814"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548813"><span class="hs-identifier hs-var">xPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548812"><span class="hs-identifier hs-var">yPi</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-369"></span><span>        </span><span id="local-6989586621679548813"><span class="annot"><span class="annottext">xPi :: Double
</span><a href="#local-6989586621679548813"><span class="hs-identifier hs-var hs-var">xPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548815"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679548812"><span class="annot"><span class="annottext">yPi :: Double
</span><a href="#local-6989586621679548812"><span class="hs-identifier hs-var hs-var">yPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548814"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_mercatorP.gif&gt;&gt;</span><span>
</span><span id="line-373"></span><span class="annot"><a href="Reanimate.GeoProjection.html#mercatorP"><span class="hs-identifier hs-type">mercatorP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-374"></span><span id="mercatorP"><span class="annot"><span class="annottext">mercatorP :: Projection
</span><a href="Reanimate.GeoProjection.html#mercatorP"><span class="hs-identifier hs-var hs-var">mercatorP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mercator&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548811"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548810"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679548811"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548811"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548809"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548809"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548808"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548808"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548809"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548808"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621679548810"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548810"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548804"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548804"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548803"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548803"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548802"><span class="hs-identifier hs-var">xPi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sinh</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548799"><span class="hs-identifier hs-var">yPi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-381"></span><span>        </span><span id="local-6989586621679548802"><span class="annot"><span class="annottext">xPi :: Double
</span><a href="#local-6989586621679548802"><span class="hs-identifier hs-var hs-var">xPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548804"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span id="local-6989586621679548799"><span class="annot"><span class="annottext">yPi :: Double
</span><a href="#local-6989586621679548799"><span class="hs-identifier hs-var hs-var">yPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548803"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><a href="Reanimate.GeoProjection.html#thetas"><span class="hs-identifier hs-type">thetas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-385"></span><span id="thetas"><span class="annot"><span class="annottext">thetas :: Vector Double
</span><a href="Reanimate.GeoProjection.html#thetas"><span class="hs-identifier hs-var hs-var">thetas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Vector Double
forall a. Unbox a =&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Vector Double) -&gt; [Double] -&gt; Vector Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; [Int] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#findThetaFast"><span class="hs-identifier hs-var">findThetaFast</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Int -&gt; Double) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Reanimate.GeoProjection.html#fromIndex"><span class="hs-identifier hs-var">fromIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Reanimate.GeoProjection.html#granularity"><span class="hs-identifier hs-var">granularity</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><a href="Reanimate.GeoProjection.html#granularity"><span class="hs-identifier hs-type">granularity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-389"></span><span id="granularity"><span class="annot"><span class="annottext">granularity :: Int
</span><a href="Reanimate.GeoProjection.html#granularity"><span class="hs-identifier hs-var hs-var">granularity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50000</span></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><a href="Reanimate.GeoProjection.html#toIndex"><span class="hs-identifier hs-type">toIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-392"></span><span id="toIndex"><span class="annot"><span class="annottext">toIndex :: Double -&gt; Int
</span><a href="Reanimate.GeoProjection.html#toIndex"><span class="hs-identifier hs-var hs-var">toIndex</span></a></span></span><span> </span><span id="local-6989586621679548792"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548792"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548792"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Reanimate.GeoProjection.html#granularity"><span class="hs-identifier hs-var">granularity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span class="annot"><a href="Reanimate.GeoProjection.html#fromIndex"><span class="hs-identifier hs-type">fromIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-394"></span><span id="fromIndex"><span class="annot"><span class="annottext">fromIndex :: Int -&gt; Double
</span><a href="Reanimate.GeoProjection.html#fromIndex"><span class="hs-identifier hs-var hs-var">fromIndex</span></a></span></span><span> </span><span id="local-6989586621679548791"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548791"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679548791"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Reanimate.GeoProjection.html#granularity"><span class="hs-identifier hs-var">granularity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span class="annot"><a href="Reanimate.GeoProjection.html#granualize"><span class="hs-identifier hs-type">granualize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-396"></span><span id="granualize"><span class="annot"><span class="annottext">granualize :: Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#granualize"><span class="hs-identifier hs-var hs-var">granualize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Reanimate.GeoProjection.html#fromIndex"><span class="hs-identifier hs-var">fromIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (Double -&gt; Int) -&gt; Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
</span><a href="Reanimate.GeoProjection.html#toIndex"><span class="hs-identifier hs-var">toIndex</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#mollweideP"><span class="hs-pragma hs-type">mollweideP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_mollweideP.gif&gt;&gt;</span><span>
</span><span id="line-400"></span><span class="annot"><a href="Reanimate.GeoProjection.html#mollweideP"><span class="hs-identifier hs-type">mollweideP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-401"></span><span id="mollweideP"><span class="annot"><span class="annottext">mollweideP :: Projection
</span><a href="Reanimate.GeoProjection.html#mollweideP"><span class="hs-identifier hs-var hs-var">mollweideP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mollweide&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548789"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548788"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679548789"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548789"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679548787"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548787"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679548786"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548786"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548785"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548784"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-406"></span><span>        </span><span id="local-6989586621679548785"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548785"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548787"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548782"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-407"></span><span>        </span><span id="local-6989586621679548784"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548784"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548782"><span class="hs-identifier hs-var">theta</span></a></span><span>
</span><span id="line-408"></span><span>        </span><span id="local-6989586621679548782"><span class="annot"><span class="annottext">theta :: Double
</span><a href="#local-6989586621679548782"><span class="hs-identifier hs-var hs-var">theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="Reanimate.GeoProjection.html#thetas"><span class="hs-identifier hs-var">thetas</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Int -&gt; Double
forall a. Unbox a =&gt; Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
</span><a href="Reanimate.GeoProjection.html#toIndex"><span class="hs-identifier hs-var">toIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548786"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-comment">-- find_theta :: Int -&gt; Double</span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-comment">-- find_theta 0 = phi</span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-comment">-- find_theta _ | abs phi == pi/2 = signum phi * pi/2</span><span>
</span><span id="line-412"></span><span>        </span><span class="hs-comment">-- find_theta n =</span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-comment">--   let !sub = find_theta (n-1)</span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-comment">--   in sub - (2*sub+sin (2*sub)-pi*sin phi)/(2+2*cos(2*sub))</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621679548788"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548788"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548779"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548779"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548778"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548778"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548777"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548776"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span>        </span><span id="local-6989586621679548775"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548775"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548779"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span id="local-6989586621679548774"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548774"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548778"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span id="local-6989586621679548773"><span class="annot"><span class="annottext">theta :: Double
</span><a href="#local-6989586621679548773"><span class="hs-identifier hs-var hs-var">theta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#granualize"><span class="hs-identifier hs-var">granualize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548774"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>        </span><span id="local-6989586621679548777"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548777"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548775"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548773"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621679548776"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548776"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548773"><span class="hs-identifier hs-var">theta</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548773"><span class="hs-identifier hs-var">theta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="annot"><a href="Reanimate.GeoProjection.html#findThetaFast"><span class="hs-identifier hs-type">findThetaFast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-424"></span><span id="findThetaFast"><span class="annot"><span class="annottext">findThetaFast :: Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#findThetaFast"><span class="hs-identifier hs-var hs-var">findThetaFast</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679548771"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548771"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548771"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548771"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Reanimate.GeoProjection.html#findThetaFast"><span class="hs-identifier hs-var">findThetaFast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">D#</span></span><span> </span><span id="local-6989586621679548769"><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548769"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double
</span><a href="#local-6989586621679548768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548769"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">D#</span></span><span> </span><span id="local-6989586621679548767"><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548767"><span class="hs-identifier hs-var">pi#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679548768"><span class="annot"><span class="annottext">go :: Double# -&gt; Double
</span><a href="#local-6989586621679548768"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679548766"><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679548765"><span class="annot"><span class="annottext">c :: Double#
</span><a href="#local-6989586621679548765"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double#
</span><span class="hs-identifier hs-var">cosDouble#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">+##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>          </span><span id="local-6989586621679548764"><span class="annot"><span class="annottext">s :: Double#
</span><a href="#local-6989586621679548764"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double#
</span><span class="hs-identifier hs-var">sinDouble#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">+##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>          </span><span id="local-6989586621679548763"><span class="annot"><span class="annottext">next :: Double#
</span><a href="#local-6989586621679548763"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>            </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">-##</span></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">+##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">+##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548764"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">-##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548767"><span class="hs-identifier hs-var">pi#</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">*##</span></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double#
</span><span class="hs-identifier hs-var">sinDouble#</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548769"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">/##</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double#
</span><span class="hs-number">2.0##</span></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">+##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548765"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">+##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548765"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double# -&gt; Double
</span><span class="hs-identifier hs-var">D#</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548763"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double# -&gt; Double#
</span><span class="hs-operator hs-var">-##</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548766"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-identifier hs-var">epsilon</span></a></span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double
</span><span class="hs-identifier hs-var">D#</span></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548763"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-437"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double# -&gt; Double
</span><a href="#local-6989586621679548768"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Double#
</span><a href="#local-6989586621679548763"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_hammerP.gif&gt;&gt;</span><span>
</span><span id="line-441"></span><span class="annot"><a href="Reanimate.GeoProjection.html#hammerP"><span class="hs-identifier hs-type">hammerP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-442"></span><span id="hammerP"><span class="annot"><span class="annottext">hammerP :: Projection
</span><a href="Reanimate.GeoProjection.html#hammerP"><span class="hs-identifier hs-var hs-var">hammerP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hammer&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548762"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548761"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>    </span><span id="local-6989586621679548762"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548762"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548760"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548760"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548759"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548759"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-445"></span><span>        </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548758"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548757"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-447"></span><span>        </span><span id="local-6989586621679548758"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548758"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548759"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548760"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548759"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548760"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>        </span><span id="local-6989586621679548757"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548757"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548759"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548759"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548760"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621679548761"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548761"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548756"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548756"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548755"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548755"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548754"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548753"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-450"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-451"></span><span>        </span><span id="local-6989586621679548752"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548752"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548756"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-452"></span><span>        </span><span id="local-6989586621679548751"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548751"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548755"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span id="local-6989586621679548750"><span class="annot"><span class="annottext">z :: Double
</span><a href="#local-6989586621679548750"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548752"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548751"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>        </span><span id="local-6989586621679548754"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548754"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548750"><span class="hs-identifier hs-var">z</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548752"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548750"><span class="hs-identifier hs-var">z</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>        </span><span id="local-6989586621679548753"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548753"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548750"><span class="hs-identifier hs-var">z</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548751"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_cylindricalEqualAreaP.gif&gt;&gt;</span><span>
</span><span id="line-458"></span><span class="annot"><a href="Reanimate.GeoProjection.html#cylindricalEqualAreaP"><span class="hs-identifier hs-type">cylindricalEqualAreaP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-459"></span><span id="cylindricalEqualAreaP"><span class="annot"><span class="annottext">cylindricalEqualAreaP :: Double -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#cylindricalEqualAreaP"><span class="hs-identifier hs-var hs-var">cylindricalEqualAreaP</span></a></span></span><span> </span><span id="local-6989586621679548747"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548747"><span class="hs-identifier hs-var">phi0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lambert&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548746"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548745"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621679548744"><span class="annot"><span class="annottext">cosPhi0 :: Double
</span><a href="#local-6989586621679548744"><span class="hs-identifier hs-var hs-var">cosPhi0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548747"><span class="hs-identifier hs-var">phi0</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679548746"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548746"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548743"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548743"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548742"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548742"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-463"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548743"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548742"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548744"><span class="hs-identifier hs-var">cosPhi0</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548744"><span class="hs-identifier hs-var">cosPhi0</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548744"><span class="hs-identifier hs-var">cosPhi0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679548745"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548745"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548741"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548741"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548740"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548740"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548739"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548738"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548744"><span class="hs-identifier hs-var">cosPhi0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621679548739"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548739"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548741"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-467"></span><span>        </span><span id="local-6989586621679548738"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548738"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548740"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548744"><span class="hs-identifier hs-var">cosPhi0</span></a></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_lambertP.gif&gt;&gt;</span><span>
</span><span id="line-470"></span><span class="annot"><a href="Reanimate.GeoProjection.html#lambertP"><span class="hs-identifier hs-type">lambertP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-471"></span><span id="lambertP"><span class="annot"><span class="annottext">lambertP :: Projection
</span><a href="Reanimate.GeoProjection.html#lambertP"><span class="hs-identifier hs-var hs-var">lambertP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lambert&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548737"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548736"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621679548737"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548737"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548735"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548735"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548734"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548734"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-474"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548735"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548734"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span id="local-6989586621679548736"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548736"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548733"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548733"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548732"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548732"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548731"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548730"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621679548731"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548731"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548733"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-478"></span><span>        </span><span id="local-6989586621679548730"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548730"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548732"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_bottomleyP.gif&gt;&gt;</span><span>
</span><span id="line-481"></span><span class="annot"><a href="Reanimate.GeoProjection.html#bottomleyP"><span class="hs-identifier hs-type">bottomleyP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-482"></span><span id="bottomleyP"><span class="annot"><span class="annottext">bottomleyP :: Double -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#bottomleyP"><span class="hs-identifier hs-var hs-var">bottomleyP</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679548729"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548729"><span class="hs-identifier hs-var">phi_1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bottomley&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548728"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548727"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>    </span><span id="local-6989586621679548728"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548728"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548726"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548726"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548725"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548725"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-485"></span><span>        </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548724"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548723"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-487"></span><span>        </span><span id="local-6989586621679548724"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548724"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548722"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548721"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548729"><span class="hs-identifier hs-var">phi_1</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span id="local-6989586621679548723"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548723"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548722"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548721"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-489"></span><span>        </span><span id="local-6989586621679548722"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548722"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548725"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span id="local-6989586621679548721"><span class="annot"><span class="annottext">e :: Double
</span><a href="#local-6989586621679548721"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548726"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548729"><span class="hs-identifier hs-var">phi_1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548722"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548722"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679548727"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548727"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548720"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548720"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548719"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548719"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548718"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548717"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-492"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-493"></span><span>        </span><span id="local-6989586621679548716"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548716"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548720"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-494"></span><span>        </span><span id="local-6989586621679548715"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548715"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548719"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-495"></span><span>        </span><span id="local-6989586621679548714"><span class="annot"><span class="annottext">x1 :: Double
</span><a href="#local-6989586621679548714"><span class="hs-identifier hs-var hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548716"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548729"><span class="hs-identifier hs-var">phi_1</span></a></span><span>
</span><span id="line-496"></span><span>        </span><span id="local-6989586621679548713"><span class="annot"><span class="annottext">y1 :: Double
</span><a href="#local-6989586621679548713"><span class="hs-identifier hs-var hs-var">y1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548715"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-497"></span><span>        </span><span id="local-6989586621679548712"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548712"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548714"><span class="hs-identifier hs-var">x1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548714"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548713"><span class="hs-identifier hs-var">y1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548713"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>        </span><span id="local-6989586621679548711"><span class="annot"><span class="annottext">e :: Double
</span><a href="#local-6989586621679548711"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548714"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548713"><span class="hs-identifier hs-var">y1</span></a></span><span>
</span><span id="line-499"></span><span>        </span><span id="local-6989586621679548718"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548718"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548712"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548712"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548712"><span class="hs-identifier hs-var">rho</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548711"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548729"><span class="hs-identifier hs-var">phi_1</span></a></span><span>
</span><span id="line-500"></span><span>        </span><span id="local-6989586621679548717"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548717"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548712"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_sinusoidalP.gif&gt;&gt;</span><span>
</span><span id="line-503"></span><span class="annot"><a href="Reanimate.GeoProjection.html#sinusoidalP"><span class="hs-identifier hs-type">sinusoidalP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-504"></span><span id="sinusoidalP"><span class="annot"><span class="annottext">sinusoidalP :: Projection
</span><a href="Reanimate.GeoProjection.html#sinusoidalP"><span class="hs-identifier hs-var hs-var">sinusoidalP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinusoidal&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548710"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548709"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621679548710"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548710"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548708"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548708"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548707"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548707"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548706"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548705"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>        </span><span id="local-6989586621679548706"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548706"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548708"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548707"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-510"></span><span>        </span><span id="local-6989586621679548705"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548705"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548707"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621679548709"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548709"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548704"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548704"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548703"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548703"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548702"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548701"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548701"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-512"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-513"></span><span>        </span><span id="local-6989586621679548702"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548702"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548704"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span id="local-6989586621679548701"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548701"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548703"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_wernerP.gif&gt;&gt;</span><span>
</span><span id="line-517"></span><span class="annot"><a href="Reanimate.GeoProjection.html#wernerP"><span class="hs-identifier hs-type">wernerP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-518"></span><span id="wernerP"><span class="annot"><span class="annottext">wernerP :: Projection
</span><a href="Reanimate.GeoProjection.html#wernerP"><span class="hs-identifier hs-var hs-var">wernerP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#moveTopP"><span class="hs-identifier hs-var">moveTopP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.23</span></span><span> </span><span class="annot"><span class="annottext">(Projection -&gt; Projection) -&gt; Projection -&gt; Projection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;werner&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548700"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548699"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-520"></span><span>    </span><span id="local-6989586621679548700"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548700"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548698"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548698"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548697"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548697"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-521"></span><span>        </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548696"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548695"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>        </span><span id="local-6989586621679548694"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548697"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-524"></span><span>        </span><span id="local-6989586621679548693"><span class="annot"><span class="annottext">e :: Double
</span><a href="#local-6989586621679548693"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548698"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-525"></span><span>        </span><span id="local-6989586621679548696"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548696"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548693"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-526"></span><span>        </span><span id="local-6989586621679548695"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548695"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548694"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548693"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-527"></span><span>    </span><span id="local-6989586621679548699"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548699"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548692"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548692"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548691"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548691"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548690"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548689"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-528"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>        </span><span id="local-6989586621679548688"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548688"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548692"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-530"></span><span>        </span><span id="local-6989586621679548687"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548687"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548691"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-531"></span><span>        </span><span id="local-6989586621679548686"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548686"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548688"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548687"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621679548685"><span class="annot"><span class="annottext">e :: Double
</span><a href="#local-6989586621679548685"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548688"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548687"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>        </span><span id="local-6989586621679548689"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548689"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548686"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-534"></span><span>        </span><span id="local-6989586621679548690"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548690"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548685"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548686"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548686"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- FIXME: find right scale and position.</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_bonneP.gif&gt;&gt;</span><span>
</span><span id="line-538"></span><span class="annot"><a href="Reanimate.GeoProjection.html#bonneP"><span class="hs-identifier hs-type">bonneP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-539"></span><span id="bonneP"><span class="annot"><span class="annottext">bonneP :: Double -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#bonneP"><span class="hs-identifier hs-var hs-var">bonneP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="Reanimate.GeoProjection.html#sinusoidalP"><span class="hs-identifier hs-var">sinusoidalP</span></a></span><span>
</span><span id="line-540"></span><span class="annot"><a href="Reanimate.GeoProjection.html#bonneP"><span class="hs-identifier hs-var">bonneP</span></a></span><span> </span><span id="local-6989586621679548684"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#moveTopP"><span class="hs-identifier hs-var">moveTopP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.17</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548683"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Projection -&gt; Projection) -&gt; Projection -&gt; Projection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#scaleP"><span class="hs-identifier hs-var">scaleP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.65</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548683"><span class="hs-identifier hs-var">factor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Projection -&gt; Projection) -&gt; Projection -&gt; Projection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bonne&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548682"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548681"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621679548683"><span class="annot"><span class="annottext">factor :: Double
</span><a href="#local-6989586621679548683"><span class="hs-identifier hs-var hs-var">factor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span id="local-6989586621679548682"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548682"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548680"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548680"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548679"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548679"><span class="hs-identifier hs-var">phi</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548678"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548677"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-546"></span><span>        </span><span id="local-6989586621679548676"><span class="annot"><span class="annottext">cotPhi0 :: Double
</span><a href="#local-6989586621679548676"><span class="hs-identifier hs-var hs-var">cotPhi0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#cot"><span class="hs-identifier hs-var">cot</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span><span>
</span><span id="line-547"></span><span>        </span><span id="local-6989586621679548675"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548675"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548676"><span class="hs-identifier hs-var">cotPhi0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548679"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-548"></span><span>        </span><span id="local-6989586621679548674"><span class="annot"><span class="annottext">e :: Double
</span><a href="#local-6989586621679548674"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548680"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548679"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548675"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-549"></span><span>        </span><span id="local-6989586621679548678"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548678"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548675"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548674"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-550"></span><span>        </span><span id="local-6989586621679548677"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548677"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548676"><span class="hs-identifier hs-var">cotPhi0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548675"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548674"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621679548681"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548681"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548673"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548673"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548672"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548672"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548671"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548670"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-552"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-553"></span><span>        </span><span id="local-6989586621679548669"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548669"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548673"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-554"></span><span>        </span><span id="local-6989586621679548668"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548668"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548672"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621679548667"><span class="annot"><span class="annottext">cotPhi0 :: Double
</span><a href="#local-6989586621679548667"><span class="hs-identifier hs-var hs-var">cotPhi0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#cot"><span class="hs-identifier hs-var">cot</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span><span>
</span><span id="line-556"></span><span>        </span><span id="local-6989586621679548666"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548666"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548669"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548669"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#cot"><span class="hs-identifier hs-var">cot</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548668"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>        </span><span class="hs-comment">-- e = atan2 x (cot phi_1 + phi_1 + y)</span><span>
</span><span id="line-558"></span><span>        </span><span id="local-6989586621679548670"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548670"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548667"><span class="hs-identifier hs-var">cotPhi0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548684"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548666"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-559"></span><span>        </span><span id="local-6989586621679548671"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548671"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548666"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548670"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548669"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548667"><span class="hs-identifier hs-var">cotPhi0</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548668"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_orthoP.gif&gt;&gt;</span><span>
</span><span id="line-562"></span><span class="annot"><a href="Reanimate.GeoProjection.html#orthoP"><span class="hs-identifier hs-type">orthoP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-563"></span><span id="orthoP"><span class="annot"><span class="annottext">orthoP :: LonLat -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#orthoP"><span class="hs-identifier hs-var hs-var">orthoP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548665"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548665"><span class="hs-identifier hs-var">lam_0</span></a></span></span><span> </span><span id="local-6989586621679548664"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ortho&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548663"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548662"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-565"></span><span>    </span><span id="local-6989586621679548663"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548663"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548661"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548661"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548660"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548660"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548659"><span class="hs-identifier hs-var">cosc</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-567"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679548658"><span class="annot"><span class="annottext">ang :: Double
</span><a href="#local-6989586621679548658"><span class="hs-identifier hs-var hs-var">ang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548657"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548656"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-568"></span><span>                </span><span id="local-6989586621679548655"><span class="annot"><span class="annottext">xV :: Double
</span><a href="#local-6989586621679548655"><span class="hs-identifier hs-var hs-var">xV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548658"><span class="hs-identifier hs-var">ang</span></a></span><span>
</span><span id="line-569"></span><span>                </span><span id="local-6989586621679548654"><span class="annot"><span class="annottext">yV :: Double
</span><a href="#local-6989586621679548654"><span class="hs-identifier hs-var hs-var">yV</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548658"><span class="hs-identifier hs-var">ang</span></a></span><span>
</span><span id="line-570"></span><span>                </span><span id="local-6989586621679548653"><span class="annot"><span class="annottext">xPos :: Double
</span><a href="#local-6989586621679548653"><span class="hs-identifier hs-var hs-var">xPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">7</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548655"><span class="hs-identifier hs-var">xV</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- trace (show (x,y)) $</span><span>
</span><span id="line-572"></span><span>              </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548653"><span class="hs-identifier hs-var">xPos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548654"><span class="hs-identifier hs-var">yV</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>            </span><span class="hs-comment">--XYCoord (0/0) (0/0)</span><span>
</span><span id="line-574"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548656"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548657"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-576"></span><span>        </span><span id="local-6989586621679548656"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548656"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548660"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548661"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548665"><span class="hs-identifier hs-var">lam_0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>        </span><span id="local-6989586621679548657"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548657"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548660"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548660"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548661"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548665"><span class="hs-identifier hs-var">lam_0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>        </span><span id="local-6989586621679548659"><span class="annot"><span class="annottext">cosc :: Double
</span><a href="#local-6989586621679548659"><span class="hs-identifier hs-var hs-var">cosc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548660"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548660"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548661"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548665"><span class="hs-identifier hs-var">lam_0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621679548662"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548662"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548652"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548652"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548651"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548651"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548650"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548649"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-581"></span><span>        </span><span id="local-6989586621679548648"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548648"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548652"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-582"></span><span>        </span><span id="local-6989586621679548647"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548647"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548651"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-583"></span><span>        </span><span id="local-6989586621679548650"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548650"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
forall a. (Ord a, Num a) =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679548646"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-584"></span><span>          </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548665"><span class="hs-identifier hs-var">lam_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548648"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548645"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548644"><span class="hs-identifier hs-var">rho</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548645"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548647"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548645"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>        </span><span id="local-6989586621679548649"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548649"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
forall a. (Ord a, Num a) =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679548646"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548645"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548647"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548645"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548664"><span class="hs-identifier hs-var">phi_0</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548644"><span class="hs-identifier hs-var">rho</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>        </span><span id="local-6989586621679548644"><span class="annot"><span class="annottext">rho :: Double
</span><a href="#local-6989586621679548644"><span class="hs-identifier hs-var hs-var">rho</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548648"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548648"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548647"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548647"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>        </span><span id="local-6989586621679548645"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679548645"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548644"><span class="hs-identifier hs-var">rho</span></a></span><span>
</span><span id="line-589"></span><span>        </span><span id="local-6989586621679548646"><span class="annot"><span class="annottext">wrap :: a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679548646"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679548643"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548643"><span class="hs-identifier hs-var">lower</span></a></span></span><span> </span><span id="local-6989586621679548642"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548642"><span class="hs-identifier hs-var">upper</span></a></span></span><span> </span><span id="local-6989586621679548641"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548641"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-590"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548641"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548642"><span class="hs-identifier hs-var">upper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548641"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548642"><span class="hs-identifier hs-var">upper</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548643"><span class="hs-identifier hs-var">lower</span></a></span><span>
</span><span id="line-591"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548641"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548643"><span class="hs-identifier hs-var">lower</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548641"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548642"><span class="hs-identifier hs-var">upper</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548643"><span class="hs-identifier hs-var">lower</span></a></span><span>
</span><span id="line-592"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679548641"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_cassiniP.gif&gt;&gt;</span><span>
</span><span id="line-595"></span><span class="annot"><a href="Reanimate.GeoProjection.html#cassiniP"><span class="hs-identifier hs-type">cassiniP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-596"></span><span id="cassiniP"><span class="annot"><span class="annottext">cassiniP :: Projection
</span><a href="Reanimate.GeoProjection.html#cassiniP"><span class="hs-identifier hs-var hs-var">cassiniP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cassini&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548640"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548639"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-598"></span><span>    </span><span id="local-6989586621679548640"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548640"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548638"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548638"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548637"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548637"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-599"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548637"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548638"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548637"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548638"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>    </span><span id="local-6989586621679548639"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548639"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548636"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548636"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548635"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548635"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548634"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548633"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-602"></span><span>        </span><span id="local-6989586621679548632"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548632"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548636"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-603"></span><span>        </span><span id="local-6989586621679548631"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548631"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548635"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-604"></span><span>        </span><span id="local-6989586621679548634"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548634"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548632"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548631"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>        </span><span id="local-6989586621679548633"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548633"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548631"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548632"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_augustP.gif&gt;&gt;</span><span>
</span><span id="line-608"></span><span class="annot"><a href="Reanimate.GeoProjection.html#augustP"><span class="hs-identifier hs-type">augustP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-609"></span><span id="augustP"><span class="annot"><span class="annottext">augustP :: Projection
</span><a href="Reanimate.GeoProjection.html#augustP"><span class="hs-identifier hs-var hs-var">augustP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Projection -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#scaleP"><span class="hs-identifier hs-var">scaleP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.70</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.70</span></span><span> </span><span class="annot"><span class="annottext">(Projection -&gt; Projection) -&gt; Projection -&gt; Projection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;august&quot;</span></span><span>  </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548630"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548629"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-611"></span><span>    </span><span id="local-6989586621679548628"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548628"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679548627"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548627"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548628"><span class="hs-identifier hs-var">xHi</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span id="local-6989586621679548626"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548626"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-614"></span><span>    </span><span id="local-6989586621679548625"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548625"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548626"><span class="hs-identifier hs-var">yHi</span></a></span><span>
</span><span id="line-615"></span><span>    </span><span id="local-6989586621679548630"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548630"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548624"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548624"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548623"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548623"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548622"><span class="hs-identifier hs-var">xPos</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548627"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548628"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548627"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548621"><span class="hs-identifier hs-var">yPos</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548625"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548626"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548625"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-617"></span><span>        </span><span id="local-6989586621679548620"><span class="annot"><span class="annottext">tanPhi :: Double
</span><a href="#local-6989586621679548620"><span class="hs-identifier hs-var hs-var">tanPhi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548623"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>        </span><span id="local-6989586621679548619"><span class="annot"><span class="annottext">k :: Double
</span><a href="#local-6989586621679548619"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548620"><span class="hs-identifier hs-var">tanPhi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548620"><span class="hs-identifier hs-var">tanPhi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>        </span><span id="local-6989586621679548618"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679548618"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548619"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548624"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>        </span><span id="local-6989586621679548617"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548617"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548624"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548619"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548618"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-621"></span><span>        </span><span id="local-6989586621679548616"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548616"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548620"><span class="hs-identifier hs-var">tanPhi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548618"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-622"></span><span>        </span><span id="local-6989586621679548615"><span class="annot"><span class="annottext">x2 :: Double
</span><a href="#local-6989586621679548615"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548617"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548617"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-623"></span><span>        </span><span id="local-6989586621679548614"><span class="annot"><span class="annottext">y2 :: Double
</span><a href="#local-6989586621679548614"><span class="hs-identifier hs-var hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548616"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548616"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-624"></span><span>        </span><span id="local-6989586621679548622"><span class="annot"><span class="annottext">xPos :: Double
</span><a href="#local-6989586621679548622"><span class="hs-identifier hs-var hs-var">xPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548617"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548615"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548614"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>        </span><span id="local-6989586621679548621"><span class="annot"><span class="annottext">yPos :: Double
</span><a href="#local-6989586621679548621"><span class="hs-identifier hs-var hs-var">yPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548616"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548615"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548614"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>    </span><span id="local-6989586621679548629"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548629"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548613"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548613"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548612"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548612"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548611"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548610"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-627"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>        </span><span id="local-6989586621679548609"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548609"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548627"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548628"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548613"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span>
</span><span id="line-629"></span><span>        </span><span id="local-6989586621679548608"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548625"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548626"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548612"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span>
</span><span id="line-630"></span><span>        </span><span id="local-6989586621679548607"><span class="annot"><span class="annottext">x2 :: Double
</span><a href="#local-6989586621679548607"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548609"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548609"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-631"></span><span>        </span><span id="local-6989586621679548606"><span class="annot"><span class="annottext">y2 :: Double
</span><a href="#local-6989586621679548606"><span class="hs-identifier hs-var hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-632"></span><span>        </span><span id="local-6989586621679548605"><span class="annot"><span class="annottext">s :: Double
</span><a href="#local-6989586621679548605"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548607"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548606"><span class="hs-identifier hs-var">y2</span></a></span><span>
</span><span id="line-633"></span><span>        </span><span id="local-6989586621679548604"><span class="annot"><span class="annottext">sin3Eta :: Double
</span><a href="#local-6989586621679548604"><span class="hs-identifier hs-var hs-var">sin3Eta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548605"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548605"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548605"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>        </span><span id="local-6989586621679548603"><span class="annot"><span class="annottext">eta :: Double
</span><a href="#local-6989586621679548603"><span class="hs-identifier hs-var hs-var">eta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548604"><span class="hs-identifier hs-var">sin3Eta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-635"></span><span>        </span><span id="local-6989586621679548602"><span class="annot"><span class="annottext">xi :: Double
</span><a href="#local-6989586621679548602"><span class="hs-identifier hs-var hs-var">xi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548604"><span class="hs-identifier hs-var">sin3Eta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">acosh</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548604"><span class="hs-identifier hs-var">sin3Eta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asinh</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548609"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span>
</span><span id="line-636"></span><span>        </span><span id="local-6989586621679548599"><span class="annot"><span class="annottext">cosEta :: Double
</span><a href="#local-6989586621679548599"><span class="hs-identifier hs-var hs-var">cosEta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548603"><span class="hs-identifier hs-var">eta</span></a></span><span>
</span><span id="line-637"></span><span>        </span><span id="local-6989586621679548598"><span class="annot"><span class="annottext">coshXi :: Double
</span><a href="#local-6989586621679548598"><span class="hs-identifier hs-var hs-var">coshXi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cosh</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548602"><span class="hs-identifier hs-var">xi</span></a></span><span>
</span><span id="line-638"></span><span>        </span><span id="local-6989586621679548596"><span class="annot"><span class="annottext">d :: Double
</span><a href="#local-6989586621679548596"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548598"><span class="hs-identifier hs-var">coshXi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548598"><span class="hs-identifier hs-var">coshXi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548599"><span class="hs-identifier hs-var">cosEta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548599"><span class="hs-identifier hs-var">cosEta</span></a></span><span>
</span><span id="line-639"></span><span>        </span><span id="local-6989586621679548611"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548611"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548609"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sinh</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548602"><span class="hs-identifier hs-var">xi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548599"><span class="hs-identifier hs-var">cosEta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.25</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548596"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>        </span><span id="local-6989586621679548610"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548610"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548608"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548598"><span class="hs-identifier hs-var">coshXi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548603"><span class="hs-identifier hs-var">eta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.25</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548596"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_collignonP.gif&gt;&gt;</span><span>
</span><span id="line-643"></span><span class="annot"><a href="Reanimate.GeoProjection.html#collignonP"><span class="hs-identifier hs-type">collignonP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-644"></span><span id="collignonP"><span class="annot"><span class="annottext">collignonP :: Projection
</span><a href="Reanimate.GeoProjection.html#collignonP"><span class="hs-identifier hs-var hs-var">collignonP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;collignon&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548595"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548594"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-646"></span><span>    </span><span id="local-6989586621679548593"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548593"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621679548592"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548592"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>    </span><span id="local-6989586621679548591"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548591"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span>
</span><span id="line-649"></span><span>    </span><span id="local-6989586621679548590"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548590"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrt2"><span class="hs-identifier hs-var">sqrt2</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621679548595"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548595"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548589"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548589"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548588"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548588"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548587"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548591"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548590"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548591"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548586"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548592"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548593"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548592"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-652"></span><span>        </span><span id="local-6989586621679548585"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679548585"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548588"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>        </span><span id="local-6989586621679548587"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548587"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548589"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548585"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-654"></span><span>        </span><span id="local-6989586621679548586"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548586"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548585"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621679548594"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548594"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548584"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548584"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548583"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548583"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548582"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548581"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-656"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-657"></span><span>        </span><span id="local-6989586621679548580"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548580"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548591"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548590"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548584"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-658"></span><span>        </span><span id="local-6989586621679548579"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548579"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548592"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548593"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548583"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span id="local-6989586621679548578"><span class="annot"><span class="annottext">l :: Double
</span><a href="#local-6989586621679548578"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548579"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-660"></span><span>        </span><span id="local-6989586621679548582"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548582"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548578"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548580"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548578"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-661"></span><span>        </span><span id="local-6989586621679548581"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548581"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548578"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_eckert1P.gif&gt;&gt;</span><span>
</span><span id="line-664"></span><span class="annot"><a href="Reanimate.GeoProjection.html#eckert1P"><span class="hs-identifier hs-type">eckert1P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-665"></span><span id="eckert1P"><span class="annot"><span class="annottext">eckert1P :: Projection
</span><a href="Reanimate.GeoProjection.html#eckert1P"><span class="hs-identifier hs-var hs-var">eckert1P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eckert1&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548577"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548576"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-667"></span><span>    </span><span id="local-6989586621679548575"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679548574"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548574"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621679548573"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548573"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621679548572"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548572"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-671"></span><span>    </span><span id="local-6989586621679548571"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548571"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621679548577"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548577"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548570"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548570"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548569"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548569"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548568"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548572"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548571"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548572"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548567"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548574"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548573"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548574"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-674"></span><span>        </span><span id="local-6989586621679548568"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548568"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548570"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548569"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>        </span><span id="local-6989586621679548567"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548567"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548569"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679548576"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548576"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548566"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548566"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548565"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548565"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548564"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548563"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-677"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-678"></span><span>        </span><span id="local-6989586621679548562"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548562"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548572"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548571"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548566"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-679"></span><span>        </span><span id="local-6989586621679548561"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548561"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548574"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548573"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548565"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-680"></span><span>        </span><span id="local-6989586621679548563"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548563"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548561"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span>
</span><span id="line-681"></span><span>        </span><span id="local-6989586621679548564"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548564"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548562"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548575"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548563"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_eckert3P.gif&gt;&gt;</span><span>
</span><span id="line-684"></span><span class="annot"><a href="Reanimate.GeoProjection.html#eckert3P"><span class="hs-identifier hs-type">eckert3P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-685"></span><span id="eckert3P"><span class="annot"><span class="annottext">eckert3P :: Projection
</span><a href="Reanimate.GeoProjection.html#eckert3P"><span class="hs-identifier hs-var hs-var">eckert3P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eckert3&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548560"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548559"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-686"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>    </span><span id="local-6989586621679548558"><span class="annot"><span class="annottext">k :: Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>    </span><span id="local-6989586621679548557"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548557"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548556"><span class="hs-identifier hs-var">yHi</span></a></span><span>
</span><span id="line-689"></span><span>    </span><span id="local-6989586621679548556"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548556"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679548555"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548555"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548554"><span class="hs-identifier hs-var">xHi</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span id="local-6989586621679548554"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548554"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-692"></span><span>    </span><span id="local-6989586621679548560"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548560"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548553"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548553"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548552"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548552"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548551"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548555"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548554"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548555"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548550"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548557"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548556"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548557"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-694"></span><span>        </span><span id="local-6989586621679548551"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548551"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548553"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548552"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548552"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>        </span><span id="local-6989586621679548550"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548550"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548552"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621679548559"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548559"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548549"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548549"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548548"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548548"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548547"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548546"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-697"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-698"></span><span>        </span><span id="local-6989586621679548545"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548545"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548555"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548554"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548549"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-699"></span><span>        </span><span id="local-6989586621679548544"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548544"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548557"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548556"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548548"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-700"></span><span>        </span><span id="local-6989586621679548547"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548547"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548545"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548544"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548544"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>        </span><span id="local-6989586621679548546"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548546"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548544"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548558"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_eckert5P.gif&gt;&gt;</span><span>
</span><span id="line-704"></span><span class="annot"><a href="Reanimate.GeoProjection.html#eckert5P"><span class="hs-identifier hs-type">eckert5P</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-705"></span><span id="eckert5P"><span class="annot"><span class="annottext">eckert5P :: Projection
</span><a href="Reanimate.GeoProjection.html#eckert5P"><span class="hs-identifier hs-var hs-var">eckert5P</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eckert5&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548543"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548542"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-707"></span><span>    </span><span id="local-6989586621679548541"><span class="annot"><span class="annottext">k :: Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679548540"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548540"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548539"><span class="hs-identifier hs-var">yHi</span></a></span><span>
</span><span id="line-709"></span><span>    </span><span id="local-6989586621679548539"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548539"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-710"></span><span>    </span><span id="local-6989586621679548538"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548538"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548537"><span class="hs-identifier hs-var">xHi</span></a></span><span>
</span><span id="line-711"></span><span>    </span><span id="local-6989586621679548537"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548537"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-712"></span><span>    </span><span id="local-6989586621679548543"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548543"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548536"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548536"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548535"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548535"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548534"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548538"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548537"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548538"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548533"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548540"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548539"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548540"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-714"></span><span>        </span><span id="local-6989586621679548534"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548534"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548536"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548535"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-715"></span><span>        </span><span id="local-6989586621679548533"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548533"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548535"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679548542"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548542"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548532"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548532"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548531"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548531"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548530"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548529"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-717"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-718"></span><span>        </span><span id="local-6989586621679548528"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548528"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548538"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548537"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548532"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-719"></span><span>        </span><span id="local-6989586621679548527"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548527"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548540"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548539"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548531"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-720"></span><span>        </span><span id="local-6989586621679548530"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548530"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548528"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548529"><span class="hs-identifier hs-var">phi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>        </span><span id="local-6989586621679548529"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548529"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548527"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548541"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#faheyP"><span class="hs-pragma hs-type">faheyP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_faheyP.gif&gt;&gt;</span><span>
</span><span id="line-725"></span><span class="annot"><a href="Reanimate.GeoProjection.html#faheyP"><span class="hs-identifier hs-type">faheyP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-726"></span><span id="faheyP"><span class="annot"><span class="annottext">faheyP :: Projection
</span><a href="Reanimate.GeoProjection.html#faheyP"><span class="hs-identifier hs-var hs-var">faheyP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fahey&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548526"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548525"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679548524"><span class="annot"><span class="annottext">faheyK :: Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var hs-var">faheyK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="Reanimate.GeoProjection.html#toRads"><span class="hs-identifier hs-var">toRads</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">35</span></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>    </span><span id="local-6989586621679548523"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548523"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548522"><span class="hs-identifier hs-var">yHi</span></a></span><span>
</span><span id="line-730"></span><span>    </span><span id="local-6989586621679548522"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548522"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span>
</span><span id="line-731"></span><span>    </span><span id="local-6989586621679548521"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548521"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548520"><span class="hs-identifier hs-var">xHi</span></a></span><span>
</span><span id="line-732"></span><span>    </span><span id="local-6989586621679548520"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548520"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">16</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span>
</span><span id="line-733"></span><span>    </span><span id="local-6989586621679548526"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548526"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548519"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548519"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548518"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548518"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548517"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548521"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548520"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548521"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548516"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548523"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548522"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548523"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-735"></span><span>        </span><span id="local-6989586621679548515"><span class="annot"><span class="annottext">t :: Double
</span><a href="#local-6989586621679548515"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548518"><span class="hs-identifier hs-var">phi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>        </span><span id="local-6989586621679548517"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548517"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548519"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548515"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548515"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>        </span><span id="local-6989586621679548516"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548516"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548515"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-738"></span><span>    </span><span id="local-6989586621679548525"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548525"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548514"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548514"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548513"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548513"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548512"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548511"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-739"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-740"></span><span>        </span><span id="local-6989586621679548510"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548510"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548521"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548520"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548514"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-741"></span><span>        </span><span id="local-6989586621679548509"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548509"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548523"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548522"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548513"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-742"></span><span>        </span><span id="local-6989586621679548508"><span class="annot"><span class="annottext">t :: Double
</span><a href="#local-6989586621679548508"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548509"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>        </span><span id="local-6989586621679548512"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548512"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548510"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548508"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548508"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>        </span><span id="local-6989586621679548511"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548511"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548509"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548524"><span class="hs-identifier hs-var">faheyK</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#foucautP"><span class="hs-pragma hs-type">foucautP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_foucautP.gif&gt;&gt;</span><span>
</span><span id="line-748"></span><span class="annot"><a href="Reanimate.GeoProjection.html#foucautP"><span class="hs-identifier hs-type">foucautP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-749"></span><span id="foucautP"><span class="annot"><span class="annottext">foucautP :: Projection
</span><a href="Reanimate.GeoProjection.html#foucautP"><span class="hs-identifier hs-var hs-var">foucautP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;foucaut&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548507"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548506"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-750"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-751"></span><span>    </span><span id="local-6989586621679548505"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548505"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548504"><span class="hs-identifier hs-var">yHi</span></a></span><span>
</span><span id="line-752"></span><span>    </span><span id="local-6989586621679548504"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548504"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>    </span><span id="local-6989586621679548503"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548503"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548502"><span class="hs-identifier hs-var">xHi</span></a></span><span>
</span><span id="line-754"></span><span>    </span><span id="local-6989586621679548502"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548502"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#tau"><span class="hs-identifier hs-var">tau</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span>
</span><span id="line-755"></span><span>    </span><span id="local-6989586621679548507"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548507"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548501"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548501"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548500"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548500"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548499"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548503"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548502"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548503"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548498"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548505"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548504"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548505"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-757"></span><span>        </span><span id="local-6989586621679548497"><span class="annot"><span class="annottext">k :: Double
</span><a href="#local-6989586621679548497"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548500"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-758"></span><span>        </span><span id="local-6989586621679548496"><span class="annot"><span class="annottext">cosk :: Double
</span><a href="#local-6989586621679548496"><span class="hs-identifier hs-var hs-var">cosk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548497"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-759"></span><span>        </span><span id="local-6989586621679548499"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548499"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548501"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548500"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548496"><span class="hs-identifier hs-var">cosk</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548496"><span class="hs-identifier hs-var">cosk</span></a></span><span>
</span><span id="line-760"></span><span>        </span><span id="local-6989586621679548498"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548498"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">tan</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548497"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-761"></span><span>    </span><span id="local-6989586621679548506"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548506"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548495"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548495"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548494"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548494"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548493"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548492"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-762"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-763"></span><span>        </span><span id="local-6989586621679548491"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548491"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548503"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548502"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548495"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-764"></span><span>        </span><span id="local-6989586621679548490"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548490"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548505"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548504"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548494"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-765"></span><span>        </span><span id="local-6989586621679548489"><span class="annot"><span class="annottext">k :: Double
</span><a href="#local-6989586621679548489"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548490"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>        </span><span id="local-6989586621679548488"><span class="annot"><span class="annottext">cosk :: Double
</span><a href="#local-6989586621679548488"><span class="hs-identifier hs-var hs-var">cosk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548489"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-767"></span><span>        </span><span id="local-6989586621679548492"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548492"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548489"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-768"></span><span>        </span><span id="local-6989586621679548493"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548493"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548491"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#sqrtPi"><span class="hs-identifier hs-var">sqrtPi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548492"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548488"><span class="hs-identifier hs-var">cosk</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548488"><span class="hs-identifier hs-var">cosk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>
</span><span id="line-770"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#lagrangeP"><span class="hs-pragma hs-type">lagrangeP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- | &lt;&lt;docs/gifs/doc_lagrangeP.gif&gt;&gt;</span><span>
</span><span id="line-772"></span><span class="annot"><a href="Reanimate.GeoProjection.html#lagrangeP"><span class="hs-identifier hs-type">lagrangeP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-773"></span><span id="lagrangeP"><span class="annot"><span class="annottext">lagrangeP :: Projection
</span><a href="Reanimate.GeoProjection.html#lagrangeP"><span class="hs-identifier hs-var hs-var">lagrangeP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (LonLat -&gt; XYCoord) -&gt; (XYCoord -&gt; LonLat) -&gt; Projection
</span><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-var">Projection</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lagrange&quot;</span></span><span> </span><span class="annot"><span class="annottext">LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548487"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548486"><span class="hs-identifier hs-var">inverse</span></a></span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-775"></span><span>    </span><span id="local-6989586621679548485"><span class="annot"><span class="annottext">yLo :: Double
</span><a href="#local-6989586621679548485"><span class="hs-identifier hs-var hs-var">yLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548484"><span class="hs-identifier hs-var">yHi</span></a></span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621679548484"><span class="annot"><span class="annottext">yHi :: Double
</span><a href="#local-6989586621679548484"><span class="hs-identifier hs-var hs-var">yHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679548483"><span class="annot"><span class="annottext">xLo :: Double
</span><a href="#local-6989586621679548483"><span class="hs-identifier hs-var hs-var">xLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548482"><span class="hs-identifier hs-var">xHi</span></a></span><span>
</span><span id="line-778"></span><span>    </span><span id="local-6989586621679548482"><span class="annot"><span class="annottext">xHi :: Double
</span><a href="#local-6989586621679548482"><span class="hs-identifier hs-var hs-var">xHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-779"></span><span>    </span><span id="local-6989586621679548481"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679548481"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-780"></span><span>    </span><span id="local-6989586621679548487"><span class="annot"><span class="annottext">forward :: LonLat -&gt; XYCoord
</span><a href="#local-6989586621679548487"><span class="hs-identifier hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-type">LonLat</span></a></span><span> </span><span id="local-6989586621679548480"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548480"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548479"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548479"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548479"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#halfPi"><span class="hs-identifier hs-var">halfPi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-identifier hs-var">epsilon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548479"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-var">XYCoord</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548478"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548483"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548482"><span class="hs-identifier hs-var">xHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548483"><span class="hs-identifier hs-var">xLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548477"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548485"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548484"><span class="hs-identifier hs-var">yHi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548485"><span class="hs-identifier hs-var">yLo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-784"></span><span>        </span><span id="local-6989586621679548476"><span class="annot"><span class="annottext">sinPhi :: Double
</span><a href="#local-6989586621679548476"><span class="hs-identifier hs-var hs-var">sinPhi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548479"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-785"></span><span>        </span><span id="local-6989586621679548475"><span class="annot"><span class="annottext">v :: Double
</span><a href="#local-6989586621679548475"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548476"><span class="hs-identifier hs-var">sinPhi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548476"><span class="hs-identifier hs-var">sinPhi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548481"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>        </span><span id="local-6989586621679548474"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679548474"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548475"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548475"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548480"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548481"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>        </span><span id="local-6989586621679548478"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548478"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548480"><span class="hs-identifier hs-var">lam</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548481"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548474"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-788"></span><span>        </span><span id="local-6989586621679548477"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548477"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548475"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548475"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548474"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-789"></span><span>    </span><span id="local-6989586621679548486"><span class="annot"><span class="annottext">inverse :: XYCoord -&gt; LonLat
</span><a href="#local-6989586621679548486"><span class="hs-identifier hs-var hs-var">inverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548473"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548473"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679548472"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548472"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548472"><span class="hs-identifier hs-var">y'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Reanimate.GeoProjection.html#epsilon"><span class="hs-identifier hs-var">epsilon</span></a></span><span>
</span><span id="line-791"></span><span>          </span><span class="hs-comment">-- = LonLat 0 (signum y * halfPi)</span><span>
</span><span id="line-792"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span>
</span><span id="line-793"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548471"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548470"><span class="hs-identifier hs-var">phi</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-795"></span><span>        </span><span id="local-6989586621679548469"><span class="annot"><span class="annottext">x :: Double
</span><a href="#local-6989586621679548469"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548483"><span class="hs-identifier hs-var">xLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548482"><span class="hs-identifier hs-var">xHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548473"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-796"></span><span>        </span><span id="local-6989586621679548468"><span class="annot"><span class="annottext">y :: Double
</span><a href="#local-6989586621679548468"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; Double
</span><a href="Reanimate.Ease.html#fromToS"><span class="hs-identifier hs-var">fromToS</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548485"><span class="hs-identifier hs-var">yLo</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548484"><span class="hs-identifier hs-var">yHi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548472"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span>
</span><span id="line-797"></span><span>        </span><span id="local-6989586621679548467"><span class="annot"><span class="annottext">x2 :: Double
</span><a href="#local-6989586621679548467"><span class="hs-identifier hs-var hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548469"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548469"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-798"></span><span>        </span><span id="local-6989586621679548466"><span class="annot"><span class="annottext">y2 :: Double
</span><a href="#local-6989586621679548466"><span class="hs-identifier hs-var hs-var">y2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548468"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548468"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-799"></span><span>        </span><span id="local-6989586621679548465"><span class="annot"><span class="annottext">t :: Double
</span><a href="#local-6989586621679548465"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548468"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548467"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548466"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>        </span><span id="local-6989586621679548464"><span class="annot"><span class="annottext">t' :: Double
</span><a href="#local-6989586621679548464"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548465"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548465"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548481"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>        </span><span id="local-6989586621679548471"><span class="annot"><span class="annottext">lam :: Double
</span><a href="#local-6989586621679548471"><span class="hs-identifier hs-var hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. RealFloat a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">atan2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548469"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548467"><span class="hs-identifier hs-var">x2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548466"><span class="hs-identifier hs-var">y2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548481"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-802"></span><span>        </span><span id="local-6989586621679548470"><span class="annot"><span class="annottext">phi :: Double
</span><a href="#local-6989586621679548470"><span class="hs-identifier hs-var hs-var">phi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">asin</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548464"><span class="hs-identifier hs-var">t'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548464"><span class="hs-identifier hs-var">t'</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span class="hs-comment">-- | Map for all features and render the geometry.</span><span>
</span><span id="line-819"></span><span id="local-6989586621679549234"><span class="annot"><a href="Reanimate.GeoProjection.html#drawFeatureCollection"><span class="hs-identifier hs-type">drawFeatureCollection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GeoFeatureCollection</span></span><span> </span><span class="annot"><a href="#local-6989586621679549234"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549234"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span></span><span>
</span><span id="line-820"></span><span id="drawFeatureCollection"><span class="annot"><span class="annottext">drawFeatureCollection :: GeoFeatureCollection a -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#drawFeatureCollection"><span class="hs-identifier hs-var hs-var">drawFeatureCollection</span></a></span></span><span> </span><span id="local-6989586621679548463"><span class="annot"><span class="annottext">GeoFeatureCollection a
</span><a href="#local-6989586621679548463"><span class="hs-identifier hs-var">geo</span></a></span></span><span> </span><span id="local-6989586621679548462"><span class="annot"><span class="annottext">a -&gt; SVG -&gt; SVG
</span><a href="#local-6989586621679548462"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span>
</span><span id="line-821"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">a -&gt; SVG -&gt; SVG
</span><a href="#local-6989586621679548462"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoFeature a
</span><a href="#local-6989586621679548460"><span class="hs-identifier hs-var">feature</span></a></span><span> </span><span class="annot"><span class="annottext">GeoFeature a -&gt; Getting a (GeoFeature a) a -&gt; a
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting a (GeoFeature a) a
forall a1 a2. Lens (GeoFeature a1) (GeoFeature a2) a1 a2
</span><span class="hs-identifier hs-var">properties</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SVG -&gt; SVG) -&gt; SVG -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GeospatialGeometry -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#renderGeometry"><span class="hs-identifier hs-var">renderGeometry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoFeature a
</span><a href="#local-6989586621679548460"><span class="hs-identifier hs-var">feature</span></a></span><span> </span><span class="annot"><span class="annottext">GeoFeature a
-&gt; Getting GeospatialGeometry (GeoFeature a) GeospatialGeometry
-&gt; GeospatialGeometry
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting GeospatialGeometry (GeoFeature a) GeospatialGeometry
forall a. Lens' (GeoFeature a) GeospatialGeometry
</span><span class="hs-identifier hs-var">geometry</span></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679548460"><span class="annot"><span class="annottext">GeoFeature a
</span><a href="#local-6989586621679548460"><span class="hs-identifier hs-var">feature</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Seq (GeoFeature a) -&gt; [GeoFeature a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoFeatureCollection a
</span><a href="#local-6989586621679548463"><span class="hs-identifier hs-var">geo</span></a></span><span> </span><span class="annot"><span class="annottext">GeoFeatureCollection a
-&gt; Getting
     (Seq (GeoFeature a)) (GeoFeatureCollection a) (Seq (GeoFeature a))
-&gt; Seq (GeoFeature a)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Seq (GeoFeature a)) (GeoFeatureCollection a) (Seq (GeoFeature a))
forall a1 a2.
Lens
  (GeoFeatureCollection a1)
  (GeoFeatureCollection a2)
  (Seq (GeoFeature a1))
  (Seq (GeoFeature a2))
</span><span class="hs-identifier hs-var">geofeatures</span></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#loadFeatureCollection"><span class="hs-pragma hs-type">loadFeatureCollection</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- | Load GeoJSON from a filepath and render the geometry.</span><span>
</span><span id="line-827"></span><span id="local-6989586621679548455"><span class="annot"><a href="Reanimate.GeoProjection.html#loadFeatureCollection"><span class="hs-identifier hs-type">loadFeatureCollection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679548455"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679548455"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span></span><span>
</span><span id="line-828"></span><span id="loadFeatureCollection"><span class="annot"><span class="annottext">loadFeatureCollection :: String -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#loadFeatureCollection"><span class="hs-identifier hs-var hs-var">loadFeatureCollection</span></a></span></span><span> </span><span id="local-6989586621679548453"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548453"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG) -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG) -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG)
-&gt; IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG) -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-829"></span><span>  </span><span id="local-6989586621679548451"><span class="annot"><span class="annottext">Maybe (GeoFeatureCollection a)
</span><a href="#local-6989586621679548451"><span class="hs-identifier hs-var">mbGeo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Maybe (GeoFeatureCollection a))
forall a. FromJSON a =&gt; String -&gt; IO (Maybe a)
</span><span class="hs-identifier hs-var">decodeFileStrict</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548453"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (GeoFeatureCollection a)
</span><a href="#local-6989586621679548451"><span class="hs-identifier hs-var">mbGeo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><span class="annottext">Maybe (GeoFeatureCollection a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG))
-&gt; String -&gt; IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loadFeatureCollection: Invalid GeoJSON: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679548453"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679548448"><span class="annot"><span class="annottext">GeoFeatureCollection a
</span><a href="#local-6989586621679548448"><span class="hs-identifier hs-var">geo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((a -&gt; SVG -&gt; SVG) -&gt; SVG) -&gt; IO ((a -&gt; SVG -&gt; SVG) -&gt; SVG)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoFeatureCollection a -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG
forall a. GeoFeatureCollection a -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#drawFeatureCollection"><span class="hs-identifier hs-var">drawFeatureCollection</span></a></span><span> </span><span class="annot"><span class="annottext">GeoFeatureCollection a
</span><a href="#local-6989586621679548448"><span class="hs-identifier hs-var">geo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span class="hs-comment">-- drawFeatureCollection :: GeoFeatureCollection a -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- loadFeatureColection :: FromJSON a =&gt; FilePath -&gt; (a -&gt; SVG -&gt; SVG) -&gt; SVG</span><span>
</span><span id="line-836"></span><span class="hs-comment">-- modifyPoints :: ((Double,Double) -&gt; (Double, Double)) -&gt; SVG -&gt; SVG</span><span>
</span><span id="line-837"></span><span class="hs-comment">-- pointsToRadians :: SVG -&gt; SVG</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- applyProjection :: Projection -&gt; SVG -&gt; SVG</span><span>
</span><span id="line-839"></span><span>
</span><span id="line-840"></span><span class="hs-comment">-- | Render GeoJSON geometry as SVG.</span><span>
</span><span id="line-841"></span><span class="annot"><a href="Reanimate.GeoProjection.html#renderGeometry"><span class="hs-identifier hs-type">renderGeometry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GeospatialGeometry</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-842"></span><span id="renderGeometry"><span class="annot"><span class="annottext">renderGeometry :: GeospatialGeometry -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#renderGeometry"><span class="hs-identifier hs-var hs-var">renderGeometry</span></a></span></span><span> </span><span id="local-6989586621679548447"><span class="annot"><span class="annottext">GeospatialGeometry
</span><a href="#local-6989586621679548447"><span class="hs-identifier hs-var">shape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-843"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GeospatialGeometry
</span><a href="#local-6989586621679548447"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-844"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MultiPolygon</span></span><span> </span><span id="local-6989586621679548445"><span class="annot"><span class="annottext">GeoMultiPolygon
</span><a href="#local-6989586621679548445"><span class="hs-identifier hs-var">mpolygon</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-845"></span><span>      </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; SVG) -&gt; [SVG] -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GeoPolygon -&gt; SVG) -&gt; [GeoPolygon] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeospatialGeometry -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#renderGeometry"><span class="hs-identifier hs-var">renderGeometry</span></a></span><span> </span><span class="annot"><span class="annottext">(GeospatialGeometry -&gt; SVG)
-&gt; (GeoPolygon -&gt; GeospatialGeometry) -&gt; GeoPolygon -&gt; SVG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GeoPolygon -&gt; GeospatialGeometry
</span><span class="hs-identifier hs-var">Polygon</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([GeoPolygon] -&gt; [SVG]) -&gt; [GeoPolygon] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq GeoPolygon -&gt; [GeoPolygon]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoMultiPolygon -&gt; Seq GeoPolygon
</span><span class="hs-identifier hs-var">splitGeoMultiPolygon</span></span><span> </span><span class="annot"><span class="annottext">GeoMultiPolygon
</span><a href="#local-6989586621679548445"><span class="hs-identifier hs-var">mpolygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Polygon</span></span><span> </span><span id="local-6989586621679548442"><span class="annot"><span class="annottext">GeoPolygon
</span><a href="#local-6989586621679548442"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-847"></span><span>      </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span>
</span><span id="line-848"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkLinePath"><span class="hs-identifier hs-var">mkLinePath</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679548440"><span class="hs-identifier hs-var">section</span></a></span><span>
</span><span id="line-849"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679548440"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679548440"><span class="hs-identifier hs-var">section</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; [[(Double, Double)]]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-850"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548439"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548438"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PointXY</span></span><span> </span><span id="local-6989586621679548439"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548439"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548438"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548438"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GeoPositionWithoutCRS -&gt; PointXY)
-&gt; [GeoPositionWithoutCRS] -&gt; [PointXY]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GeoPositionWithoutCRS -&gt; PointXY
</span><span class="hs-identifier hs-var">retrieveXY</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinearRing GeoPositionWithoutCRS -&gt; [GeoPositionWithoutCRS]
forall a. LinearRing a -&gt; [a]
</span><span class="hs-identifier hs-var">fromLinearRing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LinearRing GeoPositionWithoutCRS]
-&gt; LinearRing GeoPositionWithoutCRS
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (LinearRing GeoPositionWithoutCRS)
-&gt; [LinearRing GeoPositionWithoutCRS]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoPolygon
</span><a href="#local-6989586621679548442"><span class="hs-identifier hs-var">poly</span></a></span><span class="annot"><span class="annottext">GeoPolygon
-&gt; Getting
     (Seq (LinearRing GeoPositionWithoutCRS))
     GeoPolygon
     (Seq (LinearRing GeoPositionWithoutCRS))
-&gt; Seq (LinearRing GeoPositionWithoutCRS)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Seq (LinearRing GeoPositionWithoutCRS))
  GeoPolygon
  (Seq (LinearRing GeoPositionWithoutCRS))
Iso' GeoPolygon (Seq (LinearRing GeoPositionWithoutCRS))
</span><span class="hs-identifier hs-var">unGeoPolygon</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-853"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Line</span></span><span> </span><span id="local-6989586621679548431"><span class="annot"><span class="annottext">GeoLine
</span><a href="#local-6989586621679548431"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-855"></span><span>      </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkLinePath"><span class="hs-identifier hs-var">mkLinePath</span></a></span><span>
</span><span id="line-856"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548430"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548429"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PointXY</span></span><span> </span><span id="local-6989586621679548430"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548430"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548429"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548429"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GeoPositionWithoutCRS -&gt; PointXY)
-&gt; [GeoPositionWithoutCRS] -&gt; [PointXY]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GeoPositionWithoutCRS -&gt; PointXY
</span><span class="hs-identifier hs-var">retrieveXY</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineString GeoPositionWithoutCRS -&gt; [GeoPositionWithoutCRS]
forall a. LineString a -&gt; [a]
</span><span class="hs-identifier hs-var">Line.fromLineString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoLine
</span><a href="#local-6989586621679548431"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">GeoLine
-&gt; Getting
     (LineString GeoPositionWithoutCRS)
     GeoLine
     (LineString GeoPositionWithoutCRS)
-&gt; LineString GeoPositionWithoutCRS
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (LineString GeoPositionWithoutCRS)
  GeoLine
  (LineString GeoPositionWithoutCRS)
Iso' GeoLine (LineString GeoPositionWithoutCRS)
</span><span class="hs-identifier hs-var">unGeoLine</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-859"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MultiLine</span></span><span> </span><span id="local-6989586621679548425"><span class="annot"><span class="annottext">GeoMultiLine
</span><a href="#local-6989586621679548425"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-860"></span><span>      </span><span class="annot"><span class="annottext">[SVG] -&gt; SVG
</span><a href="Reanimate.Svg.Constructors.html#mkGroup"><span class="hs-identifier hs-var">mkGroup</span></a></span><span> </span><span class="annot"><span class="annottext">([SVG] -&gt; SVG) -&gt; [SVG] -&gt; SVG
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GeoLine -&gt; SVG) -&gt; [GeoLine] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeospatialGeometry -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#renderGeometry"><span class="hs-identifier hs-var">renderGeometry</span></a></span><span> </span><span class="annot"><span class="annottext">(GeospatialGeometry -&gt; SVG)
-&gt; (GeoLine -&gt; GeospatialGeometry) -&gt; GeoLine -&gt; SVG
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GeoLine -&gt; GeospatialGeometry
</span><span class="hs-identifier hs-var">Line</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([GeoLine] -&gt; [SVG]) -&gt; [GeoLine] -&gt; [SVG]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq GeoLine -&gt; [GeoLine]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeoMultiLine -&gt; Seq GeoLine
</span><span class="hs-identifier hs-var">splitGeoMultiLine</span></span><span> </span><span class="annot"><span class="annottext">GeoMultiLine
</span><a href="#local-6989586621679548425"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>    </span><span class="annot"><span class="annottext">GeospatialGeometry
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SVG
</span><span class="hs-identifier hs-var">None</span></span><span>
</span><span id="line-862"></span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">-- | Apply a projection to an SVG image. This is a lossy transformation</span><span>
</span><span id="line-865"></span><span class="hs-comment">--   but the default tolerance is low enough that inaccuracies should not</span><span>
</span><span id="line-866"></span><span class="hs-comment">--   be visible.</span><span>
</span><span id="line-867"></span><span class="annot"><a href="Reanimate.GeoProjection.html#applyProjection"><span class="hs-identifier hs-type">applyProjection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-868"></span><span id="applyProjection"><span class="annot"><span class="annottext">applyProjection :: Projection -&gt; SVG -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#applyProjection"><span class="hs-identifier hs-var hs-var">applyProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Projection -&gt; SVG -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#applyProjection%27"><span class="hs-identifier hs-var">applyProjection'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-2</span></span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-comment">-- | Apply a projection to an SVG image with a specified tolerance.</span><span>
</span><span id="line-871"></span><span class="hs-comment">--   Projections may turn straight lines into disjointed curves and</span><span>
</span><span id="line-872"></span><span class="hs-comment">--   the tolerance argument determined the accuracy of this transformation.</span><span>
</span><span id="line-873"></span><span class="annot"><a href="Reanimate.GeoProjection.html#applyProjection%27"><span class="hs-identifier hs-type">applyProjection'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.GeoProjection.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Reanimate.Animation.html#SVG"><span class="hs-identifier hs-type">SVG</span></a></span><span>
</span><span id="line-874"></span><span id="applyProjection%27"><span class="annot"><span class="annottext">applyProjection' :: Double -&gt; Projection -&gt; SVG -&gt; SVG
</span><a href="Reanimate.GeoProjection.html#applyProjection%27"><span class="hs-identifier hs-var hs-var">applyProjection'</span></a></span></span><span> </span><span id="local-6989586621679548423"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548423"><span class="hs-identifier hs-var">tolerance</span></a></span></span><span> </span><span id="local-6989586621679548422"><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548422"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LineCommand] -&gt; [LineCommand]) -&gt; SVG -&gt; SVG
</span><a href="Reanimate.Svg.html#mapSvgLines"><span class="hs-identifier hs-var">mapSvgLines</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548420"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-875"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-876"></span><span>    </span><span id="local-6989586621679548420"><span class="annot"><span class="annottext">start :: [LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548420"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-type">LineMove</span></a></span><span> </span><span id="local-6989586621679548418"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548418"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679548417"><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548417"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-var">LineMove</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548418"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineCommand -&gt; [LineCommand] -&gt; [LineCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; [LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548418"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548417"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-877"></span><span>    </span><span class="annot"><a href="#local-6989586621679548420"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCommand]
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-878"></span><span>    </span><span id="local-6989586621679548415"><span class="annot"><span class="annottext">worker :: RPoint -&gt; [LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548415"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679548414"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548414"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineEnd"><span class="hs-identifier hs-type">LineEnd</span></a></span><span> </span><span id="local-6989586621679548412"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548412"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679548411"><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548411"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-879"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679548410"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548410"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679548409"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548409"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; [RPoint]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([RPoint] -&gt; [RPoint]) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [RPoint] -&gt; [RPoint]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([RPoint] -&gt; [RPoint]) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint -&gt; [RPoint]
</span><a href="#local-6989586621679548406"><span class="hs-identifier hs-var">mkChunks</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548414"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548412"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-880"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(RPoint -&gt; LineCommand) -&gt; [RPoint] -&gt; [LineCommand]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679548405"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548405"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-var">LineBezier</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548405"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RPoint] -&gt; [RPoint]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548409"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LineCommand] -&gt; [LineCommand] -&gt; [LineCommand]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineEnd"><span class="hs-identifier hs-var">LineEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548410"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineCommand -&gt; [LineCommand] -&gt; [LineCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548420"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548411"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-881"></span><span>    </span><span class="annot"><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span id="local-6989586621679548403"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548403"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-type">LineBezier</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679548402"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548402"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679548401"><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548401"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-882"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679548400"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548400"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679548399"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548399"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; [RPoint]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([RPoint] -&gt; [RPoint]) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [RPoint] -&gt; [RPoint]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([RPoint] -&gt; [RPoint]) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint -&gt; [RPoint]
</span><a href="#local-6989586621679548406"><span class="hs-identifier hs-var">mkChunks</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548403"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548402"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-883"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(RPoint -&gt; LineCommand) -&gt; [RPoint] -&gt; [LineCommand]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679548398"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548398"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-var">LineBezier</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548398"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RPoint] -&gt; [RPoint]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548399"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LineCommand] -&gt; [LineCommand] -&gt; [LineCommand]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-var">LineBezier</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548400"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">LineCommand -&gt; [LineCommand] -&gt; [LineCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; [LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548400"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548401"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-884"></span><span>    </span><span class="annot"><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-type">LineBezier</span></a></span><span> </span><span id="local-6989586621679548397"><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548397"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679548396"><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548396"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-885"></span><span>      </span><span class="annot"><span class="annottext">[RPoint] -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineBezier"><span class="hs-identifier hs-var">LineBezier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RPoint -&gt; RPoint) -&gt; [RPoint] -&gt; [RPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548397"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineCommand -&gt; [LineCommand] -&gt; [LineCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; [LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RPoint] -&gt; RPoint
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[RPoint]
</span><a href="#local-6989586621679548397"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548396"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-type">LineMove</span></a></span><span> </span><span id="local-6989586621679548394"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548394"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679548393"><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548393"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; LineCommand
</span><a href="Reanimate.Svg.LineCommand.html#LineMove"><span class="hs-identifier hs-var">LineMove</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548394"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LineCommand -&gt; [LineCommand] -&gt; [LineCommand]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; [LineCommand] -&gt; [LineCommand]
</span><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548394"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[LineCommand]
</span><a href="#local-6989586621679548393"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-887"></span><span>    </span><span class="annot"><a href="#local-6989586621679548415"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-888"></span><span>    </span><span id="local-6989586621679548392"><span class="annot"><span class="annottext">lowTolerance :: Double
</span><a href="#local-6989586621679548392"><span class="hs-identifier hs-var hs-var">lowTolerance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548423"><span class="hs-identifier hs-var">tolerance</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548423"><span class="hs-identifier hs-var">tolerance</span></a></span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span>    </span><span id="local-6989586621679548416"><span class="annot"><span class="annottext">proj :: RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var hs-var">proj</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V2</span></span><span> </span><span id="local-6989586621679548390"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548390"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span id="local-6989586621679548389"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548389"><span class="hs-identifier hs-var">phi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-891"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Projection -&gt; LonLat -&gt; XYCoord
</span><a href="Reanimate.GeoProjection.html#projectionForward"><span class="hs-identifier hs-var hs-var">projectionForward</span></a></span><span> </span><span class="annot"><span class="annottext">Projection
</span><a href="#local-6989586621679548422"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(LonLat -&gt; XYCoord) -&gt; LonLat -&gt; XYCoord
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; LonLat
</span><a href="Reanimate.GeoProjection.html#LonLat"><span class="hs-identifier hs-var">LonLat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548390"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548389"><span class="hs-identifier hs-var">phi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-892"></span><span>        </span><span class="annot"><a href="Reanimate.GeoProjection.html#XYCoord"><span class="hs-identifier hs-type">XYCoord</span></a></span><span> </span><span id="local-6989586621679548388"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548388"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679548387"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548387"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; RPoint
forall a. a -&gt; a -&gt; V2 a
</span><span class="hs-identifier hs-var">V2</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548388"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548387"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-893"></span><span>    </span><span id="local-6989586621679548406"><span class="annot"><span class="annottext">mkChunks :: RPoint -&gt; RPoint -&gt; [RPoint]
</span><a href="#local-6989586621679548406"><span class="hs-identifier hs-var hs-var">mkChunks</span></a></span></span><span> </span><span id="local-6989586621679548386"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548386"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679548385"><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548385"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-894"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679548384"><span class="annot"><span class="annottext">midway :: RPoint
</span><a href="#local-6989586621679548384"><span class="hs-identifier hs-var hs-var">midway</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; RPoint -&gt; RPoint -&gt; RPoint
forall (f :: * -&gt; *) a.
(Additive f, Num a) =&gt;
a -&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-identifier hs-var">lerp</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-895"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint -&gt; Double
forall (f :: * -&gt; *) a. (Metric f, Floating a) =&gt; f a -&gt; f a -&gt; a
</span><span class="hs-identifier hs-var">distance</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548386"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint
</span><a href="#local-6989586621679548416"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548385"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548423"><span class="hs-identifier hs-var">tolerance</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint -&gt; Double
forall (f :: * -&gt; *) a. (Metric f, Floating a) =&gt; f a -&gt; f a -&gt; a
</span><span class="hs-identifier hs-var">distance</span></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679548392"><span class="hs-identifier hs-var">lowTolerance</span></a></span><span>
</span><span id="line-896"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548386"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548385"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-897"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">RPoint -&gt; RPoint -&gt; [RPoint]
</span><a href="#local-6989586621679548406"><span class="hs-identifier hs-var">mkChunks</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548384"><span class="hs-identifier hs-var">midway</span></a></span><span> </span><span class="annot"><span class="annottext">[RPoint] -&gt; [RPoint] -&gt; [RPoint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [RPoint] -&gt; [RPoint]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RPoint -&gt; RPoint -&gt; [RPoint]
</span><a href="#local-6989586621679548406"><span class="hs-identifier hs-var">mkChunks</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548384"><span class="hs-identifier hs-var">midway</span></a></span><span> </span><span class="annot"><span class="annottext">RPoint
</span><a href="#local-6989586621679548385"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span></pre></body></html>