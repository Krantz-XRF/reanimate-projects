<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Codec.Picture.Tiff.Internal.Types</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier">BinaryParam</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier">Endianness</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier">TiffHeader</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPlanarConfiguration"><span class="hs-identifier">TiffPlanarConfiguration</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCompression"><span class="hs-identifier">TiffCompression</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#IfdType"><span class="hs-identifier">IfdType</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffColorspace"><span class="hs-identifier">TiffColorspace</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFormat"><span class="hs-identifier">TiffSampleFormat</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier">ImageFileDirectory</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSample"><span class="hs-identifier">ExtraSample</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Predictor"><span class="hs-identifier">Predictor</span></a></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier">planarConfgOfConstant</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#constantToPlaneConfiguration"><span class="hs-identifier">constantToPlaneConfiguration</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#unpackSampleFormat"><span class="hs-identifier">unpackSampleFormat</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier">packSampleFormat</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#word16OfTag"><span class="hs-identifier">word16OfTag</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#unpackPhotometricInterpretation"><span class="hs-identifier">unpackPhotometricInterpretation</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packPhotometricInterpretation"><span class="hs-identifier">packPhotometricInterpretation</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#codeOfExtraSample"><span class="hs-identifier">codeOfExtraSample</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#unPackCompression"><span class="hs-identifier">unPackCompression</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packCompression"><span class="hs-identifier">packCompression</span></a></span><span> </span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#predictorOfConstant"><span class="hs-identifier">predictorOfConstant</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator">&lt;*&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeShiftR</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Binary</span></span><span class="hs-special">(</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary.Get</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Get</span></span><span>
</span><span id="line-39"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getWord16le</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getWord16be</span></span><span>
</span><span id="line-40"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getWord32le</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getWord32be</span></span><span>
</span><span id="line-41"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bytesRead</span></span><span>
</span><span id="line-42"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">skip</span></span><span>
</span><span id="line-43"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getByteString</span></span><span>
</span><span id="line-44"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary.Put</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Put</span></span><span>
</span><span id="line-46"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putWord16le</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putWord16be</span></span><span>
</span><span id="line-47"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putWord32le</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putWord32be</span></span><span>
</span><span id="line-48"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">putByteString</span></span><span>
</span><span id="line-49"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">on</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapAccumL</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Int32</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word16</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word32</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html"><span class="hs-identifier">Codec.Picture.Metadata.Exif</span></a></span><span>
</span><span id="line-58"></span><span class="hs-comment">{-import Debug.Trace-}</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="Endianness"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-var">Endianness</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="EndianLittle"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EndianBig"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158655"><span id="local-6989586621679158657"><span class="annot"><span class="annottext">Endianness -&gt; Endianness -&gt; Bool
(Endianness -&gt; Endianness -&gt; Bool)
-&gt; (Endianness -&gt; Endianness -&gt; Bool) -&gt; Eq Endianness
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Endianness -&gt; Endianness -&gt; Bool
$c/= :: Endianness -&gt; Endianness -&gt; Bool
== :: Endianness -&gt; Endianness -&gt; Bool
$c== :: Endianness -&gt; Endianness -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158648"><span id="local-6989586621679158650"><span id="local-6989586621679158652"><span class="annot"><span class="annottext">Int -&gt; Endianness -&gt; ShowS
[Endianness] -&gt; ShowS
Endianness -&gt; String
(Int -&gt; Endianness -&gt; ShowS)
-&gt; (Endianness -&gt; String)
-&gt; ([Endianness] -&gt; ShowS)
-&gt; Show Endianness
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Endianness] -&gt; ShowS
$cshowList :: [Endianness] -&gt; ShowS
show :: Endianness -&gt; String
$cshow :: Endianness -&gt; String
showsPrec :: Int -&gt; Endianness -&gt; ShowS
$cshowsPrec :: Int -&gt; Endianness -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679158643"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679158641"><span class="annot"><span class="annottext">put :: Endianness -&gt; Put
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><span class="hs-identifier hs-var">putWord16le</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0x4949</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><span class="hs-identifier hs-var">putWord16le</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0x4D4D</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679158639"><span class="annot"><span class="annottext">get :: Get Endianness
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679158637"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158637"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><span class="hs-identifier hs-var">getWord16le</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158637"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-72"></span><span>      </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0x4949</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Endianness
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0x4D4D</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Endianness
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Endianness
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid endian tag value&quot;</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Because having a polymorphic get with endianness is to nice</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- to pass on, introducing this helper type class, which is just</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- a superset of Binary, but formalising a parameter passing</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- into it.</span><span>
</span><span id="line-80"></span><span class="hs-keyword">class</span><span> </span><span id="BinaryParam"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-var">BinaryParam</span></a></span></span><span> </span><span id="local-6989586621679158775"><span class="annot"><a href="#local-6989586621679158775"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679158774"><span class="annot"><a href="#local-6989586621679158774"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>  </span><span id="getP"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-type">getP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679158775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="#local-6989586621679158774"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span id="putP"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-type">putP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679158775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158774"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="TiffHeader"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier hs-var">TiffHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TiffHeader"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier hs-var">TiffHeader</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="hdrEndianness"><span class="annot"><span class="annottext">TiffHeader -&gt; Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var hs-var">hdrEndianness</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="hdrOffset"><span class="annot"><span class="annottext">TiffHeader -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrOffset"><span class="hs-identifier hs-var hs-var">hdrOffset</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158628"><span id="local-6989586621679158630"><span class="annot"><span class="annottext">TiffHeader -&gt; TiffHeader -&gt; Bool
(TiffHeader -&gt; TiffHeader -&gt; Bool)
-&gt; (TiffHeader -&gt; TiffHeader -&gt; Bool) -&gt; Eq TiffHeader
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TiffHeader -&gt; TiffHeader -&gt; Bool
$c/= :: TiffHeader -&gt; TiffHeader -&gt; Bool
== :: TiffHeader -&gt; TiffHeader -&gt; Bool
$c== :: TiffHeader -&gt; TiffHeader -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158622"><span id="local-6989586621679158624"><span id="local-6989586621679158626"><span class="annot"><span class="annottext">Int -&gt; TiffHeader -&gt; ShowS
[TiffHeader] -&gt; ShowS
TiffHeader -&gt; String
(Int -&gt; TiffHeader -&gt; ShowS)
-&gt; (TiffHeader -&gt; String)
-&gt; ([TiffHeader] -&gt; ShowS)
-&gt; Show TiffHeader
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TiffHeader] -&gt; ShowS
$cshowList :: [TiffHeader] -&gt; ShowS
show :: TiffHeader -&gt; String
$cshow :: TiffHeader -&gt; String
showsPrec :: Int -&gt; TiffHeader -&gt; ShowS
$cshowsPrec :: Int -&gt; TiffHeader -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679158618"><span class="annot"><span class="annottext">putP :: Endianness -&gt; Word16 -&gt; Put
</span><a href="#local-6989586621679158618"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><span class="hs-identifier hs-var">putWord16le</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Put
</span><span class="hs-identifier hs-var">putWord16be</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679158617"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get Word16
</span><a href="#local-6989586621679158617"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><span class="hs-identifier hs-var">getWord16le</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word16
</span><span class="hs-identifier hs-var">getWord16be</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679158614"><span class="annot"><span class="annottext">putP :: Endianness -&gt; Int32 -&gt; Put
</span><a href="#local-6989586621679158614"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679158613"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158613"><span class="hs-identifier hs-var">en</span></a></span></span><span> </span><span id="local-6989586621679158612"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679158612"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158613"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Put) -&gt; Word32 -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679158612"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679158611"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get Int32
</span><a href="#local-6989586621679158611"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679158610"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158610"><span class="hs-identifier hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int32) -&gt; Get Word32 -&gt; Get Int32
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness -&gt; Get Word32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158610"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679158606"><span class="annot"><span class="annottext">putP :: Endianness -&gt; Word32 -&gt; Put
</span><a href="#local-6989586621679158606"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Put
</span><span class="hs-identifier hs-var">putWord32le</span></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Put
</span><span class="hs-identifier hs-var">putWord32be</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679158605"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get Word32
</span><a href="#local-6989586621679158605"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word32
</span><span class="hs-identifier hs-var">getWord32le</span></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Get Word32
</span><span class="hs-identifier hs-var">getWord32be</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679158601"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier hs-type">TiffHeader</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679158600"><span class="annot"><span class="annottext">put :: TiffHeader -&gt; Put
</span><a href="#local-6989586621679158600"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span id="local-6989586621679158599"><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158599"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158598"><span class="annot"><span class="annottext">endian :: Endianness
</span><a href="#local-6989586621679158598"><span class="hs-identifier hs-var hs-var">endian</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffHeader -&gt; Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var hs-var">hdrEndianness</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158599"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><span class="annottext">Endianness -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158598"><span class="hs-identifier hs-var">endian</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Endianness -&gt; Word16 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158598"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">42</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158598"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Put) -&gt; Word32 -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TiffHeader -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrOffset"><span class="hs-identifier hs-var hs-var">hdrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158599"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>  </span><span id="local-6989586621679158597"><span class="annot"><span class="annottext">get :: Get TiffHeader
</span><a href="#local-6989586621679158597"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679158596"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var">endian</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Endianness
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679158595"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158595"><span class="hs-identifier hs-var">magic</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word16
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var">endian</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158594"><span class="annot"><span class="annottext">magicValue :: Word16
</span><a href="#local-6989586621679158594"><span class="hs-identifier hs-var hs-var">magicValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">42</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Get () -&gt; Get ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158595"><span class="hs-identifier hs-var">magic</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158594"><span class="hs-identifier hs-var">magicValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Get ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid TIFF magic number&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; TiffHeader
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier hs-var">TiffHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; TiffHeader) -&gt; Get Word32 -&gt; Get TiffHeader
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158596"><span class="hs-identifier hs-var">endian</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">data</span><span> </span><span id="TiffPlanarConfiguration"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPlanarConfiguration"><span class="hs-identifier hs-var">TiffPlanarConfiguration</span></a></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PlanarConfigContig"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-var">PlanarConfigContig</span></a></span></span><span>    </span><span class="hs-comment">-- = 1</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PlanarConfigSeparate"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigSeparate"><span class="hs-identifier hs-var">PlanarConfigSeparate</span></a></span></span><span>  </span><span class="hs-comment">-- = 2</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier hs-type">planarConfgOfConstant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPlanarConfiguration"><span class="hs-identifier hs-type">TiffPlanarConfiguration</span></a></span><span>
</span><span id="line-128"></span><span id="planarConfgOfConstant"><span class="annot"><span class="annottext">planarConfgOfConstant :: Word32 -&gt; Get TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier hs-var hs-var">planarConfgOfConstant</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration -&gt; Get TiffPlanarConfiguration
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-var">PlanarConfigContig</span></a></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier hs-var">planarConfgOfConstant</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration -&gt; Get TiffPlanarConfiguration
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-var">PlanarConfigContig</span></a></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier hs-var">planarConfgOfConstant</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration -&gt; Get TiffPlanarConfiguration
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigSeparate"><span class="hs-identifier hs-var">PlanarConfigSeparate</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#planarConfgOfConstant"><span class="hs-identifier hs-var">planarConfgOfConstant</span></a></span><span> </span><span id="local-6989586621679158590"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158590"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get TiffPlanarConfiguration
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get TiffPlanarConfiguration)
-&gt; String -&gt; Get TiffPlanarConfiguration
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown planar constant (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158590"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#constantToPlaneConfiguration"><span class="hs-identifier hs-type">constantToPlaneConfiguration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPlanarConfiguration"><span class="hs-identifier hs-type">TiffPlanarConfiguration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-134"></span><span id="constantToPlaneConfiguration"><span class="annot"><span class="annottext">constantToPlaneConfiguration :: TiffPlanarConfiguration -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#constantToPlaneConfiguration"><span class="hs-identifier hs-var hs-var">constantToPlaneConfiguration</span></a></span></span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigContig"><span class="hs-identifier hs-var">PlanarConfigContig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#constantToPlaneConfiguration"><span class="hs-identifier hs-var">constantToPlaneConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">TiffPlanarConfiguration
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PlanarConfigSeparate"><span class="hs-identifier hs-var">PlanarConfigSeparate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">data</span><span> </span><span id="TiffCompression"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCompression"><span class="hs-identifier hs-var">TiffCompression</span></a></span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CompressionNone"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionNone"><span class="hs-identifier hs-var">CompressionNone</span></a></span></span><span>           </span><span class="hs-comment">-- 1</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CompressionModifiedRLE"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionModifiedRLE"><span class="hs-identifier hs-var">CompressionModifiedRLE</span></a></span></span><span>    </span><span class="hs-comment">-- 2</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CompressionLZW"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionLZW"><span class="hs-identifier hs-var">CompressionLZW</span></a></span></span><span>            </span><span class="hs-comment">-- 5</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CompressionJPEG"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionJPEG"><span class="hs-identifier hs-var">CompressionJPEG</span></a></span></span><span>           </span><span class="hs-comment">-- 6</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CompressionPackBit"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionPackBit"><span class="hs-identifier hs-var">CompressionPackBit</span></a></span></span><span>        </span><span class="hs-comment">-- 32273</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">data</span><span> </span><span id="IfdType"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#IfdType"><span class="hs-identifier hs-var">IfdType</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TypeByte"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeByte"><span class="hs-identifier hs-var">TypeByte</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeAscii"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeAscii"><span class="hs-identifier hs-var">TypeAscii</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeShort"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeLong"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeRational"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeRational"><span class="hs-identifier hs-var">TypeRational</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeSByte"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSByte"><span class="hs-identifier hs-var">TypeSByte</span></a></span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeUndefined"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeUndefined"><span class="hs-identifier hs-var">TypeUndefined</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeSignedShort"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedShort"><span class="hs-identifier hs-var">TypeSignedShort</span></a></span></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeSignedLong"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedLong"><span class="hs-identifier hs-var">TypeSignedLong</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeSignedRational"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedRational"><span class="hs-identifier hs-var">TypeSignedRational</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeFloat"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeFloat"><span class="hs-identifier hs-var">TypeFloat</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeDouble"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TypeDouble"><span class="hs-identifier hs-var">TypeDouble</span></a></span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679158566"><span id="local-6989586621679158568"><span id="local-6989586621679158570"><span class="annot"><span class="annottext">Int -&gt; IfdType -&gt; ShowS
[IfdType] -&gt; ShowS
IfdType -&gt; String
(Int -&gt; IfdType -&gt; ShowS)
-&gt; (IfdType -&gt; String) -&gt; ([IfdType] -&gt; ShowS) -&gt; Show IfdType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [IfdType] -&gt; ShowS
$cshowList :: [IfdType] -&gt; ShowS
show :: IfdType -&gt; String
$cshow :: IfdType -&gt; String
showsPrec :: Int -&gt; IfdType -&gt; ShowS
$cshowsPrec :: Int -&gt; IfdType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#IfdType"><span class="hs-identifier hs-type">IfdType</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679158563"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get IfdType
</span><a href="#local-6989586621679158563"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679158562"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158562"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word16
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158562"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word16 -&gt; (Word16 -&gt; Get IfdType) -&gt; Get IfdType
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Get IfdType
</span><a href="#local-6989586621679158561"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><a href="#local-6989586621679158561"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#IfdType"><span class="hs-identifier hs-type">IfdType</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span id="local-6989586621679158561"><span class="annot"><span class="annottext">conv :: Word16 -&gt; Get IfdType
</span><a href="#local-6989586621679158561"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621679158560"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158560"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158560"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeByte"><span class="hs-identifier hs-var">TypeByte</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeAscii"><span class="hs-identifier hs-var">TypeAscii</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">3</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">4</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">5</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeRational"><span class="hs-identifier hs-var">TypeRational</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">6</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSByte"><span class="hs-identifier hs-var">TypeSByte</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">7</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeUndefined"><span class="hs-identifier hs-var">TypeUndefined</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">8</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedShort"><span class="hs-identifier hs-var">TypeSignedShort</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">9</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedLong"><span class="hs-identifier hs-var">TypeSignedLong</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedRational"><span class="hs-identifier hs-var">TypeSignedRational</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">11</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeFloat"><span class="hs-identifier hs-var">TypeFloat</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">12</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Get IfdType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeDouble"><span class="hs-identifier hs-var">TypeDouble</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get IfdType
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid TIF directory type&quot;</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679158559"><span class="annot"><span class="annottext">putP :: Endianness -&gt; IfdType -&gt; Put
</span><a href="#local-6989586621679158559"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679158558"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158558"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Word16 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158558"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Put) -&gt; (IfdType -&gt; Word16) -&gt; IfdType -&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; Word16
</span><a href="#local-6989586621679158556"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><a href="#local-6989586621679158556"><span class="hs-identifier hs-type">conv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#IfdType"><span class="hs-identifier hs-type">IfdType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621679158556"><span class="annot"><span class="annottext">conv :: IfdType -&gt; Word16
</span><a href="#local-6989586621679158556"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621679158555"><span class="annot"><span class="annottext">IfdType
</span><a href="#local-6989586621679158555"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="#local-6989586621679158555"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeByte"><span class="hs-identifier hs-var">TypeByte</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeAscii"><span class="hs-identifier hs-var">TypeAscii</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">3</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">4</span></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeRational"><span class="hs-identifier hs-var">TypeRational</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">5</span></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSByte"><span class="hs-identifier hs-var">TypeSByte</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">6</span></span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeUndefined"><span class="hs-identifier hs-var">TypeUndefined</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">7</span></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedShort"><span class="hs-identifier hs-var">TypeSignedShort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">8</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedLong"><span class="hs-identifier hs-var">TypeSignedLong</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">9</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedRational"><span class="hs-identifier hs-var">TypeSignedRational</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">10</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeFloat"><span class="hs-identifier hs-var">TypeFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">11</span></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeDouble"><span class="hs-identifier hs-var">TypeDouble</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">12</span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679158552"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get ExifTag
</span><a href="#local-6989586621679158552"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679158551"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158551"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#tagOfWord16"><span class="hs-identifier hs-var">tagOfWord16</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; ExifTag) -&gt; Get Word16 -&gt; Get ExifTag
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word16
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158551"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679158549"><span class="annot"><span class="annottext">putP :: Endianness -&gt; ExifTag -&gt; Put
</span><a href="#local-6989586621679158549"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679158548"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158548"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Word16 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158548"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Put) -&gt; (ExifTag -&gt; Word16) -&gt; ExifTag -&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; Word16
</span><a href="Codec.Picture.Metadata.Exif.html#word16OfTag"><span class="hs-identifier hs-var">word16OfTag</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">data</span><span> </span><span id="Predictor"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Predictor"><span class="hs-identifier hs-var">Predictor</span></a></span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PredictorNone"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#PredictorNone"><span class="hs-identifier hs-var">PredictorNone</span></a></span></span><span>                   </span><span class="hs-comment">-- 1</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PredictorHorizontalDifferencing"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#PredictorHorizontalDifferencing"><span class="hs-identifier hs-var">PredictorHorizontalDifferencing</span></a></span></span><span> </span><span class="hs-comment">-- 2</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679158542"><span id="local-6989586621679158544"><span class="annot"><span class="annottext">Predictor -&gt; Predictor -&gt; Bool
(Predictor -&gt; Predictor -&gt; Bool)
-&gt; (Predictor -&gt; Predictor -&gt; Bool) -&gt; Eq Predictor
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Predictor -&gt; Predictor -&gt; Bool
$c/= :: Predictor -&gt; Predictor -&gt; Bool
== :: Predictor -&gt; Predictor -&gt; Bool
$c== :: Predictor -&gt; Predictor -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#predictorOfConstant"><span class="hs-identifier hs-type">predictorOfConstant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Predictor"><span class="hs-identifier hs-type">Predictor</span></a></span><span>
</span><span id="line-203"></span><span id="predictorOfConstant"><span class="annot"><span class="annottext">predictorOfConstant :: Word32 -&gt; Get Predictor
</span><a href="Codec.Picture.Tiff.Internal.Types.html#predictorOfConstant"><span class="hs-identifier hs-var hs-var">predictorOfConstant</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predictor -&gt; Get Predictor
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Predictor
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PredictorNone"><span class="hs-identifier hs-var">PredictorNone</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#predictorOfConstant"><span class="hs-identifier hs-var">predictorOfConstant</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Predictor -&gt; Get Predictor
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Predictor
</span><a href="Codec.Picture.Tiff.Internal.Types.html#PredictorHorizontalDifferencing"><span class="hs-identifier hs-var">PredictorHorizontalDifferencing</span></a></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#predictorOfConstant"><span class="hs-identifier hs-var">predictorOfConstant</span></a></span><span> </span><span id="local-6989586621679158541"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158541"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get Predictor
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get Predictor) -&gt; String -&gt; Get Predictor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown predictor (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158541"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#paddWrite"><span class="hs-identifier hs-type">paddWrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span><span>
</span><span id="line-208"></span><span id="paddWrite"><span class="annot"><span class="annottext">paddWrite :: ByteString -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#paddWrite"><span class="hs-identifier hs-var hs-var">paddWrite</span></a></span></span><span> </span><span id="local-6989586621679158539"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158539"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><span class="hs-identifier hs-var">putByteString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158539"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Put
</span><a href="#local-6989586621679158538"><span class="hs-identifier hs-var">padding</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679158537"><span class="annot"><span class="annottext">zero :: Word8
</span><a href="#local-6989586621679158537"><span class="hs-identifier hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679158538"><span class="annot"><span class="annottext">padding :: Put
</span><a href="#local-6989586621679158538"><span class="hs-identifier hs-var hs-var">padding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Put -&gt; Put
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158539"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Put -&gt; Put) -&gt; Put -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679158537"><span class="hs-identifier hs-var">zero</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifData"><span class="hs-identifier hs-type">ExifData</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679158532"><span class="annot"><span class="annottext">putP :: (Endianness, Int, ImageFileDirectory) -&gt; ExifData -&gt; Put
</span><a href="#local-6989586621679158532"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158531"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifData -&gt; Put
</span><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>      </span><span id="local-6989586621679158530"><span class="annot"><span class="annottext">dump :: ExifData -&gt; Put
</span><a href="#local-6989586621679158530"><span class="hs-identifier hs-var hs-var">dump</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifLong"><span class="hs-identifier hs-type">ExifLong</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifShort"><span class="hs-identifier hs-type">ExifShort</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifIFD"><span class="hs-identifier hs-type">ExifIFD</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExifTag, ExifData)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Put
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifString"><span class="hs-identifier hs-type">ExifString</span></a></span><span> </span><span id="local-6989586621679158524"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158524"><span class="hs-identifier hs-var">bstr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#paddWrite"><span class="hs-identifier hs-var">paddWrite</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158524"><span class="hs-identifier hs-var">bstr</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifUndefined"><span class="hs-identifier hs-type">ExifUndefined</span></a></span><span> </span><span id="local-6989586621679158522"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158522"><span class="hs-identifier hs-var">bstr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#paddWrite"><span class="hs-identifier hs-var">paddWrite</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158522"><span class="hs-identifier hs-var">bstr</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">-- wrong if length == 2</span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-type">ExifShorts</span></a></span><span> </span><span id="local-6989586621679158520"><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679158520"><span class="hs-identifier hs-var">shorts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; Put) -&gt; Vector Word16 -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Vector a -&gt; m ()
</span><span class="hs-identifier hs-var">V.mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness -&gt; Word16 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679158520"><span class="hs-identifier hs-var">shorts</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifLongs"><span class="hs-identifier hs-type">ExifLongs</span></a></span><span> </span><span id="local-6989586621679158517"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679158517"><span class="hs-identifier hs-var">longs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Put) -&gt; Vector Word32 -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; Vector a -&gt; m ()
</span><span class="hs-identifier hs-var">V.mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679158517"><span class="hs-identifier hs-var">longs</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifRational"><span class="hs-identifier hs-type">ExifRational</span></a></span><span> </span><span id="local-6989586621679158515"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158515"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679158514"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158514"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158514"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="annot"><a href="#local-6989586621679158530"><span class="hs-identifier hs-var">dump</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifSignedRational"><span class="hs-identifier hs-type">ExifSignedRational</span></a></span><span> </span><span id="local-6989586621679158512"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679158512"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679158511"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679158511"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Int32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679158512"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Int32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158531"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679158511"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679158510"><span class="annot"><span class="annottext">getP :: (Endianness, Int, ImageFileDirectory) -&gt; Get ExifData
</span><a href="#local-6989586621679158510"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158509"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158509"><span class="hs-identifier hs-var">endianness</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158508"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158508"><span class="hs-identifier hs-var">maxi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158507"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData
</span><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>      </span><span id="local-6989586621679158505"><span class="annot"><span class="annottext">align :: ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var hs-var">align</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158502"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158502"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679158501"><span class="annot"><span class="annottext">Get ExifData
</span><a href="#local-6989586621679158501"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>        </span><span id="local-6989586621679158500"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679158500"><span class="hs-identifier hs-var">readed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int64
</span><span class="hs-identifier hs-var">bytesRead</span></span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158499"><span class="annot"><span class="annottext">delta :: Int64
</span><a href="#local-6989586621679158499"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158502"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679158500"><span class="hs-identifier hs-var">readed</span></a></span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158502"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158508"><span class="hs-identifier hs-var">maxi</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679158500"><span class="hs-identifier hs-var">readed</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158502"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-233"></span><span>          </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Get ()
</span><span class="hs-identifier hs-var">skip</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Get ()) -&gt; Int -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679158499"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-236"></span><span>          </span><span class="annot"><span class="annottext">Get ExifData
</span><a href="#local-6989586621679158501"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621679158721"><span class="annot"><a href="#local-6989586621679158496"><span class="hs-identifier hs-type">getE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="#local-6989586621679158721"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-239"></span><span>      </span><span id="local-6989586621679158496"><span class="annot"><span class="annottext">getE :: Get a
</span><a href="#local-6989586621679158496"><span class="hs-identifier hs-var hs-var">getE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get a
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158509"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>      </span><span id="local-6989586621679158495"><span class="annot"><span class="annottext">getVec :: a -&gt; m a -&gt; m (Vector a)
</span><a href="#local-6989586621679158495"><span class="hs-identifier hs-var hs-var">getVec</span></a></span></span><span> </span><span id="local-6989586621679158494"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679158494"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; m a -&gt; m (Vector a)
forall (m :: * -&gt; *) a. Monad m =&gt; Int -&gt; m a -&gt; m (Vector a)
</span><span class="hs-identifier hs-var">V.replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679158494"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>      </span><span id="local-6989586621679158506"><span class="annot"><span class="annottext">fetcher :: ImageFileDirectory -&gt; Get ExifData
</span><a href="#local-6989586621679158506"><span class="hs-identifier hs-var hs-var">fetcher</span></a></span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdIdentifier :: ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var">ifdIdentifier</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagExifOffset"><span class="hs-identifier hs-var">TagExifOffset</span></a></span><span>
</span><span id="line-244"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span>
</span><span id="line-245"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>         </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158488"><span class="annot"><span class="annottext">byOffset :: [ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158488"><span class="hs-identifier hs-var hs-var">byOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; ImageFileDirectory -&gt; Ordering)
-&gt; [ImageFileDirectory] -&gt; [ImageFileDirectory]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32 -&gt; Ordering)
-&gt; (ImageFileDirectory -&gt; Word32)
-&gt; ImageFileDirectory
-&gt; ImageFileDirectory
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                </span><span id="local-6989586621679158486"><span class="annot"><span class="annottext">cleansIfds :: [ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158486"><span class="hs-identifier hs-var hs-var">cleansIfds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; ImageFileDirectory)
-&gt; [ImageFileDirectory] -&gt; [ImageFileDirectory]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness -&gt; ImageFileDirectory -&gt; ImageFileDirectory
</span><a href="Codec.Picture.Tiff.Internal.Types.html#cleanImageFileDirectory"><span class="hs-identifier hs-var">cleanImageFileDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158509"><span class="hs-identifier hs-var">endianness</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>            </span><span id="local-6989586621679158484"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158484"><span class="hs-identifier hs-var">subIfds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158486"><span class="hs-identifier hs-var">cleansIfds</span></a></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; [ImageFileDirectory])
-&gt; ([ImageFileDirectory] -&gt; [ImageFileDirectory])
-&gt; [ImageFileDirectory]
-&gt; [ImageFileDirectory]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158488"><span class="hs-identifier hs-var">byOffset</span></a></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; [ImageFileDirectory])
-&gt; Get [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get [ImageFileDirectory]
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158509"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-250"></span><span>            </span><span id="local-6989586621679158483"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158483"><span class="hs-identifier hs-var">cleaned</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Endianness
-&gt; Int -&gt; [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
</span><a href="Codec.Picture.Tiff.Internal.Types.html#fetchExtended"><span class="hs-identifier hs-var">fetchExtended</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158509"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158508"><span class="hs-identifier hs-var">maxi</span></a></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; Get [ImageFileDirectory])
-&gt; [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; ImageFileDirectory -&gt; Ordering)
-&gt; [ImageFileDirectory] -&gt; [ImageFileDirectory]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32 -&gt; Ordering)
-&gt; (ImageFileDirectory -&gt; Word32)
-&gt; ImageFileDirectory
-&gt; ImageFileDirectory
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158484"><span class="hs-identifier hs-var">subIfds</span></a></span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData) -&gt; ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ExifTag, ExifData)] -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifIFD"><span class="hs-identifier hs-var">ExifIFD</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158481"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var hs-var">ifdExtended</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158481"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679158481"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158481"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158483"><span class="hs-identifier hs-var">cleaned</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span>         </span><span class="hs-comment">{-  
      fetcher ImageFileDirectory { ifdIdentifier = TagGPSInfo
                                 , ifdType = TypeLong
                                 , ifdCount = 1 } = do
         align ifd 
         subIfds &lt;- fmap (cleanImageFileDirectory endianness) &lt;$&gt; getP endianness
         cleaned &lt;- fetchExtended endianness subIfds
         pure $ ExifIFD [(ifdIdentifier fd, ifdExtended fd) | fd &lt;- cleaned]
        -}</span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeUndefined"><span class="hs-identifier hs-var">TypeUndefined</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158479"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158479"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158479"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>         </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifUndefined"><span class="hs-identifier hs-var">ExifUndefined</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ExifData) -&gt; Get ByteString -&gt; Get ExifData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158479"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeUndefined"><span class="hs-identifier hs-var">TypeUndefined</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158478"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158478"><span class="hs-identifier hs-var">ofs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>          </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData)
-&gt; ([Word8] -&gt; ExifData) -&gt; [Word8] -&gt; Get ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifUndefined"><span class="hs-identifier hs-var">ExifUndefined</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ExifData)
-&gt; ([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Get ExifData) -&gt; [Word8] -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word8] -&gt; [Word8]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Int) -&gt; Word32 -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var hs-var">ifdCount</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word8) -&gt; Word32 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158478"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFF000000</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word8) -&gt; Word32 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158478"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0x00FF0000</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word8) -&gt; Word32 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158478"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0x0000FF00</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>              </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Word32 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word8) -&gt; Word32 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158478"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0x000000FF</span></span><span>
</span><span id="line-269"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeAscii"><span class="hs-identifier hs-var">TypeAscii</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158474"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158474"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158474"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifString"><span class="hs-identifier hs-var">ExifString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ExifData) -&gt; Get ByteString -&gt; Get ExifData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ByteString
</span><span class="hs-identifier hs-var">getByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158474"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158473"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158473"><span class="hs-identifier hs-var">ofs</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>          </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData)
-&gt; (Vector Word16 -&gt; ExifData) -&gt; Vector Word16 -&gt; Get ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-var">ExifShorts</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word16 -&gt; Get ExifData) -&gt; Vector Word16 -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word16] -&gt; Vector Word16
forall a. Int -&gt; [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromListN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">[Word16]
</span><a href="#local-6989586621679158471"><span class="hs-identifier hs-var">valList</span></a></span><span>
</span><span id="line-274"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158470"><span class="annot"><span class="annottext">high :: Word16
</span><a href="#local-6989586621679158470"><span class="hs-identifier hs-var hs-var">high</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word16) -&gt; Word32 -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158473"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-275"></span><span>                  </span><span id="local-6989586621679158469"><span class="annot"><span class="annottext">low :: Word16
</span><a href="#local-6989586621679158469"><span class="hs-identifier hs-var hs-var">low</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word16) -&gt; Word32 -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158473"><span class="hs-identifier hs-var">ofs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0xFFFF</span></span><span>
</span><span id="line-276"></span><span>                  </span><span id="local-6989586621679158471"><span class="annot"><span class="annottext">valList :: [Word16]
</span><a href="#local-6989586621679158471"><span class="hs-identifier hs-var hs-var">valList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158509"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-277"></span><span>                    </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158469"><span class="hs-identifier hs-var">low</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158470"><span class="hs-identifier hs-var">high</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>                    </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158470"><span class="hs-identifier hs-var">high</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158469"><span class="hs-identifier hs-var">low</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeRational"><span class="hs-identifier hs-var">TypeRational</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifRational"><span class="hs-identifier hs-var">ExifRational</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32 -&gt; ExifData)
-&gt; Get Word32 -&gt; Get (Word32 -&gt; ExifData)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Word32 -&gt; ExifData) -&gt; Get Word32 -&gt; Get ExifData
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeSignedRational"><span class="hs-identifier hs-var">TypeSignedRational</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>          </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifSignedRational"><span class="hs-identifier hs-var">ExifSignedRational</span></a></span><span> </span><span class="annot"><span class="annottext">(Int32 -&gt; Int32 -&gt; ExifData)
-&gt; Get Int32 -&gt; Get (Int32 -&gt; ExifData)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Int32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Int32 -&gt; ExifData) -&gt; Get Int32 -&gt; Get ExifData
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Int32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianLittle"><span class="hs-identifier hs-var">EndianLittle</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>          </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData)
-&gt; (Word32 -&gt; ExifData) -&gt; Word32 -&gt; Get ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifShort"><span class="hs-identifier hs-var">ExifShort</span></a></span><span> </span><span class="annot"><span class="annottext">(Word16 -&gt; ExifData) -&gt; (Word32 -&gt; Word16) -&gt; Word32 -&gt; ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Get ExifData) -&gt; Word32 -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158468"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158468"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158468"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>          </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-var">ExifShorts</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word16 -&gt; ExifData) -&gt; Get (Vector Word16) -&gt; Get ExifData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get Word16 -&gt; Get (Vector Word16)
forall (m :: * -&gt; *) a a.
(Monad m, Integral a) =&gt;
a -&gt; m a -&gt; m (Vector a)
</span><a href="#local-6989586621679158495"><span class="hs-identifier hs-var">getVec</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158468"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word16
forall a. BinaryParam Endianness a =&gt; Get a
</span><a href="#local-6989586621679158496"><span class="hs-identifier hs-var">getE</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>          </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Get ExifData)
-&gt; (Word32 -&gt; ExifData) -&gt; Word32 -&gt; Get ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifLong"><span class="hs-identifier hs-var">ExifLong</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; ExifData) -&gt; (Word32 -&gt; Word32) -&gt; Word32 -&gt; ExifData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Get ExifData) -&gt; Word32 -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdType :: ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var">ifdType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeLong"><span class="hs-identifier hs-var">TypeLong</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679158467"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158467"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158467"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ExifData -&gt; Get ExifData
</span><a href="#local-6989586621679158505"><span class="hs-identifier hs-var">align</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158507"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">(Get ExifData -&gt; Get ExifData) -&gt; Get ExifData -&gt; Get ExifData
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifLongs"><span class="hs-identifier hs-var">ExifLongs</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector Word32 -&gt; ExifData) -&gt; Get (Vector Word32) -&gt; Get ExifData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Get Word32 -&gt; Get (Vector Word32)
forall (m :: * -&gt; *) a a.
(Monad m, Integral a) =&gt;
a -&gt; m a -&gt; m (Vector a)
</span><a href="#local-6989586621679158495"><span class="hs-identifier hs-var">getVec</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158467"><span class="hs-identifier hs-var">count</span></a></span><span> </span><span class="annot"><span class="annottext">Get Word32
forall a. BinaryParam Endianness a =&gt; Get a
</span><a href="#local-6989586621679158496"><span class="hs-identifier hs-var">getE</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="#local-6989586621679158506"><span class="hs-identifier hs-var">fetcher</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#cleanImageFileDirectory"><span class="hs-identifier hs-type">cleanImageFileDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span>
</span><span id="line-294"></span><span id="cleanImageFileDirectory"><span class="annot"><span class="annottext">cleanImageFileDirectory :: Endianness -&gt; ImageFileDirectory -&gt; ImageFileDirectory
</span><a href="Codec.Picture.Tiff.Internal.Types.html#cleanImageFileDirectory"><span class="hs-identifier hs-var hs-var">cleanImageFileDirectory</span></a></span></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#EndianBig"><span class="hs-identifier hs-var">EndianBig</span></a></span><span> </span><span id="local-6989586621679158466"><span class="annot"><span class="annottext">ifd :: ImageFileDirectory
</span><a href="#local-6989586621679158466"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdCount :: ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var">ifdCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfdType -&gt; ImageFileDirectory
</span><a href="#local-6989586621679158465"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">(IfdType -&gt; ImageFileDirectory) -&gt; IfdType -&gt; ImageFileDirectory
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var hs-var">ifdType</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158466"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679158465"><span class="annot"><span class="annottext">aux :: IfdType -&gt; ImageFileDirectory
</span><a href="#local-6989586621679158465"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TypeShort"><span class="hs-identifier hs-var">TypeShort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158466"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158466"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="#local-6989586621679158465"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">IfdType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158466"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-298"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#cleanImageFileDirectory"><span class="hs-identifier hs-var">cleanImageFileDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679158464"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158464"><span class="hs-identifier hs-var">ifd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158464"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#fetchExtended"><span class="hs-identifier hs-type">fetchExtended</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span id="fetchExtended"><span class="annot"><span class="annottext">fetchExtended :: Endianness
-&gt; Int -&gt; [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
</span><a href="Codec.Picture.Tiff.Internal.Types.html#fetchExtended"><span class="hs-identifier hs-var hs-var">fetchExtended</span></a></span></span><span> </span><span id="local-6989586621679158463"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158463"><span class="hs-identifier hs-var">endian</span></a></span></span><span> </span><span id="local-6989586621679158462"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158462"><span class="hs-identifier hs-var">maxi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Get ImageFileDirectory)
-&gt; [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">((ImageFileDirectory -&gt; Get ImageFileDirectory)
 -&gt; [ImageFileDirectory] -&gt; Get [ImageFileDirectory])
-&gt; (ImageFileDirectory -&gt; Get ImageFileDirectory)
-&gt; [ImageFileDirectory]
-&gt; Get [ImageFileDirectory]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679158460"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158460"><span class="hs-identifier hs-var">ifd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621679158459"><span class="annot"><span class="annottext">ExifData
</span><a href="#local-6989586621679158459"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Endianness, Int, ImageFileDirectory) -&gt; Get ExifData
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158463"><span class="hs-identifier hs-var">endian</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158462"><span class="hs-identifier hs-var">maxi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158460"><span class="hs-identifier hs-var">ifd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Get ImageFileDirectory
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Get ImageFileDirectory)
-&gt; ImageFileDirectory -&gt; Get ImageFileDirectory
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158460"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="#local-6989586621679158459"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | All the IFD must be written in order according to the tag</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- value of the IFD. To avoid getting to much restriction in the</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- serialization code, just sort it.</span><span>
</span><span id="line-308"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#orderIfdByTag"><span class="hs-identifier hs-type">orderIfdByTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span id="orderIfdByTag"><span class="annot"><span class="annottext">orderIfdByTag :: [ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="Codec.Picture.Tiff.Internal.Types.html#orderIfdByTag"><span class="hs-identifier hs-var hs-var">orderIfdByTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; ImageFileDirectory -&gt; Ordering)
-&gt; [ImageFileDirectory] -&gt; [ImageFileDirectory]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ImageFileDirectory -&gt; Ordering
</span><a href="#local-6989586621679158457"><span class="hs-identifier hs-var">comparer</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679158457"><span class="annot"><span class="annottext">comparer :: ImageFileDirectory -&gt; ImageFileDirectory -&gt; Ordering
</span><a href="#local-6989586621679158457"><span class="hs-identifier hs-var hs-var">comparer</span></a></span></span><span> </span><span id="local-6989586621679158456"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158456"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679158455"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158455"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158454"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158453"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679158454"><span class="annot"><span class="annottext">t1 :: Word16
</span><a href="#local-6989586621679158454"><span class="hs-identifier hs-var hs-var">t1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; Word16
</span><a href="Codec.Picture.Metadata.Exif.html#word16OfTag"><span class="hs-identifier hs-var">word16OfTag</span></a></span><span> </span><span class="annot"><span class="annottext">(ExifTag -&gt; Word16) -&gt; ExifTag -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158456"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679158453"><span class="annot"><span class="annottext">t2 :: Word16
</span><a href="#local-6989586621679158453"><span class="hs-identifier hs-var hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag -&gt; Word16
</span><a href="Codec.Picture.Metadata.Exif.html#word16OfTag"><span class="hs-identifier hs-var">word16OfTag</span></a></span><span> </span><span class="annot"><span class="annottext">(ExifTag -&gt; Word16) -&gt; ExifTag -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158455"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Given an official offset and a list of IFD, update the offset information</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- of the IFD with extended data.</span><span>
</span><span id="line-316"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#setupIfdOffsets"><span class="hs-identifier hs-type">setupIfdOffsets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span id="setupIfdOffsets"><span class="annot"><span class="annottext">setupIfdOffsets :: Word32 -&gt; [ImageFileDirectory] -&gt; (Word32, [ImageFileDirectory])
</span><a href="Codec.Picture.Tiff.Internal.Types.html#setupIfdOffsets"><span class="hs-identifier hs-var hs-var">setupIfdOffsets</span></a></span></span><span> </span><span id="local-6989586621679158451"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158451"><span class="hs-identifier hs-var">initialOffset</span></a></span></span><span> </span><span id="local-6989586621679158450"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158450"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; ImageFileDirectory -&gt; (Word32, ImageFileDirectory))
-&gt; Word32 -&gt; [ImageFileDirectory] -&gt; (Word32, [ImageFileDirectory])
forall (t :: * -&gt; *) a b c.
Traversable t =&gt;
(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)
</span><span class="hs-identifier hs-var">mapAccumL</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; ImageFileDirectory -&gt; (Word32, ImageFileDirectory)
</span><a href="#local-6989586621679158449"><span class="hs-identifier hs-var">updater</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158448"><span class="hs-identifier hs-var">startExtended</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158450"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158447"><span class="annot"><span class="annottext">ifdElementCount :: Word32
</span><a href="#local-6989586621679158447"><span class="hs-identifier hs-var hs-var">ifdElementCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158450"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621679158445"><span class="annot"><span class="annottext">ifdSize :: Word32
</span><a href="#local-6989586621679158445"><span class="hs-identifier hs-var hs-var">ifdSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">12</span></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621679158444"><span class="annot"><span class="annottext">ifdCountSize :: Word32
</span><a href="#local-6989586621679158444"><span class="hs-identifier hs-var hs-var">ifdCountSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621679158443"><span class="annot"><span class="annottext">nextOffsetSize :: Word32
</span><a href="#local-6989586621679158443"><span class="hs-identifier hs-var hs-var">nextOffsetSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679158448"><span class="annot"><span class="annottext">startExtended :: Word32
</span><a href="#local-6989586621679158448"><span class="hs-identifier hs-var hs-var">startExtended</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158451"><span class="hs-identifier hs-var">initialOffset</span></a></span><span>
</span><span id="line-323"></span><span>                     </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158447"><span class="hs-identifier hs-var">ifdElementCount</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158445"><span class="hs-identifier hs-var">ifdSize</span></a></span><span>
</span><span id="line-324"></span><span>                     </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158444"><span class="hs-identifier hs-var">ifdCountSize</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158443"><span class="hs-identifier hs-var">nextOffsetSize</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>        </span><span id="local-6989586621679158441"><span class="annot"><span class="annottext">paddedSize :: ByteString -&gt; b
</span><a href="#local-6989586621679158441"><span class="hs-identifier hs-var hs-var">paddedSize</span></a></span></span><span> </span><span id="local-6989586621679158440"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158440"><span class="hs-identifier hs-var">blob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; b
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; b) -&gt; Int -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158439"><span class="hs-identifier hs-var">blobLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158438"><span class="hs-identifier hs-var">padding</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>          </span><span id="local-6989586621679158439"><span class="annot"><span class="annottext">blobLength :: Int
</span><a href="#local-6989586621679158439"><span class="hs-identifier hs-var hs-var">blobLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158440"><span class="hs-identifier hs-var">blob</span></a></span><span>
</span><span id="line-328"></span><span>          </span><span id="local-6989586621679158438"><span class="annot"><span class="annottext">padding :: Int
</span><a href="#local-6989586621679158438"><span class="hs-identifier hs-var hs-var">padding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679158439"><span class="hs-identifier hs-var">blobLength</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621679158449"><span class="annot"><span class="annottext">updater :: Word32 -&gt; ImageFileDirectory -&gt; (Word32, ImageFileDirectory)
</span><a href="#local-6989586621679158449"><span class="hs-identifier hs-var hs-var">updater</span></a></span></span><span> </span><span id="local-6989586621679158437"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158437"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158436"><span class="annot"><span class="annottext">ifd :: ImageFileDirectory
</span><a href="#local-6989586621679158436"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdIdentifier :: ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var">ifdIdentifier</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExifTag
</span><a href="Codec.Picture.Metadata.Exif.html#TagExifOffset"><span class="hs-identifier hs-var">TagExifOffset</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158437"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158436"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158437"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><a href="#local-6989586621679158449"><span class="hs-identifier hs-var">updater</span></a></span><span> </span><span id="local-6989586621679158435"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158435"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158434"><span class="annot"><span class="annottext">ifd :: ImageFileDirectory
</span><a href="#local-6989586621679158434"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifUndefined"><span class="hs-identifier hs-type">ExifUndefined</span></a></span><span> </span><span id="local-6989586621679158433"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158433"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158435"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word32
forall b. Num b =&gt; ByteString -&gt; b
</span><a href="#local-6989586621679158441"><span class="hs-identifier hs-var">paddedSize</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158433"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158434"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158435"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><a href="#local-6989586621679158449"><span class="hs-identifier hs-var">updater</span></a></span><span> </span><span id="local-6989586621679158432"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158432"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158431"><span class="annot"><span class="annottext">ifd :: ImageFileDirectory
</span><a href="#local-6989586621679158431"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifString"><span class="hs-identifier hs-type">ExifString</span></a></span><span> </span><span id="local-6989586621679158430"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158430"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-335"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158432"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word32
forall b. Num b =&gt; ByteString -&gt; b
</span><a href="#local-6989586621679158441"><span class="hs-identifier hs-var">paddedSize</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158430"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158431"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158432"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><a href="#local-6989586621679158449"><span class="hs-identifier hs-var">updater</span></a></span><span> </span><span id="local-6989586621679158429"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158429"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158428"><span class="annot"><span class="annottext">ifd :: ImageFileDirectory
</span><a href="#local-6989586621679158428"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifLongs"><span class="hs-identifier hs-type">ExifLongs</span></a></span><span> </span><span id="local-6989586621679158427"><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679158427"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679158427"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158429"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word32 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word32
</span><a href="#local-6989586621679158427"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158428"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158429"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>        </span><span class="annot"><a href="#local-6989586621679158449"><span class="hs-identifier hs-var">updater</span></a></span><span> </span><span id="local-6989586621679158425"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158425"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158424"><span class="annot"><span class="annottext">ifd :: ImageFileDirectory
</span><a href="#local-6989586621679158424"><span class="hs-identifier hs-var">ifd</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdExtended :: ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var">ifdExtended</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifShorts"><span class="hs-identifier hs-type">ExifShorts</span></a></span><span> </span><span id="local-6989586621679158423"><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679158423"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Vector Word16 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679158423"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158425"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Word16 -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Word16
</span><a href="#local-6989586621679158423"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158424"><span class="hs-identifier hs-var">ifd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ifdOffset :: Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var">ifdOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158425"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><a href="#local-6989586621679158449"><span class="hs-identifier hs-var">updater</span></a></span><span> </span><span id="local-6989586621679158422"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158422"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158421"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158421"><span class="hs-identifier hs-var">ifd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158422"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158421"><span class="hs-identifier hs-var">ifd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffHeader"><span class="hs-identifier hs-type">TiffHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679158418"><span class="annot"><span class="annottext">putP :: ByteString -&gt; (TiffHeader, [[ImageFileDirectory]]) -&gt; Put
</span><a href="#local-6989586621679158418"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679158417"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158417"><span class="hs-identifier hs-var">rawData</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679158416"><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158416"><span class="hs-identifier hs-var">hdr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158415"><span class="annot"><span class="annottext">[[ImageFileDirectory]]
</span><a href="#local-6989586621679158415"><span class="hs-identifier hs-var">ifds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">TiffHeader -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158416"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><span class="hs-identifier hs-var">putByteString</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158417"><span class="hs-identifier hs-var">rawData</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158414"><span class="annot"><span class="annottext">endianness :: Endianness
</span><a href="#local-6989586621679158414"><span class="hs-identifier hs-var hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffHeader -&gt; Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var hs-var">hdrEndianness</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158416"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679158413"><span class="annot"><span class="annottext">[[ImageFileDirectory]]
</span><a href="#local-6989586621679158413"><span class="hs-identifier hs-var">offseted</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; [ImageFileDirectory] -&gt; (Word32, [ImageFileDirectory]))
-&gt; Word32
-&gt; [[ImageFileDirectory]]
-&gt; (Word32, [[ImageFileDirectory]])
forall (t :: * -&gt; *) a b c.
Traversable t =&gt;
(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)
</span><span class="hs-identifier hs-var">mapAccumL</span></span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679158412"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158412"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679158411"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158411"><span class="hs-identifier hs-var">ifd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; [ImageFileDirectory] -&gt; (Word32, [ImageFileDirectory])
</span><a href="Codec.Picture.Tiff.Internal.Types.html#setupIfdOffsets"><span class="hs-identifier hs-var">setupIfdOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158412"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; (Word32, [ImageFileDirectory]))
-&gt; [ImageFileDirectory] -&gt; (Word32, [ImageFileDirectory])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="Codec.Picture.Tiff.Internal.Types.html#orderIfdByTag"><span class="hs-identifier hs-var">orderIfdByTag</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158411"><span class="hs-identifier hs-var">ifd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffHeader -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrOffset"><span class="hs-identifier hs-var hs-var">hdrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158416"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>            </span><span class="annot"><span class="annottext">[[ImageFileDirectory]]
</span><a href="#local-6989586621679158415"><span class="hs-identifier hs-var">ifds</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">[[ImageFileDirectory]] -&gt; ([ImageFileDirectory] -&gt; Put) -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[[ImageFileDirectory]]
</span><a href="#local-6989586621679158413"><span class="hs-identifier hs-var">offseted</span></a></span><span> </span><span class="annot"><span class="annottext">(([ImageFileDirectory] -&gt; Put) -&gt; Put)
-&gt; ([ImageFileDirectory] -&gt; Put) -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679158410"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158410"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><span class="annottext">Endianness -&gt; [ImageFileDirectory] -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158414"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158410"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Put) -&gt; [ImageFileDirectory] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679158408"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158408"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Endianness, Int, ImageFileDirectory) -&gt; ExifData -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158414"><span class="hs-identifier hs-var">endianness</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158408"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ExifData -&gt; Put) -&gt; ExifData -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var hs-var">ifdExtended</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158408"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158410"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621679158407"><span class="annot"><span class="annottext">getP :: ByteString -&gt; Get (TiffHeader, [[ImageFileDirectory]])
</span><a href="#local-6989586621679158407"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679158406"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158406"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679158405"><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158405"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get TiffHeader
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621679158404"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679158404"><span class="hs-identifier hs-var">readed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Int64
</span><span class="hs-identifier hs-var">bytesRead</span></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Get ()
</span><span class="hs-identifier hs-var">skip</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Get ()) -&gt; (Int64 -&gt; Int) -&gt; Int64 -&gt; Get ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Get ()) -&gt; Int64 -&gt; Get ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffHeader -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrOffset"><span class="hs-identifier hs-var hs-var">hdrOffset</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158405"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679158404"><span class="hs-identifier hs-var">readed</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158403"><span class="annot"><span class="annottext">endian :: Endianness
</span><a href="#local-6989586621679158403"><span class="hs-identifier hs-var hs-var">endian</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiffHeader -&gt; Endianness
</span><a href="Codec.Picture.Tiff.Internal.Types.html#hdrEndianness"><span class="hs-identifier hs-var hs-var">hdrEndianness</span></a></span><span> </span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158405"><span class="hs-identifier hs-var">hdr</span></a></span><span>
</span><span id="line-362"></span><span>        </span><span id="local-6989586621679158402"><span class="annot"><span class="annottext">byOffset :: [ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158402"><span class="hs-identifier hs-var hs-var">byOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; ImageFileDirectory -&gt; Ordering)
-&gt; [ImageFileDirectory] -&gt; [ImageFileDirectory]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word32 -&gt; Ordering)
-&gt; (ImageFileDirectory -&gt; Word32)
-&gt; ImageFileDirectory
-&gt; ImageFileDirectory
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621679158401"><span class="annot"><span class="annottext">cleanIfds :: [ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158401"><span class="hs-identifier hs-var hs-var">cleanIfds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; ImageFileDirectory)
-&gt; [ImageFileDirectory] -&gt; [ImageFileDirectory]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness -&gt; ImageFileDirectory -&gt; ImageFileDirectory
</span><a href="Codec.Picture.Tiff.Internal.Types.html#cleanImageFileDirectory"><span class="hs-identifier hs-var">cleanImageFileDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158403"><span class="hs-identifier hs-var">endian</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>    </span><span id="local-6989586621679158400"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158400"><span class="hs-identifier hs-var">ifd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158401"><span class="hs-identifier hs-var">cleanIfds</span></a></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; [ImageFileDirectory])
-&gt; ([ImageFileDirectory] -&gt; [ImageFileDirectory])
-&gt; [ImageFileDirectory]
-&gt; [ImageFileDirectory]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; [ImageFileDirectory]
</span><a href="#local-6989586621679158402"><span class="hs-identifier hs-var">byOffset</span></a></span><span> </span><span class="annot"><span class="annottext">([ImageFileDirectory] -&gt; [ImageFileDirectory])
-&gt; Get [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get [ImageFileDirectory]
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158403"><span class="hs-identifier hs-var">endian</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621679158399"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158399"><span class="hs-identifier hs-var">cleaned</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Endianness
-&gt; Int -&gt; [ImageFileDirectory] -&gt; Get [ImageFileDirectory]
</span><a href="Codec.Picture.Tiff.Internal.Types.html#fetchExtended"><span class="hs-identifier hs-var">fetchExtended</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158403"><span class="hs-identifier hs-var">endian</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679158406"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158400"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">(TiffHeader, [[ImageFileDirectory]])
-&gt; Get (TiffHeader, [[ImageFileDirectory]])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TiffHeader
</span><a href="#local-6989586621679158405"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158399"><span class="hs-identifier hs-var">cleaned</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-keyword">data</span><span> </span><span id="TiffSampleFormat"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFormat"><span class="hs-identifier hs-var">TiffSampleFormat</span></a></span></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TiffSampleUint"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffSampleInt"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleInt"><span class="hs-identifier hs-var">TiffSampleInt</span></a></span></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffSampleFloat"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFloat"><span class="hs-identifier hs-var">TiffSampleFloat</span></a></span></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffSampleUnknown"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUnknown"><span class="hs-identifier hs-var">TiffSampleUnknown</span></a></span></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679158391"><span id="local-6989586621679158393"><span class="annot"><span class="annottext">TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
(TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool)
-&gt; (TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool)
-&gt; Eq TiffSampleFormat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
$c/= :: TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
== :: TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
$c== :: TiffSampleFormat -&gt; TiffSampleFormat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#unpackSampleFormat"><span class="hs-identifier hs-type">unpackSampleFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFormat"><span class="hs-identifier hs-type">TiffSampleFormat</span></a></span><span>
</span><span id="line-377"></span><span id="unpackSampleFormat"><span class="annot"><span class="annottext">unpackSampleFormat :: Word32 -&gt; Get TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#unpackSampleFormat"><span class="hs-identifier hs-var hs-var">unpackSampleFormat</span></a></span></span><span> </span><span id="local-6989586621679158390"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158390"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158390"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; Get TiffSampleFormat
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; Get TiffSampleFormat
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleInt"><span class="hs-identifier hs-var">TiffSampleInt</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; Get TiffSampleFormat
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFloat"><span class="hs-identifier hs-var">TiffSampleFloat</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat -&gt; Get TiffSampleFormat
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUnknown"><span class="hs-identifier hs-var">TiffSampleUnknown</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621679158389"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158389"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get TiffSampleFormat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get TiffSampleFormat) -&gt; String -&gt; Get TiffSampleFormat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Undefined data format (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158389"><span class="hs-identifier hs-var">vv</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier hs-type">packSampleFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFormat"><span class="hs-identifier hs-type">TiffSampleFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-385"></span><span id="packSampleFormat"><span class="annot"><span class="annottext">packSampleFormat :: TiffSampleFormat -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier hs-var hs-var">packSampleFormat</span></a></span></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUint"><span class="hs-identifier hs-var">TiffSampleUint</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-386"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier hs-var">packSampleFormat</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleInt"><span class="hs-identifier hs-var">TiffSampleInt</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span>
</span><span id="line-387"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier hs-var">packSampleFormat</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleFloat"><span class="hs-identifier hs-var">TiffSampleFloat</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">3</span></span><span>
</span><span id="line-388"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packSampleFormat"><span class="hs-identifier hs-var">packSampleFormat</span></a></span><span> </span><span class="annot"><span class="annottext">TiffSampleFormat
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffSampleUnknown"><span class="hs-identifier hs-var">TiffSampleUnknown</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-keyword">data</span><span> </span><span id="ImageFileDirectory"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-var">ImageFileDirectory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ImageFileDirectory"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-var">ImageFileDirectory</span></a></span></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ifdIdentifier"><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifTag"><span class="hs-identifier hs-type">ExifTag</span></a></span><span> </span><span class="hs-comment">-- Word16</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ifdType"><span class="annot"><span class="annottext">ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var hs-var">ifdType</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#IfdType"><span class="hs-identifier hs-type">IfdType</span></a></span><span> </span><span class="hs-comment">-- Word16</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ifdCount"><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var hs-var">ifdCount</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ifdOffset"><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ifdExtended"><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifData
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdExtended"><span class="hs-identifier hs-var hs-var">ifdExtended</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Codec.Picture.Metadata.Exif.html#ExifData"><span class="hs-identifier hs-type">ExifData</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679158383"><span id="local-6989586621679158385"><span id="local-6989586621679158387"><span class="annot"><span class="annottext">Int -&gt; ImageFileDirectory -&gt; ShowS
[ImageFileDirectory] -&gt; ShowS
ImageFileDirectory -&gt; String
(Int -&gt; ImageFileDirectory -&gt; ShowS)
-&gt; (ImageFileDirectory -&gt; String)
-&gt; ([ImageFileDirectory] -&gt; ShowS)
-&gt; Show ImageFileDirectory
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ImageFileDirectory] -&gt; ShowS
$cshowList :: [ImageFileDirectory] -&gt; ShowS
show :: ImageFileDirectory -&gt; String
$cshow :: ImageFileDirectory -&gt; String
showsPrec :: Int -&gt; ImageFileDirectory -&gt; ShowS
$cshowsPrec :: Int -&gt; ImageFileDirectory -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679158380"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get ImageFileDirectory
</span><a href="#local-6989586621679158380"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679158379"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158379"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">ExifTag
-&gt; IfdType -&gt; Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-var">ImageFileDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">(ExifTag
 -&gt; IfdType -&gt; Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory)
-&gt; Get ExifTag
-&gt; Get
     (IfdType -&gt; Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get ExifTag
forall a. BinaryParam Endianness a =&gt; Get a
</span><a href="#local-6989586621679158378"><span class="hs-identifier hs-var">getE</span></a></span><span> </span><span class="annot"><span class="annottext">Get (IfdType -&gt; Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory)
-&gt; Get IfdType
-&gt; Get (Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get IfdType
forall a. BinaryParam Endianness a =&gt; Get a
</span><a href="#local-6989586621679158378"><span class="hs-identifier hs-var">getE</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Word32 -&gt; Word32 -&gt; ExifData -&gt; ImageFileDirectory)
-&gt; Get Word32 -&gt; Get (Word32 -&gt; ExifData -&gt; ImageFileDirectory)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word32
forall a. BinaryParam Endianness a =&gt; Get a
</span><a href="#local-6989586621679158378"><span class="hs-identifier hs-var">getE</span></a></span><span> </span><span class="annot"><span class="annottext">Get (Word32 -&gt; ExifData -&gt; ImageFileDirectory)
-&gt; Get Word32 -&gt; Get (ExifData -&gt; ImageFileDirectory)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Word32
forall a. BinaryParam Endianness a =&gt; Get a
</span><a href="#local-6989586621679158378"><span class="hs-identifier hs-var">getE</span></a></span><span>
</span><span id="line-402"></span><span>                       </span><span class="annot"><span class="annottext">Get (ExifData -&gt; ImageFileDirectory)
-&gt; Get ExifData -&gt; Get ImageFileDirectory
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExifData -&gt; Get ExifData
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExifData
</span><a href="Codec.Picture.Metadata.Exif.html#ExifNone"><span class="hs-identifier hs-var">ExifNone</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679158377"><span class="annot"><a href="#local-6989586621679158378"><span class="hs-identifier hs-type">getE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158377"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="#local-6989586621679158377"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-404"></span><span>              </span><span id="local-6989586621679158378"><span class="annot"><span class="annottext">getE :: Get a
</span><a href="#local-6989586621679158378"><span class="hs-identifier hs-var hs-var">getE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get a
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158379"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>  </span><span id="local-6989586621679158376"><span class="annot"><span class="annottext">putP :: Endianness -&gt; ImageFileDirectory -&gt; Put
</span><a href="#local-6989586621679158376"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679158375"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158375"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span id="local-6989586621679158374"><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158374"><span class="hs-identifier hs-var">ifd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158697"><span class="annot"><a href="#local-6989586621679158373"><span class="hs-identifier hs-type">putE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679158697"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679158697"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Put</span></span></span><span>
</span><span id="line-408"></span><span>        </span><span id="local-6989586621679158373"><span class="annot"><span class="annottext">putE :: a -&gt; Put
</span><a href="#local-6989586621679158373"><span class="hs-identifier hs-var hs-var">putE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; a -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158375"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="annottext">ExifTag -&gt; Put
forall a. BinaryParam Endianness a =&gt; a -&gt; Put
</span><a href="#local-6989586621679158373"><span class="hs-identifier hs-var">putE</span></a></span><span> </span><span class="annot"><span class="annottext">(ExifTag -&gt; Put) -&gt; ExifTag -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; ExifTag
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdIdentifier"><span class="hs-identifier hs-var hs-var">ifdIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158374"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><span class="annottext">IfdType -&gt; Put
forall a. BinaryParam Endianness a =&gt; a -&gt; Put
</span><a href="#local-6989586621679158373"><span class="hs-identifier hs-var">putE</span></a></span><span> </span><span class="annot"><span class="annottext">(IfdType -&gt; Put) -&gt; IfdType -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; IfdType
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdType"><span class="hs-identifier hs-var hs-var">ifdType</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158374"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">Word32 -&gt; Put
forall a. BinaryParam Endianness a =&gt; a -&gt; Put
</span><a href="#local-6989586621679158373"><span class="hs-identifier hs-var">putE</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Put) -&gt; Word32 -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdCount"><span class="hs-identifier hs-var hs-var">ifdCount</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158374"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">Word32 -&gt; Put
forall a. BinaryParam Endianness a =&gt; a -&gt; Put
</span><a href="#local-6989586621679158373"><span class="hs-identifier hs-var">putE</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Put) -&gt; Word32 -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory -&gt; Word32
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ifdOffset"><span class="hs-identifier hs-var hs-var">ifdOffset</span></a></span><span> </span><span class="annot"><span class="annottext">ImageFileDirectory
</span><a href="#local-6989586621679158374"><span class="hs-identifier hs-var">ifd</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#BinaryParam"><span class="hs-identifier hs-type">BinaryParam</span></a></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#Endianness"><span class="hs-identifier hs-type">Endianness</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ImageFileDirectory"><span class="hs-identifier hs-type">ImageFileDirectory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621679158370"><span class="annot"><span class="annottext">getP :: Endianness -&gt; Get [ImageFileDirectory]
</span><a href="#local-6989586621679158370"><span class="hs-identifier hs-var hs-var hs-var hs-var">getP</span></a></span></span><span> </span><span id="local-6989586621679158369"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158369"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679158368"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158368"><span class="hs-identifier hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word16
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158369"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621679158367"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158367"><span class="hs-identifier hs-var">rez</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Get ImageFileDirectory -&gt; Get [ImageFileDirectory]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158368"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Get ImageFileDirectory -&gt; Get [ImageFileDirectory])
-&gt; Get ImageFileDirectory -&gt; Get [ImageFileDirectory]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get ImageFileDirectory
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158369"><span class="hs-identifier hs-var">endianness</span></a></span><span>
</span><span id="line-418"></span><span>    </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Endianness -&gt; Get Word32
forall a b. BinaryParam a b =&gt; a -&gt; Get b
</span><a href="Codec.Picture.Tiff.Internal.Types.html#getP"><span class="hs-identifier hs-var">getP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158369"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Get [ImageFileDirectory]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158367"><span class="hs-identifier hs-var">rez</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621679158366"><span class="annot"><span class="annottext">putP :: Endianness -&gt; [ImageFileDirectory] -&gt; Put
</span><a href="#local-6989586621679158366"><span class="hs-identifier hs-var hs-var hs-var hs-var">putP</span></a></span></span><span> </span><span id="local-6989586621679158365"><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158365"><span class="hs-identifier hs-var">endianness</span></a></span></span><span> </span><span id="local-6989586621679158364"><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158364"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679158363"><span class="annot"><span class="annottext">count :: Word16
</span><a href="#local-6989586621679158363"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word16) -&gt; Int -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158364"><span class="hs-identifier hs-var">lst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">Endianness -&gt; Word16 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158365"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679158363"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><span class="annottext">(ImageFileDirectory -&gt; Put) -&gt; [ImageFileDirectory] -&gt; Put
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Endianness -&gt; ImageFileDirectory -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158365"><span class="hs-identifier hs-var">endianness</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImageFileDirectory]
</span><a href="#local-6989586621679158364"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="annottext">Endianness -&gt; Word32 -&gt; Put
forall a b. BinaryParam a b =&gt; a -&gt; b -&gt; Put
</span><a href="Codec.Picture.Tiff.Internal.Types.html#putP"><span class="hs-identifier hs-var">putP</span></a></span><span> </span><span class="annot"><span class="annottext">Endianness
</span><a href="#local-6989586621679158365"><span class="hs-identifier hs-var">endianness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-keyword">data</span><span> </span><span id="TiffColorspace"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffColorspace"><span class="hs-identifier hs-var">TiffColorspace</span></a></span></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TiffMonochromeWhite0"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochromeWhite0"><span class="hs-identifier hs-var">TiffMonochromeWhite0</span></a></span></span><span> </span><span class="hs-comment">-- ^ 0</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffMonochrome"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span></span><span>       </span><span class="hs-comment">-- ^ 1</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffRGB"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span></span><span>              </span><span class="hs-comment">-- ^ 2</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffPaleted"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPaleted"><span class="hs-identifier hs-var">TiffPaleted</span></a></span></span><span>          </span><span class="hs-comment">-- ^ 3</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffTransparencyMask"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffTransparencyMask"><span class="hs-identifier hs-var">TiffTransparencyMask</span></a></span></span><span> </span><span class="hs-comment">-- ^ 4</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffCMYK"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCMYK"><span class="hs-identifier hs-var">TiffCMYK</span></a></span></span><span>             </span><span class="hs-comment">-- ^ 5</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffYCbCr"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffYCbCr"><span class="hs-identifier hs-var">TiffYCbCr</span></a></span></span><span>            </span><span class="hs-comment">-- ^ 6</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TiffCIELab"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCIELab"><span class="hs-identifier hs-var">TiffCIELab</span></a></span></span><span>           </span><span class="hs-comment">-- ^ 8</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packPhotometricInterpretation"><span class="hs-identifier hs-type">packPhotometricInterpretation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffColorspace"><span class="hs-identifier hs-type">TiffColorspace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-440"></span><span id="packPhotometricInterpretation"><span class="annot"><span class="annottext">packPhotometricInterpretation :: TiffColorspace -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#packPhotometricInterpretation"><span class="hs-identifier hs-var hs-var">packPhotometricInterpretation</span></a></span></span><span> </span><span id="local-6989586621679158354"><span class="annot"><span class="annottext">TiffColorspace
</span><a href="#local-6989586621679158354"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="#local-6989586621679158354"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochromeWhite0"><span class="hs-identifier hs-var">TiffMonochromeWhite0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPaleted"><span class="hs-identifier hs-var">TiffPaleted</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">3</span></span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffTransparencyMask"><span class="hs-identifier hs-var">TiffTransparencyMask</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">4</span></span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCMYK"><span class="hs-identifier hs-var">TiffCMYK</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">5</span></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffYCbCr"><span class="hs-identifier hs-var">TiffYCbCr</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">6</span></span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCIELab"><span class="hs-identifier hs-var">TiffCIELab</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">8</span></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#unpackPhotometricInterpretation"><span class="hs-identifier hs-type">unpackPhotometricInterpretation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffColorspace"><span class="hs-identifier hs-type">TiffColorspace</span></a></span><span>
</span><span id="line-451"></span><span id="unpackPhotometricInterpretation"><span class="annot"><span class="annottext">unpackPhotometricInterpretation :: Word32 -&gt; Get TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#unpackPhotometricInterpretation"><span class="hs-identifier hs-var hs-var">unpackPhotometricInterpretation</span></a></span></span><span> </span><span id="local-6989586621679158353"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158353"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158353"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochromeWhite0"><span class="hs-identifier hs-var">TiffMonochromeWhite0</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffMonochrome"><span class="hs-identifier hs-var">TiffMonochrome</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffRGB"><span class="hs-identifier hs-var">TiffRGB</span></a></span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffPaleted"><span class="hs-identifier hs-var">TiffPaleted</span></a></span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffTransparencyMask"><span class="hs-identifier hs-var">TiffTransparencyMask</span></a></span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCMYK"><span class="hs-identifier hs-var">TiffCMYK</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffYCbCr"><span class="hs-identifier hs-var">TiffYCbCr</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffColorspace -&gt; Get TiffColorspace
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffColorspace
</span><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCIELab"><span class="hs-identifier hs-var">TiffCIELab</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621679158352"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158352"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get TiffColorspace
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get TiffColorspace) -&gt; String -&gt; Get TiffColorspace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unrecognized color space &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158352"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-keyword">data</span><span> </span><span id="ExtraSample"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSample"><span class="hs-identifier hs-var">ExtraSample</span></a></span></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ExtraSampleUnspecified"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnspecified"><span class="hs-identifier hs-var">ExtraSampleUnspecified</span></a></span></span><span>       </span><span class="hs-comment">-- ^ 0</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExtraSampleAssociatedAlpha"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleAssociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleAssociatedAlpha</span></a></span></span><span>   </span><span class="hs-comment">-- ^ 1</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExtraSampleUnassociatedAlpha"><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnassociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleUnassociatedAlpha</span></a></span></span><span> </span><span class="hs-comment">-- ^ 2</span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#codeOfExtraSample"><span class="hs-identifier hs-type">codeOfExtraSample</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSample"><span class="hs-identifier hs-type">ExtraSample</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-468"></span><span id="codeOfExtraSample"><span class="annot"><span class="annottext">codeOfExtraSample :: ExtraSample -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#codeOfExtraSample"><span class="hs-identifier hs-var hs-var">codeOfExtraSample</span></a></span></span><span> </span><span id="local-6989586621679158348"><span class="annot"><span class="annottext">ExtraSample
</span><a href="#local-6989586621679158348"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="#local-6989586621679158348"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnspecified"><span class="hs-identifier hs-var">ExtraSampleUnspecified</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">0</span></span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleAssociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleAssociatedAlpha</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">ExtraSample
</span><a href="Codec.Picture.Tiff.Internal.Types.html#ExtraSampleUnassociatedAlpha"><span class="hs-identifier hs-var">ExtraSampleUnassociatedAlpha</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#unPackCompression"><span class="hs-identifier hs-type">unPackCompression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Get</span></span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCompression"><span class="hs-identifier hs-type">TiffCompression</span></a></span><span>
</span><span id="line-474"></span><span id="unPackCompression"><span class="annot"><span class="annottext">unPackCompression :: Word32 -&gt; Get TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#unPackCompression"><span class="hs-identifier hs-var hs-var">unPackCompression</span></a></span></span><span> </span><span id="local-6989586621679158347"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158347"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158347"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Get TiffCompression
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionNone"><span class="hs-identifier hs-var">CompressionNone</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Get TiffCompression
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionNone"><span class="hs-identifier hs-var">CompressionNone</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Get TiffCompression
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionModifiedRLE"><span class="hs-identifier hs-var">CompressionModifiedRLE</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Get TiffCompression
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionLZW"><span class="hs-identifier hs-var">CompressionLZW</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Get TiffCompression
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionJPEG"><span class="hs-identifier hs-var">CompressionJPEG</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">32773</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiffCompression -&gt; Get TiffCompression
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionPackBit"><span class="hs-identifier hs-var">CompressionPackBit</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621679158346"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158346"><span class="hs-identifier hs-var">vv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Get TiffCompression
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Get TiffCompression) -&gt; String -&gt; Get TiffCompression
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown compression scheme &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679158346"><span class="hs-identifier hs-var">vv</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#packCompression"><span class="hs-identifier hs-type">packCompression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Codec.Picture.Tiff.Internal.Types.html#TiffCompression"><span class="hs-identifier hs-type">TiffCompression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-484"></span><span id="packCompression"><span class="annot"><span class="annottext">packCompression :: TiffCompression -&gt; Word16
</span><a href="Codec.Picture.Tiff.Internal.Types.html#packCompression"><span class="hs-identifier hs-var hs-var">packCompression</span></a></span></span><span> </span><span id="local-6989586621679158345"><span class="annot"><span class="annottext">TiffCompression
</span><a href="#local-6989586621679158345"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="#local-6989586621679158345"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionNone"><span class="hs-identifier hs-var">CompressionNone</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionModifiedRLE"><span class="hs-identifier hs-var">CompressionModifiedRLE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">2</span></span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionLZW"><span class="hs-identifier hs-var">CompressionLZW</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">5</span></span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionJPEG"><span class="hs-identifier hs-var">CompressionJPEG</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">6</span></span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="annottext">TiffCompression
</span><a href="Codec.Picture.Tiff.Internal.Types.html#CompressionPackBit"><span class="hs-identifier hs-var">CompressionPackBit</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">32773</span></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span></pre></body></html>