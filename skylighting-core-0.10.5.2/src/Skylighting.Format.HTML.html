<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Skylighting.Format.HTML</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>      </span><span class="annot"><a href="Skylighting.Format.HTML.html#formatHtmlInline"><span class="hs-identifier">formatHtmlInline</span></a></span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Skylighting.Format.HTML.html#formatHtmlBlock"><span class="hs-identifier">formatHtmlBlock</span></a></span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Skylighting.Format.HTML.html#styleToCss"><span class="hs-identifier">styleToCss</span></a></span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Skylighting.Types.html"><span class="hs-identifier">Skylighting.Types</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html5</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.Blaze.Html5.Attributes</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Semigroup</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | Format tokens using HTML spans inside @code@ tags. For example,</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- A @KeywordTok@ is rendered as a span with class @kw@.</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- Short class names correspond to 'TokenType's as follows:</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- 'KeywordTok'        = @kw@,</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- 'DataTypeTok'       = @dt@,</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- 'DecValTok'         = @dv@,</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- 'BaseNTok'          = @bn@,</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- 'FloatTok'          = @fl@,</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- 'CharTok'           = @ch@,</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- 'StringTok'         = @st@,</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- 'CommentTok'        = @co@,</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- 'OtherTok'          = @ot@,</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- 'AlertTok'          = @al@,</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- 'FunctionTok'       = @fu@,</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- 'RegionMarkerTok'   = @re@,</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- 'ErrorTok'          = @er@,</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- 'ConstantTok'       = @cn@,</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- 'SpecialCharTok'    = @sc@,</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- 'VerbatimStringTok' = @vs@,</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- 'SpecialStringTok'  = @ss@,</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- 'ImportTok'         = @im@,</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- 'DocumentationTok'  = @do@,</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- 'AnnotationTok'     = @an@,</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- 'CommentVarTok'     = @cv@,</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- 'VariableTok'       = @va@,</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- 'ControlFlowTok'    = @cf@,</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- 'OperatorTok'       = @op@,</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- 'BuiltInTok'        = @bu@,</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- 'ExtensionTok'      = @ex@,</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- 'PreprocessorTok'   = @pp@,</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- 'AttributeTok'      = @at@,</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- 'InformationTok'    = @in@,</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- 'WarningTok'        = @wa@.</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- A 'NormalTok' is not marked up at all.</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Skylighting.Format.HTML.html#formatHtmlInline"><span class="hs-identifier hs-type">formatHtmlInline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#FormatOptions"><span class="hs-identifier hs-type">FormatOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Skylighting.Types.html#SourceLine"><span class="hs-identifier hs-type">SourceLine</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-55"></span><span id="formatHtmlInline"><span class="annot"><span class="annottext">formatHtmlInline :: FormatOptions -&gt; [SourceLine] -&gt; Html
</span><a href="Skylighting.Format.HTML.html#formatHtmlInline"><span class="hs-identifier hs-var hs-var">formatHtmlInline</span></a></span></span><span> </span><span id="local-6989586621679140432"><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140432"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Html -&gt; Html
</span><a href="Skylighting.Format.HTML.html#wrapCode"><span class="hs-identifier hs-var">wrapCode</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140432"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-56"></span><span>                      </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; ([SourceLine] -&gt; Html) -&gt; [SourceLine] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html)
-&gt; ([SourceLine] -&gt; [Html]) -&gt; [SourceLine] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; [Html] -&gt; [Html]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>                      </span><span class="annot"><span class="annottext">([Html] -&gt; [Html])
-&gt; ([SourceLine] -&gt; [Html]) -&gt; [SourceLine] -&gt; [Html]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SourceLine -&gt; Html) -&gt; [SourceLine] -&gt; [Html]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token -&gt; Html) -&gt; SourceLine -&gt; Html
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FormatOptions -&gt; Token -&gt; Html
</span><a href="Skylighting.Format.HTML.html#tokenToHtml"><span class="hs-identifier hs-var">tokenToHtml</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140432"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Format tokens as an HTML @pre@ block. Each line is wrapped in an a</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- element with the class &#8216;source-line&#8217;. If line numbering</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- is selected, the surrounding pre is given the class &#8216;numberSource&#8217;,</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- and the resulting html will display line numbers thanks to the included</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- CSS.  See the documentation for 'formatHtmlInline' for information about how</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- tokens are encoded.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Skylighting.Format.HTML.html#formatHtmlBlock"><span class="hs-identifier hs-type">formatHtmlBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#FormatOptions"><span class="hs-identifier hs-type">FormatOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Skylighting.Types.html#SourceLine"><span class="hs-identifier hs-type">SourceLine</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-66"></span><span id="formatHtmlBlock"><span class="annot"><span class="annottext">formatHtmlBlock :: FormatOptions -&gt; [SourceLine] -&gt; Html
</span><a href="Skylighting.Format.HTML.html#formatHtmlBlock"><span class="hs-identifier hs-var hs-var">formatHtmlBlock</span></a></span></span><span> </span><span id="local-6989586621679140426"><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140426"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679140425"><span class="annot"><span class="annottext">[SourceLine]
</span><a href="#local-6989586621679140425"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">H.div</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.class_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sourceCode&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">H.pre</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.class_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AttributeValue) -&gt; Text -&gt; AttributeValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">Text.unwords</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679140418"><span class="hs-identifier hs-var">classes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Html -&gt; Html
</span><a href="Skylighting.Format.HTML.html#wrapCode"><span class="hs-identifier hs-var">wrapCode</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140426"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Html] -&gt; Html
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; ([Html] -&gt; [Html]) -&gt; [Html] -&gt; Html
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Html -&gt; [Html] -&gt; [Html]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">([Html] -&gt; Html) -&gt; [Html] -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(LineNo -&gt; SourceLine -&gt; Html)
-&gt; [LineNo] -&gt; [SourceLine] -&gt; [Html]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FormatOptions -&gt; LineNo -&gt; SourceLine -&gt; Html
</span><a href="Skylighting.Format.HTML.html#sourceLineToHtml"><span class="hs-identifier hs-var">sourceLineToHtml</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140426"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LineNo
</span><a href="#local-6989586621679140415"><span class="hs-identifier hs-var">startNum</span></a></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SourceLine]
</span><a href="#local-6989586621679140425"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">where</span><span>  </span><span id="local-6989586621679140418"><span class="annot"><span class="annottext">classes :: [Text]
</span><a href="#local-6989586621679140418"><span class="hs-identifier hs-var hs-var">classes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sourceCode&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-73"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;numberSource&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Bool
</span><a href="Skylighting.Types.html#numberLines"><span class="hs-identifier hs-var hs-var">numberLines</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140426"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-74"></span><span>                   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140412"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679140412"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140412"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; [Text]
</span><a href="Skylighting.Types.html#containerClasses"><span class="hs-identifier hs-var hs-var">containerClasses</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140426"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-75"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140412"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sourceCode&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>         </span><span id="local-6989586621679140415"><span class="annot"><span class="annottext">startNum :: LineNo
</span><a href="#local-6989586621679140415"><span class="hs-identifier hs-var hs-var">startNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; LineNo
</span><a href="Skylighting.Types.html#LineNo"><span class="hs-identifier hs-var">LineNo</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; LineNo) -&gt; Int -&gt; LineNo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Int
</span><a href="Skylighting.Types.html#startNumber"><span class="hs-identifier hs-var hs-var">startNumber</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140426"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Skylighting.Format.HTML.html#wrapCode"><span class="hs-identifier hs-type">wrapCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#FormatOptions"><span class="hs-identifier hs-type">FormatOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-79"></span><span id="wrapCode"><span class="annot"><span class="annottext">wrapCode :: FormatOptions -&gt; Html -&gt; Html
</span><a href="Skylighting.Format.HTML.html#wrapCode"><span class="hs-identifier hs-var hs-var">wrapCode</span></a></span></span><span> </span><span id="local-6989586621679140407"><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140407"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679140406"><span class="annot"><span class="annottext">Html
</span><a href="#local-6989586621679140406"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">H.code</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.class_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AttributeValue) -&gt; Text -&gt; AttributeValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">Text.unwords</span></span><span>
</span><span id="line-80"></span><span>                                             </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sourceCode&quot;</span></span><span>
</span><span id="line-81"></span><span>                                               </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; [Text]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; [Text]
</span><a href="Skylighting.Types.html#codeClasses"><span class="hs-identifier hs-var hs-var">codeClasses</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140407"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                         </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; (Bool, Attribute) -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; (Bool, Attribute) -&gt; h
</span><span class="hs-operator hs-var">!?</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679140402"><span class="hs-identifier hs-var">startZero</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.style</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140400"><span class="hs-identifier hs-var">counterOverride</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                         </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
</span><a href="#local-6989586621679140406"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">where</span><span>  </span><span id="local-6989586621679140400"><span class="annot"><span class="annottext">counterOverride :: [Char]
</span><a href="#local-6989586621679140400"><span class="hs-identifier hs-var hs-var">counterOverride</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;counter-reset: source-line &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679140402"><span class="hs-identifier hs-var">startZero</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;;&quot;</span></span><span>
</span><span id="line-85"></span><span>         </span><span id="local-6989586621679140402"><span class="annot"><span class="annottext">startZero :: Int
</span><a href="#local-6989586621679140402"><span class="hs-identifier hs-var hs-var">startZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Int
</span><a href="Skylighting.Types.html#startNumber"><span class="hs-identifier hs-var hs-var">startNumber</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140407"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Each line of source is wrapped in an (inline-block) anchor that makes</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- subsequent per-line processing (e.g. adding line numnbers) possible.</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Skylighting.Format.HTML.html#sourceLineToHtml"><span class="hs-identifier hs-type">sourceLineToHtml</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#FormatOptions"><span class="hs-identifier hs-type">FormatOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Skylighting.Types.html#LineNo"><span class="hs-identifier hs-type">LineNo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Skylighting.Types.html#SourceLine"><span class="hs-identifier hs-type">SourceLine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-90"></span><span id="sourceLineToHtml"><span class="annot"><span class="annottext">sourceLineToHtml :: FormatOptions -&gt; LineNo -&gt; SourceLine -&gt; Html
</span><a href="Skylighting.Format.HTML.html#sourceLineToHtml"><span class="hs-identifier hs-var hs-var">sourceLineToHtml</span></a></span></span><span> </span><span id="local-6989586621679140398"><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140398"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679140397"><span class="annot"><span class="annottext">LineNo
</span><a href="#local-6989586621679140397"><span class="hs-identifier hs-var">lno</span></a></span></span><span> </span><span id="local-6989586621679140396"><span class="annot"><span class="annottext">SourceLine
</span><a href="#local-6989586621679140396"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">H.span</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.id</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><a href="#local-6989586621679140393"><span class="hs-identifier hs-var">lineNum</span></a></span><span>
</span><span id="line-92"></span><span>         </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>           </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">H.a</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.href</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue
</span><a href="#local-6989586621679140390"><span class="hs-identifier hs-var">lineRef</span></a></span><span>
</span><span id="line-94"></span><span>               </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Bool
</span><a href="Skylighting.Types.html#numberLines"><span class="hs-identifier hs-var hs-var">numberLines</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140398"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-95"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Attribute
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-96"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">customAttribute</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Tag
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;aria-hidden&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;true&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- see jgm/pandoc#6352</span><span>
</span><span id="line-98"></span><span>               </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Bool
</span><a href="Skylighting.Types.html#numberLines"><span class="hs-identifier hs-var hs-var">numberLines</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140398"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-99"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Attribute
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-100"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">customAttribute</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Tag
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tabindex&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;-1&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>               </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Html
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-103"></span><span>           </span><span class="annot"><span class="annottext">(Token -&gt; Html) -&gt; SourceLine -&gt; Html
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FormatOptions -&gt; Token -&gt; Html
</span><a href="Skylighting.Format.HTML.html#tokenToHtml"><span class="hs-identifier hs-var">tokenToHtml</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140398"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SourceLine
</span><a href="#local-6989586621679140396"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span>  </span><span id="local-6989586621679140393"><span class="annot"><span class="annottext">lineNum :: AttributeValue
</span><a href="#local-6989586621679140393"><span class="hs-identifier hs-var hs-var">lineNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140388"><span class="hs-identifier hs-var">prefixedLineNo</span></a></span><span>
</span><span id="line-105"></span><span>         </span><span id="local-6989586621679140390"><span class="annot"><span class="annottext">lineRef :: AttributeValue
</span><a href="#local-6989586621679140390"><span class="hs-identifier hs-var hs-var">lineRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'#'</span></span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140388"><span class="hs-identifier hs-var">prefixedLineNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>         </span><span id="local-6989586621679140388"><span class="annot"><span class="annottext">prefixedLineNo :: [Char]
</span><a href="#local-6989586621679140388"><span class="hs-identifier hs-var hs-var">prefixedLineNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">Text.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FormatOptions -&gt; Text
</span><a href="Skylighting.Types.html#lineIdPrefix"><span class="hs-identifier hs-var hs-var">lineIdPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140398"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineNo -&gt; Int
</span><a href="Skylighting.Types.html#lineNo"><span class="hs-identifier hs-var hs-var">lineNo</span></a></span><span> </span><span class="annot"><span class="annottext">LineNo
</span><a href="#local-6989586621679140397"><span class="hs-identifier hs-var">lno</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Skylighting.Format.HTML.html#tokenToHtml"><span class="hs-identifier hs-type">tokenToHtml</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#FormatOptions"><span class="hs-identifier hs-type">FormatOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Skylighting.Types.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Html</span></span><span>
</span><span id="line-109"></span><span id="tokenToHtml"><span class="annot"><span class="annottext">tokenToHtml :: FormatOptions -&gt; Token -&gt; Html
</span><a href="Skylighting.Format.HTML.html#tokenToHtml"><span class="hs-identifier hs-var hs-var">tokenToHtml</span></a></span></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#NormalTok"><span class="hs-identifier hs-var">NormalTok</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679140383"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140383"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140383"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Skylighting.Format.HTML.html#tokenToHtml"><span class="hs-identifier hs-var">tokenToHtml</span></a></span><span> </span><span id="local-6989586621679140382"><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140382"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679140381"><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140381"><span class="hs-identifier hs-var">toktype</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679140380"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140380"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FormatOptions -&gt; Bool
</span><a href="Skylighting.Types.html#titleAttributes"><span class="hs-identifier hs-var hs-var">titleAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">FormatOptions
</span><a href="#local-6989586621679140382"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-112"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Html
</span><a href="#local-6989586621679140378"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">Html -&gt; Attribute -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.title</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; AttributeValue) -&gt; [Char] -&gt; AttributeValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TokenType -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140381"><span class="hs-identifier hs-var">toktype</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Html
</span><a href="#local-6989586621679140378"><span class="hs-identifier hs-var">sp</span></a></span><span>
</span><span id="line-114"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679140378"><span class="annot"><span class="annottext">sp :: Html
</span><a href="#local-6989586621679140378"><span class="hs-identifier hs-var hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Html -&gt; Html
</span><span class="hs-identifier hs-var">H.span</span></span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Attribute -&gt; Html -&gt; Html
forall h. Attributable h =&gt; h -&gt; Attribute -&gt; h
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">AttributeValue -&gt; Attribute
</span><span class="hs-identifier hs-var">A.class_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; AttributeValue
forall a. ToValue a =&gt; a -&gt; AttributeValue
</span><span class="hs-identifier hs-var">toValue</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; AttributeValue) -&gt; [Char] -&gt; AttributeValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TokenType -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140381"><span class="hs-identifier hs-var">toktype</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Html -&gt; Html) -&gt; Html -&gt; Html
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Html
forall a. ToMarkup a =&gt; a -&gt; Html
</span><span class="hs-identifier hs-var">toHtml</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679140380"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-type">short</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-117"></span><span id="short"><span class="annot"><span class="annottext">short :: TokenType -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var hs-var">short</span></a></span></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#KeywordTok"><span class="hs-identifier hs-var">KeywordTok</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;kw&quot;</span></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#DataTypeTok"><span class="hs-identifier hs-var">DataTypeTok</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;dt&quot;</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#DecValTok"><span class="hs-identifier hs-var">DecValTok</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;dv&quot;</span></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#BaseNTok"><span class="hs-identifier hs-var">BaseNTok</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;bn&quot;</span></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#FloatTok"><span class="hs-identifier hs-var">FloatTok</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;fl&quot;</span></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#CharTok"><span class="hs-identifier hs-var">CharTok</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ch&quot;</span></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#StringTok"><span class="hs-identifier hs-var">StringTok</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;st&quot;</span></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#CommentTok"><span class="hs-identifier hs-var">CommentTok</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;co&quot;</span></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#OtherTok"><span class="hs-identifier hs-var">OtherTok</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ot&quot;</span></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#AlertTok"><span class="hs-identifier hs-var">AlertTok</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;al&quot;</span></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#FunctionTok"><span class="hs-identifier hs-var">FunctionTok</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;fu&quot;</span></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#RegionMarkerTok"><span class="hs-identifier hs-var">RegionMarkerTok</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;re&quot;</span></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#ErrorTok"><span class="hs-identifier hs-var">ErrorTok</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;er&quot;</span></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#ConstantTok"><span class="hs-identifier hs-var">ConstantTok</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cn&quot;</span></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#SpecialCharTok"><span class="hs-identifier hs-var">SpecialCharTok</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sc&quot;</span></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#VerbatimStringTok"><span class="hs-identifier hs-var">VerbatimStringTok</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;vs&quot;</span></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#SpecialStringTok"><span class="hs-identifier hs-var">SpecialStringTok</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ss&quot;</span></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#ImportTok"><span class="hs-identifier hs-var">ImportTok</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;im&quot;</span></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#DocumentationTok"><span class="hs-identifier hs-var">DocumentationTok</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;do&quot;</span></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#AnnotationTok"><span class="hs-identifier hs-var">AnnotationTok</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;an&quot;</span></span><span>
</span><span id="line-137"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#CommentVarTok"><span class="hs-identifier hs-var">CommentVarTok</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cv&quot;</span></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#VariableTok"><span class="hs-identifier hs-var">VariableTok</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;va&quot;</span></span><span>
</span><span id="line-139"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#ControlFlowTok"><span class="hs-identifier hs-var">ControlFlowTok</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cf&quot;</span></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#OperatorTok"><span class="hs-identifier hs-var">OperatorTok</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;op&quot;</span></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#BuiltInTok"><span class="hs-identifier hs-var">BuiltInTok</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;bu&quot;</span></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#ExtensionTok"><span class="hs-identifier hs-var">ExtensionTok</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ex&quot;</span></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#PreprocessorTok"><span class="hs-identifier hs-var">PreprocessorTok</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pp&quot;</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#AttributeTok"><span class="hs-identifier hs-var">AttributeTok</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;at&quot;</span></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#InformationTok"><span class="hs-identifier hs-var">InformationTok</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;in&quot;</span></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#WarningTok"><span class="hs-identifier hs-var">WarningTok</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;wa&quot;</span></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="Skylighting.Types.html#NormalTok"><span class="hs-identifier hs-var">NormalTok</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Returns CSS for styling highlighted code according to the given style.</span><span>
</span><span id="line-150"></span><span class="annot"><a href="Skylighting.Format.HTML.html#styleToCss"><span class="hs-identifier hs-type">styleToCss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Skylighting.Types.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-151"></span><span id="styleToCss"><span class="annot"><span class="annottext">styleToCss :: Style -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#styleToCss"><span class="hs-identifier hs-var hs-var">styleToCss</span></a></span></span><span> </span><span id="local-6989586621679140344"><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679140342"><span class="hs-identifier hs-var">divspec</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679140341"><span class="hs-identifier hs-var">numberspec</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679140340"><span class="hs-identifier hs-var">colorspec</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621679140339"><span class="hs-identifier hs-var">linkspec</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TokenType, TokenStyle) -&gt; [Char])
-&gt; [(TokenType, TokenStyle)] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TokenType, TokenStyle) -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#toCss"><span class="hs-identifier hs-var">toCss</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TokenType TokenStyle -&gt; [(TokenType, TokenStyle)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Map TokenType TokenStyle
</span><a href="Skylighting.Types.html#tokenStyles"><span class="hs-identifier hs-var hs-var">tokenStyles</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679140340"><span class="annot"><span class="annottext">colorspec :: [[Char]]
</span><a href="#local-6989586621679140340"><span class="hs-identifier hs-var hs-var">colorspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [[Char]])
-&gt; ([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;div.sourceCode\n  {&quot;</span></span><span>
</span><span id="line-156"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140333"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140333"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;color: &quot;</span></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140333"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Maybe Color
</span><a href="Skylighting.Types.html#defaultColor"><span class="hs-identifier hs-var hs-var">defaultColor</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140330"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140330"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;background-color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140330"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Maybe Color
</span><a href="Skylighting.Types.html#backgroundColor"><span class="hs-identifier hs-var hs-var">backgroundColor</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>         </span><span id="local-6989586621679140341"><span class="annot"><span class="annottext">numberspec :: [[Char]]
</span><a href="#local-6989586621679140341"><span class="hs-identifier hs-var hs-var">numberspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre.numberSource code&quot;</span></span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  { counter-reset: source-line 0; }&quot;</span></span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre.numberSource code &gt; span&quot;</span></span><span>
</span><span id="line-164"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  { position: relative; left: -4em; counter-increment: source-line; }&quot;</span></span><span>
</span><span id="line-165"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre.numberSource code &gt; span &gt; a:first-child::before&quot;</span></span><span>
</span><span id="line-166"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  { content: counter(source-line);&quot;</span></span><span>
</span><span id="line-167"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    position: relative; left: -1em; text-align: right; vertical-align: baseline;&quot;</span></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    border: none; display: inline-block;&quot;</span></span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    -webkit-touch-callout: none; -webkit-user-select: none;&quot;</span></span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    -khtml-user-select: none; -moz-user-select: none;&quot;</span></span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    -ms-user-select: none; user-select: none;&quot;</span></span><span>
</span><span id="line-172"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    padding: 0 4px; width: 4em;&quot;</span></span><span>
</span><span id="line-173"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140328"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140328"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    background-color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140328"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Maybe Color
</span><a href="Skylighting.Types.html#lineNumberBackgroundColor"><span class="hs-identifier hs-var hs-var">lineNumberBackgroundColor</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140326"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140326"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;    color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140326"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Maybe Color
</span><a href="Skylighting.Types.html#lineNumberColor"><span class="hs-identifier hs-var hs-var">lineNumberColor</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-177"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  }&quot;</span></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre.numberSource { margin-left: 3em; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-179"></span><span>              </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140324"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140324"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;border-left: 1px solid &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140324"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style -&gt; Maybe Color
</span><a href="Skylighting.Types.html#lineNumberColor"><span class="hs-identifier hs-var hs-var">lineNumberColor</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="#local-6989586621679140344"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-180"></span><span>              </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; padding-left: 4px; }&quot;</span></span><span>
</span><span id="line-181"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>         </span><span id="local-6989586621679140342"><span class="annot"><span class="annottext">divspec :: [[Char]]
</span><a href="#local-6989586621679140342"><span class="hs-identifier hs-var hs-var">divspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-183"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre &gt; code.sourceCode { white-space: pre; position: relative; }&quot;</span></span><span> </span><span class="hs-comment">-- position relative needed for relative contents</span><span>
</span><span id="line-184"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre &gt; code.sourceCode &gt; span { display: inline-block; line-height: 1.25; }&quot;</span></span><span>
</span><span id="line-185"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre &gt; code.sourceCode &gt; span:empty { height: 1.2em; }&quot;</span></span><span> </span><span class="hs-comment">-- correct empty line height</span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.sourceCode { overflow: visible; }&quot;</span></span><span> </span><span class="hs-comment">-- needed for line numbers</span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;code.sourceCode &gt; span { color: inherit; text-decoration: inherit; }&quot;</span></span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;div.sourceCode { margin: 1em 0; }&quot;</span></span><span> </span><span class="hs-comment">-- Collapse neighbours correctly</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre.sourceCode { margin: 0; }&quot;</span></span><span> </span><span class="hs-comment">-- Collapse neighbours correctly</span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;@media screen {&quot;</span></span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;div.sourceCode { overflow: auto; }&quot;</span></span><span> </span><span class="hs-comment">-- do not overflow on screen</span><span>
</span><span id="line-192"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-193"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;@media print {&quot;</span></span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre &gt; code.sourceCode { white-space: pre-wrap; }&quot;</span></span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre &gt; code.sourceCode &gt; span { text-indent: -5em; padding-left: 5em; }&quot;</span></span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span>         </span><span id="local-6989586621679140339"><span class="annot"><span class="annottext">linkspec :: [[Char]]
</span><a href="#local-6989586621679140339"><span class="hs-identifier hs-var hs-var">linkspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;@media screen {&quot;</span></span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pre &gt; code.sourceCode &gt; span &gt; a:first-child::before { text-decoration: underline; }&quot;</span></span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="Skylighting.Format.HTML.html#toCss"><span class="hs-identifier hs-type">toCss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Skylighting.Types.html#TokenType"><span class="hs-identifier hs-type">TokenType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Skylighting.Types.html#TokenStyle"><span class="hs-identifier hs-type">TokenStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-204"></span><span id="toCss"><span class="annot"><span class="annottext">toCss :: (TokenType, TokenStyle) -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#toCss"><span class="hs-identifier hs-var hs-var">toCss</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679140323"><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140323"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679140322"><span class="annot"><span class="annottext">TokenStyle
</span><a href="#local-6989586621679140322"><span class="hs-identifier hs-var">tf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;code span&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenType -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140323"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char] -&gt; [Char]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">TokenType -&gt; [Char]
</span><a href="Skylighting.Format.HTML.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140323"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; { &quot;</span></span><span>
</span><span id="line-205"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140320"><span class="hs-identifier hs-var">colorspec</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140319"><span class="hs-identifier hs-var">backgroundspec</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140318"><span class="hs-identifier hs-var">weightspec</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140317"><span class="hs-identifier hs-var">stylespec</span></a></span><span>
</span><span id="line-206"></span><span>                </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140316"><span class="hs-identifier hs-var">decorationspec</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;} /* &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TokenType -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="#local-6989586621679140315"><span class="hs-identifier hs-var">showTokenType</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621679140323"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; */&quot;</span></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679140320"><span class="annot"><span class="annottext">colorspec :: [Char]
</span><a href="#local-6989586621679140320"><span class="hs-identifier hs-var hs-var">colorspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140314"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140314"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140314"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TokenStyle -&gt; Maybe Color
</span><a href="Skylighting.Types.html#tokenColor"><span class="hs-identifier hs-var hs-var">tokenColor</span></a></span><span> </span><span class="annot"><span class="annottext">TokenStyle
</span><a href="#local-6989586621679140322"><span class="hs-identifier hs-var">tf</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span id="local-6989586621679140319"><span class="annot"><span class="annottext">backgroundspec :: [Char]
</span><a href="#local-6989586621679140319"><span class="hs-identifier hs-var hs-var">backgroundspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679140312"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140312"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;background-color: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Color -&gt; [Char]
forall a. FromColor a =&gt; Color -&gt; a
</span><a href="Skylighting.Types.html#fromColor"><span class="hs-identifier hs-var">fromColor</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679140312"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;; &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Color -&gt; [Char]) -&gt; Maybe Color -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TokenStyle -&gt; Maybe Color
</span><a href="Skylighting.Types.html#tokenBackground"><span class="hs-identifier hs-var hs-var">tokenBackground</span></a></span><span> </span><span class="annot"><span class="annottext">TokenStyle
</span><a href="#local-6989586621679140322"><span class="hs-identifier hs-var">tf</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621679140318"><span class="annot"><span class="annottext">weightspec :: [Char]
</span><a href="#local-6989586621679140318"><span class="hs-identifier hs-var hs-var">weightspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TokenStyle -&gt; Bool
</span><a href="Skylighting.Types.html#tokenBold"><span class="hs-identifier hs-var hs-var">tokenBold</span></a></span><span> </span><span class="annot"><span class="annottext">TokenStyle
</span><a href="#local-6989586621679140322"><span class="hs-identifier hs-var">tf</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;font-weight: bold; &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679140317"><span class="annot"><span class="annottext">stylespec :: [Char]
</span><a href="#local-6989586621679140317"><span class="hs-identifier hs-var hs-var">stylespec</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TokenStyle -&gt; Bool
</span><a href="Skylighting.Types.html#tokenItalic"><span class="hs-identifier hs-var hs-var">tokenItalic</span></a></span><span> </span><span class="annot"><span class="annottext">TokenStyle
</span><a href="#local-6989586621679140322"><span class="hs-identifier hs-var">tf</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;font-style: italic; &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-211"></span><span>        </span><span id="local-6989586621679140316"><span class="annot"><span class="annottext">decorationspec :: [Char]
</span><a href="#local-6989586621679140316"><span class="hs-identifier hs-var hs-var">decorationspec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TokenStyle -&gt; Bool
</span><a href="Skylighting.Types.html#tokenUnderline"><span class="hs-identifier hs-var hs-var">tokenUnderline</span></a></span><span> </span><span class="annot"><span class="annottext">TokenStyle
</span><a href="#local-6989586621679140322"><span class="hs-identifier hs-var">tf</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;text-decoration: underline; &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679140315"><span class="annot"><span class="annottext">showTokenType :: a -&gt; [Char]
</span><a href="#local-6989586621679140315"><span class="hs-identifier hs-var hs-var">showTokenType</span></a></span></span><span> </span><span id="local-6989586621679140307"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140307"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140307"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-213"></span><span>                             </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'k'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'o'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'T'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679140305"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140305"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679140305"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-214"></span><span>                             </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span></pre></body></html>