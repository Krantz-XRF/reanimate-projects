<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  Data.Geometry.PlanarSubdivision.Merge</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Description :  Functions for merging two planar subdivisions</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Geometry.PlanarSubdivision.Merge</span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#merge"><span class="hs-identifier">merge</span></a></span><span>
</span><span id="line-11"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith"><span class="hs-identifier">mergeWith</span></a></span><span>
</span><span id="line-12"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeAllWith"><span class="hs-identifier">mergeAllWith</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHoleIn"><span class="hs-identifier">embedAsHoleIn</span></a></span><span>
</span><span id="line-15"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHolesIn"><span class="hs-identifier">embedAsHolesIn</span></a></span><span>
</span><span id="line-16"></span><span>                                            </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algorithms.DivideAndConquer</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">holes</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html"><span class="hs-identifier">Data.Geometry.PlanarSubdivision.Basic</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html"><span class="hs-identifier">Data.Geometry.PlanarSubdivision.Raw</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Polygon.html"><span class="hs-identifier">Data.Geometry.Polygon</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.PlanarGraph.Dart</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.PlaneGraph.html"><span class="hs-identifier">Data.PlaneGraph</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup.Foldable</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- * Embedding one subdivision in another one</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHolesIn"><span class="hs-identifier hs-type">embedAsHolesIn</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679954784"><span class="annot"><a href="#local-6989586621679954784"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679954783"><span class="annot"><a href="#local-6989586621679954783"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679954782"><span class="annot"><a href="#local-6989586621679954782"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679954781"><span class="annot"><a href="#local-6989586621679954781"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679954780"><span class="annot"><a href="#local-6989586621679954780"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679954779"><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679954778"><span class="annot"><a href="#local-6989586621679954778"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679954784"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679954784"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954784"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954782"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954781"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954780"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954778"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The disjoint &quot;holes&quot;</span><span>
</span><span id="line-37"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679954784"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ How to merge the face data</span><span>
</span><span id="line-38"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679954783"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-comment">-- ^ Face in which to embed the given subdivisions</span><span>
</span><span id="line-39"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954783"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954781"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954780"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954778"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-comment">-- ^ the outer subdivision</span><span>
</span><span id="line-40"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954783"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954781"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954780"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954778"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-41"></span><span id="embedAsHolesIn"><span class="annot"><span class="annottext">embedAsHolesIn :: t (PlanarSubdivision h v e f r)
-&gt; (t f -&gt; f -&gt; f)
-&gt; FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHolesIn"><span class="hs-identifier hs-var hs-var">embedAsHolesIn</span></a></span></span><span> </span><span id="local-6989586621679954777"><span class="annot"><span class="annottext">t (PlanarSubdivision h v e f r)
</span><a href="#local-6989586621679954777"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span id="local-6989586621679954776"><span class="annot"><span class="annottext">t f -&gt; f -&gt; f
</span><a href="#local-6989586621679954776"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
-&gt; (f -&gt; f -&gt; f)
-&gt; FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k k (s :: k) (h :: k) v e f r.
PlanarSubdivision h v e f r
-&gt; (f -&gt; f -&gt; f)
-&gt; FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHoleIn"><span class="hs-identifier hs-var">embedAsHoleIn</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954775"><span class="hs-identifier hs-var">ph'</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954774"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-comment">-- merges all holes into one subdivision</span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679954775"><span class="annot"><span class="annottext">ph' :: PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954775"><span class="hs-identifier hs-var hs-var">ph'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f -&gt; f -&gt; f)
-&gt; t (PlanarSubdivision h v e f r) -&gt; PlanarSubdivision h v e f r
forall k (t :: * -&gt; *) f (s :: k) v e r.
Foldable1 t =&gt;
(f -&gt; f -&gt; f)
-&gt; t (PlanarSubdivision s v e f r) -&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeAllWith"><span class="hs-identifier hs-var">mergeAllWith</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">t (PlanarSubdivision h v e f r)
</span><a href="#local-6989586621679954777"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-comment">-- the new data value to use for the face i</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679954774"><span class="annot"><span class="annottext">g :: f -&gt; f -&gt; f
</span><a href="#local-6989586621679954774"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t f -&gt; f -&gt; f
</span><a href="#local-6989586621679954776"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PlanarSubdivision h v e f r -&gt; f)
-&gt; t (PlanarSubdivision h v e f r) -&gt; t f
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679954772"><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954772"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954772"><span class="hs-identifier hs-var">h</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
-&gt; Getting f (PlanarSubdivision h v e f r) f -&gt; f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">FaceId' h
-&gt; Lens'
     (PlanarSubdivision h v e f r)
     (DataOf (PlanarSubdivision h v e f r) (FaceId' h))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r -&gt; FaceId' h
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954772"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (PlanarSubdivision h v e f r)
</span><a href="#local-6989586621679954777"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHoleIn"><span class="hs-identifier hs-type">embedAsHoleIn</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679955043"><span class="annot"><a href="#local-6989586621679955043"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679955048"><span class="annot"><a href="#local-6989586621679955048"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679955047"><span class="annot"><a href="#local-6989586621679955047"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679955046"><span class="annot"><a href="#local-6989586621679955046"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679955045"><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679955044"><span class="annot"><a href="#local-6989586621679955044"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-49"></span><span>                           </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955048"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955047"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955046"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955044"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-comment">-- ^ The hole</span><span>
</span><span id="line-50"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ How to merge the face data (hole value first)</span><span>
</span><span id="line-51"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679955043"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-comment">-- ^ Face in which to embed the given subdivisions</span><span>
</span><span id="line-52"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955043"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955047"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955046"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955044"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-comment">-- ^ the outer subdivision</span><span>
</span><span id="line-53"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955043"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955047"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955046"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955044"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-54"></span><span id="embedAsHoleIn"><span class="annot"><span class="annottext">embedAsHoleIn :: PlanarSubdivision h v e f r
-&gt; (f -&gt; f -&gt; f)
-&gt; FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHoleIn"><span class="hs-identifier hs-var hs-var">embedAsHoleIn</span></a></span></span><span> </span><span id="local-6989586621679954768"><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954768"><span class="hs-identifier hs-var">ph'</span></a></span></span><span> </span><span id="local-6989586621679954767"><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954767"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679954766"><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679954766"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679954765"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954765"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector (RawFace s f)
 -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k (s :: k) f v e r.
(Vector (RawFace s f)
 -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith%27"><span class="hs-identifier hs-var">mergeWith'</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
</span><a href="#local-6989586621679954763"><span class="hs-identifier hs-var">mergeFaces</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954765"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954762"><span class="hs-identifier hs-var">ph</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-comment">-- coerce the worlds to be the same</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="#local-6989586621679954762"><span class="hs-identifier hs-type">ph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955043"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955047"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955046"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955045"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955044"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621679954762"><span class="annot"><span class="annottext">ph :: PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954762"><span class="hs-identifier hs-var hs-var">ph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r -&gt; PlanarSubdivision s v e f r
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision h v e f r
</span><a href="#local-6989586621679954768"><span class="hs-identifier hs-var">ph'</span></a></span><span>
</span><span id="line-59"></span><span>      </span><span class="hs-comment">-- We are coercing the 'h' into an 's' here. Since these</span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-comment">-- parameters are phantom types the representation of the data</span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-comment">-- is the same, and hence the unsafeCoerce should be safe here.</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679954763"><span class="annot"><span class="annottext">mergeFaces :: Vector (RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
</span><a href="#local-6989586621679954763"><span class="hs-identifier hs-var hs-var">mergeFaces</span></a></span></span><span> </span><span id="local-6989586621679954761"><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954761"><span class="hs-identifier hs-var">fs1</span></a></span></span><span> </span><span id="local-6989586621679954760"><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954760"><span class="hs-identifier hs-var">fs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; FaceId' s -&gt; RawFace s f -&gt; Vector (RawFace s f)
</span><a href="#local-6989586621679954759"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954761"><span class="hs-identifier hs-var">fs1</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId' s
</span><a href="#local-6989586621679954766"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; RawFace s f
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954760"><span class="hs-identifier hs-var">fs2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.tail</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954760"><span class="hs-identifier hs-var">fs2</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679954759"><span class="annot"><span class="annottext">update :: Vector (RawFace s f)
-&gt; FaceId' s -&gt; RawFace s f -&gt; Vector (RawFace s f)
</span><a href="#local-6989586621679954759"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679954756"><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954756"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621679954753"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954753"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679954752"><span class="annot"><span class="annottext">RawFace s f
</span><a href="#local-6989586621679954752"><span class="hs-identifier hs-var">h2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span id="local-6989586621679954750"><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954750"><span class="hs-identifier hs-var">hs'</span></a></span></span><span> </span><span id="local-6989586621679954749"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954749"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawFace s f
</span><a href="#local-6989586621679954752"><span class="hs-identifier hs-var">h2</span></a></span><span class="annot"><span class="annottext">RawFace s f
-&gt; Getting
     (FaceData (Dart s) f) (RawFace s f) (FaceData (Dart s) f)
-&gt; FaceData (Dart s) f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (FaceData (Dart s) f) (RawFace s f) (FaceData (Dart s) f)
forall k (s :: k) f f2.
Lens
  (RawFace s f)
  (RawFace s f2)
  (FaceData (Dart s) f)
  (FaceData (Dart s) f2)
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span>
</span><span id="line-66"></span><span>                                             </span><span id="local-6989586621679954747"><span class="annot"><span class="annottext">g :: FaceData (Dart s) f -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621679954747"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span id="local-6989586621679954746"><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954746"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span id="local-6989586621679954745"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954745"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f. Seq h -&gt; f -&gt; FaceData h f
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954750"><span class="hs-identifier hs-var">hs'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; Seq (Dart s) -&gt; Seq (Dart s)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954746"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954767"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954749"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954745"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>                                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954756"><span class="hs-identifier hs-var">fs</span></a></span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; (Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; Vector (RawFace s f)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">Index (Vector (RawFace s f))
-&gt; Traversal'
     (Vector (RawFace s f)) (IxValue (Vector (RawFace s f)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (RawFace s f))
</span><a href="#local-6989586621679954753"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">((RawFace s f -&gt; Identity (RawFace s f))
 -&gt; Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
-&gt; ((FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
    -&gt; RawFace s f -&gt; Identity (RawFace s f))
-&gt; (FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
-&gt; Vector (RawFace s f)
-&gt; Identity (Vector (RawFace s f))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
-&gt; RawFace s f -&gt; Identity (RawFace s f)
forall k (s :: k) f f2.
Lens
  (RawFace s f)
  (RawFace s f2)
  (FaceData (Dart s) f)
  (FaceData (Dart s) f2)
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span> </span><span class="annot"><span class="annottext">((FaceData (Dart s) f -&gt; Identity (FaceData (Dart s) f))
 -&gt; Vector (RawFace s f) -&gt; Identity (Vector (RawFace s f)))
-&gt; (FaceData (Dart s) f -&gt; FaceData (Dart s) f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">FaceData (Dart s) f -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621679954747"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">-- (PlanarSubdivision cs vd rd rf)&amp;faceDataOf i %~ updateFData</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- where</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">--   -- shift p2</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-comment">--   p2' :: PlanarSubdivision s v e f r</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">--   p2' = unsafeCoerce p2''</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">--   p2'' :: PlanarSubdivision h v e f r</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">--   p2'' = shift (numComponents ps) (numVertices ps) (numDarts ps `div` 2) (numFaces ps) ph</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">--       -- we have to shift the number of the *Arcs*. Since every dart consists</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">--       -- of two arcs, we have to shift by numDarts / 2</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">--   -- merges all holes into one subdivision</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">--   ph = mergeAllWith const hs</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-comment">--   cs = ps^.components &lt;&gt; p2'^.components</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">--   vd = ps^.rawVertexData &lt;&gt; p2'^.rawVertexData</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">--   rd = ps^.rawDartData &lt;&gt; p2'^.rawDartData</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">--   rf = ps^.rawFaceData &lt;&gt; (V.tail $ p2'^.rawFaceData)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">--   -- the new data value to use for the face i</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">--   x = f ofData (ps^.dataOf i)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">--   ofData = fmap (\h -&gt; h^.dataOf (outerFaceId h)) hs</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">--   updateFData (FaceData hs' _) = FaceData (newHs &lt;&gt; hs') x</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">--   newHs = p2'^?!rawFaceData.ix 0.faceDataVal.holes</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- * Merging Disjoint Subdivisions</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Merge a pair of *disjoint* planar subdivisions, unifying their</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- outer face. The given function is used to merge the data</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- corresponding to the outer face. The subdivisions are merged pairwise, no</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- guarantees are given about the order in which they are merged. Hence,</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- it is expected that f is commutative.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- running time: \(O(n\log n)\), where \(n\) is the total size of the</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- subdivisions.</span><span>
</span><span id="line-110"></span><span id="local-6989586621679955035"><span id="local-6989586621679955036"><span id="local-6989586621679955037"><span id="local-6989586621679955038"><span id="local-6989586621679955039"><span id="local-6989586621679955041"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeAllWith"><span class="hs-identifier hs-type">mergeAllWith</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679955041"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-111"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679955039"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679955039"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679955039"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679955041"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955038"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955037"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955036"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955039"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955038"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955037"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955036"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955039"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955035"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-114"></span><span id="mergeAllWith"><span class="annot"><span class="annottext">mergeAllWith :: (f -&gt; f -&gt; f)
-&gt; t (PlanarSubdivision s v e f r) -&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeAllWith"><span class="hs-identifier hs-var hs-var">mergeAllWith</span></a></span></span><span> </span><span id="local-6989586621679954740"><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954740"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PlanarSubdivision s v e f r
 -&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; (PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r)
-&gt; NonEmpty (PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall (f :: * -&gt; *) s a.
Foldable1 f =&gt;
(s -&gt; s -&gt; s) -&gt; (a -&gt; s) -&gt; f a -&gt; s
</span><span class="hs-identifier hs-var">divideAndConquer1With</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f -&gt; f -&gt; f)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k f (s :: k) v e r.
(f -&gt; f -&gt; f)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith"><span class="hs-identifier hs-var">mergeWith</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954740"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (PlanarSubdivision s v e f r)
 -&gt; PlanarSubdivision s v e f r)
-&gt; (t (PlanarSubdivision s v e f r)
    -&gt; NonEmpty (PlanarSubdivision s v e f r))
-&gt; t (PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t (PlanarSubdivision s v e f r)
-&gt; NonEmpty (PlanarSubdivision s v e f r)
forall (t :: * -&gt; *) a. Foldable1 t =&gt; t a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">toNonEmpty</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Merge a pair of *disjoint* planar subdivisions, unifying their</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- outer face. For the outerface data it simply takes the data of the</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- first subdivision.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- runningtime: \(O(n)\)</span><span>
</span><span id="line-121"></span><span id="local-6989586621679954792"><span id="local-6989586621679954793"><span id="local-6989586621679954794"><span id="local-6989586621679954795"><span id="local-6989586621679954796"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#merge"><span class="hs-identifier hs-type">merge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954795"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954794"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954793"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954792"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954795"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954794"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954793"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954792"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954796"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954795"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954794"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954793"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954792"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-122"></span><span id="merge"><span class="annot"><span class="annottext">merge :: PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#merge"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f -&gt; f -&gt; f)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k f (s :: k) v e r.
(f -&gt; f -&gt; f)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith"><span class="hs-identifier hs-var">mergeWith</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Merge a pair of *disjoint* planar subdivisions. In particular,</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- this function unifies the structure assuming that the two</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- subdivisions share the outer face.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- runningtime: \(O(n)\)</span><span>
</span><span id="line-129"></span><span id="local-6989586621679954949"><span id="local-6989586621679954950"><span id="local-6989586621679954951"><span id="local-6989586621679954952"><span id="local-6989586621679954953"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith"><span class="hs-identifier hs-type">mergeWith</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679954953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954953"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^  how to merge the data of the outer face</span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954952"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954951"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954950"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954949"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-131"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954952"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954951"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954950"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954949"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954952"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954951"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954950"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954953"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954949"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-133"></span><span id="mergeWith"><span class="annot"><span class="annottext">mergeWith :: (f -&gt; f -&gt; f)
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith"><span class="hs-identifier hs-var hs-var">mergeWith</span></a></span></span><span> </span><span id="local-6989586621679954736"><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954736"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Vector (RawFace s f)
 -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k (s :: k) f v e r.
(Vector (RawFace s f)
 -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith%27"><span class="hs-identifier hs-var">mergeWith'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f -&gt; f -&gt; f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
forall k f (s :: k).
(f -&gt; f -&gt; f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeFaceData"><span class="hs-identifier hs-var">mergeFaceData</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954736"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Takes care of actually combining the vectors with data.</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- only thing left is how to merge the raw face data</span><span>
</span><span id="line-137"></span><span id="local-6989586621679955000"><span id="local-6989586621679955001"><span id="local-6989586621679955002"><span id="local-6989586621679955003"><span id="local-6989586621679955004"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith%27"><span class="hs-identifier hs-type">mergeWith'</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955003"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955003"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955003"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>             </span><span class="hs-comment">-- ^  how to merge the raw face data</span><span>
</span><span id="line-139"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955002"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955001"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955003"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955000"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-140"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955002"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955001"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955003"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955000"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-141"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955002"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955001"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955003"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679955000"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-142"></span><span id="mergeWith%27"><span class="annot"><span class="annottext">mergeWith' :: (Vector (RawFace s f)
 -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f))
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeWith%27"><span class="hs-identifier hs-var hs-var">mergeWith'</span></a></span></span><span> </span><span id="local-6989586621679954734"><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
</span><a href="#local-6989586621679954734"><span class="hs-identifier hs-var">mergeFaces</span></a></span></span><span> </span><span id="local-6989586621679954733"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679954732"><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954732"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r
forall k (s :: k) v e f r1.
Vector (Component s r1)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r1
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-var">PlanarSubdivision</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
</span><a href="#local-6989586621679954730"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621679954729"><span class="hs-identifier hs-var">vd</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621679954728"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954727"><span class="hs-identifier hs-var">rf</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-comment">-- shift p2</span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679954726"><span class="annot"><span class="annottext">p2' :: PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954726"><span class="hs-identifier hs-var hs-var">p2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
forall k (s :: k) v e f r.
Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#shift"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#numComponents"><span class="hs-identifier hs-var">numComponents</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#numVertices"><span class="hs-identifier hs-var">numVertices</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#numDarts"><span class="hs-identifier hs-var">numDarts</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r -&gt; Int
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; Int
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#numFaces"><span class="hs-identifier hs-var">numFaces</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954732"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-comment">-- we have to shift the number of the *Arcs*. Since every dart</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-comment">-- consists of two arcs, we have to shift by numDarts / 2</span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-comment">-- Furthermore, we take numFaces - 1 since we want the first</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-comment">-- /internal/ face of p2 (the one with FaceId 1) to correspond with the first free</span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-comment">-- position (at index numFaces)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679954730"><span class="annot"><span class="annottext">cs :: Vector (Component s r)
</span><a href="#local-6989586621679954730"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Component s r))
     (PlanarSubdivision s v e f r)
     (Vector (Component s r))
-&gt; Vector (Component s r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Component s r))
  (PlanarSubdivision s v e f r)
  (Vector (Component s r))
forall k (s :: k) v e f r1 r2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f r2)
  (Vector (Component s r1))
  (Vector (Component s r2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#components"><span class="hs-identifier hs-var">components</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
-&gt; Vector (Component s r) -&gt; Vector (Component s r)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954726"><span class="hs-identifier hs-var">p2'</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Component s r))
     (PlanarSubdivision s v e f r)
     (Vector (Component s r))
-&gt; Vector (Component s r)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Component s r))
  (PlanarSubdivision s v e f r)
  (Vector (Component s r))
forall k (s :: k) v e f r1 r2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f r2)
  (Vector (Component s r1))
  (Vector (Component s r2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#components"><span class="hs-identifier hs-var">components</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679954729"><span class="annot"><span class="annottext">vd :: Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621679954729"><span class="hs-identifier hs-var hs-var">vd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
forall k (s :: k) v e f r1 v2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v2 e f r1)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954726"><span class="hs-identifier hs-var">p2'</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Raw s (VertexId' (Wrap s)) v))
     (PlanarSubdivision s v e f r)
     (Vector (Raw s (VertexId' (Wrap s)) v))
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v))
forall k (s :: k) v e f r1 v2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v2 e f r1)
  (Vector (Raw s (VertexId' (Wrap s)) v))
  (Vector (Raw s (VertexId' (Wrap s)) v2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679954728"><span class="annot"><span class="annottext">rd :: Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621679954728"><span class="hs-identifier hs-var hs-var">rd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Raw s (Dart (Wrap s)) e))
     (PlanarSubdivision s v e f r)
     (Vector (Raw s (Dart (Wrap s)) e))
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Raw s (Dart (Wrap s)) e))
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (Dart (Wrap s)) e))
forall k (s :: k) v e f r1 e2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e2 f r1)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954726"><span class="hs-identifier hs-var">p2'</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (Raw s (Dart (Wrap s)) e))
     (PlanarSubdivision s v e f r)
     (Vector (Raw s (Dart (Wrap s)) e))
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Raw s (Dart (Wrap s)) e))
  (PlanarSubdivision s v e f r)
  (Vector (Raw s (Dart (Wrap s)) e))
forall k (s :: k) v e f r1 e2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e2 f r1)
  (Vector (Raw s (Dart (Wrap s)) e))
  (Vector (Raw s (Dart (Wrap s)) e2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawDartData"><span class="hs-identifier hs-var">rawDartData</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679954727"><span class="annot"><span class="annottext">rf :: Vector (RawFace s f)
</span><a href="#local-6989586621679954727"><span class="hs-identifier hs-var hs-var">rf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954733"><span class="hs-identifier hs-var">p1</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (RawFace s f))
     (PlanarSubdivision s v e f r)
     (Vector (RawFace s f))
-&gt; Vector (RawFace s f)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (RawFace s f))
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
forall k (s :: k) v e f r1 f2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f2 r1)
  (Vector (RawFace s f))
  (Vector (RawFace s f2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
</span><a href="#local-6989586621679954734"><span class="hs-operator hs-var">`mergeFaces`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679954726"><span class="hs-identifier hs-var">p2'</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting
     (Vector (RawFace s f))
     (PlanarSubdivision s v e f r)
     (Vector (RawFace s f))
-&gt; Vector (RawFace s f)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (RawFace s f))
  (PlanarSubdivision s v e f r)
  (Vector (RawFace s f))
forall k (s :: k) v e f r1 f2.
Lens
  (PlanarSubdivision s v e f r1)
  (PlanarSubdivision s v e f2 r1)
  (Vector (RawFace s f))
  (Vector (RawFace s f2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawFaceData"><span class="hs-identifier hs-var">rawFaceData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679954931"><span id="local-6989586621679954932"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeFaceData"><span class="hs-identifier hs-type">mergeFaceData</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679954932"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954932"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679954932"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954932"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954932"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954931"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954932"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-161"></span><span id="mergeFaceData"><span class="annot"><span class="annottext">mergeFaceData :: (f -&gt; f -&gt; f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
-&gt; Vector (RawFace s f)
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mergeFaceData"><span class="hs-identifier hs-var hs-var">mergeFaceData</span></a></span></span><span> </span><span id="local-6989586621679954715"><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954715"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679954714"><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954714"><span class="hs-identifier hs-var">vs1</span></a></span></span><span> </span><span id="local-6989586621679954713"><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954713"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawFace s f -&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. a -&gt; Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.cons</span></span><span> </span><span class="annot"><span class="annottext">RawFace s f
</span><a href="#local-6989586621679954711"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954710"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679954710"><span class="annot"><span class="annottext">ts :: Vector (RawFace s f)
</span><a href="#local-6989586621679954710"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.tail</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954714"><span class="hs-identifier hs-var">vs1</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall a. Vector a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.tail</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954713"><span class="hs-identifier hs-var">vs2</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679954711"><span class="annot"><span class="annottext">h :: RawFace s f
</span><a href="#local-6989586621679954711"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span id="local-6989586621679954709"><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954709"><span class="hs-identifier hs-var">hs1</span></a></span></span><span> </span><span id="local-6989586621679954708"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954708"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954714"><span class="hs-identifier hs-var">vs1</span></a></span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Getting
     (FaceData (Dart s) f) (Vector (RawFace s f)) (FaceData (Dart s) f)
-&gt; FaceData (Dart s) f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(Vector (RawFace s f) -&gt; RawFace s f)
-&gt; Optic'
     (-&gt;)
     (Const (FaceData (Dart s) f))
     (Vector (RawFace s f))
     (RawFace s f)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; RawFace s f
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span class="annot"><span class="annottext">Optic'
  (-&gt;)
  (Const (FaceData (Dart s) f))
  (Vector (RawFace s f))
  (RawFace s f)
-&gt; ((FaceData (Dart s) f
     -&gt; Const (FaceData (Dart s) f) (FaceData (Dart s) f))
    -&gt; RawFace s f -&gt; Const (FaceData (Dart s) f) (RawFace s f))
-&gt; Getting
     (FaceData (Dart s) f) (Vector (RawFace s f)) (FaceData (Dart s) f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f
 -&gt; Const (FaceData (Dart s) f) (FaceData (Dart s) f))
-&gt; RawFace s f -&gt; Const (FaceData (Dart s) f) (RawFace s f)
forall k (s :: k) f f2.
Lens
  (RawFace s f)
  (RawFace s f2)
  (FaceData (Dart s) f)
  (FaceData (Dart s) f2)
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span>
</span><span id="line-165"></span><span>             </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span id="local-6989586621679954706"><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954706"><span class="hs-identifier hs-var">hs2</span></a></span></span><span> </span><span id="local-6989586621679954705"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954705"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954713"><span class="hs-identifier hs-var">vs2</span></a></span><span class="annot"><span class="annottext">Vector (RawFace s f)
-&gt; Getting
     (FaceData (Dart s) f) (Vector (RawFace s f)) (FaceData (Dart s) f)
-&gt; FaceData (Dart s) f
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(Vector (RawFace s f) -&gt; RawFace s f)
-&gt; Optic'
     (-&gt;)
     (Const (FaceData (Dart s) f))
     (Vector (RawFace s f))
     (RawFace s f)
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s a.
(Profunctor p, Contravariant f) =&gt;
(s -&gt; a) -&gt; Optic' p f s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f) -&gt; RawFace s f
forall a. Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.head</span></span><span class="annot"><span class="annottext">Optic'
  (-&gt;)
  (Const (FaceData (Dart s) f))
  (Vector (RawFace s f))
  (RawFace s f)
-&gt; ((FaceData (Dart s) f
     -&gt; Const (FaceData (Dart s) f) (FaceData (Dart s) f))
    -&gt; RawFace s f -&gt; Const (FaceData (Dart s) f) (RawFace s f))
-&gt; Getting
     (FaceData (Dart s) f) (Vector (RawFace s f)) (FaceData (Dart s) f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(FaceData (Dart s) f
 -&gt; Const (FaceData (Dart s) f) (FaceData (Dart s) f))
-&gt; RawFace s f -&gt; Const (FaceData (Dart s) f) (RawFace s f)
forall k (s :: k) f f2.
Lens
  (RawFace s f)
  (RawFace s f2)
  (FaceData (Dart s) f)
  (FaceData (Dart s) f2)
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#faceDataVal"><span class="hs-identifier hs-var">faceDataVal</span></a></span><span>
</span><span id="line-166"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
forall k (s :: k) f.
Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-var">RawFace</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(FaceData (Dart s) f -&gt; RawFace s f)
-&gt; FaceData (Dart s) f -&gt; RawFace s f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f. Seq h -&gt; f -&gt; FaceData h f
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954709"><span class="hs-identifier hs-var">hs1</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; Seq (Dart s) -&gt; Seq (Dart s)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954706"><span class="hs-identifier hs-var">hs2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f -&gt; f -&gt; f
</span><a href="#local-6989586621679954715"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954708"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954705"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- -- | applies a function to the first value of a vector</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- onHead     :: (a -&gt; a) -&gt; V.Vector a -&gt; V.Vector a</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- onHead f v = v&amp;ix 0 %~ f</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- * Implementation Helpers</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Shift the indices in a planar subdiv by the given numbers</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- (componentId;vertexId,darts,faceIds). Note that the result is not really a</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- valid planar subdivision, so be careful when using this!</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#shift"><span class="hs-identifier hs-type">shift</span></a></span><span>                                             </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679954913"><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679954912"><span class="annot"><a href="#local-6989586621679954912"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679954911"><span class="annot"><a href="#local-6989586621679954911"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679954910"><span class="annot"><a href="#local-6989586621679954910"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679954909"><span class="annot"><a href="#local-6989586621679954909"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-179"></span><span>                                                     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-180"></span><span>                                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954912"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954911"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954910"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954909"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-181"></span><span>                                                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954912"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954911"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954910"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954909"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-182"></span><span id="shift"><span class="annot"><span class="annottext">shift :: Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#shift"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621679954703"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954703"><span class="hs-identifier hs-var">nc</span></a></span></span><span> </span><span id="local-6989586621679954702"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954702"><span class="hs-identifier hs-var">nv</span></a></span></span><span> </span><span id="local-6989586621679954701"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954701"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679954700"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954700"><span class="hs-identifier hs-var">nf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span id="local-6989586621679954699"><span class="annot"><span class="annottext">Vector (Component s r)
</span><a href="#local-6989586621679954699"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679954698"><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621679954698"><span class="hs-identifier hs-var">vd</span></a></span></span><span> </span><span id="local-6989586621679954697"><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621679954697"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679954696"><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954696"><span class="hs-identifier hs-var">rf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r
forall k (s :: k) v e f r1.
Vector (Component s r1)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (RawFace s f)
-&gt; PlanarSubdivision s v e f r1
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-var">PlanarSubdivision</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
</span><a href="#local-6989586621679954695"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621679954694"><span class="hs-identifier hs-var">vd'</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621679954693"><span class="hs-identifier hs-var">rd'</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954692"><span class="hs-identifier hs-var">rf'</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679954695"><span class="annot"><span class="annottext">cs' :: Vector (Component s r)
</span><a href="#local-6989586621679954695"><span class="hs-identifier hs-var hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679954691"><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621679954691"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Component s r
</span><a href="#local-6989586621679954691"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">Component s r -&gt; (Component s r -&gt; Component s r) -&gt; Component s r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (VertexId s 'Primal)
 -&gt; Identity (Vector (VertexId s 'Primal)))
-&gt; Component s r -&gt; Identity (Component s r)
forall k (s :: k) v e f r v'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v' e f r)
  (Vector v)
  (Vector v')
</span><a href="Data.PlaneGraph.Core.html#vertexData"><span class="hs-identifier hs-var">PG.vertexData</span></a></span><span class="annot"><span class="annottext">((Vector (VertexId s 'Primal)
  -&gt; Identity (Vector (VertexId s 'Primal)))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; ((VertexId s 'Primal -&gt; Identity (VertexId s 'Primal))
    -&gt; Vector (VertexId s 'Primal)
    -&gt; Identity (Vector (VertexId s 'Primal)))
-&gt; (VertexId s 'Primal -&gt; Identity (VertexId s 'Primal))
-&gt; Component s r
-&gt; Identity (Component s r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexId s 'Primal -&gt; Identity (VertexId s 'Primal))
-&gt; Vector (VertexId s 'Primal)
-&gt; Identity (Vector (VertexId s 'Primal))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span>  </span><span class="annot"><span class="annottext">((VertexId s 'Primal -&gt; Identity (VertexId s 'Primal))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; (VertexId s 'Primal -&gt; VertexId s 'Primal)
-&gt; Component s r
-&gt; Component s r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">VertexId s 'Primal -&gt; VertexId s 'Primal
</span><a href="#local-6989586621679954688"><span class="hs-identifier hs-var">incV</span></a></span><span>
</span><span id="line-185"></span><span>                    </span><span class="annot"><span class="annottext">Component s r -&gt; (Component s r -&gt; Component s r) -&gt; Component s r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Identity (Vector (Dart s)))
-&gt; Component s r -&gt; Identity (Component s r)
forall k (s :: k) v e f r e'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e' f r)
  (Vector e)
  (Vector e')
</span><a href="Data.PlaneGraph.Core.html#rawDartData"><span class="hs-identifier hs-var">PG.rawDartData</span></a></span><span class="annot"><span class="annottext">((Vector (Dart s) -&gt; Identity (Vector (Dart s)))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; ((Dart s -&gt; Identity (Dart s))
    -&gt; Vector (Dart s) -&gt; Identity (Vector (Dart s)))
-&gt; (Dart s -&gt; Identity (Dart s))
-&gt; Component s r
-&gt; Identity (Component s r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Dart s -&gt; Identity (Dart s))
-&gt; Vector (Dart s) -&gt; Identity (Vector (Dart s))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((Dart s -&gt; Identity (Dart s))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; (Dart s -&gt; Dart s) -&gt; Component s r -&gt; Component s r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
</span><a href="#local-6989586621679954686"><span class="hs-identifier hs-var">incD</span></a></span><span>
</span><span id="line-186"></span><span>                    </span><span class="annot"><span class="annottext">Component s r -&gt; (Component s r -&gt; Component s r) -&gt; Component s r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector (FaceId s 'Primal) -&gt; Identity (Vector (FaceId s 'Primal)))
-&gt; Component s r -&gt; Identity (Component s r)
forall k (s :: k) v e f r f'.
Lens
  (PlaneGraph s v e f r)
  (PlaneGraph s v e f' r)
  (Vector f)
  (Vector f')
</span><a href="Data.PlaneGraph.Core.html#faceData"><span class="hs-identifier hs-var">PG.faceData</span></a></span><span class="annot"><span class="annottext">((Vector (FaceId s 'Primal)
  -&gt; Identity (Vector (FaceId s 'Primal)))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; ((FaceId s 'Primal -&gt; Identity (FaceId s 'Primal))
    -&gt; Vector (FaceId s 'Primal)
    -&gt; Identity (Vector (FaceId s 'Primal)))
-&gt; (FaceId s 'Primal -&gt; Identity (FaceId s 'Primal))
-&gt; Component s r
-&gt; Identity (Component s r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(FaceId s 'Primal -&gt; Identity (FaceId s 'Primal))
-&gt; Vector (FaceId s 'Primal)
-&gt; Identity (Vector (FaceId s 'Primal))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span>    </span><span class="annot"><span class="annottext">((FaceId s 'Primal -&gt; Identity (FaceId s 'Primal))
 -&gt; Component s r -&gt; Identity (Component s r))
-&gt; (FaceId s 'Primal -&gt; FaceId s 'Primal)
-&gt; Component s r
-&gt; Component s r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">FaceId s 'Primal -&gt; FaceId s 'Primal
</span><a href="#local-6989586621679954684"><span class="hs-identifier hs-var">incFi</span></a></span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Component s r -&gt; Component s r)
-&gt; Vector (Component s r) -&gt; Vector (Component s r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Component s r)
</span><a href="#local-6989586621679954699"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679954694"><span class="annot"><span class="annottext">vd' :: Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621679954694"><span class="hs-identifier hs-var hs-var">vd'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621679954681"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621679954681"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621679954680"><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621679954680"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679954679"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679954679"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComponentId s
-&gt; VertexId' (Wrap s) -&gt; v -&gt; Raw s (VertexId' (Wrap s)) v
forall k (s :: k) ia a. ComponentId s -&gt; ia -&gt; a -&gt; Raw s ia a
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-var">Raw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s -&gt; ComponentId s
</span><a href="#local-6989586621679954678"><span class="hs-identifier hs-var">incC</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621679954681"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexId' (Wrap s)
</span><a href="#local-6989586621679954680"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679954679"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>                    </span><span class="annot"><span class="annottext">(Raw s (VertexId' (Wrap s)) v -&gt; Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
-&gt; Vector (Raw s (VertexId' (Wrap s)) v)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (VertexId' (Wrap s)) v)
</span><a href="#local-6989586621679954698"><span class="hs-identifier hs-var">vd</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679954693"><span class="annot"><span class="annottext">rd' :: Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621679954693"><span class="hs-identifier hs-var hs-var">rd'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621679954677"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621679954677"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621679954676"><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621679954676"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679954675"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679954675"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComponentId s -&gt; Dart (Wrap s) -&gt; e -&gt; Raw s (Dart (Wrap s)) e
forall k (s :: k) ia a. ComponentId s -&gt; ia -&gt; a -&gt; Raw s ia a
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#Raw"><span class="hs-identifier hs-var">Raw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s -&gt; ComponentId s
</span><a href="#local-6989586621679954678"><span class="hs-identifier hs-var">incC</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621679954677"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dart (Wrap s)
</span><a href="#local-6989586621679954676"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679954675"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>                    </span><span class="annot"><span class="annottext">(Raw s (Dart (Wrap s)) e -&gt; Raw s (Dart (Wrap s)) e)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
-&gt; Vector (Raw s (Dart (Wrap s)) e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (Raw s (Dart (Wrap s)) e)
</span><a href="#local-6989586621679954697"><span class="hs-identifier hs-var">rd</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679954692"><span class="annot"><span class="annottext">rf' :: Vector (RawFace s f)
</span><a href="#local-6989586621679954692"><span class="hs-identifier hs-var hs-var">rf'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-type">RawFace</span></a></span><span> </span><span id="local-6989586621679954674"><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
</span><a href="#local-6989586621679954674"><span class="hs-identifier hs-var">fidx</span></a></span></span><span> </span><span id="local-6989586621679954673"><span class="annot"><span class="annottext">FaceData (Dart s) f
</span><a href="#local-6989586621679954673"><span class="hs-identifier hs-var">fd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
forall k (s :: k) f.
Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; FaceData (Dart s) f -&gt; RawFace s f
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#RawFace"><span class="hs-identifier hs-var">RawFace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ComponentId s, FaceId' (Wrap s))
-&gt; (ComponentId s, FaceId' (Wrap s))
</span><a href="#local-6989586621679954672"><span class="hs-identifier hs-var">incFIdx</span></a></span><span> </span><span class="annot"><span class="annottext">((ComponentId s, FaceId' (Wrap s))
 -&gt; (ComponentId s, FaceId' (Wrap s)))
-&gt; Maybe (ComponentId s, FaceId' (Wrap s))
-&gt; Maybe (ComponentId s, FaceId' (Wrap s))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ComponentId s, FaceId' (Wrap s))
</span><a href="#local-6989586621679954674"><span class="hs-identifier hs-var">fidx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceData (Dart s) f -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621679954671"><span class="hs-identifier hs-var">incF</span></a></span><span> </span><span class="annot"><span class="annottext">FaceData (Dart s) f
</span><a href="#local-6989586621679954673"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RawFace s f -&gt; RawFace s f)
-&gt; Vector (RawFace s f) -&gt; Vector (RawFace s f)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector (RawFace s f)
</span><a href="#local-6989586621679954696"><span class="hs-identifier hs-var">rf</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621679954678"><span class="hs-identifier hs-type">incC</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621679954678"><span class="annot"><span class="annottext">incC :: ComponentId s -&gt; ComponentId s
</span><a href="#local-6989586621679954678"><span class="hs-identifier hs-var hs-var">incC</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span> </span><span id="local-6989586621679954669"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954669"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ComponentId s
forall k (s :: k). Int -&gt; ComponentId s
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#ComponentId"><span class="hs-identifier hs-var">ComponentId</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ComponentId s) -&gt; Int -&gt; ComponentId s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954669"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954703"><span class="hs-identifier hs-var">nc</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="#local-6989586621679954688"><span class="hs-identifier hs-type">incV</span></a></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621679954688"><span class="annot"><span class="annottext">incV :: VertexId s 'Primal -&gt; VertexId s 'Primal
</span><a href="#local-6989586621679954688"><span class="hs-identifier hs-var hs-var">incV</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621679954667"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954667"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s 'Primal
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; VertexId s 'Primal) -&gt; Int -&gt; VertexId s 'Primal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954667"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954702"><span class="hs-identifier hs-var">nv</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621679954686"><span class="hs-identifier hs-type">incD</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621679954686"><span class="annot"><span class="annottext">incD :: Dart s -&gt; Dart s
</span><a href="#local-6989586621679954686"><span class="hs-identifier hs-var hs-var">incD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arc</span></span><span> </span><span id="local-6989586621679954664"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954664"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679954663"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679954663"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arc s -&gt; Direction -&gt; Dart s
forall k (s :: k). Arc s -&gt; Direction -&gt; Dart s
</span><span class="hs-identifier hs-var">Dart</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Arc s
forall k (s :: k). Int -&gt; Arc s
</span><span class="hs-identifier hs-var">Arc</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Arc s) -&gt; Int -&gt; Arc s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954664"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954701"><span class="hs-identifier hs-var">nd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679954663"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679954672"><span class="annot"><span class="annottext">incFIdx :: (ComponentId s, FaceId' (Wrap s))
-&gt; (ComponentId s, FaceId' (Wrap s))
</span><a href="#local-6989586621679954672"><span class="hs-identifier hs-var hs-var">incFIdx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679954662"><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621679954662"><span class="hs-identifier hs-var">ci</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679954661"><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621679954661"><span class="hs-identifier hs-var">fi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentId s -&gt; ComponentId s
</span><a href="#local-6989586621679954678"><span class="hs-identifier hs-var">incC</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentId s
</span><a href="#local-6989586621679954662"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FaceId' (Wrap s)
</span><a href="#local-6989586621679954661"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-comment">-- observe that the fi here is the fi with respect to its original graph. Hence,</span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-comment">-- we do not want to increase those id's</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="#local-6989586621679954671"><span class="hs-identifier hs-type">incF</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679954910"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679954910"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679954671"><span class="annot"><span class="annottext">incF :: FaceData (Dart s) f -&gt; FaceData (Dart s) f
</span><a href="#local-6989586621679954671"><span class="hs-identifier hs-var hs-var">incF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-type">FaceData</span></a></span><span> </span><span id="local-6989586621679954660"><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954660"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span id="local-6989586621679954659"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954659"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (Dart s) -&gt; f -&gt; FaceData (Dart s) f
forall h f. Seq h -&gt; f -&gt; FaceData h f
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#FaceData"><span class="hs-identifier hs-var">FaceData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
</span><a href="#local-6989586621679954686"><span class="hs-identifier hs-var">incD</span></a></span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Dart s) -&gt; Seq (Dart s) -&gt; Seq (Dart s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Seq (Dart s)
</span><a href="#local-6989586621679954660"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679954659"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621679954684"><span class="hs-identifier hs-type">incFi</span></a></span><span>                       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679954913"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679954684"><span class="annot"><span class="annottext">incFi :: FaceId s 'Primal -&gt; FaceId s 'Primal
</span><a href="#local-6989586621679954684"><span class="hs-identifier hs-var hs-var">incFi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FaceId</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VertexId</span></span><span> </span><span id="local-6989586621679954658"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954658"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId s 'Dual -&gt; FaceId s 'Primal
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId s 'Dual -&gt; FaceId s 'Primal)
-&gt; (Int -&gt; VertexId s 'Dual) -&gt; Int -&gt; FaceId s 'Primal
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId s 'Dual
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FaceId s 'Primal) -&gt; Int -&gt; FaceId s 'Primal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954658"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679954700"><span class="hs-identifier hs-var">nf</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-keyword">data</span><span> </span><span id="Test"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Test"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span>
</span><span id="line-215"></span><span class="hs-keyword">newtype</span><span> </span><span id="Id"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Id"><span class="hs-identifier hs-var">Id</span></a></span></span><span> </span><span id="local-6989586621679954809"><span class="annot"><a href="#local-6989586621679954809"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Id"><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Id"><span class="hs-identifier hs-var">Id</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679954809"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle1"><span class="hs-identifier hs-type">triangle1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-219"></span><span id="triangle1"><span class="annot"><span class="annottext">triangle1 :: PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle1"><span class="hs-identifier hs-var hs-var">triangle1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679954654"><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954654"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id Test
-&gt; SimplePolygon () Rational
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision Test () () Int Rational
forall k r (proxy :: k -&gt; *) (s :: k) p f.
(Ord r, Fractional r) =&gt;
proxy s
-&gt; SimplePolygon p r -&gt; f -&gt; f -&gt; PlanarSubdivision s p () f r
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier hs-var">fromSimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test -&gt; Id Test
forall a. a -&gt; Id a
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-var">Test</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954654"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>          </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG1"><span class="hs-identifier hs-var">trianglePG1</span></a></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG1"><span class="hs-identifier hs-type">trianglePG1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-222"></span><span id="trianglePG1"><span class="annot"><span class="annottext">trianglePG1 :: SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG1"><span class="hs-identifier hs-var hs-var">trianglePG1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational
forall p r. (Eq r, Num r) =&gt; [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#fromPoints"><span class="hs-identifier hs-var">fromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational)
-&gt; ([Point 2 Rational] -&gt; [Point 2 Rational :+ ()])
-&gt; [Point 2 Rational]
-&gt; SimplePolygon () Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 Rational -&gt; Point 2 Rational :+ ())
-&gt; [Point 2 Rational] -&gt; [Point 2 Rational :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Point 2 Rational -&gt; Point 2 Rational :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational] -&gt; SimplePolygon () Rational)
-&gt; [Point 2 Rational] -&gt; SimplePolygon () Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 Rational
forall (d :: Nat) r. (Arity d, Num r) =&gt; Point d r
</span><a href="Data.Geometry.Point.Internal.html#origin"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">200</span></span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle2"><span class="hs-identifier hs-type">triangle2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-226"></span><span id="triangle2"><span class="annot"><span class="annottext">triangle2 :: PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle2"><span class="hs-identifier hs-var hs-var">triangle2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679954646"><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954646"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id Test
-&gt; SimplePolygon () Rational
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision Test () () Int Rational
forall k r (proxy :: k -&gt; *) (s :: k) p f.
(Ord r, Fractional r) =&gt;
proxy s
-&gt; SimplePolygon p r -&gt; f -&gt; f -&gt; PlanarSubdivision s p () f r
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier hs-var">fromSimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test -&gt; Id Test
forall a. a -&gt; Id a
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-var">Test</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954646"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>          </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG2"><span class="hs-identifier hs-var">trianglePG2</span></a></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG2"><span class="hs-identifier hs-type">trianglePG2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-229"></span><span id="trianglePG2"><span class="annot"><span class="annottext">trianglePG2 :: SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG2"><span class="hs-identifier hs-var hs-var">trianglePG2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational
forall p r. (Eq r, Num r) =&gt; [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#fromPoints"><span class="hs-identifier hs-var">fromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational)
-&gt; ([Point 2 Rational] -&gt; [Point 2 Rational :+ ()])
-&gt; [Point 2 Rational]
-&gt; SimplePolygon () Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 Rational -&gt; Point 2 Rational :+ ())
-&gt; [Point 2 Rational] -&gt; [Point 2 Rational :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Point 2 Rational -&gt; Point 2 Rational :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational] -&gt; SimplePolygon () Rational)
-&gt; [Point 2 Rational] -&gt; SimplePolygon () Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">30</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">30</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">40</span></span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle4"><span class="hs-identifier hs-type">triangle4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-234"></span><span id="triangle4"><span class="annot"><span class="annottext">triangle4 :: PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle4"><span class="hs-identifier hs-var hs-var">triangle4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679954643"><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954643"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id Test
-&gt; SimplePolygon () Rational
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision Test () () Int Rational
forall k r (proxy :: k -&gt; *) (s :: k) p f.
(Ord r, Fractional r) =&gt;
proxy s
-&gt; SimplePolygon p r -&gt; f -&gt; f -&gt; PlanarSubdivision s p () f r
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier hs-var">fromSimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test -&gt; Id Test
forall a. a -&gt; Id a
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-var">Test</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954643"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG4"><span class="hs-identifier hs-var">trianglePG4</span></a></span><span>
</span><span id="line-236"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG4"><span class="hs-identifier hs-type">trianglePG4</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-237"></span><span id="trianglePG4"><span class="annot"><span class="annottext">trianglePG4 :: SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG4"><span class="hs-identifier hs-var hs-var">trianglePG4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational
forall p r. (Eq r, Num r) =&gt; [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#fromPoints"><span class="hs-identifier hs-var">fromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational)
-&gt; ([Point 2 Rational] -&gt; [Point 2 Rational :+ ()])
-&gt; [Point 2 Rational]
-&gt; SimplePolygon () Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 Rational -&gt; Point 2 Rational :+ ())
-&gt; [Point 2 Rational] -&gt; [Point 2 Rational :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Point 2 Rational -&gt; Point 2 Rational :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational] -&gt; SimplePolygon () Rational)
-&gt; [Point 2 Rational] -&gt; SimplePolygon () Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">400</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">400</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">600</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">400</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">600</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">600</span></span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle3"><span class="hs-identifier hs-type">triangle3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-240"></span><span id="triangle3"><span class="annot"><span class="annottext">triangle3 :: PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle3"><span class="hs-identifier hs-var hs-var">triangle3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679954640"><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954640"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id Test
-&gt; SimplePolygon () Rational
-&gt; Int
-&gt; Int
-&gt; PlanarSubdivision Test () () Int Rational
forall k r (proxy :: k -&gt; *) (s :: k) p f.
(Ord r, Fractional r) =&gt;
proxy s
-&gt; SimplePolygon p r -&gt; f -&gt; f -&gt; PlanarSubdivision s p () f r
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#fromSimplePolygon"><span class="hs-identifier hs-var">fromSimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test -&gt; Id Test
forall a. a -&gt; Id a
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-var">Test</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="#local-6989586621679954640"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>          </span><span class="annot"><span class="annottext">SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG3"><span class="hs-identifier hs-var">trianglePG3</span></a></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG3"><span class="hs-identifier hs-type">trianglePG3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.Polygon.Core.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-243"></span><span id="trianglePG3"><span class="annot"><span class="annottext">trianglePG3 :: SimplePolygon () Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#trianglePG3"><span class="hs-identifier hs-var hs-var">trianglePG3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational
forall p r. (Eq r, Num r) =&gt; [Point 2 r :+ p] -&gt; SimplePolygon p r
</span><a href="Data.Geometry.Polygon.Core.html#fromPoints"><span class="hs-identifier hs-var">fromPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational :+ ()] -&gt; SimplePolygon () Rational)
-&gt; ([Point 2 Rational] -&gt; [Point 2 Rational :+ ()])
-&gt; [Point 2 Rational]
-&gt; SimplePolygon () Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 Rational -&gt; Point 2 Rational :+ ())
-&gt; [Point 2 Rational] -&gt; [Point 2 Rational :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Point 2 Rational -&gt; Point 2 Rational :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 Rational] -&gt; SimplePolygon () Rational)
-&gt; [Point 2 Rational] -&gt; SimplePolygon () Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">401</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">530</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">410</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">530</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Point 2 Rational
forall r. r -&gt; r -&gt; Point 2 r
</span><a href="Data.Geometry.Point.Internal.html#Point2"><span class="hs-identifier hs-var">Point2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">410</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">540</span></span><span class="hs-special">]</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#_myPS"><span class="hs-identifier hs-type">_myPS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-247"></span><span id="_myPS"><span class="annot"><span class="annottext">_myPS :: PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#_myPS"><span class="hs-identifier hs-var hs-var">_myPS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
-&gt; (Int -&gt; Int -&gt; Int)
-&gt; FaceId' Test
-&gt; PlanarSubdivision Test () () Int Rational
-&gt; PlanarSubdivision Test () () Int Rational
forall k k (s :: k) (h :: k) v e f r.
PlanarSubdivision h v e f r
-&gt; (f -&gt; f -&gt; f)
-&gt; FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHoleIn"><span class="hs-identifier hs-var">embedAsHoleIn</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle2"><span class="hs-identifier hs-var">triangle2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FaceId' Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mkFI"><span class="hs-identifier hs-var">mkFI</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle1"><span class="hs-identifier hs-var">triangle1</span></a></span><span>
</span><span id="line-248"></span><span>       </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
-&gt; PlanarSubdivision Test () () Int Rational
-&gt; PlanarSubdivision Test () () Int Rational
forall k (s :: k) v e f r.
PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r -&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#merge"><span class="hs-operator hs-var">`merge`</span></a></span><span>
</span><span id="line-249"></span><span>       </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
-&gt; (Int -&gt; Int -&gt; Int)
-&gt; FaceId' Test
-&gt; PlanarSubdivision Test () () Int Rational
-&gt; PlanarSubdivision Test () () Int Rational
forall k k (s :: k) (h :: k) v e f r.
PlanarSubdivision h v e f r
-&gt; (f -&gt; f -&gt; f)
-&gt; FaceId' s
-&gt; PlanarSubdivision s v e f r
-&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#embedAsHoleIn"><span class="hs-identifier hs-var">embedAsHoleIn</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle3"><span class="hs-identifier hs-var">triangle3</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; FaceId' Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mkFI"><span class="hs-identifier hs-var">mkFI</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision Test () () Int Rational
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#triangle4"><span class="hs-identifier hs-var">triangle4</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#mkFI"><span class="hs-identifier hs-type">mkFI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FaceId'</span></span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Merge.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-253"></span><span id="mkFI"><span class="annot"><span class="annottext">mkFI :: Int -&gt; FaceId' Test
</span><a href="Data.Geometry.PlanarSubdivision.Merge.html#mkFI"><span class="hs-identifier hs-var hs-var">mkFI</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId Test 'Dual -&gt; FaceId' Test
forall k (s :: k) (w :: World). VertexId s (DualOf w) -&gt; FaceId s w
</span><span class="hs-identifier hs-var">FaceId</span></span><span> </span><span class="annot"><span class="annottext">(VertexId Test 'Dual -&gt; FaceId' Test)
-&gt; (Int -&gt; VertexId Test 'Dual) -&gt; Int -&gt; FaceId' Test
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VertexId Test 'Dual
forall k (s :: k) (w :: World). Int -&gt; VertexId s w
</span><span class="hs-identifier hs-var">VertexId</span></span><span>
</span><span id="line-254"></span></pre></body></html>