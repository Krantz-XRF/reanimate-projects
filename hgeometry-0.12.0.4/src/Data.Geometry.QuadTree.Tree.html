<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Data.Geometry.QuadTree.Tree</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-9"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Geometry.QuadTree.Tree</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makePrisms</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifoldable</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bitraversable</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Apply</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html"><span class="hs-identifier">Data.Geometry.QuadTree.Cell</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html"><span class="hs-identifier">Data.Geometry.QuadTree.Quadrants</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html"><span class="hs-identifier">Data.Geometry.QuadTree.Split</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup.Foldable.Class</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup.Traversable.Class</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tree</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RoseTree</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Tree.Util</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TreeNode</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Our cells use Rational numbers as their numeric type</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- type CellR = Cell (RealNumber 10)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | The Actual Tree type representing a quadTree</span><span>
</span><span id="line-37"></span><span class="hs-keyword">data</span><span> </span><span id="Tree"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-var">Tree</span></a></span></span><span> </span><span id="local-6989586621679934287"><span class="annot"><a href="#local-6989586621679934287"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679934288"><span class="annot"><a href="#local-6989586621679934288"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Leaf"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679934288"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-38"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="Node"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-var">Node</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679934287"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934287"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934288"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- quadrants are stored lazily on purpose</span><span>
</span><span id="line-39"></span><span>              </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679934165"><span id="local-6989586621679934167"><span id="local-6989586621679934169"><span class="annot"><span class="annottext">Int -&gt; Tree v p -&gt; ShowS
[Tree v p] -&gt; ShowS
Tree v p -&gt; String
(Int -&gt; Tree v p -&gt; ShowS)
-&gt; (Tree v p -&gt; String) -&gt; ([Tree v p] -&gt; ShowS) -&gt; Show (Tree v p)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall v p. (Show p, Show v) =&gt; Int -&gt; Tree v p -&gt; ShowS
forall v p. (Show p, Show v) =&gt; [Tree v p] -&gt; ShowS
forall v p. (Show p, Show v) =&gt; Tree v p -&gt; String
showList :: [Tree v p] -&gt; ShowS
$cshowList :: forall v p. (Show p, Show v) =&gt; [Tree v p] -&gt; ShowS
show :: Tree v p -&gt; String
$cshow :: forall v p. (Show p, Show v) =&gt; Tree v p -&gt; String
showsPrec :: Int -&gt; Tree v p -&gt; ShowS
$cshowsPrec :: forall v p. (Show p, Show v) =&gt; Int -&gt; Tree v p -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679934160"><span id="local-6989586621679934162"><span class="annot"><span class="annottext">Tree v p -&gt; Tree v p -&gt; Bool
(Tree v p -&gt; Tree v p -&gt; Bool)
-&gt; (Tree v p -&gt; Tree v p -&gt; Bool) -&gt; Eq (Tree v p)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v p. (Eq p, Eq v) =&gt; Tree v p -&gt; Tree v p -&gt; Bool
/= :: Tree v p -&gt; Tree v p -&gt; Bool
$c/= :: forall v p. (Eq p, Eq v) =&gt; Tree v p -&gt; Tree v p -&gt; Bool
== :: Tree v p -&gt; Tree v p -&gt; Bool
$c== :: forall v p. (Eq p, Eq v) =&gt; Tree v p -&gt; Tree v p -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span id="_Node"><span id="_Leaf"><span id="local-6989586621679934158"><span id="local-6989586621679934287"><span id="local-6989586621679934288"><span class="hs-identifier">makePrisms</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Tree</span></span></span></span></span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679934151"><span id="local-6989586621679934153"><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679934149"><span class="annot"><span class="annottext">bimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; Tree a c -&gt; Tree b d
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bimap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (c -&gt; d) -&gt; Tree a c -&gt; Tree b d
forall (t :: * -&gt; * -&gt; *) a b c d.
Bitraversable t =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; t a c -&gt; t b d
</span><span class="hs-identifier hs-var">bimapDefault</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679934140"><span id="local-6989586621679934142"><span id="local-6989586621679934145"><span class="annot"><span class="hs-identifier hs-type">Bifoldable</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679934138"><span class="annot"><span class="annottext">bifoldMap :: (a -&gt; m) -&gt; (b -&gt; m) -&gt; Tree a b -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bifoldMap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; (b -&gt; m) -&gt; Tree a b -&gt; m
forall (t :: * -&gt; * -&gt; *) m a b.
(Bitraversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; (b -&gt; m) -&gt; t a b -&gt; m
</span><span class="hs-identifier hs-var">bifoldMapDefault</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bitraversable</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679934131"><span class="annot"><span class="annottext">bitraverse :: (a -&gt; f c) -&gt; (b -&gt; f d) -&gt; Tree a b -&gt; f (Tree c d)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bitraverse</span></span></span><span> </span><span id="local-6989586621679934129"><span class="annot"><span class="annottext">a -&gt; f c
</span><a href="#local-6989586621679934129"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679934128"><span class="annot"><span class="annottext">b -&gt; f d
</span><a href="#local-6989586621679934128"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679934127"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679934127"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">d -&gt; Tree c d
forall v p. p -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span> </span><span class="annot"><span class="annottext">(d -&gt; Tree c d) -&gt; f d -&gt; f (Tree c d)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; f d
</span><a href="#local-6989586621679934128"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679934127"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679934125"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679934125"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679934124"><span class="annot"><span class="annottext">Quadrants (Tree a b)
</span><a href="#local-6989586621679934124"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c -&gt; Quadrants (Tree c d) -&gt; Tree c d
forall v p. v -&gt; Quadrants (Tree v p) -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Quadrants (Tree c d) -&gt; Tree c d)
-&gt; f c -&gt; f (Quadrants (Tree c d) -&gt; Tree c d)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f c
</span><a href="#local-6989586621679934129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679934125"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f (Quadrants (Tree c d) -&gt; Tree c d)
-&gt; f (Quadrants (Tree c d)) -&gt; f (Tree c d)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Tree a b -&gt; f (Tree c d))
-&gt; Quadrants (Tree a b) -&gt; f (Quadrants (Tree c d))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; Tree a b -&gt; f (Tree c d)
forall (t :: * -&gt; * -&gt; *) (f :: * -&gt; *) a c b d.
(Bitraversable t, Applicative f) =&gt;
(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; t a b -&gt; f (t c d)
</span><span class="hs-identifier hs-var">bitraverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f c
</span><a href="#local-6989586621679934129"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; f d
</span><a href="#local-6989586621679934128"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Quadrants (Tree a b)
</span><a href="#local-6989586621679934124"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679934118"><span id="local-6989586621679934120"><span class="annot"><span class="hs-identifier hs-type">Bifoldable1</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span></span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679934112"><span class="annot"><span class="hs-identifier hs-type">Bitraversable1</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679934110"><span class="annot"><span class="annottext">bitraverse1 :: (a -&gt; f b) -&gt; (c -&gt; f d) -&gt; Tree a c -&gt; f (Tree b d)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bitraverse1</span></span></span><span> </span><span id="local-6989586621679934108"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679934108"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679934107"><span class="annot"><span class="annottext">c -&gt; f d
</span><a href="#local-6989586621679934107"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679934106"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679934106"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">d -&gt; Tree b d
forall v p. p -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span> </span><span class="annot"><span class="annottext">(d -&gt; Tree b d) -&gt; f d -&gt; f (Tree b d)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; f d
</span><a href="#local-6989586621679934107"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679934106"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679934105"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679934105"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679934104"><span class="annot"><span class="annottext">Quadrants (Tree a c)
</span><a href="#local-6989586621679934104"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Quadrants (Tree b d) -&gt; Tree b d
forall v p. v -&gt; Quadrants (Tree v p) -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Quadrants (Tree b d) -&gt; Tree b d)
-&gt; f b -&gt; f (Quadrants (Tree b d) -&gt; Tree b d)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679934108"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679934105"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f (Quadrants (Tree b d) -&gt; Tree b d)
-&gt; f (Quadrants (Tree b d)) -&gt; f (Tree b d)
forall (f :: * -&gt; *) a b. Apply f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;.&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Tree a c -&gt; f (Tree b d))
-&gt; Quadrants (Tree a c) -&gt; f (Quadrants (Tree b d))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable1 t, Apply f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; (c -&gt; f d) -&gt; Tree a c -&gt; f (Tree b d)
forall (t :: * -&gt; * -&gt; *) (f :: * -&gt; *) a b c d.
(Bitraversable1 t, Apply f) =&gt;
(a -&gt; f b) -&gt; (c -&gt; f d) -&gt; t a c -&gt; f (t b d)
</span><span class="hs-identifier hs-var">bitraverse1</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679934108"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; f d
</span><a href="#local-6989586621679934107"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Quadrants (Tree a c)
</span><a href="#local-6989586621679934104"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Fold on the Tree type.</span><span>
</span><span id="line-60"></span><span id="local-6989586621679934220"><span id="local-6989586621679934221"><span id="local-6989586621679934222"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#foldTree"><span class="hs-identifier hs-type">foldTree</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679934222"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679934221"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679934220"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934221"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679934221"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934220"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934222"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679934221"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-61"></span><span id="foldTree"><span class="annot"><span class="annottext">foldTree :: (p -&gt; b) -&gt; (v -&gt; Quadrants b -&gt; b) -&gt; Tree v p -&gt; b
</span><a href="Data.Geometry.QuadTree.Tree.html#foldTree"><span class="hs-identifier hs-var hs-var">foldTree</span></a></span></span><span> </span><span id="local-6989586621679934100"><span class="annot"><span class="annottext">p -&gt; b
</span><a href="#local-6989586621679934100"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679934099"><span class="annot"><span class="annottext">v -&gt; Quadrants b -&gt; b
</span><a href="#local-6989586621679934099"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree v p -&gt; b
</span><a href="#local-6989586621679934098"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679934098"><span class="annot"><span class="annottext">go :: Tree v p -&gt; b
</span><a href="#local-6989586621679934098"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679934097"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934097"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p -&gt; b
</span><a href="#local-6989586621679934100"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934097"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679934096"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934096"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679934095"><span class="annot"><span class="annottext">Quadrants (Tree v p)
</span><a href="#local-6989586621679934095"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Quadrants b -&gt; b
</span><a href="#local-6989586621679934099"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934096"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tree v p -&gt; b
</span><a href="#local-6989586621679934098"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Tree v p -&gt; b) -&gt; Quadrants (Tree v p) -&gt; Quadrants b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Quadrants (Tree v p)
</span><a href="#local-6989586621679934095"><span class="hs-identifier hs-var">qs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Produce a list of all leaves of a quad tree</span><span>
</span><span id="line-68"></span><span id="local-6989586621679934093"><span id="local-6989586621679934094"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#leaves"><span class="hs-identifier hs-type">leaves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934094"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934093"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679934093"><span class="hs-identifier hs-type">p</span></a></span></span></span><span>
</span><span id="line-69"></span><span id="leaves"><span class="annot"><span class="annottext">leaves :: Tree v p -&gt; NonEmpty p
</span><a href="Data.Geometry.QuadTree.Tree.html#leaves"><span class="hs-identifier hs-var hs-var">leaves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[p] -&gt; NonEmpty p
forall a. [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([p] -&gt; NonEmpty p) -&gt; (Tree v p -&gt; [p]) -&gt; Tree v p -&gt; NonEmpty p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; [p]) -&gt; (p -&gt; [p]) -&gt; Tree v p -&gt; [p]
forall (p :: * -&gt; * -&gt; *) m a b.
(Bifoldable p, Monoid m) =&gt;
(a -&gt; m) -&gt; (b -&gt; m) -&gt; p a b -&gt; m
</span><span class="hs-identifier hs-var">bifoldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[p] -&gt; v -&gt; [p]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; [p] -&gt; [p]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Converts into a RoseTree</span><span>
</span><span id="line-72"></span><span id="local-6989586621679934087"><span id="local-6989586621679934088"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#toRoseTree"><span class="hs-identifier hs-type">toRoseTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934088"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934087"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RoseTree.Tree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TreeNode</span></span><span> </span><span class="annot"><a href="#local-6989586621679934088"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934087"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-73"></span><span id="toRoseTree"><span class="annot"><span class="annottext">toRoseTree :: Tree v p -&gt; Tree (TreeNode v p)
</span><a href="Data.Geometry.QuadTree.Tree.html#toRoseTree"><span class="hs-identifier hs-var hs-var">toRoseTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p -&gt; Tree (TreeNode v p))
-&gt; (v -&gt; Quadrants (Tree (TreeNode v p)) -&gt; Tree (TreeNode v p))
-&gt; Tree v p
-&gt; Tree (TreeNode v p)
forall p b v. (p -&gt; b) -&gt; (v -&gt; Quadrants b -&gt; b) -&gt; Tree v p -&gt; b
</span><a href="Data.Geometry.QuadTree.Tree.html#foldTree"><span class="hs-identifier hs-var">foldTree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679934085"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934085"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TreeNode v p -&gt; [Tree (TreeNode v p)] -&gt; Tree (TreeNode v p)
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">RoseTree.Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; TreeNode v p
forall v a. a -&gt; TreeNode v a
</span><span class="hs-identifier hs-var">LeafNode</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934085"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>                      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679934082"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934082"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679934081"><span class="annot"><span class="annottext">Quadrants (Tree (TreeNode v p))
</span><a href="#local-6989586621679934081"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TreeNode v p -&gt; [Tree (TreeNode v p)] -&gt; Tree (TreeNode v p)
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">RoseTree.Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; TreeNode v p
forall v a. v -&gt; TreeNode v a
</span><span class="hs-identifier hs-var">InternalNode</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934082"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quadrants (Tree (TreeNode v p)) -&gt; [Tree (TreeNode v p)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">Quadrants (Tree (TreeNode v p))
</span><a href="#local-6989586621679934081"><span class="hs-identifier hs-var">qs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Computes the height of the quadtree</span><span>
</span><span id="line-77"></span><span id="local-6989586621679934077"><span id="local-6989586621679934078"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#height"><span class="hs-identifier hs-type">height</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934078"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934077"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span></span></span><span>
</span><span id="line-78"></span><span id="height"><span class="annot"><span class="annottext">height :: Tree v p -&gt; Integer
</span><a href="Data.Geometry.QuadTree.Tree.html#height"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p -&gt; Integer)
-&gt; (v -&gt; Quadrants Integer -&gt; Integer) -&gt; Tree v p -&gt; Integer
forall p b v. (p -&gt; b) -&gt; (v -&gt; Quadrants b -&gt; b) -&gt; Tree v p -&gt; b
</span><a href="Data.Geometry.QuadTree.Tree.html#foldTree"><span class="hs-identifier hs-var">foldTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; p -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer)
-&gt; (Quadrants Integer -&gt; Integer) -&gt; Quadrants Integer -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Quadrants Integer -&gt; Integer
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- * Functions operating on the QuadTree (in temrs of the 'Tree' type)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Builds a QuadTree</span><span>
</span><span id="line-87"></span><span id="local-6989586621679934183"><span id="local-6989586621679934184"><span id="local-6989586621679934185"><span id="local-6989586621679934186"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#build"><span class="hs-identifier hs-type">build</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679934186"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-88"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Splitter"><span class="hs-identifier hs-type">Splitter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934186"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934185"><span class="hs-identifier hs-type">pts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934184"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934183"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934186"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679934185"><span class="hs-identifier hs-type">pts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934184"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934183"><span class="hs-identifier hs-type">p</span></a></span></span></span></span></span><span>
</span><span id="line-89"></span><span id="build"><span class="annot"><span class="annottext">build :: Splitter r pts v p -&gt; Cell r -&gt; pts -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#build"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679934072"><span class="annot"><span class="annottext">Splitter r pts v p
</span><a href="#local-6989586621679934072"><span class="hs-identifier hs-var">shouldSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; pts -&gt; Tree v p
</span><a href="#local-6989586621679934071"><span class="hs-identifier hs-var">build'</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621679934071"><span class="annot"><span class="annottext">build' :: Cell r -&gt; pts -&gt; Tree v p
</span><a href="#local-6989586621679934071"><span class="hs-identifier hs-var hs-var">build'</span></a></span></span><span> </span><span id="local-6989586621679934070"><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934070"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679934069"><span class="annot"><span class="annottext">pts
</span><a href="#local-6989586621679934069"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Splitter r pts v p
</span><a href="#local-6989586621679934072"><span class="hs-identifier hs-var">shouldSplit</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934070"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">pts
</span><a href="#local-6989586621679934069"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>                      </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#No"><span class="hs-identifier hs-type">No</span></a></span><span> </span><span id="local-6989586621679934067"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934067"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p -&gt; Tree v p
forall v p. p -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934067"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-93"></span><span>                      </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Yes"><span class="hs-identifier hs-type">Yes</span></a></span><span> </span><span id="local-6989586621679934065"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934065"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679934064"><span class="annot"><span class="annottext">Quadrants pts
</span><a href="#local-6989586621679934064"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Quadrants (Tree v p) -&gt; Tree v p
forall v p. v -&gt; Quadrants (Tree v p) -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934065"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Quadrants (Tree v p) -&gt; Tree v p)
-&gt; Quadrants (Tree v p) -&gt; Tree v p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; pts -&gt; Tree v p
</span><a href="#local-6989586621679934071"><span class="hs-identifier hs-var">build'</span></a></span><span> </span><span class="annot"><span class="annottext">(Cell r -&gt; pts -&gt; Tree v p)
-&gt; Corners (Cell r) -&gt; Corners (pts -&gt; Tree v p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Corners (Cell r)
forall r. (Num r, Fractional r) =&gt; Cell r -&gt; Quadrants (Cell r)
</span><a href="Data.Geometry.QuadTree.Cell.html#splitCell"><span class="hs-identifier hs-var">splitCell</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934070"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Corners (pts -&gt; Tree v p) -&gt; Quadrants pts -&gt; Quadrants (Tree v p)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Quadrants pts
</span><a href="#local-6989586621679934064"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Annotate the tree with its corresponing cells</span><span>
</span><span id="line-96"></span><span id="local-6989586621679934190"><span id="local-6989586621679934191"><span id="local-6989586621679934192"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#withCells"><span class="hs-identifier hs-type">withCells</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679934192"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934192"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934191"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934190"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679934191"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934192"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679934190"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934192"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-97"></span><span id="withCells"><span class="annot"><span class="annottext">withCells :: Cell r -&gt; Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r)
</span><a href="Data.Geometry.QuadTree.Tree.html#withCells"><span class="hs-identifier hs-var hs-var">withCells</span></a></span></span><span> </span><span id="local-6989586621679934061"><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934061"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679934060"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934060"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(p :+ Cell r) -&gt; Tree (v :+ Cell r) (p :+ Cell r)
forall v p. p -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679934060"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; Cell r -&gt; p :+ Cell r
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934061"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679934058"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934058"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679934057"><span class="annot"><span class="annottext">Quadrants (Tree v p)
</span><a href="#local-6989586621679934057"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(v :+ Cell r)
-&gt; Quadrants (Tree (v :+ Cell r) (p :+ Cell r))
-&gt; Tree (v :+ Cell r) (p :+ Cell r)
forall v p. v -&gt; Quadrants (Tree v p) -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679934058"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; Cell r -&gt; v :+ Cell r
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934061"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cell r -&gt; Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r)
forall r v p.
Fractional r =&gt;
Cell r -&gt; Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r)
</span><a href="Data.Geometry.QuadTree.Tree.html#withCells"><span class="hs-identifier hs-var">withCells</span></a></span><span> </span><span class="annot"><span class="annottext">(Cell r -&gt; Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r))
-&gt; Corners (Cell r)
-&gt; Corners (Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Corners (Cell r)
forall r. (Num r, Fractional r) =&gt; Cell r -&gt; Quadrants (Cell r)
</span><a href="Data.Geometry.QuadTree.Cell.html#splitCell"><span class="hs-identifier hs-var">splitCell</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934061"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">Corners (Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r))
-&gt; Quadrants (Tree v p)
-&gt; Quadrants (Tree (v :+ Cell r) (p :+ Cell r))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Quadrants (Tree v p)
</span><a href="#local-6989586621679934057"><span class="hs-identifier hs-var">qs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Build a QuadtTree from a set of points.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- pre: the points lie inside the initial given cell.</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- running time: \(O(nh)\), where \(n\) is the number of points and</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- \(h\) is the height of the resulting quadTree.</span><span>
</span><span id="line-111"></span><span id="local-6989586621679934055"><span id="local-6989586621679934056"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#fromPoints"><span class="hs-identifier hs-type">fromPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679934056"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679934056"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934056"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679934056"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679934055"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679934056"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679934055"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-114"></span><span id="fromPoints"><span class="annot"><span class="annottext">fromPoints :: Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p))
</span><a href="Data.Geometry.QuadTree.Tree.html#fromPoints"><span class="hs-identifier hs-var hs-var">fromPoints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Splitter r [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
-&gt; Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p))
forall r pts v p.
Fractional r =&gt;
Splitter r pts v p -&gt; Cell r -&gt; pts -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Splitter r [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
forall r p.
(Fractional r, Ord r) =&gt;
Splitter r [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
</span><a href="Data.Geometry.QuadTree.Tree.html#fromPointsF"><span class="hs-identifier hs-var">fromPointsF</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | The function that can be used to build a quadTree 'fromPoints'</span><span>
</span><span id="line-117"></span><span id="local-6989586621679934181"><span id="local-6989586621679934182"><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#fromPointsF"><span class="hs-identifier hs-type">fromPointsF</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679934182"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679934182"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Splitter"><span class="hs-identifier hs-type">Splitter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679934182"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679934182"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679934181"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679934182"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679934181"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-119"></span><span id="fromPointsF"><span class="annot"><span class="annottext">fromPointsF :: Splitter r [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
</span><a href="Data.Geometry.QuadTree.Tree.html#fromPointsF"><span class="hs-identifier hs-var hs-var">fromPointsF</span></a></span></span><span> </span><span id="local-6989586621679934052"><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934052"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Point 2 r :+ p)
-&gt; Split [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
forall i v p. p -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#No"><span class="hs-identifier hs-var">No</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Point 2 r :+ p)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679934051"><span class="annot"><span class="annottext">Point 2 r :+ p
</span><a href="#local-6989586621679934051"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Point 2 r :+ p)
-&gt; Split [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
forall i v p. p -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#No"><span class="hs-identifier hs-var">No</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r :+ p) -&gt; Maybe (Point 2 r :+ p)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ p
</span><a href="#local-6989586621679934051"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span id="local-6989586621679934050"><span class="annot"><span class="annottext">[Point 2 r :+ p]
</span><a href="#local-6989586621679934050"><span class="hs-identifier hs-var">pts</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">()
-&gt; Quadrants [Point 2 r :+ p]
-&gt; Split [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
forall i v p. v -&gt; Quadrants i -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#Yes"><span class="hs-identifier hs-var">Yes</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Quadrants [Point 2 r :+ p]
 -&gt; Split [Point 2 r :+ p] () (Maybe (Point 2 r :+ p)))
-&gt; Quadrants [Point 2 r :+ p]
-&gt; Split [Point 2 r :+ p] () (Maybe (Point 2 r :+ p))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; [Point 2 r :+ p] -&gt; Quadrants [Point 2 r :+ p]
forall r p.
(Fractional r, Ord r) =&gt;
Cell r -&gt; [Point 2 r :+ p] -&gt; Quadrants [Point 2 r :+ p]
</span><a href="Data.Geometry.QuadTree.Cell.html#partitionPoints"><span class="hs-identifier hs-var">partitionPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621679934052"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ p]
</span><a href="#local-6989586621679934050"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-comment">-- (\cell -&gt; filter (`inCell` cell) pts) &lt;$&gt; splitCell c</span><span>
</span><span id="line-124"></span></pre></body></html>