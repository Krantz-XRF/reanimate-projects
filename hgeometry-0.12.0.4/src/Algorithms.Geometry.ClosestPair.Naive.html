<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  Algorithms.Geometry.ClosestPair.Naive</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Naive \O(n\^2)\) time algorithm to compute the closest pair of points among</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- \(n\) points in \(\mathbb{R}^d\).</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Algorithms.Geometry.ClosestPair.Naive</span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPair"><span class="hs-identifier">closestPair</span></a></span><span>
</span><span id="line-13"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier">closestPairWith</span></a></span><span>
</span><span id="line-14"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#DistanceFunction"><span class="hs-identifier">DistanceFunction</span></a></span><span>
</span><span id="line-15"></span><span>                                            </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">_1</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Properties.html"><span class="hs-identifier">Data.Geometry.Properties</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Properties.html#NumType"><span class="hs-identifier">NumType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Vector.html"><span class="hs-identifier">Data.Geometry.Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier">Arity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.LSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">LSeq</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Util</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Naive algorithm to compute the closest pair according to the</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- (squared) Euclidean distance in \(d\) dimensions. Note that we need</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- at least two elements for there to be a closest pair.</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- running time: \(O(dn^2)\) time.</span><span>
</span><span id="line-35"></span><span id="local-6989586621679949804"><span id="local-6989586621679949805"><span id="local-6989586621679949806"><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPair"><span class="hs-identifier hs-type">closestPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679949806"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Vector.VectorFamily.html#Arity"><span class="hs-identifier hs-type">Arity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949805"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679949806"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949805"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949806"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679949804"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Two</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949805"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949806"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679949804"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-37"></span><span id="closestPair"><span class="annot"><span class="annottext">closestPair :: LSeq 2 (Point d r :+ p) -&gt; Two (Point d r :+ p)
</span><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPair"><span class="hs-identifier hs-var hs-var">closestPair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SP (Two (Point d r :+ p)) r
-&gt; Getting
     (Two (Point d r :+ p))
     (SP (Two (Point d r :+ p)) r)
     (Two (Point d r :+ p))
-&gt; Two (Point d r :+ p)
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Two (Point d r :+ p))
  (SP (Two (Point d r :+ p)) r)
  (Two (Point d r :+ p))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SP (Two (Point d r :+ p)) r -&gt; Two (Point d r :+ p))
-&gt; (LSeq 2 (Point d r :+ p) -&gt; SP (Two (Point d r :+ p)) r)
-&gt; LSeq 2 (Point d r :+ p)
-&gt; Two (Point d r :+ p)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DistanceFunction (Point d r :+ p)
-&gt; LSeq 2 (Point d r :+ p) -&gt; SP (Two (Point d r :+ p)) r
forall r (d :: Nat) p.
Ord r =&gt;
DistanceFunction (Point d r :+ p)
-&gt; LSeq 2 (Point d r :+ p) -&gt; SP (Two (Point d r :+ p)) r
</span><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier hs-var">closestPairWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679949802"><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949802"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679949801"><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949801"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; r
forall r (d :: Nat).
(Num r, Arity d) =&gt;
Point d r -&gt; Point d r -&gt; r
</span><a href="Data.Geometry.Point.Internal.html#squaredEuclideanDist"><span class="hs-identifier hs-var">squaredEuclideanDist</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949802"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">(Point d r :+ p)
-&gt; Getting (Point d r) (Point d r :+ p) (Point d r) -&gt; Point d r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point d r) (Point d r :+ p) (Point d r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949801"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">(Point d r :+ p)
-&gt; Getting (Point d r) (Point d r :+ p) (Point d r) -&gt; Point d r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point d r) (Point d r :+ p) (Point d r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">type</span><span> </span><span id="DistanceFunction"><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#DistanceFunction"><span class="hs-identifier hs-var">DistanceFunction</span></a></span></span><span> </span><span id="local-6989586621679949798"><span class="annot"><a href="#local-6989586621679949798"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679949798"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679949798"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Properties.html#NumType"><span class="hs-identifier hs-type">NumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949798"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Naive algorithm to compute the closest pair of points (and the</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- distance realized by those points) given a distance function.  Note</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- that we need at least two elements for there to be a closest pair.</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- running time: \(O(T(d)n^2)\), where \(T(d)\) is the time required</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- to evaluate the distance between two points in \(\mathbb{R}^d\).</span><span>
</span><span id="line-48"></span><span id="local-6989586621679949843"><span id="local-6989586621679949844"><span id="local-6989586621679949845"><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier hs-type">closestPairWith</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679949845"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-49"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#DistanceFunction"><span class="hs-identifier hs-type">DistanceFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949844"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679949843"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949844"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679949843"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Two</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949844"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679949845"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679949843"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679949845"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-51"></span><span id="closestPairWith"><span class="annot"><span class="annottext">closestPairWith :: DistanceFunction (Point d r :+ p)
-&gt; LSeq 2 (Point d r :+ p) -&gt; SP (Two (Point d r :+ p)) r
</span><a href="Algorithms.Geometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier hs-var hs-var">closestPairWith</span></a></span></span><span> </span><span id="local-6989586621679949797"><span class="annot"><span class="annottext">DistanceFunction (Point d r :+ p)
</span><a href="#local-6989586621679949797"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg r (Two (Point d r :+ p)) -&gt; SP (Two (Point d r :+ p)) r
forall b a. Arg b a -&gt; SP a b
</span><a href="#local-6989586621679949796"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg r (Two (Point d r :+ p)) -&gt; SP (Two (Point d r :+ p)) r)
-&gt; (LSeq 2 (Point d r :+ p) -&gt; Arg r (Two (Point d r :+ p)))
-&gt; LSeq 2 (Point d r :+ p)
-&gt; SP (Two (Point d r :+ p)) r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Min (Arg r (Two (Point d r :+ p))) -&gt; Arg r (Two (Point d r :+ p))
forall a. Min a -&gt; a
</span><span class="hs-identifier hs-var hs-var">getMin</span></span><span> </span><span class="annot"><span class="annottext">(Min (Arg r (Two (Point d r :+ p)))
 -&gt; Arg r (Two (Point d r :+ p)))
-&gt; (LSeq 2 (Point d r :+ p) -&gt; Min (Arg r (Two (Point d r :+ p))))
-&gt; LSeq 2 (Point d r :+ p)
-&gt; Arg r (Two (Point d r :+ p))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Min (Arg r (Two (Point d r :+ p))))
-&gt; Min (Arg r (Two (Point d r :+ p)))
forall a. Semigroup a =&gt; NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">sconcat</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Min (Arg r (Two (Point d r :+ p))))
 -&gt; Min (Arg r (Two (Point d r :+ p))))
-&gt; (LSeq 2 (Point d r :+ p)
    -&gt; NonEmpty (Min (Arg r (Two (Point d r :+ p)))))
-&gt; LSeq 2 (Point d r :+ p)
-&gt; Min (Arg r (Two (Point d r :+ p)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Two (Point d r :+ p) -&gt; Min (Arg r (Two (Point d r :+ p))))
-&gt; NonEmpty (Two (Point d r :+ p))
-&gt; NonEmpty (Min (Arg r (Two (Point d r :+ p))))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Two (Point d r :+ p) -&gt; Min (Arg r (Two (Point d r :+ p)))
</span><a href="#local-6989586621679949793"><span class="hs-identifier hs-var">mkPair</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Two (Point d r :+ p))
 -&gt; NonEmpty (Min (Arg r (Two (Point d r :+ p)))))
-&gt; (LSeq 2 (Point d r :+ p) -&gt; NonEmpty (Two (Point d r :+ p)))
-&gt; LSeq 2 (Point d r :+ p)
-&gt; NonEmpty (Min (Arg r (Two (Point d r :+ p))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LSeq 2 (Point d r :+ p) -&gt; NonEmpty (Two (Point d r :+ p))
forall a. LSeq 2 a -&gt; NonEmpty (Two a)
</span><a href="Algorithms.Geometry.ClosestPair.Naive.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679949796"><span class="annot"><span class="annottext">getVal :: Arg b a -&gt; SP a b
</span><a href="#local-6989586621679949796"><span class="hs-identifier hs-var hs-var">getVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arg</span></span><span> </span><span id="local-6989586621679949790"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679949790"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679949789"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679949789"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; SP a b
forall a b. a -&gt; b -&gt; SP a b
</span><span class="hs-identifier hs-var">SP</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679949789"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679949790"><span class="hs-identifier hs-var">dist</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679949793"><span class="annot"><span class="annottext">mkPair :: Two (Point d r :+ p) -&gt; Min (Arg r (Two (Point d r :+ p)))
</span><a href="#local-6989586621679949793"><span class="hs-identifier hs-var hs-var">mkPair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Two</span></span><span> </span><span id="local-6989586621679949786"><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949786"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679949785"><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949785"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg r (Two (Point d r :+ p)) -&gt; Min (Arg r (Two (Point d r :+ p)))
forall a. a -&gt; Min a
</span><span class="hs-identifier hs-var">Min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Two (Point d r :+ p) -&gt; Arg r (Two (Point d r :+ p))
forall a b. a -&gt; b -&gt; Arg a b
</span><span class="hs-identifier hs-var">Arg</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DistanceFunction (Point d r :+ p)
</span><a href="#local-6989586621679949797"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949786"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949785"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; Two (Point d r :+ p)
forall a. a -&gt; a -&gt; Two a
</span><span class="hs-identifier hs-var">Two</span></span><span> </span><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949786"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r :+ p
</span><a href="#local-6989586621679949785"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | Produce all lists from a vec of elements. Since the Vec contains at least two</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- elements, the resulting list is non-empty</span><span>
</span><span id="line-58"></span><span id="local-6989586621679949822"><span class="annot"><a href="Algorithms.Geometry.ClosestPair.Naive.html#pairs"><span class="hs-identifier hs-type">pairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LSeq</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679949822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Two</span></span><span> </span><span class="annot"><a href="#local-6989586621679949822"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-59"></span><span id="pairs"><span class="annot"><span class="annottext">pairs :: LSeq 2 a -&gt; NonEmpty (Two a)
</span><a href="Algorithms.Geometry.ClosestPair.Naive.html#pairs"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Two a] -&gt; NonEmpty (Two a)
forall a. [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Two a] -&gt; NonEmpty (Two a))
-&gt; (LSeq 2 a -&gt; [Two a]) -&gt; LSeq 2 a -&gt; NonEmpty (Two a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Two a]
forall a. [a] -&gt; [Two a]
</span><span class="hs-identifier hs-var">uniquePairs</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Two a]) -&gt; (LSeq 2 a -&gt; [a]) -&gt; LSeq 2 a -&gt; [Two a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LSeq 2 a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span>
</span><span id="line-60"></span></pre></body></html>